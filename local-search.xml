<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>SpringCloud | Alibaba | Seata</title>
    <link href="/2022/07/29/SpringCloud%7CAlibaba%7CSeata/"/>
    <url>/2022/07/29/SpringCloud%7CAlibaba%7CSeata/</url>
    
    <content type="html"><![CDATA[<br><br><div style="text-align:center;padding:10px;border-radius:15px"><a href="http://seata.io/en-us/"><img  style="width:280px;border-radius:5px" src="https://files.catbox.moe/t60a2p.png"/></a></div><p>[TOC]</p><br><hr><br><br><h2 id="⚽️-概述"><a href="#⚽️-概述" class="headerlink" title="⚽️ 概述"></a>⚽️ 概述</h2><h3 id="解决问题：分布式事务"><a href="#解决问题：分布式事务" class="headerlink" title="解决问题：分布式事务"></a>解决问题：分布式事务</h3><p>分布式之前，单机单库</p><p>分布式之后，多机多库</p><h3 id="能干嘛？"><a href="#能干嘛？" class="headerlink" title="能干嘛？"></a>能干嘛？</h3><div style="background-image: linear-gradient(to right,#CE9FFC,#7367F0);width:100%;padding:15px 15px;border-radius:15px;color:white;"><b><span style="color:#FFF720;font-size:23px">一个 ID（Transaction ID XID）</span><br>全局唯一的事务 ID<br><br><span style="color:#FFF720;font-size:23px">三个组件模型</span><br>  Transaction Coordinator（TC）<br>Transaction Manager（TM）<br>Resource Manager（RM）<br><br><span style="color:#FFF720;font-size:23px">三个组件模型 | 说明</span><br><span style="color:#FEC163;font-size:20px">TC：</span>事务协调器，维护全局事务的运行状态，负责协调并驱动全局事务的提交或回滚<br><span style="color:#FEC163;font-size:20px">TM：</span>控制全局事务的边界，负责开启一个全局事务，并最终发起全局提交或全局回滚决议<br><span style="color:#FEC163;font-size:20px">RM：</span>控制分支事务，负责分支注册、状态汇报，并接收事务协调器的指令，驱动分支（本地）事务的提交</b><br></div><h3 id="执行流程"><a href="#执行流程" class="headerlink" title="执行流程"></a>执行流程</h3><div style="padding:5px 10px;width:100%;text-align:center"><img style="border:1px solid gray;background:white;width:70%;padding:0 8px;border-radius:20px;margin-top:5px" src="https://files.catbox.moe/sm1z18.png"></div><ol><li>TM 向 TC 申请开启一个全局事务，全局事务创建成功并生成一个全局唯一的 XID</li><li>XID 在微服务调用链路的上下文中传播</li><li>RM 向 TC 注册分支事务，将其纳入 XID 对应全局事务的管辖</li><li>TM 向 TC 发起针对 XID 的全局提交或回滚决议</li><li>TC 调度 XID 下管辖的全部分支事务完成提交或回滚请求</li></ol>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
      <category>SpringCloudAlibaba</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
      <tag>SpringCloudAlibaba</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | Alibaba | Sentinel</title>
    <link href="/2022/07/28/SpringCloud%7CAlibaba%7CSentinel/"/>
    <url>/2022/07/28/SpringCloud%7CAlibaba%7CSentinel/</url>
    
    <content type="html"><![CDATA[<br><div style="text-align:center;padding:10px;border-radius:15px"><a href="https://github.com/alibaba/sentinel"><img  style="width:280px;border-radius:5px" src="https://files.catbox.moe/4c8dsu.png"/></a></div><p>[TOC]</p><br><hr><br><br><h2 id="🎨-概念"><a href="#🎨-概念" class="headerlink" title="🎨 概念"></a>🎨 概念</h2><h3 id="与-Hystrix-对比"><a href="#与-Hystrix-对比" class="headerlink" title="与 Hystrix 对比"></a>与 Hystrix 对比</h3><p>分布式系统的流量防卫兵</p><table><thead><tr><th>Sentinel</th><th>Hystrix</th></tr></thead><tbody><tr><td>单独一个组件，可以独立出来</td><td>需要手动搭建监控平台</td></tr><tr><td>直接界面化的细颗粒度统一配置</td><td>没有 web 界面可以给我们进行更加细颗粒度化的配置流控、速率控制、服务熔断、服务降级等</td></tr></tbody></table><div style="text-align:center"><img style="width:75%;border:1px solid #eae6e6;border-radius:5px" src="https://files.catbox.moe/05vjsu.png"/></div><h3 id="Sentinel-分为两部分"><a href="#Sentinel-分为两部分" class="headerlink" title="Sentinel 分为两部分"></a>Sentinel 分为两部分</h3><ul><li><strong>核心库（Java客户端）</strong>不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo/Spring Cloud 等框架也有较好的支持</li><li><strong>控制台（Dashboard）</strong>基于 SpringBoot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用程序</li></ul><h3 id="Sentinel-有三个核心类"><a href="#Sentinel-有三个核心类" class="headerlink" title="Sentinel 有三个核心类"></a>Sentinel 有三个核心类</h3><ul><li><strong>SphU.entrty(resourceName)：</strong>定义资源</li><li><strong>Tracer：</strong>定义统计</li><li><strong>ContextUtil：</strong>定义了上下文</li></ul><br><br><br><br><br><Br><h2 id="🎮-安装"><a href="#🎮-安装" class="headerlink" title="🎮 安装"></a>🎮 安装</h2><ol><li><p>去 **<a href="https://github.com/alibaba/sentinel">GitHub</a>**下载jar 包</p></li><li><p>执行<code>java -jar  sentinel-dashboard-x.x.x.jar</code></p></li><li><p>访问 <code>http://localhost:8080</code><a href="http://localhost:8080/">【点击快速访问】</a></p></li></ol><br><br><br><br><br><Br><h2 id="🥥-小尝试"><a href="#🥥-小尝试" class="headerlink" title="🥥 小尝试"></a>🥥 小尝试</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud0starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 持久化 --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.csp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>sentinel-datasource-nacos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8401</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> cloudalibaba<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>service<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">nacos</span><span class="token punctuation">:</span><span class="token key atrule">discovery</span><span class="token punctuation">:</span><span class="token comment"># Nacos 服务注册中心</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> <span class="token key atrule">localhost</span><span class="token punctuation">:</span> <span class="token number">8848</span><span class="token key atrule">sentinel</span><span class="token punctuation">:</span><span class="token key atrule">transport</span><span class="token punctuation">:</span>  <span class="token comment"># 配置 Sentinel dashboard 地址</span><span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8080</span><span class="token comment"># 默认 8719 端口，如果被占用则会+1 自动扫描，直至找到未被占用的端口</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span><span class="token key atrule">management</span><span class="token punctuation">:</span><span class="token key atrule">endpoints</span><span class="token punctuation">:</span><span class="token key atrule">web</span><span class="token punctuation">:</span><span class="token key atrule">exposure</span><span class="token punctuation">:</span><span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">'*'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableDiscoveryClient</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainApp8401</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">MainApp8401</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlowLimitController</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testA"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token string">"-------testA"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testB"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    retrun <span class="token string">"-------testB"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><br><br><br><Br><h2 id="🏀-流控规则"><a href="#🏀-流控规则" class="headerlink" title="🏀 流控规则"></a>🏀 流控规则</h2><h4 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h4><div style="text-align:center"><img style="width:50%;border:1px solid #eae6e6;border-radius:5px" src="https://files.catbox.moe/dlcefi.png"/></div><hr><ul><li>资源名：唯一名称，默认请求路径</li><li>针对来源：Sentinel可以针对调用者进行限流，填写微服务名，默认default（不区分来源）</li><li>阈值类型 单机阈值：<ul><li>QPS（每秒钟的请求数量）：当调用该api的QPS达到阈值的时候，进行限流</li><li>线程数：当调用该api的线程数达到阈值的时候，进行限流</li></ul></li><li>是否集群：不需要集群</li><li>流控模式：<ul><li><strong>直接</strong>：api达到限流条件时，直接限流</li><li><strong>关联</strong>：当关联的资源达到阈值时，就限流自己</li><li><strong>链路</strong>：只记录指定链路上的流量(指定资源人入口资源进来的流量，如果达到阈值，就进行限流）【api级别的针对来源】</li></ul></li><li>流控效果：<ul><li>快速失败：直接失败，抛异常</li><li>Warm Up：根据codeFactor （令加载因子，默认3）的值，从阈值/codeFactor，经过预热时长，才达到设置的QPS阈值</li></ul></li></ul><br><br><br><h2 id="🪃-流控模式"><a href="#🪃-流控模式" class="headerlink" title="🪃 流控模式"></a>🪃 流控模式</h2><h4 id="1-直接（默认）"><a href="#1-直接（默认）" class="headerlink" title="1. 直接（默认）"></a>1. 直接<font color=red>（默认）</font></h4><table><thead><tr><th>名称</th><th>阈值</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td>QPS（每秒请求数）</td><td>N</td><td>当每秒请求数超过 N 时直接报错。</td><td>拒之门外</td></tr><tr><td>线程</td><td>N</td><td>当每秒线程超过 N 个则直接报错。</td><td>关门打狗</td></tr></tbody></table><h4 id="2-关联"><a href="#2-关联" class="headerlink" title="2. 关联"></a>2. 关联</h4><p>当关联的资源达到阈值时，就限流自己（B 惹事，A 挂了）。</p><div style="text-align:center"><img style="width:50%;border:1px solid #eae6e6;border-radius:5px" src="https://files.catbox.moe/xnqyjr.png"/></div><h4 id="3-链路"><a href="#3-链路" class="headerlink" title="3. 链路"></a>3. 链路</h4><br><br><Br><br><br><Br><h2 id="🏈-流控效果"><a href="#🏈-流控效果" class="headerlink" title="🏈 流控效果"></a>🏈 流控效果</h2><p>快速失败：直接失败，报错：</p><table><thead><tr><th>流控效果</th><th>效果</th><th>备注</th></tr></thead><tbody><tr><td>直接失败</td><td>超过阈值直接报错</td><td></td></tr><tr><td>预热</td><td>公式：阈值除以 coldFactor（默认 3），经过预热时长后才会达到阈值。</td><td></td></tr><tr><td>排队等待</td><td>依次处理请求</td><td>必须要是 QPS</td></tr><tr><td><font color=#f6f8fa>————————————————————————</font></td><td><font color=#f6f8fa>————————————————————————————————————</font></td><td><font color=#f6f8fa>—————-</font></td></tr></tbody></table><br><br><br><br><br><Br><h2 id="🎾-熔断降级"><a href="#🎾-熔断降级" class="headerlink" title="🎾 熔断降级"></a>🎾 熔断降级</h2><h3 id="概念-区别于-Hystrix"><a href="#概念-区别于-Hystrix" class="headerlink" title="概念 | 区别于 Hystrix"></a>概念 | 区别于 Hystrix</h3><br><div style="background-image: linear-gradient(to right,#CE9FFC,#7367F0);width:100%;padding:15px 15px;border-radius:15px;color:white;"><b>Sentinel 熔断降级会在调用链路中某个资源出现不稳定状态时（例如调用超时或异常比例升高），对这个资源的调用进行限制，让请求快速失败，避免影响到其它的资源而导致级联错误。  <br>当资源被降级后，在接下来的降级时间窗口之内，对该资源的调用都自动熔断（默认行为是抛出 DegradeException）。</b></div><br><div style="background-image: linear-gradient(to right,#FFF886,#F072B6);width:100%;padding:15px 15px;border-radius:15px;"><b>Sentinel 熔断降级<span style="color:red"> 没 有 半 开 状 态</span></b></div><br><h3 id="降级策略"><a href="#降级策略" class="headerlink" title="降级策略"></a>降级策略</h3><h4 id="RT-（平均响应时间-秒级）"><a href="#RT-（平均响应时间-秒级）" class="headerlink" title="RT （平均响应时间 | 秒级）"></a><strong><font color=#2b61a7>RT （平均响应时间 | 秒级）</font></strong></h4><p>平均响应时间 <strong>超出阈值 且 在时间窗口内通过的请求 ≥ 5</strong>，两个条件同时满足后触发降级 窗口期过后关闭断路器 RT最大4900（更大的需要通过-Dcsp.sentinel.statistic.max.rt=XXXX才能生效）异常比列（秒级）</p><table><thead><tr><th>参数名</th><th>作用</th></tr></thead><tbody><tr><td>RT</td><td>平均响应时间</td></tr><tr><td>时间窗口</td><td>恢复时间</td></tr><tr><td><font color=white>——————————————————————————————————</font></td><td><font color=white>—————————————————————————————————–</font></td></tr></tbody></table><h4 id="异常比列（秒级）"><a href="#异常比列（秒级）" class="headerlink" title="异常比列（秒级）"></a><font color=#2b61a7>异常比列（秒级）</font></h4><p><font color=#2b61a7><b>QPS ≥ 5</b></font> <font color=red><strong>且</strong></font> <font color=#2b61a7><b>异常比例（秒级统计）超过阈值</b></font>时，触发降级；时间窗口结束后，关闭降级</p><table><thead><tr><th>参数名</th><th>作用</th><th>备注</th></tr></thead><tbody><tr><td>异常比例</td><td>超过该异常比例就熔断降级</td><td>范围 [0,1]</td></tr><tr><td>时间窗口</td><td>恢复时间</td><td></td></tr><tr><td><font color=white>————————————————————————</font></td><td><font color=white>————————————————————————————————————</font></td><td><font color=white>—————-</font></td></tr></tbody></table><br><h4 id="异常数（分钟级）"><a href="#异常数（分钟级）" class="headerlink" title="异常数（分钟级）"></a><font color=#2b61a7>异常数（分钟级）</font></h4><p>异常数（分钟统计）超过阈值时，出发降级，时间窗口结束后，关闭降级</p><table><thead><tr><th>参数名</th><th>作用</th></tr></thead><tbody><tr><td>异常数</td><td>一分钟内超过该数量就熔断降级</td></tr><tr><td>时间窗口</td><td>恢复时间</td></tr><tr><td><font color=white>——————————————————————————————————</font></td><td><font color=white>—————————————————————————————————–</font></td></tr></tbody></table><br><br><Br><br><br><br><h2 id="🎱-热点限流-SentinelResource"><a href="#🎱-热点限流-SentinelResource" class="headerlink" title="🎱 热点限流 | @SentinelResource"></a>🎱 热点限流 | @SentinelResource</h2><div style="border-radius:10px;padding:3px 5px;font-size:20px;width:100%;text-align:center;background:red;color:white"><b>重要</b></div><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="何为热点？"><a href="#何为热点？" class="headerlink" title="何为热点？"></a>何为热点？</h4><p>热点即<font color=#2b61a7><strong>经常访问的数据</strong></font>。很多时候我们希望统计某个热点数据中访问频次最高的 Top K数据，并对其访问进行限制。比如：</p><ul><li>商品ID为参数，统计一段时间内最常购买的商品 ID 并进行限制</li><li>用户ID为参数，针对一酸时间内频繁访问的用户ID 进行限制心</li></ul><p>热点参数限流会統计传入参数中的热点参数，并根据配置的限流國值与模式，对包含热点参数的资源调用进行限流。热点参数限流可以看做是一种特殊的流量控制，仅对包含热点参数的资源调用生效。</p><div style="text-align:center"><img style="width:100%;border-radius:5px" src="https://files.catbox.moe/x7biyg.png"/></div><p>Sentinel 利用 LRU 策略统计最近最常访问的热点参数，结合令牌桶算法来进行参数级别的流控。热点参数限流支持集群模式。</p><br><h3 id="❶-Ribbon-系列-blockHandler-配置出错"><a href="#❶-Ribbon-系列-blockHandler-配置出错" class="headerlink" title="❶ Ribbon 系列 | blockHandler | 配置出错"></a>❶ Ribbon 系列 | blockHandler | 配置出错</h3><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td>value</td><td>资源名</td></tr><tr><td>blockHandler</td><td>服务降级的函数名（类比@<code>HystrixCommand(fallbackMethod=&quot;xxx&quot;)</code></td></tr></tbody></table><h4 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testHotKey"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"testHotKey"</span><span class="token punctuation">,</span>blockHandler<span class="token operator">=</span><span class="token string">"deal_testHotKey"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testHotKey</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"p1"</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> p1<span class="token punctuation">,</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"p2"</span><span class="token punctuation">,</span>required<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> p2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token string">"------testHotKey"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">deal_testHotKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> p1<span class="token punctuation">,</span><span class="token class-name">String</span> p2<span class="token punctuation">,</span><span class="token class-name">BlockException</span> exception<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token string">"------------deal_testHotKey，o(╥﹏╥)o"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div style="text-align:center"><img style="width:50%;border-radius:5px" src="https://files.catbox.moe/yydgrr.png"/></div><p><font color=#2b61a7><strong>第 0 个参数（p1）每秒访问次数超过 1 则会进行降级处理，执行方法<code>dal_testHotKey</code>进行友好回复</strong>。</font></p><br><h4 id="高级-参数例外项"><a href="#高级-参数例外项" class="headerlink" title="高级 | 参数例外项"></a>高级 | 参数例外项</h4><p><strong><font color=#2b61a7>支持八种基本类型</font></strong></p><ol><li>当 p1 的值是某个值是不被限流（或限流值很大）</li></ol><div style="background-image: linear-gradient(to right,#CE9FFC,#7367F0);width:100%;padding:15px 15px;border-radius:15px;color:white;"><b><span style="color:#FFF720">@SentinelResource</span><br>处理的是sentinel控制台配置的违规情况，有b1ockHandler方法配置的兜底处理;<br><span style="color:#FFF720">RuntimeException</span><br>int age = 10/0，这个是java运行时报出的运行时异常RunTimeException, @SentinelResource不管<br><br><span style="color:#FFF720">@SentinelResource主管配置出错，运行出错该走异常走异常</span><br></b></div><br><h3 id="🅽-Ribbon-系列-blockHandlerClass"><a href="#🅽-Ribbon-系列-blockHandlerClass" class="headerlink" title="🅽 Ribbon 系列 | blockHandlerClass"></a>🅽 Ribbon 系列 | blockHandlerClass</h3><p>创建 <code>CustomerBlockHandler</code> 类</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> xxxController<span class="token punctuation">&#123;</span>      <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/rateLimit/customerBlockHandler"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"customerBlockHandler"</span><span class="token punctuation">,</span>blockHandlerClass <span class="token operator">=</span> <span class="token class-name">CustomerBlockHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>blockHandler<span class="token operator">=</span><span class="token string">"handlerException1"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">customerBlockHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonRestlt</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"按url限流"</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2020</span>K<span class="token punctuation">,</span><span class="token string">"serial003x"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/rateLimit/customerBlockHandler"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"customerBlockHandler"</span><span class="token punctuation">,</span>blockHandlerClass <span class="token operator">=</span> <span class="token class-name">CustomerBlockHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>blockHandler<span class="token operator">=</span><span class="token string">"handlerException2"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">customerBlockHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonRestlt</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"按客户自定义"</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2020</span>K<span class="token punctuation">,</span><span class="token string">"serial003x"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// handler 兜底方法</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerBlockHandler</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerException1</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> exception<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">4444</span><span class="token punctuation">,</span><span class="token string">"按url 限流,global handlerException----1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerException2</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> exception<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">4444</span><span class="token punctuation">,</span><span class="token string">"按客户自定义,global handlerException----2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><h3 id="😶-Ribbon-系列-Fallback-Sentinel-整合-Ribbon-与-OpenFeign"><a href="#😶-Ribbon-系列-Fallback-Sentinel-整合-Ribbon-与-OpenFeign" class="headerlink" title="😶 Ribbon 系列 | Fallback | Sentinel 整合 Ribbon 与 OpenFeign"></a>😶 Ribbon 系列 | Fallback | Sentinel 整合 Ribbon 与 OpenFeign</h3><p><strong>微服务提供者 9003 与 9004</strong></p><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9003</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">nacos</span><span class="token punctuation">:</span><span class="token key atrule">discovery</span><span class="token punctuation">:</span><span class="token comment">## 注册进 Nacos</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span><span class="token key atrule">management</span><span class="token punctuation">:</span><span class="token key atrule">endpoints</span><span class="token punctuation">:</span><span class="token key atrule">web</span><span class="token punctuation">:</span><span class="token key atrule">exposure</span><span class="token punctuation">:</span><span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">"*"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableDiscoveryClient</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentMain9003</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentMain9003</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentController</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;server.port&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">static</span>  <span class="token punctuation">&#123;</span>    hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span><span class="token string">"asdasfasfadf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span><span class="token string">"asfdfsertsdg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span><span class="token string">"sdfgsdgsdgfs"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/paymentSQL/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Payment</span> payment <span class="token operator">=</span> hashMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"from MySQL,serverPort:"</span><span class="token operator">+</span>serverPort<span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><strong>新建 Module 消费者 cloudalibaba-consumer-nacos-order84</strong></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">84</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>order<span class="token punctuation">-</span>consumer84<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">nacos</span><span class="token punctuation">:</span><span class="token key atrule">discovery</span><span class="token punctuation">:</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span><span class="token key atrule">sentinel</span><span class="token punctuation">:</span><span class="token key atrule">transport</span><span class="token punctuation">:</span><span class="token key atrule">dashboard</span><span class="token punctuation">:</span> <span class="token key atrule">localhost</span><span class="token punctuation">:</span> <span class="token number">8080</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span><span class="token comment"># 消费者将要去访问的微服务名称（注册成功斤 nacos 的微服务提供者）</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">nacos-user-service</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContextConfig</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>  <span class="token annotation punctuation">@LoadBalanced</span>  <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">getRestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleBreakerController</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SERVICE_URL <span class="token operator">=</span> <span class="token string">"http://nacos-payment-provider"</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Resource</span>  <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/consumer/fallback/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token comment">// 情况 1 只配置 fallback</span>  <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"fallback"</span><span class="token punctuation">,</span>fallback<span class="token operator">=</span><span class="token string">"handlerFallback"</span><span class="token punctuation">)</span>  <span class="token comment">// 情况 2 只配置 blockHandler</span>  <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"fallback"</span><span class="token punctuation">,</span>blockHandler<span class="token operator">=</span><span class="token string">"blockHandler"</span><span class="token punctuation">)</span>    <span class="token comment">// 情况 3 两个都配置</span>  <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"fallback"</span><span class="token punctuation">,</span>blockHandler<span class="token operator">=</span><span class="token string">"blockHandler"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL<span class="token operator">+</span><span class="token string">"/paymentSQL/"</span><span class="token operator">+</span>id<span class="token punctuation">,</span><span class="token class-name">CommonRestlt</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllEgalArgumentException</span><span class="token punctuation">(</span><span class="token string">"IllEgalArgumentException,非法参数异常..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">"NullPointerException,该 ID 没有对应记录，空指针异常"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> handlerFallback <span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">,</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Payemnt</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span>  <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span><span class="token string">"兜底异常 HandlerFallBack，Exception 内容："</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div style="background-image: linear-gradient(to right,#CE9FFC,#7367F0);width:100%;padding:15px 15px;border-radius:15px;color:white;"><b><span style="color:#FFF720">只配 fallback</span><br>当出现报错的时候，会返回兜底的「友好界面」<br><span style="color:#FFF720">只配 blockHandler</span><br>出现报错时显示不友好的提示页面，但是多次访问限流后会返回 blockHandler 指定的方法<br><span style="color:#FFF720">两个都配置</span><br>「友好回复」超过阈值后进行「限流」</b></div><br><h3 id="Ribbon-系列-exceptionsToIgnore-异常忽略"><a href="#Ribbon-系列-exceptionsToIgnore-异常忽略" class="headerlink" title="Ribbon 系列 | exceptionsToIgnore | 异常忽略"></a>Ribbon 系列 | exceptionsToIgnore | 异常忽略</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/consumer/fallback/&#123;id&#125;"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"fallback"</span><span class="token punctuation">,</span>fallback<span class="token operator">=</span><span class="token string">"handlerFallback"</span><span class="token punctuation">,</span>blockHandler<span class="token operator">=</span><span class="token string">"blockHandler"</span><span class="token punctuation">,</span>exceptionsToIgnore<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token class-name">IllegalArgumentException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">// ☝🏻 如果是上述报错则不再执行 Fallback 方法兜底，没有降级效果</span><span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"请求成功"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><h3 id="Feign-系列"><a href="#Feign-系列" class="headerlink" title="Feign 系列"></a>Feign 系列</h3><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">84</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>order<span class="token punctuation">-</span>consumer<span class="token key atrule">cloud</span><span class="token punctuation">:</span> <span class="token key atrule">nacos</span><span class="token punctuation">:</span><span class="token key atrule">discovery</span><span class="token punctuation">:</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span><span class="token key atrule">sentinel</span><span class="token punctuation">:</span><span class="token key atrule">transport</span><span class="token punctuation">:</span><span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8080</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">nacos-user-service</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider<span class="token key atrule">feign</span><span class="token punctuation">:</span><span class="token key atrule">sentinel</span><span class="token punctuation">:</span><span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableDiscoveryClient</span><span class="token annotation punctuation">@ApringBootApplication</span><span class="token annotation punctuation">@EnableFeignClients</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderNacosMain84</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">OrderNacosMain84</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"nacos-payment-provider"</span><span class="token punctuation">,</span>fallback<span class="token operator">=</span><span class="token class-name">PaymentFallbackService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PaymentService</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/paymentSQL/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentFallbackService</span> <span class="token keyword">implements</span> <span class="token class-name">PaymentService</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">44444</span><span class="token punctuation">,</span><span class="token string">"服务降级返回-----PayemntFallbackService"</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"errorSerial"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleBreakerController</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Resource</span>  <span class="token keyword">private</span> <span class="token class-name">PaymentService</span> paymentService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/consumer/paymentSQL/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> paymentService<span class="token punctuation">.</span><span class="token function">paymentSQL</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><br><br><br><Br><h2 id="🎲-系统自适应限流"><a href="#🎲-系统自适应限流" class="headerlink" title="🎲 系统自适应限流"></a>🎲 系统自适应限流</h2><div style="text-align:center"><img style="width:100%;border-radius:5px" src="https://files.catbox.moe/6ys8or.png"/></div><p><strong><font color=#2b61a7>系统规则支持以下的模式：</font></strong></p><ul><li><strong>Load 自适应</strong>（仅对 Linux/Unix-like 机器生效）：系统的 load1 作为启发指标，进行自适应系统保护。当系统 load1 超过设定的启发值，且系统当前的并发线程数超过估算的系统容量时才会触发系统保护（BBR 阶段）。系统容量由系统的 <code>maxQps * minRt</code> 估算得出。设定参考值一般是 <code>CPU cores * 2.5</code>。</li><li><strong>CPU usage</strong>（1.5.0+ 版本）：当系统 CPU 使用率超过阈值即触发系统保护（取值范围 0.0-1.0），比较灵敏。</li><li><strong>平均 RT</strong>：当单台机器上所有入口流量的平均 RT 达到阈值即触发系统保护，单位是毫秒。</li><li><strong>并发线程数</strong>：当单台机器上所有入口流量的并发线程数达到阈值即触发系统保护。</li><li><strong>入口 QPS</strong>：当单台机器上所有入口流量的 QPS 达到阈值即触发系统保护。</li></ul><br><br><br><br><br><Br><h2 id="⚽️-Sentinel-持久化规则"><a href="#⚽️-Sentinel-持久化规则" class="headerlink" title="⚽️ Sentinel | 持久化规则"></a>⚽️ Sentinel | 持久化规则</h2><div style="background-image: linear-gradient(to right,#CE9FFC,#7367F0);width:100%;padding:15px 15px;border-radius:15px;color:white;"><b><span style="color:#FFF720">解决痛点：</span><br>每次重启项目后在 Sentinel 里面的配置都会丢失，这很不利于产品发布。<br><span style="color:#FFF720">解决方案</span><br>使用 <span style="color:#3CD500">Nacos</span> 进行配置存储。<br></b></div><br><br><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.csp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>sentinel-datasource-nacos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8401</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> cloudalibaba<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>service<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">nacos</span><span class="token punctuation">:</span><span class="token key atrule">discovery</span><span class="token punctuation">:</span><span class="token comment"># Nacos 服务注册中心</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> <span class="token key atrule">localhost</span><span class="token punctuation">:</span> <span class="token number">8848</span><span class="token key atrule">sentinel</span><span class="token punctuation">:</span><span class="token key atrule">transport</span><span class="token punctuation">:</span>  <span class="token comment"># 配置 Sentinel dashboard 地址</span><span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8080</span><span class="token comment"># 默认 8719 端口，如果被占用则会+1 自动扫描，直至找到未被占用的端口</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span><span class="token key atrule">datasource</span><span class="token punctuation">:</span><span class="token key atrule">ds1</span><span class="token punctuation">:</span><span class="token key atrule">nacos</span><span class="token punctuation">:</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span><span class="token key atrule">dataId</span><span class="token punctuation">:</span> cloudalibaba<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>service<span class="token key atrule">groupId</span><span class="token punctuation">:</span> DEFAULT_GROUP<span class="token key atrule">data-type</span><span class="token punctuation">:</span> json<span class="token key atrule">rule-type</span><span class="token punctuation">:</span> flow<span class="token key atrule">management</span><span class="token punctuation">:</span><span class="token key atrule">endpoints</span><span class="token punctuation">:</span><span class="token key atrule">web</span><span class="token punctuation">:</span><span class="token key atrule">exposure</span><span class="token punctuation">:</span><span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">'*'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">[</span>  <span class="token punctuation">&#123;</span>    <span class="token comment">// URL 资源名称</span>    <span class="token property">"resource"</span><span class="token operator">:</span><span class="token string">"/rateLimit/byUrl"</span><span class="token punctuation">,</span>    <span class="token comment">// 来源应用</span>    <span class="token property">"limitApp"</span><span class="token operator">:</span><span class="token string">"default"</span><span class="token punctuation">,</span>    <span class="token comment">// 阈值类型 0：线程数，1：QPS</span>    <span class="token property">"grade"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>    <span class="token comment">// 单击阈值</span>    <span class="token property">"count"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>    <span class="token comment">// 流控模式 0：直接1：关联2：链路</span>    <span class="token property">"storategy"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">// 流控效果 0:直接失败1：预热WarmUp2：排队等待</span>    <span class="token property">"controlBehavior"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">// 是否集群</span>    <span class="token property">"clusterMode"</span><span class="token operator">:</span><span class="token boolean">false</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div style="background-image: linear-gradient(to right,#CE9FFC,#7367F0);width:100%;padding:15px 15px;border-radius:15px;color:white;"><b><span style="color:#FFF720">停机后没有了，但是开机后会再次出现</span><br></div><br><br><br><br><Br><br><Br><br><Br><br>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
      <category>SpringCloudAlibaba</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
      <tag>SpringCloudAlibaba</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSS | 颜色显示</title>
    <link href="/2022/07/28/%E5%89%8D%E7%AB%AF/css/CSS%20%7C%20%E9%A2%9C%E8%89%B2%E6%98%BE%E7%A4%BA/"/>
    <url>/2022/07/28/%E5%89%8D%E7%AB%AF/css/CSS%20%7C%20%E9%A2%9C%E8%89%B2%E6%98%BE%E7%A4%BA/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 直接用名字 */</span><span class="token property">color</span><span class="token punctuation">:</span> white<span class="token comment">/* # */</span><span class="token property">color</span><span class="token punctuation">:</span> #ffffff <span class="token comment">/* rgb(红,绿,蓝) */</span><span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span>255<span class="token punctuation">,</span>255<span class="token punctuation">)</span><span class="token comment">/* rgba(红,绿,蓝,0~1透明度) */</span><span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>225<span class="token punctuation">,</span>225<span class="token punctuation">,</span>225<span class="token punctuation">,</span>0.5<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
      <category>CSS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>前端 | 一个有趣的 hover 效果</title>
    <link href="/2022/07/28/%E5%89%8D%E7%AB%AF/%E6%95%88%E6%9E%9C/%E4%B8%80%E4%B8%AA%E6%9C%89%E8%B6%A3%E7%9A%84%20hover%20%E6%95%88%E6%9E%9C/"/>
    <url>/2022/07/28/%E5%89%8D%E7%AB%AF/%E6%95%88%E6%9E%9C/%E4%B8%80%E4%B8%AA%E6%9C%89%E8%B6%A3%E7%9A%84%20hover%20%E6%95%88%E6%9E%9C/</url>
    
    <content type="html"><![CDATA[<p><a href="https://www.bilibili.com/video/BV1Bg411f7o5?spm_id_from=333.999.0.0&vd_source=32c908a2f8edcccb3fa042cf11b101bc"><strong>来源：Bilibili</strong></a></p><br><div style="text-align:center"><img src="https://files.catbox.moe/4krqh8.gif" style="width:100%"/></div><br><div style="display:flex"><div style="text-align:center;padding:0 10px 0 0"><img src="https://files.catbox.moe/rbsrx1.png"></div><div style="text-align:center;padding:0 0 10px 0"><img src="https://files.catbox.moe/a0z0bm.png"></div></div><br><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>hover 效果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./index.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Login<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>账号<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>密码<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token keyword">let</span> span        <span class="token keyword">let</span> inTime<span class="token punctuation">,</span>outTime        <span class="token comment">// 获取 Login</span>        <span class="token keyword">let</span> login<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.login'</span><span class="token punctuation">)</span>        <span class="token keyword">let</span> isIn <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 默认开关打开</span>        <span class="token keyword">let</span> isOut        <span class="token comment">// 鼠标进入事件</span>        login<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mouseenter'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            isOut <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// 莫仍环比</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>isIn<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                inTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token comment">// 生成 span 元素</span>                span <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span>                login<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>span<span class="token punctuation">)</span>                <span class="token comment">// span 去使用 in 动画</span>                span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>animation <span class="token operator">=</span> <span class="token string">'in .5s ease-out forwards'</span>                <span class="token comment">// 计算 top 和 left 的值</span>                <span class="token keyword">let</span> top <span class="token operator">=</span> e<span class="token punctuation">.</span>clientY <span class="token operator">-</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>                <span class="token keyword">let</span> left <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX <span class="token operator">-</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">;</span>                span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> top <span class="token operator">+</span><span class="token string">'px'</span>                span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> left <span class="token operator">+</span><span class="token string">'px'</span>                isIn <span class="token operator">=</span> <span class="token boolean">false</span>    <span class="token comment">// 当我们执行完程序后 关闭</span>                isOut <span class="token operator">=</span> <span class="token boolean">true</span>    <span class="token comment">// 当我们执行完程序后 打开</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 鼠标离开事件</span>        login<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mouseleave'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>isOut<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                outTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">let</span> passTime <span class="token operator">=</span> outTime <span class="token operator">-</span> inTime<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>passTime<span class="token operator">&lt;</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token function">setTimeout</span><span class="token punctuation">(</span>mouseleave<span class="token punctuation">,</span><span class="token number">500</span><span class="token operator">-</span>passTime<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 已经经过的时间就不要了</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token function">mouseleave</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">function</span> <span class="token function">mouseleave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>animation <span class="token operator">=</span> <span class="token string">'out .5s ease-out forwards'</span>                <span class="token comment">// 计算 top 和 left 的值</span>                <span class="token keyword">let</span> top <span class="token operator">=</span> e<span class="token punctuation">.</span>clientY <span class="token operator">-</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>                <span class="token keyword">let</span> left <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX <span class="token operator">-</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">;</span>                span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> top <span class="token operator">+</span><span class="token string">'px'</span>                span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> left <span class="token operator">+</span><span class="token string">'px'</span>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    login<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>span<span class="token punctuation">)</span>                    isIn <span class="token operator">=</span> <span class="token boolean">true</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div class="code-wrapper"><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">*</span><span class="token punctuation">&#123;</span>    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> #eeeeee<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">body</span><span class="token punctuation">&#123;</span>    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>    <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>    <span class="token property">background-color</span><span class="token punctuation">:</span> #2c3e50<span class="token punctuation">;</span>    <span class="token comment">/* background-image: linear-gradient(to right,#fbc2eb,#a6c1ee); */</span><span class="token punctuation">&#125;</span><span class="token selector">.login</span><span class="token punctuation">&#123;</span>    <span class="token comment">/* 超出部分隐藏 */</span>    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>    <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> 450px<span class="token punctuation">;</span>    <span class="token property">background-color</span><span class="token punctuation">:</span> #34495e<span class="token punctuation">;</span>    <span class="token property">border-radius</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>    <span class="token property">box-shadow</span><span class="token punctuation">:</span> 10px 10px 20px <span class="token function">rgba</span><span class="token punctuation">(</span>33<span class="token punctuation">,</span>44<span class="token punctuation">,</span>55<span class="token punctuation">,</span> .3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">h1</span><span class="token punctuation">&#123;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> 45px<span class="token punctuation">;</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> 400<span class="token punctuation">;</span>    <span class="token comment">/* 提高层级 */</span>    <span class="token property">z-index</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">form</span><span class="token punctuation">&#123;</span>    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>    <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>    <span class="token property">justify-content</span><span class="token punctuation">:</span> space-around<span class="token punctuation">;</span>    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> 230px<span class="token punctuation">;</span>    <span class="token comment">/* 提高层级 */</span>    <span class="token property">z-index</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">input</span><span class="token punctuation">&#123;</span>    <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>    <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>    <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>    <span class="token property">border-bottom</span><span class="token punctuation">:</span> 2px solid #eeeeee<span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>    <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">input::placeholder</span><span class="token punctuation">&#123;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> #eeeeee<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">button</span><span class="token punctuation">&#123;</span>    <span class="token property">width</span><span class="token punctuation">:</span> 180px<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> 36px<span class="token punctuation">;</span>    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #eeeeee<span class="token punctuation">;</span>    <span class="token property">border-radius</span><span class="token punctuation">:</span> 18px<span class="token punctuation">;</span>    <span class="token property">background-color</span><span class="token punctuation">:</span>transparent<span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>    <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">span</span><span class="token punctuation">&#123;</span>    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token property">background-color</span><span class="token punctuation">:</span> #916968<span class="token punctuation">;</span>    <span class="token comment">/* 鼠标居中 */</span>    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* 圆形展开 */</span>    <span class="token property">border-radius</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 鼠标进图 login 时的动画 */</span><span class="token atrule"><span class="token rule">@keyframes</span> in</span><span class="token punctuation">&#123;</span>    <span class="token selector">0%</span>    <span class="token punctuation">&#123;</span>        <span class="token property">width</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>        <span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token selector">100%</span>    <span class="token punctuation">&#123;</span>        <span class="token property">width</span><span class="token punctuation">:</span> 1200px<span class="token punctuation">;</span>        <span class="token property">height</span><span class="token punctuation">:</span> 1200px<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/* 鼠标离开 login 时的动画 */</span><span class="token atrule"><span class="token rule">@keyframes</span> out</span><span class="token punctuation">&#123;</span>    <span class="token selector">0%</span>    <span class="token punctuation">&#123;</span>        <span class="token property">width</span><span class="token punctuation">:</span> 1200px<span class="token punctuation">;</span>        <span class="token property">height</span><span class="token punctuation">:</span> 1200px<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token selector">100%</span><span class="token punctuation">&#123;</span>        <span class="token property">width</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>        <span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
      <category>效果</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
      <tag>效果</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSS | 渐变效果</title>
    <link href="/2022/07/28/%E5%89%8D%E7%AB%AF/css/css%20%7C%20%E6%B8%90%E5%8F%98%E6%95%88%E6%9E%9C/"/>
    <url>/2022/07/28/%E5%89%8D%E7%AB%AF/css/css%20%7C%20%E6%B8%90%E5%8F%98%E6%95%88%E6%9E%9C/</url>
    
    <content type="html"><![CDATA[<div class="code-wrapper"><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>to right<span class="token punctuation">,</span>#fbc2eb<span class="token punctuation">,</span>#a6c1ee<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
      <category>CSS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | Alibaba | Nacos 在 MacOS 上启动失败的解决方案</title>
    <link href="/2022/07/27/SpringCloud%7CAlibaba%7CNacos%E5%9C%A8MacOS%E4%B8%8A%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <url>/2022/07/27/SpringCloud%7CAlibaba%7CNacos%E5%9C%A8MacOS%E4%B8%8A%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
    
    <content type="html"><![CDATA[<br><h2 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h2><blockquote><p>系统：Monterey 12.5</p><p>芯片：M1</p><p>型号：MacBook Air 2020 款</p></blockquote><div style="text-align:center"><img style="width:85%" src="https://files.catbox.moe/qduqap.png"/></div><br><br><h2 id="可能造成启动失败的问题-及-解决方案"><a href="#可能造成启动失败的问题-及-解决方案" class="headerlink" title="可能造成启动失败的问题 及 解决方案"></a>可能造成启动失败的问题 及 解决方案</h2><h3 id="问题一"><a href="#问题一" class="headerlink" title="问题一"></a>问题一</h3><p>没有安装 Java 「或」 环境变量中没有 JAVA_HOME  「或」 JAVA_HOME 指向路径不对</p><h4 id="解决方案-一"><a href="#解决方案-一" class="headerlink" title="解决方案 一"></a>解决方案 一</h4><p>配置环境变量</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">## 去 Orcal 官网安装 Java sudo vim ~&#x2F;.bash_profile## 将以下内容粘贴到文件中（自己修改下相关路径）export JAVA_HOME&#x3D;&#x2F;Library&#x2F;Java&#x2F;JavaVirtualMachines&#x2F;jdk1.8.0_311.jdk&#x2F;Contents&#x2F;Homeexport PATH&#x3D;$JAVA_HOME&#x2F;bin:$PATH:.:&#x2F;Users&#x2F;hsk&#x2F;.codeexpander&#x2F;installation&#x2F;node_modules&#x2F;.bin:&#x2F;Applications&#x2F;Codeexpander.app&#x2F;Contents&#x2F;Resources&#x2F;app&#x2F;app&#x2F;nodes:&#x2F;Applications&#x2F;Codeexpander.app&#x2F;Contents&#x2F;Resources&#x2F;app&#x2F;app&#x2F;node_modules&#x2F;.bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><h4 id="解决方案-二-暴力修改"><a href="#解决方案-二-暴力修改" class="headerlink" title="解决方案 二 | 暴力修改"></a>解决方案 二 | 暴力修改</h4><p>修改<code>nacos/bin/startup.sh</code>文件，将 <code>JAVA_HOME</code> 直接写在里面</p><p>如下图所示，直接在 <code>JAVA_HOME</code> 后面添加 Java 路径就可以</p><div style="text-align:center"><img style="width:85%" src="https://files.catbox.moe/4en87x.png"/></div><h2 id="可能出现的问题二"><a href="#可能出现的问题二" class="headerlink" title="可能出现的问题二"></a>可能出现的问题二</h2><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>权限不足</p><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p>在启动命令前面加上<code>sudo</code></p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">## 启动 Nacossudo sh startup.sh -m standalone## 关闭 Nacossudo .&#x2F;shutdown.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Error</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringCloud</tag>
      
      <tag>SpringCloudAlibaba</tag>
      
      <tag>Error</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | Alibaba | Nacos</title>
    <link href="/2022/07/27/SpringCloud%20%7C%20Alibaba%20%7C%20Nacos/"/>
    <url>/2022/07/27/SpringCloud%20%7C%20Alibaba%20%7C%20Nacos/</url>
    
    <content type="html"><![CDATA[<br><div style="text-align:center;padding:10px;border-radius:15px"><a href="https://nacos.io/zh-cn/"><img  style="width:280px;border-radius:5px" src="https://files.catbox.moe/jyxm76.png"/></a></div><p><font size=2 color=darkgray>前面四个字母分别为 Naming 与 Configuration 的前两个字母，最后的 s 为 Service。</font></p><hr><p>[TOC]</p><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><h3 id="是什么？"><a href="#是什么？" class="headerlink" title="是什么？"></a>是什么？</h3><p>一个更易于构建云原生应用的动态服务发现、配置管理和服务管理平台。</p><p>Nacos = Eureka + Config + Bus</p><div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/7uo4z3.png"/></div><br><h3 id="特性："><a href="#特性：" class="headerlink" title="特性："></a>特性：</h3><ul><li><strong>单机模式 ：</strong>用于测试和单机使用</li><li><strong>集群模式 ：</strong>用于生产环境，确保高可用</li><li><strong>多集群模式：</strong>用于多数据中心场景</li></ul><br><h2 id="安装-Nacos"><a href="#安装-Nacos" class="headerlink" title="安装 Nacos"></a>安装 Nacos</h2><h3 id="Win-Mac-安装"><a href="#Win-Mac-安装" class="headerlink" title="Win/Mac 安装"></a>Win/Mac 安装</h3><ol><li>在 <a href="https://github.com/alibaba/nacos"><strong>GitHub</strong></a> 下载 Nacos RELEASE 版本</li><li>解压缩</li><li><code>cd nacos/bin</code></li><li>启动<ol><li>Mac/Linux/Unix <code>sh startup.sh -m standalone</code></li><li>Windows <code>startup.cmd -m standalone</code></li></ol></li></ol><br><h3 id="Linux-安装"><a href="#Linux-安装" class="headerlink" title="Linux 安装"></a>Linux 安装</h3><br><br><h2 id="🪵-小实战-Nacos-替代-Eureka-作为-服务注册中心"><a href="#🪵-小实战-Nacos-替代-Eureka-作为-服务注册中心" class="headerlink" title="🪵 小实战 | Nacos 替代 Eureka 作为-服务注册中心"></a>🪵 小实战 | Nacos 替代 Eureka 作为-服务注册中心</h2><h4 id="9001-生产者"><a href="#9001-生产者" class="headerlink" title="9001 | 生产者"></a>9001 | 生产者</h4><ol><li>新建 Module<code>Cloudalibaba-provider-payment-9001</code></li><li>配置 xml 与 yml</li></ol><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;latest.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">server:port: 9001spring:application:name: nacos-payment-providercloud:nacos:discovery:server-addr: localhost:8848 # 配置 Nacos 地址management:endpoints:web:exposure:include: &quot;*&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableDiscoveryClient</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NacosProviderDemoApplication</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NacosProviderDemoApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentController</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;server.port&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/payment/nacos/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPayment</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token string">"Nacos registry,serverPort"</span><span class="token operator">+</span>serverPort<span class="token operator">+</span><span class="token string">"\tid:"</span><span class="token operator">+</span>id<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><h4 id="9002-与-9001-一致-生产者"><a href="#9002-与-9001-一致-生产者" class="headerlink" title="9002 | 与 9001 一致 | 生产者"></a>9002 | 与 9001 一致 | 生产者</h4><br><h4 id="83-消费者"><a href="#83-消费者" class="headerlink" title="83 | 消费者"></a>83 | 消费者</h4><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;latest.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">server:port: 83spring:application:name: nacos-order-consumercloud:nacos:discovery:server-addr: localhost:8848 # 配置 Nacos 地址service-url:nacos-user-service: http:&#x2F;&#x2F;nacos-payment-provider<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableDiscoveryClient</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentMain9002</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentMain9002</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContextConfig</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Bean</span>  <span class="token annotation punctuation">@LoadBalance</span>  <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">getRestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderNacosController</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>  <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;service-url.nacos-user-service&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> serverURL<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/consumer/payment/nacos/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>serverURL<span class="token operator">+</span><span class="token string">"/payment/nacos/"</span><span class="token operator">+</span>id<span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><blockquote><h4 id="切换模式"><a href="#切换模式" class="headerlink" title="切换模式"></a>切换模式</h4><p>curl -X PUT ‘$NACOS_SERVER:8848/nacos/v1/ns/operator/switches?entry=serverMode&amp;value=CP’</p></blockquote><h2 id="🪵-小实战-Nacos-替代-Config-作为-服务配置中心"><a href="#🪵-小实战-Nacos-替代-Config-作为-服务配置中心" class="headerlink" title="🪵 小实战 | Nacos 替代 Config 作为-服务配置中心"></a>🪵 小实战 | Nacos 替代 Config 作为-服务配置中心</h2><h3 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a>相关配置</h3><h4 id="xml-文件"><a href="#xml-文件" class="headerlink" title="xml 文件"></a>xml 文件</h4><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- Nacos 作为配置中心 --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- Nacos 作为服务注册 --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;latest.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="yml-文件"><a href="#yml-文件" class="headerlink" title="yml 文件"></a>yml 文件</h4><p>bootstrap.yml</p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">## 全局配置bootstrap.yml &gt; 局部配置 application.ymlserver:port: 3377spring:application:name: nacos-config-clientcloud:nacos:discovery:server-addr: localhost:8848 # Nacos 作为服务注册地址config:server-addr: localhost: 8848 # Nacos 作为配置中心地址file-extension: yaml # 指定为 yaml 格式的配置# $&#123;spring.application.name&#125;-$&#123;spring.profile.active&#125;.$&#123;spring.cloud.nacos.config.file-extension&#125;# 上述内容为：nacos-config-client-dev.yaml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div style="text-align:center"><img style="width:75%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/0056py.png"/></div><br><div style="text-align:center"><img style="width:75%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/zjkp79.png"/></div><br><p>application.yml</p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">spring:profiles:active: dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h4 id="主启动"><a href="#主启动" class="headerlink" title="主启动"></a>主启动</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableDiscoveryClient</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NacosConfigClientMain3377</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NacosConfigClientMain3377</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RefreshScope</span> <span class="token comment">// Nacos 支持动态刷新</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientController</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;config.info&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> configInfo<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/config/info"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getConfigInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> configInfo<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="进入-Nacos-html-『-localhost-8848-nacos-』"><a href="#进入-Nacos-html-『-localhost-8848-nacos-』" class="headerlink" title="进入 Nacos.html 『 localhost:8848/nacos 』"></a>进入 Nacos.html 『 localhost:8848/nacos 』</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">$&#123;spring.application.name&#125;-$&#123;spring.profile.active&#125;.$&#123;spring.cloud.nacos.config.file-extension&#125;# 上述内容为：nacos-config-client-dev.yml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>新建配置</p><div style="display:flex"><div style="text-align:center"><img style="width:90%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/3kn5l4.png"/></div><div style="text-align:center"><img style="width:90%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/rhtwe9.png"/></div></div><h3 id="命名空间-分类设计"><a href="#命名空间-分类设计" class="headerlink" title="命名空间 | 分类设计"></a>命名空间 | 分类设计</h3><h4 id="是什么？-1"><a href="#是什么？-1" class="headerlink" title="是什么？"></a>是什么？</h4><p>类似 Java 里面的 package 包名和类名</p><p>最外层的 namespace 可以用于区分部署环境，Group 和 DataID 逻辑上区分两个目标对象。</p><div style="text-align:center;background:gray;border-radius:25px;border:1px solid black;height:300px;padding:10px"><span style="margin-top:20px;color:white"><b>NameSpace</b></span><br><div style="text-align:center;background:orange;border-radius:25px;border:1px solid black;height:240px;padding:10px"><span style="margin-top:20px;color:white"><b>Group</b></span><br><div style="text-align:center;background:pink;border-radius:25px;border:1px solid black;height:190px;padding:10px"><span style="margin-top:20px;color:white"><b>Service</b></span><br><div style="display:flex;text-align:center;padding:20px"><div style="width:30%;background:#5fa2dd;border-radius:10px;border:1px solid darkgray;display:center;padding:10px;margin-left:10%;color:white">Cluster1<br><div style="border-radius:5px;background:#aec0e6;margin-top:10px;padding:5px 3px;font-size:13px;font-size:10px">Instance1</div><div style="border-radius:5px;background:#aec0e6;margin-top:15px;padding:5px 3px;font-size:13px;font-size:10px">Instance2</div></div><div style="width:30%;background:#5fa2dd;border-radius:10px;border:1px solid darkgray;display:center;padding:10px;margin-left:20%;color:white">Cluster2<br><div style="border-radius:5px;background:#aec0e6;margin-top:10px;padding:5px 3px;font-size:10px">Instance3</div><div style="border-radius:5px;background:#aec0e6;margin-top:15px;padding:5px 3px;font-size:10px">Instance4</div></div></div></div></div></div><br><p><font color=#2b61a7><strong>默认情况：</strong><br><strong>Namespace=public, Group=DEFAULT_GROUP, 默认Cluster是EDEFAULT。</strong></font><br>Nacos默认的命名空间是public, Namespace主要用来实现隔离。<br>比如说我们现在有三个环境：开发、测试、生产环境，我们就可以创建三个Namespace， 不同的Namespace之间是隔离的。</p><p>Group 默认是 DEFAULT_GROUP，GROUP 可以把不同的微服务划分到同一个分组里面去。</p><br><br><h3 id="DataID"><a href="#DataID" class="headerlink" title="DataID"></a>DataID</h3><p><strong>没有默认，需要取名字，取名规则：</strong></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">$&#123;spring.application.name&#125;-$&#123;spring.profile.active&#125;.$&#123;spring.cloud.nacos.config.file-extension&#125;# 本项目为：nacos-config-client-dev.yaml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><blockquote><p>指定 <code>spring.profile.active</code>和配置文件的 <code>DataID</code>来使不同环境下读取不同的配置。</p><p>默认空间+默认分组+新建 <code>dev</code> 和 <code>test</code> 两个 DataID</p></blockquote><p><strong>NacosConfig:</strong>    <code>nocas-config-client-test.yaml</code></p><div class="code-wrapper"><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">config</span><span class="token punctuation">:</span><span class="token key atrule">info</span><span class="token punctuation">:</span> from nacos config center<span class="token punctuation">,</span>nacos<span class="token punctuation">-</span>config<span class="token punctuation">-</span>client<span class="token punctuation">-</span>test.yaml<span class="token punctuation">,</span>version=2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h3 id="Group"><a href="#Group" class="headerlink" title="Group"></a>Group</h3><p><strong>默认: <font color=#5891ff>DEFAULT_GROUP</font></strong></p><p>项目中使用：</p><p>在<code>config</code>下增加一个 <code>group:</code>就可以了。</p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>config<span class="token punctuation">-</span>client<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">nacos</span><span class="token punctuation">:</span><span class="token key atrule">discovery</span><span class="token punctuation">:</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment"># Nacos 作为服务注册地址</span><span class="token key atrule">config</span><span class="token punctuation">:</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> <span class="token key atrule">localhost</span><span class="token punctuation">:</span> <span class="token number">8848</span> <span class="token comment"># Nacos 作为配置中心地址</span><span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yaml <span class="token comment"># 指定为 yaml 格式的配置</span><span class="token key atrule">group</span><span class="token punctuation">:</span> TEST_GROUP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="NameSpace-命名空间"><a href="#NameSpace-命名空间" class="headerlink" title="NameSpace 命名空间"></a>NameSpace 命名空间</h3><p>在 NacosWeb 上创建命名空间，创建完毕之后首页最上方会显示命名空间：</p><br><div style="text-align:center"><img style="width:75%;border:1px solid #eae6e6;border-radius:25px" src="https://files.catbox.moe/95nerp.png"/></div><br><p>命名空间创建之后会有一个<code>命名空间名称</code>或<code>命名空间 ID</code></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>config<span class="token punctuation">-</span>client<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">nacos</span><span class="token punctuation">:</span><span class="token key atrule">discovery</span><span class="token punctuation">:</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment"># Nacos 作为服务注册地址</span><span class="token key atrule">config</span><span class="token punctuation">:</span><span class="token key atrule">server-addr</span><span class="token punctuation">:</span> <span class="token key atrule">localhost</span><span class="token punctuation">:</span> <span class="token number">8848</span> <span class="token comment"># Nacos 作为配置中心地址</span><span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yaml <span class="token comment"># 指定为 yaml 格式的配置</span><span class="token key atrule">group</span><span class="token punctuation">:</span> TEST_GROUP<span class="token key atrule">namespace</span><span class="token punctuation">:</span> nameSpaceId<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><br><h2 id="🏀-Nacos-集群和持久化配置（重要）"><a href="#🏀-Nacos-集群和持久化配置（重要）" class="headerlink" title="🏀 Nacos 集群和持久化配置（重要）"></a>🏀 Nacos 集群和持久化配置（重要）</h2><div style="border-radius:10px;padding:3px 5px;font-size:20px;width:100%;text-align:center;background:red;color:white"><b>重要</b></div><br><div style="text-align:center"><img style="width:75%;border:1px solid #eae6e6;border-radius:25px" src="https://files.catbox.moe/dl4nzg.png"/></div><br><p><strong>VIP:</strong> 虚拟 IP（Virtual IP）可以考虑使用 Nginx</p><div style="text-align:center"><img style="width:45%;border:1px solid #eae6e6;border-radius:25px" src="https://files.catbox.moe/zb67fv.png"/></div><h3 id="Nacos-数据存储-Derby-→-MySQL"><a href="#Nacos-数据存储-Derby-→-MySQL" class="headerlink" title="Nacos 数据存储 Derby → MySQL"></a>Nacos 数据存储 Derby → MySQL</h3><h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><p>自带 Derby 嵌入式数据库，但是在集群模式下，N 个 Nacos 组成的集群就会有 N 个 Derby 数据库，会导致每个 Nacos 的数据不一致，因此需要切换到 <strong>MySQL</strong></p><h4 id="配置方式"><a href="#配置方式" class="headerlink" title="配置方式"></a>配置方式</h4><p><strong>打开并在 Navicat 中执行文件 ：</strong><code>/nacos/conf/nacos-mysql.sql</code></p><p><strong>打开并编辑文件：</strong> <code>/nacos/conf/application.peoperties</code></p><div class="code-wrapper"><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment"># 指定为 MySQL 数据库</span><span class="token attr-name">spring.datasource.platform</span><span class="token punctuation">=</span><span class="token attr-value">mysql</span><span class="token comment"># 数据库数量</span><span class="token attr-name">db.num</span><span class="token punctuation">=</span><span class="token attr-value">1 </span><span class="token comment"># 数据库连接信息</span><span class="token attr-name">db.url.0</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC</span><span class="token attr-name">db.user.0</span><span class="token punctuation">=</span><span class="token attr-value">username</span><span class="token attr-name">db.password.0</span><span class="token punctuation">=</span><span class="token attr-value">password</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Linux-Nacos-集群部署"><a href="#Linux-Nacos-集群部署" class="headerlink" title="Linux Nacos 集群部署"></a>Linux Nacos 集群部署</h3><p><strong>获取安装包：</strong> 可以 curl 或者下载到本地后上传到 Linux</p><p><strong>依次执行下方命令：</strong>(2.1RELEASE 之后的版本已经有了-p 参数)</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 解压缩tar -zxvf nacos-server-x.x.x.tar.gz# copy 三份cp -r nacos &#x2F;myNacos&#x2F; # 修改一下 application.properties 中的 mysql 数据库信息# 进入 bin 文件cd .&#x2F;myNacos&#x2F;nacos&#x2F;bin## 查看网卡iphostname -i## copy得到 cluster.conf.examplecp cluster.conf.example cluster.conf## 写入以下内容（IP 不可以是 127.0.0.1）## 目的是为了让这三个端口作为一个集群192.168.111.144:3333192.168.111.144:4444192.168.111.144:5555## 备份一下脚本cp startup.sh startup.sh.bk## 修改一下 startup.sh 脚本，接收 -p 端口号sudo vim startup.sh## 修改内容如下图所示<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div style="text-align:center"><img style="width:75%;border:1px solid #eae6e6;border-radius:25px" src="https://files.catbox.moe/0dbton.png"/></div><br><div style="text-align:center"><img style="width:75%;border:1px solid #eae6e6;border-radius:25px" src="https://files.catbox.moe/wkr6u4.png"/></div><br><h3 id="部署-Nginx"><a href="#部署-Nginx" class="headerlink" title="部署 Nginx"></a>部署 Nginx</h3><div style="text-align:center"><img style="width:75%;border:1px solid #eae6e6;border-radius:25px" src="https://files.catbox.moe/hwc0cw.png"/></div><br><br><br><h2 id="🥥-复习-服务中心"><a href="#🥥-复习-服务中心" class="headerlink" title="🥥 复习 | 服务中心"></a>🥥 复习 | 服务中心</h2><p>Nacos <strong><font color=red>支持 AP/CP</font></strong> 切换</p><div style="text-align:center"><img style="width:75%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/2yqnnm.png"/></div><br><table><thead><tr><th></th><th>Nacos</th><th>Eureka</th><th>Consul</th><th>CoreDNS</th><th>Zookeeper</th></tr></thead><tbody><tr><td>一致性协议</td><td>CP+AP</td><td>AP</td><td>CP</td><td>/</td><td>CP</td></tr><tr><td>健康检查</td><td>TCP/HTTP/MySQL/Client Beat</td><td>Client Beat</td><td>TCP/HTTP/gRPC/md</td><td>/</td><td>Client Beat</td></tr><tr><td>负载均衡</td><td>权重/DSL/metadata/CMDB</td><td>Ribbon</td><td>Fabio</td><td>RR</td><td>/</td></tr><tr><td>雪崩保护</td><td>支持</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr><td>自动注销实例</td><td>支持</td><td>支持</td><td>不支特</td><td>不支持</td><td>支持</td></tr><tr><td>访问协议</td><td>HTTP/DNS/UDP</td><td>HTTP</td><td>HTTP/DNS</td><td>DNS</td><td>TCP</td></tr><tr><td>监听支特</td><td>支持</td><td>支持</td><td>支持</td><td>不支持</td><td>支持</td></tr><tr><td>多数据中心</td><td>支持</td><td>支持</td><td>支持</td><td>不支持</td><td>不支持</td></tr><tr><td>跨注州中心</td><td>支持</td><td>不支持</td><td>支持</td><td>不支持</td><td>不支持</td></tr><tr><td>Springcloud 集成</td><td>支持</td><td>支持</td><td>支持</td><td>不支持</td><td>不支持</td></tr><tr><td>Dubbo 集成</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td><td>支持</td></tr><tr><td>K8s 集成</td><td>支持</td><td>不支持</td><td>支持</td><td>支持</td><td>不支持</td></tr></tbody></table><br><div style="text-align:center"><span style="padding:10px 15px;width:60%;border-radius:15px;text-align:center;background:#4e49be"><span style="color:white"><b>👆 Nacos 与其他注册中心特性对比</b></span></span></div><br><h4 id="复习一下-CAP"><a href="#复习一下-CAP" class="headerlink" title="复习一下 CAP"></a>复习一下 CAP</h4><p><strong><font color=red>C是所有节点在同一时间看到的数据是一致的；而A的定义是所有的请求都会收到响应。</font></strong></p><h4 id="何时选择使用何种模式？"><a href="#何时选择使用何种模式？" class="headerlink" title="何时选择使用何种模式？"></a>何时选择使用何种模式？</h4><p>一般来说，如果不需要存储服务级别的信息且服务实例是通过nacos-client注册，并能够保持心跳上报，那么就可以选择AP模式。当前主流的服务如 Spring cloud 和Dubbo 服务，都适用于AP模式，AP模式为了服务的可能性而减弱了一致性，因此AP模式下只支持注册临时实例。</p><p>如果需要在服务级别编辑或者存储配置信息，那么CP 是必须，K8S服务和DNS服务则适用于CP模式。</p><p>CP模式下则支持注册持久化实例，此时则是以 Raft 协议为集群运行模式，该模式下注册实例之前必须先注册服务，如果服务不存在，则会返回错误。</p><br><br>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
      <category>SpringCloudAlibaba</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
      <tag>SpringCloudAlibaba</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | Alibaba | 相关概念</title>
    <link href="/2022/07/27/SpringCloud%20%7C%20Alibaba%20%7C%20SpringCloud-Alibaba/"/>
    <url>/2022/07/27/SpringCloud%20%7C%20Alibaba%20%7C%20SpringCloud-Alibaba/</url>
    
    <content type="html"><![CDATA[<div style="text-align:center;padding:10px;border-radius:15px"><a href="https://spring.io/projects/spring-cloud-alibaba"><img  style="width:130px;border-radius:35px" src="https://files.catbox.moe/txwxuh.png"/></a></div><br><div style="width:100%;height:85px;background:#eef7fa;border-radius:10px;text-align:center;padding:22px 0px;"><div><img style="width:25px;border-radius:5px;margin:0 10px  9px 0" src="https://files.catbox.moe/2u957r.png"/><a href="https://github.com/alibaba/spring-cloud-alibaba/blob/2.2.x/Roadmap-zh.md" style="font-size:24px;margin-right:15px"><b>Github</b></a></div></div><hr><h2 id="📐-概念"><a href="#📐-概念" class="headerlink" title="📐 概念"></a>📐 概念</h2><h3 id="为什么会出现-SpringCloud-Alibaba"><a href="#为什么会出现-SpringCloud-Alibaba" class="headerlink" title="为什么会出现 SpringCloud Alibaba"></a>为什么会出现 SpringCloud Alibaba</h3><ol><li>SpringCloud Netfilx项目进入维护模式</li></ol><h3 id="能干什么？"><a href="#能干什么？" class="headerlink" title="能干什么？"></a>能干什么？</h3><p><strong>服务限流降级：</strong>默认支持 Servlet、Feign、 RestTemplate、Dubbo 和RocketMQ 限流降级功能的接入，可以在运行时通过控制台实时修改限流降级规则，还支持查看限流降级 Metrics 监控。<br><strong>服务注册与发现：</strong>适配 Spring Cloud 服务注册与发现标准，默认集成了Ribbon 的支持。<br><strong>分布式配置管理：</strong>支持分布式系统中的外部化配置，配置更改时自动刷新。<br><strong>消息驱动能力：</strong>基于 Spring Cloud Stream 为微服务应用构建消息驱动能力。<br><strong>阿里云对象存储：</strong>阿里云提供的海量、安全、低成本、高可靠的云存储服务。支持在任何应用、任何时间、任何地点存储和访问任意类型的数据。<br><strong>分布式任务调度：</strong>提供秒级、精准、高可靠、高可用的定时（基于 Cron 表达式）任务调度服务。同时提供分布式的任务执行模型，如网格任务。网格任务支持海量子任务均匀分配到所有 Worker (schedulerx-client）上执行。</p>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
      <category>SpringCloudAlibaba</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
      <tag>SpringCloudAlibaba</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 链路追踪 | Sleuth</title>
    <link href="/2022/07/26/SpringCloud%20%7C%20%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA%20%7C%20Sleuth/"/>
    <url>/2022/07/26/SpringCloud%20%7C%20%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA%20%7C%20Sleuth/</url>
    
    <content type="html"><![CDATA[<div style="border:1px solid gray;border-radius:15px;text-align:center;display:flex;padding:0px"><div><a href="https://spring.io/projects/spring-cloud-sleuth"><img style="border-radius:15px;width:30%" src="https://files.catbox.moe/7qho39.png"/></a></div><div style="margin-top:20px;margin-right:200px"><a href="https://zipkin.io/pages/quickstart.html"><img style="border-radius:15px;width:48%;" src="https://files.catbox.moe/j3pgte.png"/></a></div></div><br><br><h2 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h2><div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/onvs1o.png"/></div><br><br><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>在微服务框架中，一个由客户端发起的请求在后端系统中会经过多个不同的的服务节点调用来协同产生最后的请求结果，每一个前端请求都会形成一条复杂的分布式服务调用链路，链路中的任何-环出现高延时或错误都会引起整个请求最后的失败。</p><p>当要管理下图中的大型项目时，就需要对相关联路进行跟踪：</p><div style="text-align:center"><img style="border-radius:15px;width:50%" src="https://files.catbox.moe/1keeb7.png"/></div><h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><blockquote><p>提供了一套完整的服务跟踪方案，在分布式系统中提供追踪解决方案并兼容支持 zipkin。</p></blockquote><br><br><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>自从 SPC 『 F 』 版开始就不再需要安装 zipkin 了，只需要安装 jar 包。</p><p>快速开始：</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">curl -sSL https:&#x2F;&#x2F;zipkin.io&#x2F;quickstart.sh | bash -sjava -jar zipkin.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><div style="text-align:center"><img style="border-radius:15px;width:80%" src="https://files.catbox.moe/575fla.png"/></div><p>表示一请求链路，一条链路通过Trace ld唯一标识，Span标识发起的请求信息，各span通过parent id 关联起来。</p><br><br><h2 id="架构图"><a href="#架构图" class="headerlink" title="架构图"></a>架构图</h2><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/8ck4er.png"  /><br><br><span style="color:darkgray">👆官方架构图</span></div><br><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/5q9g2l.png"  /><br><br><span style="color:darkgray">👆简化图</span></div><br><br><br><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- Sleuth --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-zipkin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8001</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>paymrnt<span class="token punctuation">-</span>service<span class="token key atrule">zipkin</span><span class="token punctuation">:</span><span class="token key atrule">base-url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">9411</span><span class="token key atrule">sleuth</span><span class="token punctuation">:</span><span class="token key atrule">sampler</span><span class="token punctuation">:</span><span class="token comment"># 采样率介于 [0,1] 之间，1 代表全部采集，一般使用 0.5 就够了</span><span class="token key atrule">probability</span><span class="token punctuation">:</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 消息驱动 | Stream</title>
    <link href="/2022/07/25/SpringCloud%20%7C%20%E6%B6%88%E6%81%AF%E9%A9%B1%E5%8A%A8%20%7C%20Stream/"/>
    <url>/2022/07/25/SpringCloud%20%7C%20%E6%B6%88%E6%81%AF%E9%A9%B1%E5%8A%A8%20%7C%20Stream/</url>
    
    <content type="html"><![CDATA[<div style="text-align:center"><a href="https://spring.io/projects/spring-cloud-stream"><img style="border-radius:15px;width:55%" src="https://files.catbox.moe/33p0oa.png"/></a></div><p>[toc]</p><h2 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h2><div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/ecsq3v.png"/></div><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>屏蔽底层消息中间件的差异，降低切换成本，统一消息的编程模型。</p><p>核心思想：Binder Implementations 绑定器对象</p><h3 id="什么是Spring-CloudStream"><a href="#什么是Spring-CloudStream" class="headerlink" title="什么是Spring CloudStream"></a>什么是Spring CloudStream</h3><p>官方定义 Spring Cloud Stream 是一个构建消息驱动微服务的框架。<br>应用程序通过 inputs 或者 outputs 来与 Spring Cloud Stream中binder对象交互。<br>通过我们配置来binding（绑定），而Spring Cloud Stream 的binder对象负责与消息中间件交互。<br>所以，我们只需要搞清楚如何与 Spring Cloud Stream 交互就可以方便使用消息驱动的方式。</p><p>通过使用Spring Integration来连接消息代理中间件以实现消息事件驱动。<br>Spring Cloud Stream 为一些供应商的消息中间件产品提供了个性化的自动化配置实现，引用了发布-订阅、消费组、分区的三个核心概念。<br><font color=red><strong>目前仅支持RabbitMQ、 Kafka。</strong></font></p><div style="display:flex">  <div style="height:500px;width:100%;background:#CCCCFF;border-radius:30px 30px 30px 30px;padding:0px 5px">    <div style="font-size:32px;width:100%;text-align:center;margin-top:20px;border:2px solid white;border-top:0;border-left:0;border-right:0;padding:10px 0px">引入之前    </div>    <div style="margin-top:25px;padding:0 15px">      <div style="color:white;font-size:16px;border:1px solid darkgray;border-top:0;border-left:0;border-right:0;padding:10px 0"><b>        生产者/消费者之间靠<span style="color:red;margin-top:5px">消息媒介</span>传递信息内容 Message      </b></div><br>      <div style="color:white;font-size:16px;border:1px solid darkgray;border-top:0;border-left:0;border-right:0;padding:10px 0"><b>        消息必须走特定的<span style="color:red;margin-top:5px">通道</span>      </b></div><br>            <div style="color:white;font-size:16px;border:1px solid darkgray;border-top:0;border-left:0;border-right:0;padding:10px 0"><b>        消息通道里的消息如何被消费？谁负责收发<span style="color:red;margin-top:5px">处理</span>      </b></div><br>    </div>  </div>  <div style="height:500px;width:100%;background:#FFCCCC;border-radius:30px 30px 30px 30px;padding:0 5px">    <div style="color:white;font-size:32px;width:100%;text-align:center;margin-top:20px;border:2px solid white;border-top:0;border-left:0;border-right:0;padding:10px 0px">    引入之后    </div>    <div style="margin-top:25px;padding:0 15px">      <div style="color:white;font-size:16px;border:1px solid darkgray;border-top:0;border-left:0;border-right:0;padding:10px 0"><b>        通过定义绑定器 Binder 作为中间层，实现了应用程序与<span style="color:red;margin-top:5px">消息中间件细节之间的隔离。</span>      </b></div><br>    </div>  </div></div><h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><h3 id="SpringCloud-Stream-官方架构图"><a href="#SpringCloud-Stream-官方架构图" class="headerlink" title="SpringCloud Stream 官方架构图"></a>SpringCloud Stream 官方架构图</h3><div style="text-align:center"><img style="width:80%" src="https://files.catbox.moe/cbr386.jpeg"/></div><br><table><thead><tr><th>组成</th><th>说明</th></tr></thead><tbody><tr><td><strong>Binder</strong></td><td>很方便的连接中间件，屏蔽差异。</td></tr><tr><td><strong>Channel</strong></td><td>通道，是队列 Queue 的一种抽象，在消息通讯系统中就是实现存储和转发的媒介，通过 Channel 对队列进行配置。</td></tr><tr><td><strong>Source 和 Sink</strong></td><td>可以简单理解为参照对象时 SpringCloud Sream 自身，从 Stream 发布消息就是输出，接收消息就是输入。</td></tr><tr><td><strong>MiddleWare</strong></td><td>中间件，目前只支持 RabbitMQ 与 Kafka</td></tr><tr><td><strong>@Input</strong></td><td>注解标识输入通道，通过该输入通道接受到的消息进入应用程序</td></tr><tr><td><strong>@Output</strong></td><td>注解标识输出通道，发布的消息将通过该通道离开应用程序</td></tr><tr><td><strong>@StreamListener</strong></td><td>监听队列，用于消费者的队列的消息接收</td></tr><tr><td><strong>@EnableBinding</strong></td><td>指信道 channel 和 exchange 绑定在一起</td></tr></tbody></table><br><br><h3 id="SpringCloud-Stream-标准流程套路"><a href="#SpringCloud-Stream-标准流程套路" class="headerlink" title="SpringCloud Stream 标准流程套路"></a>SpringCloud Stream 标准流程套路</h3><div style="text-align:center"><img style="width:80%" src="https://files.catbox.moe/heh9sh.jpg"/></div><br><br><br><h2 id="😪-初级-实现-生产者与消费者"><a href="#😪-初级-实现-生产者与消费者" class="headerlink" title="😪 初级 | 实现 | 生产者与消费者"></a>😪 初级 | 实现 | 生产者与消费者</h2><h3 id="新建模块"><a href="#新建模块" class="headerlink" title="新建模块"></a>新建模块</h3><ol><li>cloud-stream-rabbitmq-provider8801 作为生产者进行发消息模块</li><li>cloud-stream-rabbitmq-consumer8802 作为消息接收模块</li><li>cloud-stream-rabbitmq-consumer8803 作为消息接收模块</li></ol><h3 id="生产者模块-cloud-stream-rabbitmq-provider8801"><a href="#生产者模块-cloud-stream-rabbitmq-provider8801" class="headerlink" title="生产者模块 | cloud-stream-rabbitmq-provider8801"></a>生产者模块 | cloud-stream-rabbitmq-provider8801</h3><h4 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h4><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-stream-rabbit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="application-yml"><a href="#application-yml" class="headerlink" title="application.yml"></a>application.yml</h4><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8801</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>stream<span class="token punctuation">-</span>provider<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">stream</span><span class="token punctuation">:</span><span class="token key atrule">binders</span><span class="token punctuation">:</span> <span class="token comment"># 在此配置要绑定的 rabbitmq 服务信息</span><span class="token key atrule">defaultRabbit</span><span class="token punctuation">:</span><span class="token comment"># 表示定义的名称，用于 binding 整合</span><span class="token key atrule">type</span><span class="token punctuation">:</span> rabbit<span class="token comment"># 消息组件类型</span><span class="token key atrule">environment</span><span class="token punctuation">:</span><span class="token comment"># 设置 rabbitmq 的相关环境配置</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span><span class="token key atrule">host</span><span class="token punctuation">:</span> localhost<span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span><span class="token key atrule">username</span><span class="token punctuation">:</span> guest<span class="token key atrule">password</span><span class="token punctuation">:</span> guest<span class="token key atrule">bindings</span><span class="token punctuation">:</span><span class="token comment"># 服务器整合处理</span><span class="token key atrule">output</span><span class="token punctuation">:</span><span class="token comment"># 这个名字是一个通道的名称</span><span class="token key atrule">destination</span><span class="token punctuation">:</span> studyExchange <span class="token comment"># 表示要使用的 Exchange 名称定义</span><span class="token key atrule">content-type</span><span class="token punctuation">:</span> application/json <span class="token comment"># 设置消息类型，本次为 JSON，文本则设置 text/plain</span><span class="token key atrule">binder</span><span class="token punctuation">:</span> defaultRabbit <span class="token comment"># 设置要绑定的消息服务的具体设置</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="Main-主启动"><a href="#Main-主启动" class="headerlink" title="Main 主启动"></a>Main 主启动</h4><p><code>com.atguigu.springcloud.StreamMQMain8801.java</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StreamMQMain8801</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SptingApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">StreamMQMain8801</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="Service-业务类"><a href="#Service-业务类" class="headerlink" title="Service 业务类"></a>Service 业务类</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IMessageProvider</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>source</span><span class="token punctuation">;</span><span class="token comment">// @Service 不用写（与 RabbitMQ 打交道）</span><span class="token annotation punctuation">@EnableBinding</span><span class="token punctuation">(</span><span class="token class-name">Source</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">// 定义消息的推送管道</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageProviderImpl</span> <span class="token keyword">implements</span> <span class="token class-name">IMessageProvider</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>  <span class="token keyword">private</span> <span class="token class-name">MessageChannel</span> output<span class="token punctuation">;</span> <span class="token comment">// 消息发送管道</span>  <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> serial <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 关键 发送 Message</span>    output<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withPayload</span><span class="token punctuation">(</span>serial<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"*****serial:"</span><span class="token operator">+</span>serial<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="Controller-层"><a href="#Controller-层" class="headerlink" title="Controller 层"></a>Controller 层</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SendMessageController</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Resource</span>  <span class="token keyword">private</span> <span class="token class-name">IMessageProvider</span> messageProvider<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/sendMessage"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> messageProvider<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><h3 id="接收者模块-cloud-stream-rabbitmq-consumer8802"><a href="#接收者模块-cloud-stream-rabbitmq-consumer8802" class="headerlink" title="接收者模块 | cloud-stream-rabbitmq-consumer8802"></a>接收者模块 | cloud-stream-rabbitmq-consumer8802</h3><h4 id="Application-yml"><a href="#Application-yml" class="headerlink" title="Application.yml"></a>Application.yml</h4><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8801</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>stream<span class="token punctuation">-</span>provider<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">stream</span><span class="token punctuation">:</span><span class="token key atrule">binders</span><span class="token punctuation">:</span> <span class="token comment"># 在此配置要绑定的 rabbitmq 服务信息</span><span class="token key atrule">defaultRabbit</span><span class="token punctuation">:</span><span class="token comment"># 表示定义的名称，用于 binding 整合</span><span class="token key atrule">type</span><span class="token punctuation">:</span> rabbit<span class="token comment"># 消息组件类型</span><span class="token key atrule">environment</span><span class="token punctuation">:</span><span class="token comment"># 设置 rabbitmq 的相关环境配置</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span><span class="token key atrule">host</span><span class="token punctuation">:</span> localhost<span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span><span class="token key atrule">username</span><span class="token punctuation">:</span> guest<span class="token key atrule">password</span><span class="token punctuation">:</span> guest<span class="token key atrule">bindings</span><span class="token punctuation">:</span><span class="token comment"># 服务器整合处理</span><span class="token key atrule">input</span><span class="token punctuation">:</span><span class="token comment"># 这个名字是一个通道的名称</span><span class="token key atrule">destination</span><span class="token punctuation">:</span> studyExchange <span class="token comment"># 表示要使用的 Exchange 名称定义</span><span class="token key atrule">content-type</span><span class="token punctuation">:</span> application/json <span class="token comment"># 设置消息类型，本次为 JSON，文本则设置 text/plain</span><span class="token key atrule">binder</span><span class="token punctuation">:</span> defaultRabbit <span class="token comment"># 设置要绑定的消息服务的具体设置</span><span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">client</span><span class="token punctuation">:</span> <span class="token comment"># Eureka 客户端注册</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka<span class="token key atrule">instance</span><span class="token punctuation">:</span><span class="token key atrule">lease-renewal-interval-in-seconds</span><span class="token punctuation">:</span> <span class="token number">2</span> <span class="token comment"># 设置心跳的时间间隔（默认 30 秒） </span><span class="token key atrule">lease-expirationduration-in-seconds</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token comment"># 如果现在超过了 5 秒的间隔（默认 90 秒）</span><span class="token key atrule">instance-id</span><span class="token punctuation">:</span> receive<span class="token punctuation">-</span>8802.com <span class="token comment"># 在信息列表时显示主机名称</span><span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 访问路径变为 IP 地址</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="Main-主启动-1"><a href="#Main-主启动-1" class="headerlink" title="Main 主启动"></a>Main 主启动</h4><p><code>com.atguigu.springcloud.contr0ller.ReceiveMessageListenerController.java</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Comment</span><span class="token annotation punctuation">@EnableBinding</span><span class="token punctuation">(</span><span class="token class-name">Sink</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReceiveMessageListenerController</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;server.port&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>    <span class="token annotation punctuation">@StreamListener</span><span class="token punctuation">(</span><span class="token class-name">Sink</span><span class="token punctuation">.</span>INPUT<span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">input</span><span class="token punctuation">(</span><span class="token class-name">Message</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> message<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"消费者 1 号："</span><span class="token operator">+</span>message<span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\t port:"</span><span class="token operator">+</span>serverPort<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="😫-高级-分组-重复消费-与-持久化"><a href="#😫-高级-分组-重复消费-与-持久化" class="headerlink" title="😫 高级 | 分组 | 重复消费 与 持久化"></a>😫 高级 | 分组 | 重复消费 与 持久化</h2><h3 id="分组-同一个组只可以进行一次消费，竞争消费"><a href="#分组-同一个组只可以进行一次消费，竞争消费" class="headerlink" title="分组 | 同一个组只可以进行一次消费，竞争消费"></a>分组 | <font color=red>同一个组只可以进行一次消费，竞争消费</font></h3><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>8802 与 8803 都会收到，存在重复消费问题；</p><hr><p>比如在如下场景中，订单系统我们做集群部署，都会从RabbitMQ中获取订单信息，那<font color=red>如果一个订单同时被两个服务获取到</font>，那么就会造成数据错误，我们得避免这种情况。<br><font color=red>这时我们就可以使用Stream中的消息分组来解决。</font><br></p><div style="text-align:center"><img style="width:50%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/rz7uu6.png"/></div><br><p>注意在Stream中处于<b><font color=orange>同一个group中的多个消费者是竞争关系，就能够保证消息只会被其中一个应用消费一次。</font><font color=red>不同组是可以全面消费的(重复消费）</font></b></p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>自定义配置分组，将两个消费者放在同一个分组内，解决重复消费问题。</p><p><strong>加：</strong><code>spring.cloud.stream.bindings.input.group:组名</code></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8801</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>stream<span class="token punctuation">-</span>provider<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">stream</span><span class="token punctuation">:</span><span class="token key atrule">binders</span><span class="token punctuation">:</span> <span class="token comment"># 在此配置要绑定的 rabbitmq 服务信息</span><span class="token key atrule">defaultRabbit</span><span class="token punctuation">:</span><span class="token comment"># 表示定义的名称，用于 binding 整合</span><span class="token key atrule">type</span><span class="token punctuation">:</span> rabbit<span class="token comment"># 消息组件类型</span><span class="token key atrule">environment</span><span class="token punctuation">:</span><span class="token comment"># 设置 rabbitmq 的相关环境配置</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span><span class="token key atrule">host</span><span class="token punctuation">:</span> localhost<span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span><span class="token key atrule">username</span><span class="token punctuation">:</span> guest<span class="token key atrule">password</span><span class="token punctuation">:</span> guest<span class="token key atrule">bindings</span><span class="token punctuation">:</span><span class="token comment"># 服务器整合处理</span><span class="token key atrule">input</span><span class="token punctuation">:</span><span class="token comment"># 这个名字是一个通道的名称</span><span class="token key atrule">destination</span><span class="token punctuation">:</span> studyExchange <span class="token comment"># 表示要使用的 Exchange 名称定义</span><span class="token key atrule">content-type</span><span class="token punctuation">:</span> application/json <span class="token comment"># 设置消息类型，本次为 JSON，文本则设置 text/plain</span><span class="token key atrule">binder</span><span class="token punctuation">:</span> defaultRabbit <span class="token comment"># 设置要绑定的消息服务的具体设置</span><span class="token comment">## 在 8802 与 8803 中都加入下列代码，放入同一个组中</span><span class="token key atrule">group</span><span class="token punctuation">:</span> groupA<span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">client</span><span class="token punctuation">:</span> <span class="token comment"># Eureka 客户端注册</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka<span class="token key atrule">instance</span><span class="token punctuation">:</span><span class="token key atrule">lease-renewal-interval-in-seconds</span><span class="token punctuation">:</span> <span class="token number">2</span> <span class="token comment"># 设置心跳的时间间隔（默认 30 秒） </span><span class="token key atrule">lease-expirationduration-in-seconds</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token comment"># 如果现在超过了 5 秒的间隔（默认 90 秒）</span><span class="token key atrule">instance-id</span><span class="token punctuation">:</span> receive<span class="token punctuation">-</span>8802.com <span class="token comment"># 在信息列表时显示主机名称</span><span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 访问路径变为 IP 地址</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h3><p>加了 <code>Group</code> 之后会有持久性。</p><p>若是生产者在消费者关闭的情况下，发送了内容，那么消费者启动后也能接收到消息。</p>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 消息总线 | Bus</title>
    <link href="/2022/07/25/SpringCloud%20%7C%20%E6%B6%88%E6%81%AF%E6%80%BB%E7%BA%BF%20%7C%20Bus/"/>
    <url>/2022/07/25/SpringCloud%20%7C%20%E6%B6%88%E6%81%AF%E6%80%BB%E7%BA%BF%20%7C%20Bus/</url>
    
    <content type="html"><![CDATA[<div style="text-align:center"><a href="https://spring.io/projects/spring-cloud-bus"><img style="border-radius:15px;width:55%" src="https://files.catbox.moe/tx6kxj.jpeg"/></a></div><br><br><h2 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h2><div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/yl9duc.png"/></div><h2 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h2><p>Spring Cloud Bus 配合 Spring Cloud Config 使用可以实现配置的动态刷新。</p><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>Spring Cloud Bus是用来将分布式系统的节点与轻量级消息系统链接起来的框架，它整台了Java的事件处理机制和消息中间体的功能。</p><h3 id="支持的中间件"><a href="#支持的中间件" class="headerlink" title="支持的中间件"></a>支持的中间件</h3><p><strong><font color=orange>RabbitMQ</font> 与 <font color=orange>Kafka</font></strong></p><h3 id="能干什么"><a href="#能干什么" class="headerlink" title="能干什么"></a>能干什么</h3><p>Spring Cloud Bus能管理和传播分布式系统间的消息，就像一个分布式执行器，可用于广播状态更改、事件推送等，也可以当作微服务间的通信通道。</p><h3 id="两种方式"><a href="#两种方式" class="headerlink" title="两种方式"></a>两种方式</h3><p>1） 利用消息总线触发一个客户端/bus/refresh，进而刷新所有客户端的配置</p><p>2） 利用消息总线触发一个服务端（总控） ConfigServer 的/bus/refresh端点，进而刷新所有客户端的配置</p><div style="text-align:center"><img src="https://files.catbox.moe/gw6yds.png" style="width:80%;border-radius:25px;border:1px solid darkgray;padding:10px"><br><span>👆 总控方式</span></div><div style="text-align:center"><img src="https://files.catbox.moe/gic4xb.jpeg" style="width:80%;border-radius:25px;border:1px solid darkgray;padding:10px"><br><span>👆 客户端方式</span></div><p><font color=darkgray>破坏了微服务模块单一性，万一他挂了，不仅不能通知，还不能参与原先的服务；破坏了微服务各个节点的对等性；有一定的局限性。劣徒，微服务在迁移时，他的网络地址常常会发生变化，如果此时要做到自动刷新，那就回增加更多的修改。</font></p><h3 id="什么是总线？"><a href="#什么是总线？" class="headerlink" title="什么是总线？"></a>什么是总线？</h3><p>什么是总线<br>在微服务架构的系统中，通常会使用<font color=red>轻量级的消息代理</font>来构建一个<font color=red>共用的消息主题</font>，并让系统中所有微服务实例都连接上来。由于<font color=red>该主题中产生的消息会被所有实例监听和消费，所以称它为消息总线。</font>在总线上的各个实例，都可以方便地广播一些需要让其他连接在该主题上的实例都知道的消息。</p><h3 id="基本原理"><a href="#基本原理" class="headerlink" title="基本原理"></a>基本原理</h3><p>Config Client 实例都监听 MQ 中同个topic(默认是SpringCloudBus)。当一个服务刷新数据的时候，它会把这个信息放入到Topic中，这样其它监听同一Topic的服务就能得到通知，然后去更新自身的配置。</p><h2 id="🧶-SpringCloud-Bus-动态刷新全局广播"><a href="#🧶-SpringCloud-Bus-动态刷新全局广播" class="headerlink" title="🧶 SpringCloud Bus 动态刷新全局广播"></a>🧶 SpringCloud Bus 动态刷新全局广播</h2><ol><li>新建 Module <code>cloud-config-client-3366</code> </li><li>yml 配置</li></ol><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment">## bootstrap.yml</span><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3366</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>client<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">config</span><span class="token punctuation">:</span><span class="token key atrule">label</span><span class="token punctuation">:</span> master <span class="token comment"># 分支名称</span><span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token comment"># 配置文件名称</span><span class="token key atrule">profile</span><span class="token punctuation">:</span> dev<span class="token comment"># 读取后缀名成 # 上述综合为：master 分支上的 config-dev.yml 的配置文件被读取为：http://config-3344.com:3344/master/config-dev</span><span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">3344</span> <span class="token comment"># 配置中心地址</span><span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">client</span><span class="token punctuation">:</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka<span class="token key atrule">management</span><span class="token punctuation">:</span><span class="token key atrule">endpoints</span><span class="token punctuation">:</span><span class="token key atrule">web</span><span class="token punctuation">:</span><span class="token key atrule">exposure</span><span class="token punctuation">:</span><span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">"*"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableEurekaClient</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientMain3366</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ConfigClientMain3366</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RefreshScope</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientController</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;server.port&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;config.info&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> configInfo<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/cnofigInfo"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">configInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token string">"ServerPort:"</span><span class="token operator">+</span>serverPort<span class="token operator">+</span><span class="token string">"\t\n\nConfigInfo:"</span><span class="token operator">+</span>configInfo<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="配置步骤"><a href="#配置步骤" class="headerlink" title="配置步骤"></a>配置步骤</h3><ol><li>给 cloud-config-center-3344 配置中心服务端添加消息总线支持</li><li>给 cloud-config-client-3355  客户端添加消息总线支持</li><li>给 cloud-config-client-3366 客户端添加消息总线支持</li></ol><p><strong>消息总线支持</strong></p><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- 添加 RabbitMQ 依赖--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-bus-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><strong>3344 总控中 yml 追加下列代码</strong></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment">## application.yml</span><span class="token key atrule">management</span><span class="token punctuation">:</span><span class="token key atrule">endpoints</span><span class="token punctuation">:</span><span class="token key atrule">web</span><span class="token punctuation">:</span><span class="token key atrule">exposure</span><span class="token punctuation">:</span><span class="token key atrule">include</span><span class="token punctuation">:</span> `bus<span class="token punctuation">-</span>refresh`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><strong>3355 追加以下代码</strong></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment">## bootstrap.yml</span><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3355</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>client<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">config</span><span class="token punctuation">:</span><span class="token key atrule">label</span><span class="token punctuation">:</span> master <span class="token comment"># 分支名称</span><span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token comment"># 配置文件名称</span><span class="token key atrule">profile</span><span class="token punctuation">:</span> dev<span class="token comment"># 读取后缀名成 # 上述综合为：master 分支上的 config-dev.yml 的配置文件被读取为：http://config-3344.com:3344/master/config-dev</span><span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">3344</span> <span class="token comment"># 配置中心地址</span><span class="token comment">## 追加代码</span><span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span><span class="token key atrule">host</span><span class="token punctuation">:</span> localhost<span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span><span class="token key atrule">username</span><span class="token punctuation">:</span> guest<span class="token key atrule">password</span><span class="token punctuation">:</span> guest<span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">client</span><span class="token punctuation">:</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka<span class="token key atrule">management</span><span class="token punctuation">:</span><span class="token key atrule">endpoints</span><span class="token punctuation">:</span><span class="token key atrule">web</span><span class="token punctuation">:</span><span class="token key atrule">exposure</span><span class="token punctuation">:</span><span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">"*"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><strong>3366 追加以下代码</strong></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment">## bootstrap.yml</span><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3366</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>client<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">config</span><span class="token punctuation">:</span><span class="token key atrule">label</span><span class="token punctuation">:</span> master <span class="token comment"># 分支名称</span><span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token comment"># 配置文件名称</span><span class="token key atrule">profile</span><span class="token punctuation">:</span> dev<span class="token comment"># 读取后缀名成 # 上述综合为：master 分支上的 config-dev.yml 的配置文件被读取为：http://config-3344.com:3344/master/config-dev</span><span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">3344</span> <span class="token comment"># 配置中心地址</span><span class="token comment">## 追加代码</span><span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span><span class="token key atrule">host</span><span class="token punctuation">:</span> localhost<span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span><span class="token key atrule">username</span><span class="token punctuation">:</span> guest<span class="token key atrule">password</span><span class="token punctuation">:</span> guest<span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">client</span><span class="token punctuation">:</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka<span class="token key atrule">management</span><span class="token punctuation">:</span><span class="token key atrule">endpoints</span><span class="token punctuation">:</span><span class="token key atrule">web</span><span class="token punctuation">:</span><span class="token key atrule">exposure</span><span class="token punctuation">:</span><span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">"*"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="📐-SpringCloud-Bus-动态刷新定点通知"><a href="#📐-SpringCloud-Bus-动态刷新定点通知" class="headerlink" title="📐 SpringCloud Bus 动态刷新定点通知"></a>📐 SpringCloud Bus 动态刷新定点通知</h2><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">curl <span class="token punctuation">-</span>X POST http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>配置中心端口号/actuator/bus<span class="token punctuation">-</span>refresh/<span class="token punctuation">&#123;</span>destination<span class="token punctuation">&#125;</span><span class="token comment"># &#123;destination&#125; 是微服务的名称+端口号</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 服务配置 | Config</title>
    <link href="/2022/07/25/SpringCloud%20%7C%20Config/"/>
    <url>/2022/07/25/SpringCloud%20%7C%20Config/</url>
    
    <content type="html"><![CDATA[<p>[TOC]</p><div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/l794tk.png"/></div><br><blockquote><p><code>ConfigClientMain</code></p><p>端口：3344</p><p>作用：中心化的外部配置</p></blockquote><br><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p><strong>是什么？</strong></p><p>SpringCloud Config 为微服务架构中的微服务提供集中化的外部配置支持，配置服务器为<font color=red>各个不同的微服务应用</font>的所有环境提供了一个<font color=red>中心化的外部配置</font>。</p><div style="text-align:center"><img style="width:80%;" src="https://files.catbox.moe/5ja5us.jpeg"/></div><p><strong>能干嘛？</strong></p><ol><li>集中管理配置文件</li><li>不同环境不同配置，动态化的解析更新，分环境部署，比如：dev/test/prod/beta/release</li><li>运行期间动态调整配置，不再需要在每个服务部署的机器上编写配置文件，服务会向配置中心统一拉去配置自己的信息</li><li>当配置发生变动时，服务不需要重启计科感知到配置的变化并应用新的配置</li><li>将配置信息以 REST 接口的形式暴露</li></ol><p><strong>怎么用？</strong></p><p>SpringCloud Config分为<font color=red>服务端和客户端两部分</font>。</p><p>服务端也称为<font color=red>分布式配置中心，它是一个独立的微服务应用</font>，用来连接配置服务器并为客户端提供获取配置信息，加密/解密信息等访问接口</p><p>客户端则是通过指定的配蛋中心来管理应用资源，以及与业务相关的配置内容，并在启动的时候从配置中心获取和加载配置信息配置服务器默认采用git来存储配置信息，这样就有助于对环境配置进行版本管理，并且可以通过git客户端工具来方便的管理和访问配置内容。</p><p><strong>由于 SpringCloud Config 默认使用 Git 来存储配置文件（也有其他方式比如支持 SVN 和本地文件），但最推荐的还是 Git，而且使用的是 http/https 访问的方式。</strong></p><h2 id="🧑🏻‍🔧-配置步骤-Server-端"><a href="#🧑🏻‍🔧-配置步骤-Server-端" class="headerlink" title="🧑🏻‍🔧 配置步骤 | Server 端"></a>🧑🏻‍🔧 配置步骤 | Server 端</h2><ol><li>在 GitHub 上创建一个 springcloud-config 的 Repository</li><li>获得 <a href="mailto:&#x67;&#x69;&#116;&#64;&#x67;&#x69;&#x74;&#104;&#x75;&#x62;&#46;&#x63;&#x6f;&#x6d;">&#x67;&#x69;&#116;&#64;&#x67;&#x69;&#x74;&#104;&#x75;&#x62;&#46;&#x63;&#x6f;&#x6d;</a>:xxxx/xxxx</li><li>本地硬盘目录上新建 git 仓库并 clone</li><li>此时再本地磁盘下有一个 springcloud-config</li><li>新建 Module 模块 cloud-ocnfig-center-3344，它即为 Cloud 的配置中心模块</li><li>POM</li><li>YML</li><li>主启动类</li></ol><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-config-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3344</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>config<span class="token punctuation">-</span>center<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">config</span><span class="token punctuation">:</span><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">git</span><span class="token punctuation">:</span><span class="token key atrule">uri</span><span class="token punctuation">:</span> git@github.com<span class="token punctuation">:</span>zzyybs/springcloud<span class="token punctuation">-</span>config.git<span class="token key atrule">search-paths</span><span class="token punctuation">:</span><span class="token punctuation">-</span> springcloud<span class="token punctuation">-</span>config<span class="token key atrule">label</span><span class="token punctuation">:</span> master<span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">client</span><span class="token punctuation">:</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableConfigServer</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainAppConfigCenter3344</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">MainAppConfigCenter3344</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="📄-五种配置"><a href="#📄-五种配置" class="headerlink" title="📄 五种配置"></a>📄 五种配置</h2><blockquote><p>**label:**分支</p><p><strong>name：</strong>服务名</p><p><strong>profiles：</strong>环境（dev/test/prod）</p></blockquote><p>/{application}/{profile}[/{label}]</p><ul><li><a href="http://config-3344.com:3344/config/dev/master">http://config-3344.com:3344/config/dev/master</a></li><li><a href="http://config-3344.com:3344/config/test/master">http://config-3344.com:3344/config/test/master</a></li><li><a href="http://config-3344.com:3344/config/prod/master">http://config-3344.com:3344/config/prod/master</a></li></ul><p>/{application}-{profile}.yml</p><ul><li><a href="http://config-3344.com:3344/config-dev.yml">http://config-3344.com:3344/config-dev.yml</a></li><li><a href="http://config-3344.com:3344/config-test.yml">http://config-3344.com:3344/config-test.yml</a></li><li><a href="http://config-3344.com:3344/config-prod.yml">http://config-3344.com:3344/config-prod.yml</a></li></ul><p>/{label}/{application}-{profile}.yml</p><ul><li><p>Master 分支</p><ul><li><p><a href="http://config-3344.com:3344/master/config-dev.tml">http://config-3344.com:3344/master/config-dev.tml</a></p></li><li><p><a href="http://config-3344.com:3344/master/config-test.yml">http://config-3344.com:3344/master/config-test.yml</a></p></li><li><p><a href="http://config-3344.com:3344/master/config-prod.yml">http://config-3344.com:3344/master/config-prod.yml</a></p></li></ul></li><li><p>Dev 分支</p><ul><li><a href="http://config-3344.com:3344/dev/config-dev.tml">http://config-3344.com:3344/dev/config-dev.tml</a></li><li><a href="http://config-3344.com:3344/dev/config-test.tml">http://config-3344.com:3344/dev/config-test.tml</a></li><li><a href="http://config-3344.com:3344/dev/config-prod.tml">http://config-3344.com:3344/dev/config-prod.tml</a></li></ul></li></ul><p>/{application}-{profile}.properties</p><p>/{label}/{application}-{profile}.properties</p><div style="box-shadow:0 0 25px gray;text-align:center;background:#117462;padding:50px 0;width:100%;height:150px;border:1px solid black;border-radius:20px"><a style="color:white;font-size:32px"><b>至此，已经打通 GitHub 与 ConfigCenter</b></a></div><h2 id="📺-配置步骤-Config-Client-客户端"><a href="#📺-配置步骤-Config-Client-客户端" class="headerlink" title="📺 配置步骤 | Config Client | 客户端"></a>📺 配置步骤 | Config Client | 客户端</h2><h3 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a>相关配置</h3><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="bootstrap-yml"><a href="#bootstrap-yml" class="headerlink" title="bootstrap.yml"></a>bootstrap.yml</h3><h4 id="是什么？"><a href="#是什么？" class="headerlink" title="是什么？"></a>是什么？</h4><p>application.yml 是用户级的资源配置项</p><p>bootstrap.yml 是系统级的，<font color=red><b>优先级更高。</b></font></p><blockquote><p>Spring Cloud会创建”Bootstrap Context”，作为Spring应用的 Application Context’的父上下文。初始化的时候，<code>Bootstrap context</code> 负责从外部源加载配置属性并解析配置。这两个上下文共享一个从外部获取的Environment。</p><p><code>Bootstrap</code>属性有高优先级，默认情况下，它们不会被本地配置覆盖。<code>Bootstrap context</code>和<code>Application Context</code>有着不同的约定所以新增了一个bootstrap.yml文件，保<code>&#39;Bootstrap Context</code> 和 <code>Application Context</code> 配置的分离。</p><p><font color=red><b>要将Client模块下的application.yml文件改为bootstrap.yml,这是很关键的，</b></font>因为bootstrap.yml是比application.yml先加载的。bootstrap.yml优先级高于application.yml。</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment">## bootstrap.yml</span><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3355</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token punctuation">-</span>client<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">config</span><span class="token punctuation">:</span><span class="token key atrule">label</span><span class="token punctuation">:</span> master <span class="token comment"># 分支名称</span><span class="token key atrule">name</span><span class="token punctuation">:</span> config<span class="token comment"># 配置文件名称</span><span class="token key atrule">profile</span><span class="token punctuation">:</span> dev<span class="token comment"># 读取后缀名成 # 上述综合为：master 分支上的 config-dev.yml 的配置文件被读取为：http://config-3344.com:3344/master/config-dev</span><span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">3344</span> <span class="token comment"># 配置中心地址</span><span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">client</span><span class="token punctuation">:</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div style="text-align:center"><img style="wisth:80%;border-radius:20px" src="https://files.catbox.moe/hb6la5.png"/></div><h3 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h3><ol><li><strong>主启动</strong></li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableEurekaClient</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientMain3355</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ConfigClientMain3355</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ol start="2"><li><strong>业务类（仅用于演示）</strong></li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientController</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;config.info&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> configInfo<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/configInfo"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCOnfigInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> configInfo<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>当 GitHub 刷新之后，3344 紧随着就刷新了，但是若不重启 3355 那么 3355 还是不会发生任何变化</p><ol><li>Client 端加入以下依赖</li></ol><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><ol start="2"><li>修改Client - yml，暴露监控端口</li></ol><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment">## 追加以下</span><span class="token key atrule">management</span><span class="token punctuation">:</span><span class="token key atrule">endpoints</span><span class="token punctuation">:</span><span class="token key atrule">web</span><span class="token punctuation">:</span><span class="token key atrule">exposure</span><span class="token punctuation">:</span><span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">"*"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ol start="3"><li>@RefreshScope 业务类 Controller 修改</li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RefreshScope</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientController</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;config.info&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> configInfo<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/configInfo"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCOnfigInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> configInfo<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ol start="4"><li><p>测试「 修改 github –&gt; 3344 –&gt; 3355 」 <font color=red>失败</font></p></li><li><p><font color=GREEN><b>需要运维人员发送 Post 请求刷新 3355</b></font><code>curl -X POST &quot;http://localhost:3355/actuator/refresh&quot;</code></p></li><li><p>问题已解决，但是若是有多个微服务客户端，则会很麻烦，所以要使用到消息总线</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【日记】9号线地铁的小女孩</title>
    <link href="/2022/07/23/%E6%97%A5%E8%AE%B0/%E6%97%A5%E8%AE%B0%E3%80%919%E5%8F%B7%E7%BA%BF%E5%9C%B0%E9%93%81%E7%9A%84%E5%B0%8F%E5%A5%B3%E5%AD%A9/"/>
    <url>/2022/07/23/%E6%97%A5%E8%AE%B0/%E6%97%A5%E8%AE%B0%E3%80%919%E5%8F%B7%E7%BA%BF%E5%9C%B0%E9%93%81%E7%9A%84%E5%B0%8F%E5%A5%B3%E5%AD%A9/</url>
    
    <content type="html"><![CDATA[<h4 id="日记-2022-07-23-9-号线地铁的小女孩"><a href="#日记-2022-07-23-9-号线地铁的小女孩" class="headerlink" title="日记 | 2022-07-23 | 9 号线地铁的小女孩"></a>日记 | 2022-07-23 | 9 号线地铁的小女孩</h4><br><hr><p>今天在九号线上，遇到了一个很可爱的小女孩。</p><p>我旁边只有一个座位了，因此小女孩的妈妈让小女孩坐在了我旁边，女孩的妈妈站着，若是平时我就站起来给妈妈让位置了，但是考虑到 9 号线座位一直狠稀有且我要坐的路程很远，我便坐在这里。</p><p>一会儿有人上下车，对面有个空位置，小女孩妈妈便坐上去了，低头玩手机的小女孩抬头突然发现妈妈不见了，便站起来一直喊妈妈，实在是太可爱了。</p><p>且，我发现一个稍微有趣的现象：若是妈妈带孩子且只有一个位置，那么坐下来的都是孩子，但是若是一个父亲带着孩子，那么坐下来的往往是父亲，然后将孩子抱在怀里。</p>]]></content>
    
    
    <categories>
      
      <category>日记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>日记</tag>
      
      <tag>生活中的趣事</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 服务网关 | SpringCloud GateWay</title>
    <link href="/2022/07/22/SpringCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7%20%7C%20Gateway/"/>
    <url>/2022/07/22/SpringCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7%20%7C%20Gateway/</url>
    
    <content type="html"><![CDATA[<br><div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/y9jzw3.png"/></div><br><p><font color=red><strong>核心逻辑</strong></font>：路由转发 + 执行过滤器链</p><div style="hight:100px;padding:20px;width:100%;text-align:center;background:#2b61a7;border-radius:15px;border:1px solid gray;"><a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gateway-starter"><span style="color:white">Spring Cloud</span><b><span style="color:white;font-size:64px;">Gateway</span></b></a></div><h2 id="🥥-概念"><a href="#🥥-概念" class="headerlink" title="🥥 概念"></a>🥥 概念</h2><p><strong>Route（路由）</strong> 路由是构建网关的基本模块，它由 ID，目标 URI，一系列的断言和过滤器组成，如果断言为 true 则匹配该路由。</p><p><strong>Predicate（断言）</strong>参考的是 Java8 的 java.util.funcation.Predicate，开发人员可以匹配 HTTP 请求中的所有内容（例如请求头或者请求参数），<font color=red>如果请求与断言相匹配则进行路由。</font></p><p><strong>Filter（过滤）</strong> 指的是 Spring 框架中 GatewayFilter 的实例，使用过滤器，可以在请求被路由前或者之后对请求进行修改。</p><div style="text-align:center"><img style="border:1px solid darkgray;border-radius:15px;padding:10px;width:70%" src="https://files.catbox.moe/z2zbg2.png" /></div><h3 id="执行过程："><a href="#执行过程：" class="headerlink" title="执行过程："></a><strong>执行过程</strong>：</h3><div style="text-align:center"><img style="width:60%" src="https://files.catbox.moe/q8xgyo.png"/></div><p>客户端向 SpringCloudGateway 发出请求。然后在 Gateway Handler Mapping 中找到与请求相匹配的路由，将其发送到 Gateway Web Handler。</p><p><strong>Handler</strong>再通过指定的过滤器链来将请求发送到我们实际的服务执行业务逻辑，然后返回，过滤器之间用虚线分开是因为过滤器可能会在发送代理请求之前（”pre”）或之后（“post”）执行业务逻辑。</p><p><strong>Filter</strong> 在”pre” 类型的过滤器可以做参数校验、权限校验、流量监控、日志输出、协议转换等，在”post”类型的过滤器中可以做相应内容、响应头的修改，日志的修改，日志的输出，流量监控等有着非常重要的作用。</p><br><br><br><h2 id="🥥-路由"><a href="#🥥-路由" class="headerlink" title="🥥 路由"></a>🥥 路由</h2><h4 id="方式一-「-application-yml-中配置路由-」"><a href="#方式一-「-application-yml-中配置路由-」" class="headerlink" title="方式一 「 application.yml 中配置路由 」"></a>方式一 「 application.yml 中配置路由 」</h4><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9527</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">gateway</span><span class="token punctuation">:</span><span class="token comment"># 路由</span><span class="token key atrule">routes</span><span class="token punctuation">:</span><span class="token comment"># 路由 ID ，没有固定规则但是要求唯一，建议配合服务名</span><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh <span class="token comment"># 屁屁额后提供服务的路由地址</span><span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8001</span><span class="token key atrule">predicates</span><span class="token punctuation">:</span><span class="token comment"># 断言，路径匹配的进行路由</span><span class="token punctuation">-</span> Path=/payment/get/<span class="token important">**</span>        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh2<span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">8001</span><span class="token key atrule">predicates</span><span class="token punctuation">:</span><span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span><span class="token comment">## 注册进 Eureka</span><span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">instance</span><span class="token punctuation">:</span><span class="token key atrule">hostname</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway<span class="token punctuation">-</span>service<span class="token key atrule">client</span><span class="token punctuation">:</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 主启动类</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableEurekaClient</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GateWayMain9527</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">GateWayMain9527</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="方式二-「-Java编码方式-」"><a href="#方式二-「-Java编码方式-」" class="headerlink" title="方式二 「 Java编码方式 」"></a>方式二 「 Java编码方式 」</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// com.jim.springcloud.config</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GateWayConfig</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Bean</span>  <span class="token keyword">public</span> <span class="token class-name">RouteLocator</span> <span class="token function">customRouteLocator</span><span class="token punctuation">(</span><span class="token class-name">RouteLocatorBuilder</span> routeLocatorBuilder<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">RouteLocatorBuilder<span class="token punctuation">.</span>Builder</span> routes <span class="token operator">=</span> routeLocatorBuilder<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// id （localhost:端口号）+用户访问路径 实际给的地址</span>    routes<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">"path_route_atguigu"</span><span class="token punctuation">,</span>r <span class="token operator">-></span> r<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">"/guonei"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">"http://news.baidu.com/guonei"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> routes<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="方式三-「-配合-Ribbon-实现负载均衡-」"><a href="#方式三-「-配合-Ribbon-实现负载均衡-」" class="headerlink" title="方式三 「 配合 Ribbon 实现负载均衡 」"></a>方式三 「 配合 Ribbon 实现负载均衡 」</h4><p>默认情况下 Gateway 会根据注册中心注册的服务列表，以注册中心上的微服务名为路径创建<b><font color=orange>动态路由进行转发，从而实现动态路由的功能。</font></b></p> <div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9527</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>  <span class="token key atrule">gateway</span><span class="token punctuation">:</span>  <span class="token key atrule">discovery</span><span class="token punctuation">:</span>  <span class="token key atrule">locator</span><span class="token punctuation">:</span>  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">gateway</span><span class="token punctuation">:</span><span class="token comment"># 路由</span><span class="token key atrule">routes</span><span class="token punctuation">:</span><span class="token comment"># 路由 ID ，没有固定规则但是要求唯一，建议配合服务名</span><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh <span class="token comment">## uri: http://localhost:8001</span><span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service<span class="token key atrule">predicates</span><span class="token punctuation">:</span><span class="token comment"># 断言，路径匹配的进行路由</span><span class="token punctuation">-</span> Path=/payment/get/<span class="token important">**</span>        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> payment_routh2        <span class="token comment">## uri: http://localhost:8001</span>        <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service<span class="token key atrule">predicates</span><span class="token punctuation">:</span><span class="token punctuation">-</span> Path=/payment/lb/<span class="token important">**</span><span class="token comment">## 注册进 Eureka</span><span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">instance</span><span class="token punctuation">:</span><span class="token key atrule">hostname</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>gateway<span class="token punctuation">-</span>service<span class="token key atrule">client</span><span class="token punctuation">:</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="🥥-Gateway-常用的-Predicates"><a href="#🥥-Gateway-常用的-Predicates" class="headerlink" title="🥥 Gateway 常用的 Predicates"></a>🥥 Gateway 常用的 Predicates</h2><p><a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gateway-request-predicates-factories">Predicates</a></p><h4 id="获取当前时间-地区"><a href="#获取当前时间-地区" class="headerlink" title="获取当前时间 + 地区"></a>获取当前时间 + 地区</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 获取时间</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">ZonedDateTime</span> t <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2022-02-02-21T15:51:37.485+08:00[Asia/Shanghai]</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="时间限制"><a href="#时间限制" class="headerlink" title="时间限制"></a>时间限制</h3><h4 id="After-可以用来提前上线未开放的功能"><a href="#After-可以用来提前上线未开放的功能" class="headerlink" title="After | 可以用来提前上线未开放的功能"></a><code>After</code> | 可以用来提前上线未开放的功能</h4><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">After=2022<span class="token punctuation">-</span>02<span class="token punctuation">-</span>02<span class="token punctuation">-</span>21T15<span class="token punctuation">:</span>51<span class="token punctuation">:</span>37.485+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h4 id="Before-定期下线某个功能"><a href="#Before-定期下线某个功能" class="headerlink" title="Before | 定期下线某个功能"></a><code>Before</code> | 定期下线某个功能</h4><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">Before=2022<span class="token punctuation">-</span>02<span class="token punctuation">-</span>02<span class="token punctuation">-</span>21T15<span class="token punctuation">:</span>51<span class="token punctuation">:</span>37.485+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h4 id="Between-在某个时间段内"><a href="#Between-在某个时间段内" class="headerlink" title="Between | 在某个时间段内"></a><code>Between</code> | 在某个时间段内</h4><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml">Between=2022<span class="token punctuation">-</span>02<span class="token punctuation">-</span>02<span class="token punctuation">-</span>21T15<span class="token punctuation">:</span>51<span class="token punctuation">:</span>37.485+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span><span class="token punctuation">,</span>2022<span class="token punctuation">-</span>07<span class="token punctuation">-</span>25<span class="token punctuation">-</span>21T15<span class="token punctuation">:</span>51<span class="token punctuation">:</span>37.485+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="Cookie-限制"><a href="#Cookie-限制" class="headerlink" title="Cookie 限制"></a>Cookie 限制</h3><p>Cookie Route Predicate需要两个参数，一个是 Cookie name 一个是正则表达式。<br>路由规则会通过获取对应的 Cookie name 值和正则表达式去匹配，如果匹配上就会执行路由，如果没有匹配上则不执行</p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">gateway</span><span class="token punctuation">:</span><span class="token key atrule">routes</span><span class="token punctuation">:</span><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> cookie_route<span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org<span class="token key atrule">predicates</span><span class="token punctuation">:</span><span class="token comment">## 需要一个 key-value 键值对，key 是 username；value 是 zzyy</span><span class="token punctuation">-</span> Cookie=username<span class="token punctuation">,</span>zzyy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Header-请求头"><a href="#Header-请求头" class="headerlink" title="Header 请求头"></a>Header 请求头</h3><p>两个参数：一个是属性名称和一个正则表达式，这个属性值和正则表达式匹配执行</p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">gateway</span><span class="token punctuation">:</span><span class="token key atrule">routes</span><span class="token punctuation">:</span><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> header_route<span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org<span class="token key atrule">predicates</span><span class="token punctuation">:</span><span class="token punctuation">-</span> Header=x<span class="token punctuation">-</span>Request<span class="token punctuation">-</span>Id<span class="token punctuation">,</span>\d+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h3><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">gateway</span><span class="token punctuation">:</span><span class="token key atrule">routes</span><span class="token punctuation">:</span><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> header_route<span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org<span class="token key atrule">predicates</span><span class="token punctuation">:</span><span class="token punctuation">-</span> Method=GET <span class="token comment">## 只允许 Get 请求</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h2><h4 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h4><p>路由过滤器可用于修改进入的HTTP请求和返回的HTTP响应，路由过滤器只能指定路由进行使用。<br>Spring Cloud Gateway 内置了多种路由过滤器，他们都由GatewayFilter的工厂类来产生。</p><p><strong>生命周期 | 业务逻辑之前 + 业务逻辑之后</strong></p><p><a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gatewayfilter-factories">Gateway Filter</a></p><p><a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#global-filters">Gateway Global Filter</a></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">gateway</span><span class="token punctuation">:</span><span class="token key atrule">routes</span><span class="token punctuation">:</span><span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> header_route<span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org<span class="token key atrule">filters</span><span class="token punctuation">:</span><span class="token comment">## 过滤器工厂会在匹配的请求头加一对请求头，名称为 X-Request-Id，值为 1024</span><span class="token punctuation">-</span> AddRequestParameter=X<span class="token punctuation">-</span>Request<span class="token punctuation">-</span>Id<span class="token punctuation">,</span><span class="token number">1024</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="自定义过滤器"><a href="#自定义过滤器" class="headerlink" title="自定义过滤器"></a>自定义过滤器</h4><p><code>implements GlobalFilter,Ordered</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyLogGateWayFilter</span> <span class="token keyword">implements</span> <span class="token class-name">GlobalFilter</span><span class="token punctuation">,</span><span class="token class-name">Ordered</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">></span></span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchange</span> exchange<span class="token punctuation">,</span><span class="token class-name">GatewayFilterChain</span> chain<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"--------com in MyLogGateWayFilter"</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">String</span> uname <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueryParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token string">"uname"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>uname <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"--------用户名为 null，非法用户，o(╥﹏╥)o"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setStatusCode</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus<span class="token punctuation">.</span>NotAcceptABLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> chain<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>报错 | SpringCloud GateWay 启动报错</title>
    <link href="/2022/07/22/%E3%80%90Error%E3%80%91%7C%20SpringCloud-GateWay-%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99/"/>
    <url>/2022/07/22/%E3%80%90Error%E3%80%91%7C%20SpringCloud-GateWay-%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99/</url>
    
    <content type="html"><![CDATA[<h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">Spring MVC found on classpath,which is incompatible with Spring Cloud Gateway at this time.Please remove spring-boot-starter-web dependency.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>在 Gateway 端移除跟 web 有关的配置。</p><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Error</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Error</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 服务网关 | GateWay 与 Zuul</title>
    <link href="/2022/07/22/SpringCloud%20%7C%20%E8%B7%AF%E7%94%B1%E7%BD%91%E5%85%B3%20%7C%20GateWay/"/>
    <url>/2022/07/22/SpringCloud%20%7C%20%E8%B7%AF%E7%94%B1%E7%BD%91%E5%85%B3%20%7C%20GateWay/</url>
    
    <content type="html"><![CDATA[<br><div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/qrn7ti.png"/></div><br><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>Gateway是在Spring生态系统之上构建的API网关服务，基于Spring 5，Spring Boot 2和 Project Reactor等技术。<br>Gatewav旨在提供一 种简单而有效的方式来对Apl进行路由，以及提供一些强大的过滤器功能，例如：熔断、限流、重试等。</p><p>SpringCloud Gateway 是 Spring cloud 的一个全新项目，基于 Spring 5.0+Spring Boot 2.0 和Project Reactor 等技术开发的网关，它旨在为微服务架构提供一种简单有效的统一的API 路由管理方式。<br>SpringCloud Gateway 作为 Spring cloud 生态系统中的网关，目标是替代zuul，在Spring Cloud 2.0以以上版本中，没有对新版本的Zuul 2.0以上最新高性能版本进行集成，仍然还是使用的Zuul 1.x非Reactor模式的老版本。而为了提升网关的性能， <b><font color=orange>SpringCloud Gateway是基于WebFlux框架实现的，而WebFlux框架底层则使用了高性能的Reactor模式通信框架Netty。</font></b><br>Spring Cloud Gateway的目标提供统一的路由方式且基于 Filter 链的方式提供了网关基本的功能，例如：安全，监控/指标，和限流。</p><h2 id="为何-放弃-Zuul"><a href="#为何-放弃-Zuul" class="headerlink" title="为何 放弃 Zuul"></a>为何 <del>放弃 Zuul</del></h2><p>一方面因为Zuul1.0己经进入了维护阶段，而且Gateway是SpringCloud团队研发的，是亲儿子产品，值得信赖。<br>而且很多功能Zuul都没有用起来也非常的简单便捷。</p><p>Gateway是基于异步非阻塞模型上进行开发的，性能方面不需要担心。虽然 Netflix 早就发布了最新的Zuul 2.x，但 SpringCloud 貌似没有整合计划。而且Netflix相关组件都宣布进入维护期；不知前景如何？</p><p>多方面综合考虑Gateway是很理想的网关选择。</p><h2 id="SpringGateway-的特性"><a href="#SpringGateway-的特性" class="headerlink" title="SpringGateway 的特性"></a>SpringGateway 的特性</h2><p><font color=Orange><b>基于Spring Framework 5, Project Reactor 和 Spring Boot 2.0 进行构建；</b></font><br>动态路由：能够匹配任何请求属性；<br>可以对路由指定 Predicate（断言）和Filter(过滤器）；<br>集成Hystrix的断路器功能；<br>集成 Spring Cloud 服务发现功能；<br>易于编写的 Predicate（断言）和Filter（过滤器）；<br>请求限流功能；<br>支持路径重写。</p><h2 id="Spring-Cloud-Gateway-与-Zulyg"><a href="#Spring-Cloud-Gateway-与-Zulyg" class="headerlink" title="Spring Cloud Gateway 与 Zulyg"></a>Spring Cloud Gateway 与 Zulyg</h2><p><strong>SpringCloud H.x 版本及之前推荐使用 Zuul 版本，F 版及之后的版本推荐 Gateway。</strong></p><p>1、 Zuul 1.x，是一个基于阻塞 I/O 的 API Gateway<br>2、 Zuul 1.x 基于Servlet 2.5使用阻塞架构它不支持任何长连接(如 WebSocket) zuul 的设计模式和Nginx较像，每次1/の操作都是从工作线程中选择个执行，请求线程被阳塞到工作线程完成，但是差别是Nginx 用C+＋实现，Zuul 用 Java 实现，而JVM 本身会有第一次加载较慢的情况，使得Zuul 的性能相对较差。<br>3、zuul 2.x 理念更先进，想基于Netty非阻塞和支持长连接，但SpringCloud目前还没有整合。zuul 2.x的性能较zuul 1.x 有较大提升，在性能方面，根据官方提供的基准测试， Spring Cloud Gateway 的RPS（每秒请求数）是Zuul 的1.6倍。<br>4、 Spring Cloud Gateway 建立 在 Spring Framework 5、 Project、Reactor 和 Spring Boot 2 之上，使用非阻塞 APl。<br>5、Spring Cloud Gateway 还支持 Websocket，并日与Spring紧密集成拥有更好的开发体验。</p>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IDEA | application.yml 识别不到</title>
    <link href="/2022/07/22/2022-07-22-IDEA--application.yml-%E8%AF%86%E5%88%AB%E4%B8%8D%E5%88%B0/"/>
    <url>/2022/07/22/2022-07-22-IDEA--application.yml-%E8%AF%86%E5%88%AB%E4%B8%8D%E5%88%B0/</url>
    
    <content type="html"><![CDATA[<p>Project Structure → Module → 项目目录 → 右键 → Spring → ➕ → ➕ → Other files → 找到该 application.yml 文件</p>]]></content>
    
    
    <categories>
      
      <category>IDEA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IDEA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeeCode | 03 | 无重复字符串</title>
    <link href="/2022/07/20/LeeCode/LeeCode%20%7C%2003%20%7C%20%E6%97%A0%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    <url>/2022/07/20/LeeCode/LeeCode%20%7C%2003%20%7C%20%E6%97%A0%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
    
    <content type="html"><![CDATA[<p><br><br></p><div style="text-align:center"><img style="z-index:2;width:200px;border-radius:20px;border:1px solid black;box-shadow:0 0 20px darkgray;" src="https://files.catbox.moe/srel0u.png"/></div><br><br><br><br><br><br><h2 id="LeeCode-03-无重复字符串"><a href="#LeeCode-03-无重复字符串" class="headerlink" title="LeeCode | 03 | 无重复字符串"></a>LeeCode | 03 | 无重复字符串</h2><table><thead><tr><th>方法</th><th>难度</th></tr></thead><tbody><tr><td>难度</td><td><font color=orange><b>中等</b></font></td></tr><tr><td>时间复杂度</td><td><em>O</em>(<em>n</em>)</td></tr><tr><td>方法</td><td>滑动窗口</td></tr></tbody></table><br><p>给定一个字符串 <code>s</code> ，请你找出其中不含有重复字符的 <strong>最长子串</strong> 的长度。</p><p><strong>示例 1:</strong></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">输入: s &#x3D; &quot;abcabcbb&quot;输出: 3 解释: 因为无重复字符的最长子串是 &quot;abc&quot;，所以其长度为 3。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p><strong>示例 2:</strong></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">输入: s &#x3D; &quot;bbbbb&quot;输出: 1解释: 因为无重复字符的最长子串是 &quot;b&quot;，所以其长度为 1。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p><strong>示例 3:</strong></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">输入: s &#x3D; &quot;pwwkew&quot;输出: 3解释: 因为无重复字符的最长子串是 &quot;wke&quot;，所以其长度为 3。     请注意，你的答案必须是 子串 的长度，&quot;pwke&quot; 是一个子序列，不是子串。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lengthOfLongestSubstring</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                left <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>max<span class="token punctuation">,</span>i<span class="token operator">-</span>left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> max<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><br><h4 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 得到字符串在位置 x 的 char</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// HashMap 中是否含有 Key</span><span class="token class-name">HashMap</span><span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token class-name">Key</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><h4 id="代码阅读"><a href="#代码阅读" class="headerlink" title="代码阅读"></a>代码阅读</h4><p><strong>核心</strong>：只经历了一次循环</p><blockquote><p>其实就是一个队列,比如例题中的 abcabcbb，进入这个队列（窗口）为 abc 满足题目要求，当再进入 a，队列变成了 abca，这时候不满足要求。所以，我们要移动这个队列！</p><p>如何移动？</p><p>我们只要把队列的左边的元素移出就行了，直到满足题目要求！</p><p>一直维持这样的队列，找出队列出现最长的长度时候，求出解！</p></blockquote><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><blockquote><p> <strong>字符串</strong>：<code>asdibdga</code>；</p><p>进入循环，目前 left 是 0，max 是 0；</p><p>循环到<code>asdib</code>没有出现重复，以上字符都被放到 HashMap 中，目前 <code>max</code>=5，<code>i </code>= 4，<code>i-left+1</code>=5，因此<code>max</code> = Math.max(5,5)；</p><p>遍历到 <code>d</code> 的时候，出现了第一个字符，这里会取一个最大值，是在 <code>left</code> 和第一次出现 <code>d</code> 的位置取最大值，很明显，出现 <code>d</code> 的位置更大，因此 <code>left</code> 变成了3；而在 HashMap 中的<code>d</code>的位置变成了 5</p><p>目前最大值是 5，<code>left</code> 是 3；</p><p>继续遍历，<code>g</code> 不存在，跳过 <code>if</code>，将 <code>g</code> 放到；</p><p>遇到 <code>a</code>，发现 <code>a</code> 存在，因此执行<code>if</code>下的代码：</p><ul><li>取当前的 <code>left</code> 与 <code>a</code> 的位置作对比，发现 <code>left</code> 更大，因此去 <code>left</code>=3，而 <code>a</code> 的位置是 1，因此 <code>left</code>=3</li></ul><p><code>a</code> 的位置更新为 7</p><p>对 <code>max</code>=5 和 7-3+1=5 取最大值，<code>max</code> 依旧是 5</p><p>∴ return 5</p></blockquote><blockquote><p><strong>字符串</strong>： <code>bcdaghjalk</code></p><p>进入循环，循环到 <code>j</code>，长度为 7，left=0</p><p>遇到 <code>a</code>，left=Math.max(0,4)=4</p><p>这时候<code>a</code>的位置更新到 7，也就是舍弃了左侧 <code>bcd</code>，窗口变成了<code>ghja</code>，此时 max 是 8，[a,a) 之间的距离是4&lt;8，不取。</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>LeeCode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>刷题</tag>
      
      <tag>LeeCode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>测试 | JMeter | 高并发测试工具</title>
    <link href="/2022/07/20/%E6%B5%8B%E8%AF%95%20%7C%20JMeter%20%7C%20%E9%AB%98%E5%B9%B6%E5%8F%91%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/"/>
    <url>/2022/07/20/%E6%B5%8B%E8%AF%95%20%7C%20JMeter%20%7C%20%E9%AB%98%E5%B9%B6%E5%8F%91%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<h1 id="JMeter-高并发测试"><a href="#JMeter-高并发测试" class="headerlink" title="JMeter 高并发测试"></a>JMeter 高并发测试</h1><div style="text-align:center;border:1px solid darkgray;padding:10px;border-radius:15px">  <img  style="width:230px;border-radius:15px" src="https://files.catbox.moe/74qnts.png"/></div><br><div style="border:1px solid darkgray;width:100%;height:85px;background:#eef7fa;border-radius:15px;text-align:center;padding:22px 0px;"><div><a href="https://jmeter.apache.org/" style="font-size:24px;margin-right:15px"><b>官网</b></a></div></div><br><div style="text-align:center;border:1px solid darkgray;padding:10px;border-radius:15px">  <img  style="width:85%x;border-radius:15px" src="https://files.catbox.moe/jw2wqy.png"/></div>]]></content>
    
    
    <categories>
      
      <category>测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>高并发</tag>
      
      <tag>测试</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 服务降级 | Hystrix</title>
    <link href="/2022/07/20/SpringCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7%20%7C%20Hystrix/"/>
    <url>/2022/07/20/SpringCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7%20%7C%20Hystrix/</url>
    
    <content type="html"><![CDATA[<div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/5pf4tu.png"/></div><p>[TOC]</p><div style="text-align:center;border:1px solid darkgray;padding:10px;border-radius:15px">  <img  style="width:230px;border-radius:15px" src="https://files.catbox.moe/0hcf7z.png"/></div><br><div style="width:100%;height:85px;background:#ffb0d2;border-radius:15px;text-align:center;padding:22px 0px;"><div><img style="width:25px;border-radius:5px;margin:0 10px  9px 30px" src="https://files.catbox.moe/2u957r.png"/><a href="https://github.com/Netflix/Hystrix" style="font-size:24px;margin-right:15px"><b>GitHub （已停止运维）</b></a></div></div><blockquote><ul><li>运行</li><li>超时</li><li>宕机</li></ul></blockquote><br><br><h2 id="How-Does-it-work？"><a href="#How-Does-it-work？" class="headerlink" title="How Does it work？"></a>How Does it work？</h2><br><div style="text-align:center"><img style="width:90%;border:1px solid darkgray;padding:15px;border-radius:15px" src="https://files.catbox.moe/woi3j5.png"></div><br><ol><li>选择<code>construct a HystrixCommand</code>或者<code>HystrixObservableCommand</code></li><li>选择方法</li><li>判断缓存中是否有<ol><li><font color=red><strong>是</strong></font>：返回缓存结果</li><li><font color=green><strong>否</strong></font>：向下执行</li></ol></li><li>断路器是否打开<ol><li><font color=red><strong>是</strong></font>：服务降级 FallBack</li><li><font color=green><strong>否</strong></font>：向下执行</li></ol></li><li>判断线程池是否满了？<ol><li><font color=red><strong>是</strong></font>：服务降级 FallBack</li><li><font color=green><strong>否</strong></font>：向下执行</li></ol></li><li><code>construct()</code> <strong>OR</strong> <code>run()</code></li><li>是否<strong>失败</strong>或者<strong>超时</strong>？<ol><li><font color=red><strong>是</strong></font>：服务降级 FallBack，并报告给断路器</li><li><font color=green><strong>否</strong></font>：<font color=Green>正常执行</font>，并报告给断路器</li></ol></li></ol><br><h2 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h2><blockquote><p><strong>1-1 方法</strong></p><p>@HystrixCommand(fallbackMethod=”paymentInfo_TImeOutHandler”,commandProperties={@HystrixProperty(name=”execution.isolation.thread.timeoutInMilliseconds”,value=”3000”)})</p><p><strong>1-N 方法</strong></p><p>@DefaultProperties(defaultFallback=”payment_Global_FallbackMethod”)</p><p><strong>N-N</strong></p><p>新建一个类，实现 @FeignClient 下的 PaymentHystrixService 接口</p><p>@FeignClient(value = “CLOUD-PROVIDER-HYSTRIX-PAYMENT”,fallback=”PaymentFallbackService.class”)</p><p>public class PaymentFallbackService implements PaymentHystrixService</p></blockquote><blockquote><p>@EnableCircuitBreaker</p></blockquote><h2 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h2><br><hr><p><b><font color=#2b61a7 size=4>服务降级</font></b></p><p>服务降级一般是指在服务器压力剧增的时候，根据实际业务使用情况以及流量，对一些服务和页面有策略的不处理或者用一种简单的方式进行处理，从而释放服务器资源的资源以保证核心业务的正常高效运行。</p><br><hr><p><b><font color=#2b61a7 size=4>服务熔断</font></b></p><p>熔断机制是应对雪崩效应的一种微服务链路保护机制。当扇出链路的某个微服务出错不可用或者响应时间太长时，会进行服务的降级，进而熔断该节点微服务的调用，快速返回错误的响应信息。<br><font color=darkgr><b>当检测到该节点微服务调用响应正常后，恢复调用链路。</b></font></p><p>在Spring Cloud框架里，熔断机制通过Hystrix实现。</p><p>Hystrix会监控微服务间调用的状况，当失败的调用到一定阈值，缺省是5秒内20次调用失败，就会启动熔断机制。熔断机制的注解是@HystrixCommand</p><p>服务降级 ⇨ 进行熔断 ⇨ 回复调用链路</p><br><hr><p><b><font color=#2b61a7 size=4>服务雪崩</font></b><br>多个微服务之间调用的时候，假设微服务A调用微服务B和微服务C，微服务B和微服务C又调用其它的微服务，这就是所谓的 <font color=red>“扇出”</font>。如果扇出的链路上某个微服务的调用响应时间过长或者不可用，对微服务A的调用就会占用越来越多的系统资源，进而引起系统崩溃，所谓的 “雪崩效应”。</p><p>对于高流量的应用来说，单一的后端依赖可能会导致所有服务器上的所有资源都在几秒钟内饱和。比失败更糟糕的是，这些应用程序还可能导致服务之问的延迟增加，备份队列，线程和其他系统资源紧张，导致整个系统发生更多的级联故障。这些都表示需要对故障和延迟进行隔离和管理，以便单个依赖关系的失败，不能取消整个应用程序或系统。</p><p>所以，通常当你发现一个模块下的某个实例失败后，这时候这个模块依然还会接收流量，然后这个有问题的模块还调用了其他的模块，这样就会发生级联故障，或者叫雪崩。</p><br><hr><p><b><font color=#2b61a7 size=4>什么是 Hystrix</font></b></p><p>Hystrix是一个用于处理分布式系统的<font color=red>延迟</font>和<font color=red>容错</font>的开源库，在分布式系统里，许多依赖不可避免的会调用失败，比如超时、异常等，Hystrix能够保证在-个依赖出问题的情况下，<font color=red>不会导致整体服务失败，避免级联故障，以提高分布式系统的弹性。</font></p><p><strong>“断路器”</strong> 本身是一种开关装置，当某个服务单元发生故障之后，通过断路器的故障监控(类似熔断保险丝），<font color=red>向调用方返回一个符合预期的、可处理的备选响应 <font color=green><strong>（FallBack）</strong></font>，而不是长时间的等待或者抛出调用方无法处理的异常，</font>这样就保证了服务调用方的线程不会被长时间、不必要地占用，从而避免了故障在分布式系统中的蔓延，乃至雪崩。</p><br><br><br><h2 id="能干嘛？"><a href="#能干嘛？" class="headerlink" title="能干嘛？"></a>能干嘛？</h2><ol><li>服务降级</li><li>服务熔断</li><li>接近实时的监控</li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommandHelloWorld</span> <span class="token keyword">extends</span> <span class="token class-name">HystrixCommand</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">CommandHelloWorld</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token class-name">HystrixCommandGroupKey<span class="token punctuation">.</span>Factory</span><span class="token punctuation">.</span><span class="token function">asKey</span><span class="token punctuation">(</span><span class="token string">"ExampleGroup"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"Hello "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><br><h2 id="尝试-相关配置及代码"><a href="#尝试-相关配置及代码" class="headerlink" title="尝试 | 相关配置及代码"></a>尝试 | 相关配置及代码</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-netflix-hystrix<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>x.y.z<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment"># application.yml</span><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">1234</span><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> xxx<span class="token key atrule">eureka</span><span class="token punctuation">:</span><span class="token key atrule">client</span><span class="token punctuation">:</span><span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token key atrule">service-url</span><span class="token punctuation">:</span><span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 主启动 com.xxx.springcloud.PaymentHystrixMain</span><span class="token annotation punctuation">@ApringBootApplicatioin</span><span class="token annotation punctuation">@EnableEurekaClient</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentHystrixMain</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentHystrixMain</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentService</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_OK</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token string">"线程池：\t "</span><span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"paymentIngo_OK,id\t"</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">"\tO(∩_∩)O哈哈~"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_Timeout</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>      <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token function">cathc</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token string">"线程池：\t "</span><span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"paymentIngo_OK,id\t"</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">"\tO(∩_∩)O哈哈~\t耗时三秒钟"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentController</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Resource</span>  <span class="token keyword">private</span> <span class="token class-name">PaymentService</span> paymentService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;server.port&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/payment/hystrix/ok/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">payment_OK</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> result <span class="token operator">=</span> paymentService<span class="token punctuation">.</span><span class="token function">paymentInfo_OK</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"result:"</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/payment/hystrix/timeout/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">payment_Tiemout</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> result <span class="token operator">=</span> paymentService<span class="token punctuation">.</span><span class="token function">paymentInfo_Timeout</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"result:"</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=red><b>以上两个方法，一个点击后就会响应，一个需要等待三秒后才会响应。</b></font>当timeout 的请求过多时，容易造成 tomcat 阻塞，从而导致无法请求。</p><br><br><br><h2 id="🏀-服务降级-超时-🐢-宕机-☠️-后"><a href="#🏀-服务降级-超时-🐢-宕机-☠️-后" class="headerlink" title="🏀 服务降级 | 超时 🐢 宕机 ☠️ 后"></a>🏀 服务降级 | 超时 🐢 <del>宕机</del> ☠️ 后</h2><p><strong>配置替代编码</strong><font color=orange><strong>（有 1-1 则优先 1-1 否则 1-N）</strong></font></p><h3 id="1-1-专属替换"><a href="#1-1-专属替换" class="headerlink" title="1-1 | 专属替换"></a>1-1 | 专属替换</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentService</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@HystrixCommand</span><span class="token punctuation">(</span>fallbackMethod<span class="token operator">=</span><span class="token string">"paymentInfo_TImeOutHandler"</span><span class="token punctuation">,</span>commandProperties<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"execution.isolation.thread.timeoutInMilliseconds"</span><span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"3000"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_Timeout</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>      <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token function">cathc</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token string">"线程池：\t "</span><span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"paymentIngo_OK,id\t"</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">"\tO(∩_∩)O哈哈~\t耗时三秒钟"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_TimeOutHandler</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"线程池：\t "</span><span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"paymentIngo_OK,id\t"</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">"\to(╥﹏╥)o 呜呜~"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>设置自身调用超时时间的峰值，峰值内可以正常运行。<br>超过了需要有兜底的方法处理，作服务降级（Fallback）。</p><h3 id="1-N-全局替换"><a href="#1-N-全局替换" class="headerlink" title="1-N | 全局替换"></a>1-N | 全局替换</h3><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@DefaultProperties</span><span class="token punctuation">(</span>defaultFallback<span class="token operator">=</span><span class="token string">"payment_Global_FallbackMethod"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> ABC<span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/consumer/payment/hystrix/timeout/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token annotation punctuation">@HystrixCommand</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Pathvariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> a<span class="token operator">=</span>n<span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token string">"Success"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">payment_Global_FallbackMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token string">"Global异常!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="N-N（各自对应）"><a href="#N-N（各自对应）" class="headerlink" title="N-N（各自对应）"></a>N-N（各自对应）</h3><blockquote><p>新建一个类，实现 @FeignClient 下的 PaymentHystrixService 接口</p><p>@FeignClient(value = “CLOUD-PROVIDER-HYSTRIX-PAYMENT”,fallback=”PaymentFallbackService.class”)</p><p>public class PaymentFallbackService implements PaymentHystrixService</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"CLOUD-PROVIDER-HYSTRIX-PAYMENT"</span><span class="token punctuation">,</span>fallback<span class="token operator">=</span><span class="token string">"PaymentFallbackService.class"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PaymentHystrixService</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/payment/hystrix/ok/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_OK</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/payment/hystrix/timeout/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_Timeout</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentFallbackService</span> <span class="token keyword">implements</span> <span class="token class-name">PaymentHystrixService</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_OK</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo_Timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>这样写的话，当出现问题的时候，会调用类方法中的方法</p></blockquote><br><br><br><h2 id="🏀-服务熔断-恢复调用链路"><a href="#🏀-服务熔断-恢复调用链路" class="headerlink" title="🏀 服务熔断 | 恢复调用链路"></a>🏀 服务熔断 | 恢复调用链路</h2><h4 id="断路器触发条件"><a href="#断路器触发条件" class="headerlink" title="断路器触发条件"></a><b><font color=#2b61a7 size=4>断路器触发条件</font></b></h4><table><thead><tr><th>方法</th><th>作用</th></tr></thead><tbody><tr><td>@HystrixProperty(name = “circuitBreaker.enabled”, value = “true”),</td><td>是否开启断路器</td></tr><tr><td>@HystrixProperty(name = “circuitBreaker.requestVolumeThreshold”, value = “10”),</td><td>请求次数</td></tr><tr><td>@HystrixProperty(name = “circuitBreaker.sleepWindowInMilliseconds”, value = “10000”),</td><td>时间窗口期</td></tr><tr><td>@HystrixProperty(name = “circuitBreaker.errorThresholdPercentage”, value = “60”),</td><td>失败率达到多少后跳闸</td></tr><tr><td>@HystrixProperty(name = “execution.isolation.thread.timeoutInMilliseconds”, value = “5000”)</td><td>超时处理</td></tr></tbody></table><p><font size=4><b>三个重要参数：<font color=#2c61a8>快照时间窗、请求总数闲值、错误百分比阀值。</font></b></font></p><p><font color=orange size=2>默认 10 秒 20 个请求超过 50%</font></p><ol><li>快照时间窗：断路器确定是否打开需要统计一些请求和错误数据，而统计的时间范国就是快照时间窗，默认为最近的10秒。</li><li>请求总数阀值：在快照时间窗内，必须满足请求总数调值才有资格熔断。默认为20，意味着在10秒内，如果该hystrix命令的调用次数不足20次，即使所有的请求都超时或其他原因失败，断路器都不会打开。</li><li>错误百分比闲值：当请求总数在快照时间窗内超过了阀值，比如发生了30次调用，如果在这30次调用中，有15次发生了超时异常，也就是超过50%的错误百分比，在默认设定50%调值情况下，这时候就会将断路器打开。</li><li><font color=#2c61a8><b>开启状态下，所有请求都不会转发；一段时间后（默认五秒）进入半开状态，半开状态时，会先让一个请求进行转发，如果成功，断路器关闭，若失败则继续开启。</b></font></li></ol><br><br><div style="text-align:center;border:1px solid lightgray;padding:15px;border-radius:15px">  <img  style="width:50%;border-radius:15px;border:1px solid #f5f7f9" src="https://files.catbox.moe/rpp4e9.png"/></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@HystrixCommand</span><span class="token punctuation">(</span>fallbackMethod <span class="token operator">=</span> <span class="token string">"paymentCircuitBreakerFallback"</span><span class="token punctuation">,</span> commandProperties <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"circuitBreaker.enabled"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">/*是否开启断路器*/</span><span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"circuitBreaker.requestVolumeThreshold"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"10"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// 请求次数</span><span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"circuitBreaker.sleepWindowInMilliseconds"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"10000"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 时间窗口期</span><span class="token annotation punctuation">@HystrixProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"circuitBreaker.errorThresholdPercentage"</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"60"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// 失败率达到多少后跳闸</span><span class="token comment">//@HystrixProperty(name = "execution.isolation.thread.timeoutInMilliseconds", value = "5000")// 超时处理</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentCircuitBreaker</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>id <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"***id 不能负数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token comment">// UUID.randomUUID.toString();</span>  <span class="token class-name">String</span> serialNumber <span class="token operator">=</span> <span class="token class-name">IdUtil</span><span class="token punctuation">.</span><span class="token function">simpleUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\t"</span><span class="token operator">+</span><span class="token string">"调用成功，流水号："</span><span class="token operator">+</span>serialNumber<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentCircuitBreaker_fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token string">"id 不能是负数，请稍后再试(灬ꈍ ꈍ灬)~~ ID:"</span><span class="token operator">+</span>id<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><ol><li>再有请求调用的时候，将不会调用主逻辑，而是直接调用降级fallback通过断路器，实现了自动地发现错误并将降级逻辑切换为主逻辑，减少响应延迟的效果。</li><li>原来的主逻辑要如何恢复呢？<br>对于这一问题，hystrix也为我们实现了自动恢复功能。当断路器打开，对主逻辑进行熔断之后，hystrix会启动一个休眠时间窗，在这个时间窗内，降级逻辑是临时的成为主逻辑，当休眠时间窗到期，断路器将进入半开状态，释放一次请求到原来的主逻辑上，如果此次请求正常返回，那么断路器将继续闭合，主逻辑恢复，如果这次请求依然有问题，断路器继续进入打开状态，休眠时间窗重新计时。</li></ol><h2 id="📺-Dashboard-仪表盘操作界面-😦"><a href="#📺-Dashboard-仪表盘操作界面-😦" class="headerlink" title="📺 Dashboard | 仪表盘操作界面 | 😦"></a>📺 Dashboard | 仪表盘操作界面 | 😦</h2><p>除了隔离依赖服务的调用以外，Hystrix还提供了<font color=red><b>准实时的调用监控 (Hystrix Dashboard)<br></b></font>，Hystrix会持续地记录所有通过Hystrix发起的请求的执行信息，并以统计报表和图形的形式展示给用户，包括每秒执行多少请求多少成功，多少失败等。Netflix通过hystrix-metrics-event-stream项目实现了对以上指标的监控。Spring Cloud也提供了Hystrix Dashboard的整合，对监控内容转化成可视化界面。</p><h3 id="开启-Dashboard"><a href="#开启-Dashboard" class="headerlink" title="开启 Dashboard"></a>开启 Dashboard</h3><h4 id="1-新建-Module"><a href="#1-新建-Module" class="headerlink" title="1. 新建 Module"></a>1. 新建 Module</h4><h4 id="2-添加-Dependency"><a href="#2-添加-Dependency" class="headerlink" title="2. 添加 Dependency"></a>2. 添加 Dependency</h4><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- Hystrix Dashboard（放在监控端） --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-stater-netflix-hystrix-dashboard<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 监控信息(放在被监控端) --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="3-application-yml"><a href="#3-application-yml" class="headerlink" title="3. application.yml"></a>3. application.yml</h4><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h4 id="4-主启动类"><a href="#4-主启动类" class="headerlink" title="4. 主启动类"></a>4. 主启动类</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableHystrixDashboard</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HystrixDashboardMain</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">HystrixDashboardMain</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="5-访问"><a href="#5-访问" class="headerlink" title="5. 访问"></a>5. 访问</h4><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">http://localhost:xxx/hystrix<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h4 id="6-报错"><a href="#6-报错" class="headerlink" title="6. 报错"></a>6. 报错</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootAppliaction</span><span class="token annotation punctuation">@EnableEurekaClient</span><span class="token annotation punctuation">@EnableCircuitBreaker</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentHystrixMain8001</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentHystrixMain8001</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>      <span class="token comment">/** 此配置是为了服务监控未配置，与服务容错本身无关，springcloud 升级后的坑  *S而vletRegistrationBean 因为 Springboot 的默认路径不是"/hystrix.stream"  *只要在自己的项目里配置上 servlet 就可以了  */</span>  <span class="token annotation punctuation">@Bean</span>  <span class="token keyword">public</span> <span class="token class-name">ServletRegistrationBean</span> <span class="token function">getServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">HystrixMetricsStreamServlet</span> streamServlet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HystrixMetricsStreamServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">ServletRegistrationBean</span> registrationBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletRegistrationBean</span><span class="token punctuation">(</span>streamServlet<span class="token punctuation">)</span><span class="token punctuation">;</span>    registrationBean<span class="token punctuation">.</span><span class="token function">setLoadOnStartup</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    registrationBean<span class="token punctuation">.</span><span class="token function">addUrlMappings</span><span class="token punctuation">(</span><span class="token string">"/hystrix.stream"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    registrationBean<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"HystriaMetricsStreamServlet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> registrationBean<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><h3 id="🧐-如何看？-7-色-1-圈-1-线"><a href="#🧐-如何看？-7-色-1-圈-1-线" class="headerlink" title="🧐 如何看？ | 7 色 | 1 圈 | 1 线"></a>🧐 如何看？ | 7 色 | 1 圈 | 1 线</h3><div style="text-align:center"><img style="width:70%;border:1px solid gray;border-radius:10px;padding:5px" src="https://files.catbox.moe/2ecbho.png"/></div><div style="text-align:center;background:#061D75;border-radius:10px"><span style="color:#E2E4E7"><h3>7 色</h3></span></div><p><font color=#5a7762><b>成功 | Success</b></font></p><p><font color=#3247c5><b>断路 | Short-Circuited</b></font></p><p><font color=#5ebeb5><b>错误请求 | Bad Request</b></font></p><p><font color=orange><b>超时 | Timeout</b></font></p><p><font color=purple><b>拒绝 | Rejected</b></font></p><p><font color=red><b>失败 | Failure</b></font></p><p><font color=black><b>错误 | Error</b></font></p><div style="text-align:center;background:#061D75;border-radius:10px"><span style="color:#E2E4E7"><h3>1 圈</h3></span></div><p>实心园：共有两种含义。它通过颜色的变化代表了实例的健康程度，它的健康程度度从 <font color=green><strong>绿色</strong></font> &lt; <font color=#FFD301><strong>黄色</strong></font> &lt; <font color=orange><strong>橙色</strong></font> &lt; <font color=red><strong>红色</strong></font> 递减。<br>该实心园除了颜色的变化之外，它的大小也会根据实例的请求流量发生变化，流量越大该实心圆就越大。所以通过该实心园的展示，就可以在大量的实例中快速的发现<font color=red><b>故障实例和高压力实例</b></font>。</p>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Markdown 常用语法</title>
    <link href="/2022/07/19/Markdown/"/>
    <url>/2022/07/19/Markdown/</url>
    
    <content type="html"><![CDATA[<p>[TOC]</p><br><div style="width:100%;height:85px;background:#eef7fa;border-radius:10px;text-align:center;padding:22px 0px;"><div><img style="width:25px;border-radius:5px;margin:0 10px  9px 0" src="https://files.catbox.moe/2u957r.png"/><a href="https://github.com/Sakiyary/Markdown-Typora-VSCode-Doc" style="font-size:24px;margin-right:15px"><b>转载自 Github</b></a></div></div><br><h1 id="Markdown-Typora-VSCode-超全教程-给大一新生安利的文本神器"><a href="#Markdown-Typora-VSCode-超全教程-给大一新生安利的文本神器" class="headerlink" title="[Markdown+Typora/VSCode 超全教程] 给大一新生安利的文本神器"></a>[Markdown+Typora/VSCode 超全教程] 给大一新生安利的文本神器</h1><p>Sakiyary 2022/7/16</p><h2 id="😂-简要介绍"><a href="#😂-简要介绍" class="headerlink" title="😂 简要介绍"></a>😂 简要介绍</h2><p><strong>Markdown</strong> 是一种轻量型标记语言, 是一种语法. 以 <code>.md</code> 结尾的文本文件就是 Markdown 文件. 相较于 <strong>Word</strong>, 它更加像是 <strong>HTML</strong> 语言或是 $\LaTeX$, 并不是最淳朴的那种”所见即所得”. 它处处透露着一种极简主义. 高效简洁清晰的同时, 又很简单. 看起来舒服, 语法简单, 尤其在处理纯文本上有很大的优势. </p><p>它相较于 <strong>Word</strong>, 兼容性非常高, 可以跨平台使用, 不用担心奇奇怪怪的版本兼容问题. 同时, 有许多网站都支持或正在使用 <strong>Markdown</strong> 语法. 如 <strong>Github</strong> (等一系列代码托管平台), StackOverflow(等答疑平台), 简书, 语雀 (等一系列笔记平台).</p><h2 id="📐-实际应用"><a href="#📐-实际应用" class="headerlink" title="📐 实际应用"></a>📐 实际应用</h2><p>所有要写文本的时候都可以用上 <strong>Markdown</strong>!</p><p>它可以让你不再纠结什么字体, 什么样式, 什么排版. 而且逻辑清晰, 层次分明.</p><p>像我大一的时候就用 Markdown 来写各种笔记, 演讲稿, 课程论文, 实验报告, 代码的 <code>README.md</code> … 包括本教程文档.</p><h2 id="🍴-工具"><a href="#🍴-工具" class="headerlink" title="🍴 工具"></a>🍴 工具</h2><p>Markdown 只是一种语法. 那么用来写 Markdown 的文本编辑器呢? 我推荐的是 <strong>Typora</strong> 或者 <strong>VS Code</strong></p><h3 id="Typora"><a href="#Typora" class="headerlink" title="Typora"></a>Typora</h3><p>Typora 应该是被广泛用于写 Markdown 的文本软件, 就和 Markdown 语法一样高效. 而且它还有很实用的扩展语法与自定义样式的功能. 其能将 <code>.md</code> 导出成多种文件, 如 <code>.pdf</code>, <code>.html</code>, <code>.docx</code> (没想到吧, 能导出到 Word)</p><p>但是现在 Typora 已经发布正式版并且变为收费软件. 中文官网在此 <a href="https://typoraio.cn/">Typora 官方中文站 </a>. </p><p>我当然是推荐大家都用正版啦. 不过价格是永久版￥89, 好在可以用在3台设备上. 如果和你的两位同学/舍友均摊一下, 每人就只要￥30, 和一张游戏月卡差不多. </p><p>至于盗版以及破解方法<a href="https://www.only4.work/blog/?id=379">在此随便找一种改注册表时间方法的</a><del>不介绍(还挺多的其实)</del>.</p><p><del>还有一种免费白嫖的方法就是安装测试版/Beta版. 官网有历史版本的下载链接 <a href="https://typoraio.cn/windows/dev_release.html">Typora 历史版本下载页</a></del></p><p>白嫖Beta版已经寄了, 要么支持正版要么去学习一下破解方法吧 (还是忍不住啦, 看上面的链接👆)</p><h3 id="VS-Code"><a href="#VS-Code" class="headerlink" title="VS Code"></a>VS Code</h3><p>这是微软家的开源文本编辑器, 理论上来说所有代码, 语言, 都可以用 VS Code 来写, 同样是非常的简洁好用. 在下载插件 <strong>Markdown All in One</strong> 后对 Markdown 的基础支持也是非常的好. 若在 VS Code 下载 Markdown 各种附加扩展, 就能获得比 Typora 更加丰富的扩展语法与操作.</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>大部分IDE, 像 Jetbrain 的全家桶里应该每一款, 都支持 Markdown 语法, 在此不多赘述.</p><p>本文档主要使用 Typora 进行演示, 同时会介绍许多 Typora 所包含的扩展语法.</p><h2 id="🍭-基础教程"><a href="#🍭-基础教程" class="headerlink" title="🍭 基础教程"></a>🍭 基础教程</h2><p>当有多种标记方法时我会倾向其中一种. </p><p>标题有 <code>*</code> 表示该为扩展语法, 仅在 Typora 或 添加了扩展的 VS Code <strong>本地生效</strong>, 在大多数平台上<strong>并不认可</strong>.</p><h3 id="0-写-Markdown-的第零步"><a href="#0-写-Markdown-的第零步" class="headerlink" title="0. 写 Markdown 的第零步"></a>0. 写 Markdown 的第零步</h3><p>我们写文本的时候大多写的是中文, 可是输入法在输中文时使用的标点为全角标点, 如 <code>，。？！（）【】：；“”</code>. 这些标点是不被 Markdown 所认可的, 也是无法转义的. </p><p>我建议大家写 Markdown 的时候都用半角标点, 即英文标点, 如 <code>,.?!()[]:;&quot;&quot;</code>. 且每个半角标点在文本使用时加上后置空格, 符合英文标点的书写规范, 也更加美观.</p><p>以微软自带输入法举例, 在使用中文输入法时按下 <code>Ctrl</code> + <code>.(这是个句号)</code>, 切换标点的全角与半角. 这样即可中文输入+半角标点.</p><h3 id="1-标题-数个-“-”-空格-前置"><a href="#1-标题-数个-“-”-空格-前置" class="headerlink" title="1. 标题 [数个 “#” + 空格 前置]"></a>1. 标题 [数个 “#” + 空格 前置]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none"># 一级标题## 二级标题### 三级标题#### 四级标题##### 五级标题###### 六级标题<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>标题会在目录与大纲分级显示, 可以跳转. </p><p>在 Typora 中建议开启 <code>严格模式</code>, 即不应为 <code>#标题</code>, 应为 <code># 标题</code>. </p><p>应该要手动补上空格, 使得 Markdown 语法在其他文本编辑器上兼容. </p><h3 id="2-强调-用-“-”-或-“-”-包围"><a href="#2-强调-用-“-”-或-“-”-包围" class="headerlink" title="2. 强调 [用 “**” 或 “__” 包围]"></a>2. 强调 [用 “**” 或 “__” 包围]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">**欢迎报考南京大学!** (我喜欢用这种)__欢迎报考南京大学!__<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>或者选中想要强调的文字按下 <code>Ctrl</code> + <code>B</code>. </p><p>E.G. </p><p><strong>欢迎报考南京大学!</strong></p><h3 id="3-斜体-用-“-”-或-“-”-包围"><a href="#3-斜体-用-“-”-或-“-”-包围" class="headerlink" title="3. 斜体 [用 “*” 或 “_” 包围]"></a>3. 斜体 [用 “*” 或 “_” 包围]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">*欢迎大佬来浇浇我各种知识* (我喜欢用这种)_欢迎大佬来浇浇我各种知识_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>或者选中想要强调的文字按下 <code>Ctrl</code> + <code>I</code>. </p><p>E.G. </p><p><em>欢迎大佬来浇浇我各种知识</em></p><p>(P.S. <em><strong>斜体并强调</strong></em> [用 “***” 或 “___” 包围])</p><h3 id="4-删除线-用-“-”-包围"><a href="#4-删除线-用-“-”-包围" class="headerlink" title="4. 删除线 [用 “~~” 包围]"></a>4. 删除线 [用 “~~” 包围]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">~~我宣布个事儿, 我是Sabiyary!~~<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>E.G. </p><p><del>我宣布个事儿, 我是Sabiyary!</del></p><h3 id="5-高亮-用-“-”-包围"><a href="#5-高亮-用-“-”-包围" class="headerlink" title="5. *高亮 [用 “==” 包围]"></a>5. *高亮 [用 “==” 包围]</h3><p><strong>(注意: 此为扩展语法)</strong></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">&#x3D;&#x3D;我喜欢黄色, 也喜欢绿色&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>E.G. </p><p>==我喜欢黄色, 也喜欢绿色==</p><h3 id="6-代码-用-“-”-包围"><a href="#6-代码-用-“-”-包围" class="headerlink" title="6. 代码 [用 “`” 包围]"></a>6. 代码 [用 “`” 包围]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">&#96;sudo rm -rf &#x2F;*&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>E.G. </p><p><code>sudo rm -rf /*</code> (没事别乱敲这个! )</p><p><del>“请输入管理员密码: (闪烁的光标)”</del></p><h3 id="7-代码块-按三个-“-”-并敲回车"><a href="#7-代码块-按三个-“-”-并敲回车" class="headerlink" title="7. 代码块 [按三个 “`” 并敲回车]"></a>7. 代码块 [按三个 “`” 并敲回车]</h3><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c">```<span class="token comment">// 这里就可以开始输入你要的代码了</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">mian</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    print（“Hello<span class="token punctuation">,</span> world<span class="token operator">!</span>\n"）<span class="token punctuation">;</span>    retrun O<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>``` <span class="token comment">// (这三个"`"文本编辑器会帮你自动补全 一般不用手动输)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>(我之前都是用这个来展示各种语法的, 应该不用举例了吧)</p><p>要想显示行数的话, 一般要在 Typora 的设置里勾上这个显示行数的选项. </p><p>代码块里可以选择语言, 其会根据语言来自动高亮各个语句. 在选择语言后, <code>```</code> 会变为 <code>````</code> + <code>对应语言</code>.</p><h3 id="8-引用-“-gt-”-空格-前置"><a href="#8-引用-“-gt-”-空格-前置" class="headerlink" title="8. 引用 [“&gt;” + 空格 前置]"></a>8. 引用 [“&gt;” + 空格 前置]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">&gt; 24岁, 是学生.&gt; &gt; 学生特有的无处不在(恼)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>引用是可以嵌套的!</p><p>E.G. </p><blockquote><p>24岁, 是学生.</p><blockquote><p>学生特有的无处不在(恼)</p></blockquote></blockquote><h3 id="9-无序列表-“-“-或-“-”-空格-前置"><a href="#9-无序列表-“-“-或-“-”-空格-前置" class="headerlink" title="9. 无序列表 [“-“ 或  “+” + 空格 前置]"></a>9. 无序列表 [“-“ 或  “+” + 空格 前置]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">- 一颗是枣树 (我喜欢用这种)+ 另一颗还是枣树* (其实这种也可以, 不过由于在 Typora 中很难单个输入, 故不常用)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>三种前置符都可以, 敲回车会自动补全, 可在 Typora 设置中调整补全的符号, 敲回车后按下 <code>Tab</code> 会缩进一级. </p><p>E.G. </p><ul><li>一颗是枣树</li><li>另一颗还是枣树</li></ul><h3 id="10-有序列表-数字-“-”-空格-前置"><a href="#10-有序列表-数字-“-”-空格-前置" class="headerlink" title="10. 有序列表 [数字 + “.” + 空格 前置]"></a>10. 有序列表 [数字 + “.” + 空格 前置]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">我来这里就为了三件事:1. 公平2. 公平3. 还是tm的公平!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>敲回车会自动补全, 敲回车后按下 <code>Tab</code> 会缩进一级. </p><p>E.G. </p><p>我来这里就为了三件事:</p><ol><li><p>公平</p></li><li><p>公平</p></li><li><p>还是tm的公平!</p></li></ol><h3 id="11-上标-用-“-”-包围"><a href="#11-上标-用-“-”-包围" class="headerlink" title="11. *上标 [用 “^” 包围]"></a>11. *上标 [用 “^” 包围]</h3><p><strong>(注意: 此为扩展语法)</strong></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">C语言中int的上限是 2^31^ - 1 &#x3D; 2147483647<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>E.G. </p><p>C语言中 <code>int</code> 的上限是 2^31^ - 1 = 2147483647</p><h3 id="12-下标-用-“-”-包围"><a href="#12-下标-用-“-”-包围" class="headerlink" title="12. *下标 [用 “~” 包围]"></a>12. *下标 [用 “~” 包围]</h3><p><strong>(注意: 此为扩展语法)</strong></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">H~2~O 是剧毒的!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>E.G. </p><p>H<del>2</del>O 是剧毒的!</p><h3 id="13-注释-“-”-后置"><a href="#13-注释-“-”-后置" class="headerlink" title="13. *注释 [“[^]” 后置]"></a>13. *注释 [“[^]” 后置]</h3><p><strong>(注意: 此为扩展语法)</strong></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">&gt; 今日我们相聚于此, 是为了学习 Markdown 的使用, 它的教程对于全体「观众」而言, 值得足足两个硬币的支持鼓励!<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="沃兹·基·硕德 改编自「公鸡」普契涅拉.">[1]</span></a></sup>需要在文末写上注释对应的内容E.G. > 今日我们相聚于此, 是为了学习 Markdown 的使用, 它的教程对于全体「观众」而言, 值得足足两个硬币的支持鼓励!<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="沃兹·基·硕德 改编自「公鸡」普契涅拉.">[1]</span></a></sup>### 14. 链接 [常用 "[ ]" + "( )" 分别包围文本与链接]**(注意: 文内跳转为扩展用法)**<hexoPostRenderCodeBlock><pre class="line-numbers language-none"><code class="language-none">[来看看我贫瘠的仓库罢](https:&#x2F;&#x2F;github.com&#x2F;Sakiyary)[基础教程: 12. 下标](#12. 下标 [用 &quot;~&quot; 包围])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>支持网页链接与文内跳转, 按住 <code>Ctrl</code> 并 <code>单击鼠标左键</code> 即可跳转.</p><p>E.G. </p><p><a href="https://github.com/Sakiyary">来看看我贫瘠的仓库罢</a></p><p>[基础教程: 12. 下标](#12. 下标 [用 “~” 包围])</p><h3 id="15-任务列表-“-”-空格-前置"><a href="#15-任务列表-“-”-空格-前置" class="headerlink" title="15. 任务列表 [“- [ ]” + 空格 前置]"></a>15. 任务列表 [“- [ ]” + 空格 前置]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">TodoList:- [ ] 刷B站- [ ] 写代码- [x] 起床<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>用 <code>x</code> 代替 <code>[ ]</code> 中的空格来勾选任务列表. 在 Typora 中可以直接用鼠标左键单击勾选框.</p><p>E.G. TodoList:</p><ul><li><input disabled="" type="checkbox"> 刷B站</li><li><input disabled="" type="checkbox"> 写代码</li><li><input checked="" disabled="" type="checkbox"> 起床</li></ul><h3 id="16-表格-用-“-”-绘制表格边框"><a href="#16-表格-用-“-”-绘制表格边框" class="headerlink" title="16. 表格 [用 “|” 绘制表格边框]"></a>16. 表格 [用 “|” 绘制表格边框]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">| 学号 | 姓名  | 年龄 || :--- | :---: | ---: | (引号的位置代表着 左对齐, 居中, 右对齐)|114514|田所|24||1919810|浩三|25|<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>第一行为表头, 并由第二行分割线决定对齐方式与长度, 第三行及之后即表格数据</p><p>E.G. </p><table><thead><tr><th align="left">学号</th><th align="center">姓名</th><th align="right">年龄</th></tr></thead><tbody><tr><td align="left">114514</td><td align="center">田所</td><td align="right">24</td></tr><tr><td align="left">1919810</td><td align="center">浩三</td><td align="right">25</td></tr></tbody></table><h3 id="17-图片-直接拖进来或者复制粘贴"><a href="#17-图片-直接拖进来或者复制粘贴" class="headerlink" title="17. 图片 [直接拖进来或者复制粘贴]"></a>17. 图片 [直接拖进来或者复制粘贴]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">![图片](图片的位置)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>我还是会选择拖进来或者复制粘贴啦~ 在 Typora 的设置里也可以改图片的储存方式. </p><h3 id="18-分割线-按三个-“-”-或-“-“-或-“-”-并敲回车"><a href="#18-分割线-按三个-“-”-或-“-“-或-“-”-并敲回车" class="headerlink" title="18. 分割线 [按三个 “*” 或 “-“ 或 “_” 并敲回车]"></a>18. 分割线 [按三个 “*” 或 “-“ 或 “_” 并敲回车]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">***--- (我喜欢用这种)___&#x2F;&#x2F; (其实按三个及以上都可以)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>由于 <code>*</code> 与 <code>_</code> 均会自动补全, 所以我觉得 <code>-</code> 最为方便.</p><p>E.G. </p><hr><hr><hr><h3 id="19-Emoji表情-“-”-前置"><a href="#19-Emoji表情-“-”-前置" class="headerlink" title="19. Emoji表情 [“:” 前置]"></a>19. Emoji表情 [“:” 前置]</h3><p><strong>(注意: 英文输入为扩展语法)</strong></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">:sweat_smile: :drooling_face::clown_face:&#x2F;&#x2F; (敲回车或者鼠标点击, 后置的&quot;:&quot;一般不需要手动输)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>这个功能唯一的要求就是英语水平要高, 或者大概记得各个 Emoji 的英文名. </p><p>E.G. </p><p>:sweat_smile:<br>:drooling_face:<br>:clown_face:</p><p>对于其余普通的 Markdown 文本编辑器, 可以直接将 Emoji 表情复制进来, 这是直接<strong>硬编码</strong>的 (<del>刻进DNA里</del>)</p><p>E.G. </p><p>😅🤤🤡</p><p>用好这个功能可以让你的文本非常的可爱! <del>太抽象了</del></p><p>这里分享一个可以复制<a href="https://emojipedia.org/apple/">全Emoji的网站</a>, 非常好用! 我之前的C语言大作业也是从这里下载的资源! </p><h2 id="🔥-进阶教程"><a href="#🔥-进阶教程" class="headerlink" title="🔥 进阶教程"></a>🔥 进阶教程</h2><h3 id="1-目录-自动生成"><a href="#1-目录-自动生成" class="headerlink" title="1. 目录 [自动生成]"></a>1. 目录 [自动生成]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">[TOC] (此为 Typora 特有的, 如本文档开头)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>若使用 VS Code 搭配 Markdown All in One 扩展, 可在 VS Code 的<code>命令面板</code> (即 <a href="https://code.visualstudio.com/docs/getstarted/userinterface#_command-palette">VS Code Command Palette</a>) 输入 <code>Create Table of Contents</code> 自动生成目录, 且可在扩展设置中细调目录参数.</p><h3 id="2-内联-HTML-代码-用-“-lt-gt-lt-gt-”-包围"><a href="#2-内联-HTML-代码-用-“-lt-gt-lt-gt-”-包围" class="headerlink" title="2. 内联 HTML 代码 [用 “&lt;&gt; &lt;/&gt;” 包围]"></a>2. 内联 HTML 代码 [用 “&lt;&gt; &lt;/&gt;” 包围]</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">&lt;div style&#x3D;&quot;text-align:center&quot;&gt;  &lt;font style&#x3D;&quot;color:red&quot;&gt;我不会 HTML 呜呜呜... 浇浇我&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;center&gt;简单的文字居中也可以这样&lt;&#x2F;center&gt;&lt;u&gt;我差点忘了还有下划线这东西...&lt;&#x2F;u&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>只要你会写, 你完全可以把 Markdown 当作 <strong>HTML</strong> 来写.</p><p>同时, <code>.md</code> 文件可以直接导出成一个网页.</p><p>下划线可以选中想要下划的文字按下 <code>Ctrl</code> + <code>U</code>. </p><p>E.G. </p><div style="text-align:center">  <font style="color:red">我不会 HTML 呜呜呜... 浇浇我</font></div><center>简单的文字居中也可以这样</center><p><u>我差点忘了还有下划线这东西…</u></p><h3 id="3-内联-LaTeX-公式-用-“-”-包围"><a href="#3-内联-LaTeX-公式-用-“-”-包围" class="headerlink" title="3. 内联 $\LaTeX$ 公式 [用 “$” 包围]"></a>3. 内联 $\LaTeX$ 公式 [用 “$” 包围]</h3><p><strong>(注意: 部分编译器会不识别部分符号)</strong></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">$\LaTeX$ 是最好用的论文排版语言! 不信你看!$a^n+b^n&#x3D;c^n$$$%\usepackage&#123;unicode-math&#125;\displaystyle \ointctrclockwise\mathcal&#123;D&#125;[x(t)]\sqrt&#123;\frac&#123;\displaystyle3\uppi^2-\sum_&#123;q&#x3D;0&#125;^&#123;\infty&#125;(z+\hat L)^&#123;q&#125;\exp(\symrm&#123;i&#125;q^2 \hbar x)&#125;&#123;\displaystyle (\symsfup&#123;Tr&#125;\symbfcal&#123;A&#125;)\left(\symbf\Lambda_&#123;j_1j_2&#125;^&#123;i_1i_2&#125;\Gamma_&#123;i_1i_2&#125;^&#123;j_1j_2&#125;\hookrightarrow\vec D\cdot \symbf P \right)&#125;&#125;&#x3D;\underbrace&#123;\widetilde&#123;\left\langle \frac&#123;\notin \emptyset&#125;&#123;\varpi\alpha_&#123;k\uparrow&#125;&#125;\middle\vert\frac&#123;\partial_\mu T_&#123;\mu\nu&#125;&#125;&#123;2&#125;\right\rangle&#125;&#125;_&#123;\mathrm&#123;K&#125;_3\mathrm&#123;Fe&#125;(\mathrm&#123;CN&#125;)_6&#125; ,\forall z \in \mathbb&#123;R&#125;$$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>用 <code>$</code> 包围为单条公式, 按下两个 <code>$</code> 并敲回车即生成公式块.</p><p>E.G. </p><p>$\LaTeX$ 是最好用的论文排版语言! 不信你看!</p><p>$a^n+b^n=c^n$<br>$$<br>%\usepackage{unicode-math}<br>\displaystyle \ointctrclockwise\mathcal{D}[x(t)]<br>\sqrt{\frac{\displaystyle3\uppi^2-\sum_{q=0}^{\infty}(z+\hat L)^{q}<br>\exp(\symrm{i}q^2 \hbar x)}{\displaystyle (\symsfup{Tr}\symbfcal{A})<br>\left(\symbf\Lambda_{j_1j_2}^{i_1i_2}\Gamma_{i_1i_2}^{j_1j_2}<br>\hookrightarrow\vec D\cdot \symbf P \right)}}<br>=\underbrace{\widetilde{\left\langle \frac{\notin \emptyset}<br>{\varpi\alpha_{k\uparrow}}\middle\vert<br>\frac{\partial_\mu T_{\mu\nu}}{2}\right\rangle}}_{\mathrm{K}_3<br>\mathrm{Fe}(\mathrm{CN})_6} ,\forall z \in \mathbb{R}<br>$$</p><h3 id="4-网络图床"><a href="#4-网络图床" class="headerlink" title="4. *网络图床"></a>4. *网络图床</h3><p>(这是学长给我的网络图床教程, 我并未实践过…)</p><p>分享一个 Typora 搭配腾讯云COS/阿里云OSS图床的<a href="https://blog.csdn.net/guo_ridgepole/article/details/108257277">例子</a>. 新用户免费试用6个月, 另外还可选择七牛云或者路过图床.</p><h3 id="5-Typora-的常用快捷键"><a href="#5-Typora-的常用快捷键" class="headerlink" title="5. *Typora 的常用快捷键"></a>5. *Typora 的常用快捷键</h3><table><thead><tr><th align="center">按键</th><th align="center">效果</th><th align="center">按键</th><th align="center">效果</th></tr></thead><tbody><tr><td align="center"><code>Ctrl</code> + <code>D</code></td><td align="center">选中当前词</td><td align="center"><code>Ctrl</code> + <code>L</code></td><td align="center">选中当前句/行</td></tr><tr><td align="center"><code>Ctrl</code> + <code>E</code></td><td align="center">选中当前区块</td><td align="center"><code>Ctrl</code> + <code>F</code></td><td align="center">搜索当前选中</td></tr><tr><td align="center"><code>Ctrl</code> + <code>B</code></td><td align="center">加粗当前选中</td><td align="center"><code>Ctrl</code> + <code>H</code></td><td align="center">替换当前选中</td></tr><tr><td align="center"><code>Ctrl</code> + <code>I</code></td><td align="center">倾斜当前选中</td><td align="center"><code>Ctrl</code> + <code>U</code></td><td align="center">下划当前选中</td></tr><tr><td align="center"><code>Ctrl</code> + <code>K</code></td><td align="center">将当前选中生成链接</td><td align="center"><code>Ctrl</code> + <code>J</code></td><td align="center">滚动屏幕将选中滚至顶部</td></tr><tr><td align="center"><code>Ctrl</code> + <code>W</code></td><td align="center">关闭当前窗口</td><td align="center"><code>Ctrl</code> + <code>N</code></td><td align="center">打开新窗口</td></tr><tr><td align="center"><code>Ctrl</code> + <code>O</code></td><td align="center">打开文件</td><td align="center"><code>Ctrl</code> + <code>P</code></td><td align="center">搜索文件并打开</td></tr><tr><td align="center"><code>Ctrl</code> + <code>回车</code></td><td align="center">表格下方插入行</td><td align="center"><code>Ctrl</code> + <code>,</code></td><td align="center">打开偏好设置</td></tr><tr><td align="center"><code>Ctrl</code> + <code>.</code></td><td align="center">切换全角/半角标点</td><td align="center"><code>Ctrl</code> + <code>/</code></td><td align="center">切换正常/源代码视图</td></tr><tr><td align="center"><code>Ctrl</code> + <code>Shift</code> + <code>-</code></td><td align="center">缩小视图缩放</td><td align="center"><code>Ctrl</code> + <code>Shift</code> + <code>+</code></td><td align="center">放大视图缩放</td></tr></tbody></table><p>还有一些不常用的/三键的快捷键不在此列出.</p><h3 id="6-Typora-的主题样式与检查元素"><a href="#6-Typora-的主题样式与检查元素" class="headerlink" title="6. *Typora 的主题样式与检查元素"></a>6. *Typora 的主题样式与检查元素</h3><p>Markdown 在编译后约等于 HTML. 而 Typora 的正常视图就是编译后的 Markdown, 故Typora的主题样式本质就是 CSS 文件.</p><p>可以下载各种好看的主题给 Typora换上, 同时也可以自己调整对应的 CSS 文件, 或者自己手搓. </p><p>在 Typora 设置中开启 <code>调试模式</code> 后即可在正常视图右击打开 <code>检查元素</code>, 在其中就可以完全将 Markdown 文件当成 HTML 来编辑.</p><h2 id="💯-总结"><a href="#💯-总结" class="headerlink" title="💯 总结"></a>💯 总结</h2><p>至此, <strong>Markdown + Typora / VSCode</strong> 的手册教程也告一段落. </p><p>不知你看完这么长的教程/手册, 是否能体会到 Markdown 的精妙简洁之处呢? </p><p>其实 Markdown 只是标记语言的最开始, 我的感受是会了 Markdown 之后对于理解 HTML 也有帮助, 对于用 $\LaTeX$ 来写论文也有帮助. 标记语言正是为了摆脱 Word 那种虽然”所见即所得”, 但又过于花哨浮华, 很差的兼容性与闭源的编码的缺陷. 当你能掌握这样的”所写即所得”时, 你肯定会感受到用 Markdown 这类语言来处理文本的妙处!</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>沃兹·基·硕德 改编自「公鸡」普契涅拉.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></hexoPostRenderCodeBlock><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:1" class="footnote-text"><span>沃兹·基·硕德 改编自「公鸡」普契涅拉.<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>博客</tag>
      
      <tag>Markdown</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 负载均衡 | OpenFeign</title>
    <link href="/2022/07/19/SpringCloud%20%7C%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%20%7C%20OpenFeign/"/>
    <url>/2022/07/19/SpringCloud%20%7C%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%20%7C%20OpenFeign/</url>
    
    <content type="html"><![CDATA[<div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/67isds.png"/></div><br><h1 id="OpenFeign"><a href="#OpenFeign" class="headerlink" title="OpenFeign"></a><a href="https://spring.io/projects/spring-cloud-openfeign"><font color=black>OpenFeign</font></a></h1><p><font color=orange><b>@FeignClient</b></font></p><blockquote><p> Feign是一个声明式WebService客户端。使用Feign能让编写Web Service客户端更加简单。</p></blockquote><blockquote><p>它的使用方法是定义一个服务接口然后在上面添加注解。Feign也支持可拔插式的编码器和解码器。Spring Cloud对Feign进行了封装，使其支持了Spring MVC标准注解和HttpMessageConverters。 Feign可以与Eureka和Ribbon组合使用以支持负载均衡</p></blockquote><p>Feign 是一个声明式的 Web 服务客户端，让编写 Web 服务客户端变得非常容易，只需要创建一个接口并在接口上加上注释就可以了。</p><p><br><br></p><h2 id="Feign简介"><a href="#Feign简介" class="headerlink" title="Feign简介"></a>Feign简介</h2><p><font color=#2b61a7><b>Feign能干什么</b></font><br>Feign旨在使编写Java Http客户端变得更容易。<br>前面在使用Ribbon+ RestTemplate时，利用RestTemplate对http请求的封装处理，形成了一套模版化的调用方法。但是在实际开发中，由于对服务依赖的调用可能不止一处，往往</p><p>一个接口会被多处调用，所以通常都会针对每个微服务自行封装一些客户端类来包装这些依赖服务的调用。所以，Feign在此基础上做了进一步封装，由他来帮助我们定义和实现依赖服务接口的定义。在Feign的实现下我们只需创建一个接口并使用注解的方式来配置它(以前是Dao接口上面标注Mapper注解,现在是一个微服务接口上面标注Feign注解即可，即可完成对服务提供方的接口鄉定，简化了使用Spring cloud Ribbon时，自动封装服务调用客户端的开发量</p><p><font color=#2b61a7><b>Feign集成了Ribbon</b></font></p><p>利用Ribbon维护了Payment的服务列表信息，并日通过轮询实现了客户端的负载均衡。而与Ribbon不同的是，通过feign只需要定义服务绑定接口且以声明式的方法，优雅而简单的实现了服务调用。</p><table><thead><tr><th>Feign</th><th>OpenFeign</th></tr></thead><tbody><tr><td>Feign是Spring Cloud组件中的一个轻量级RESTful的HTTP服务客户端Feign内置了Ribbon，用来做客户端负载均衡，去调用服务注册中心的服务。Feign的使用方式是：使用Feign的注解定义接口，调用这个接口就可以调用服务注册中心的服务。</td><td>openFeign是Spring Cloud 在Feign的基础上支持了SpringMVc的注解，如@Reques Mapping等等。OpenFeign的@ FeignClient可以解析SpringMVC的@RequestMapping注解下的接口，并通过动态代理的方式产生实现类，实现类中做负载均衡并调用其他服务。</td></tr></tbody></table><br><br><h2 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a>相关配置</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-feign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><strong>接口</strong></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"CLOUD-PAYMENT-SERVICE"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PaymentFeignService</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/payment/get/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">getPaymentById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><strong>主启动</strong></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableFeignClients</span><span class="token comment">// 主启动类</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p><strong>Controller</strong></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderFeignController</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Resource</span>  <span class="token keyword">private</span> <span class="token class-name">PaymentFeignService</span> paymentFeignService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/payment/get/&#123;id&#125;"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">getPaymentById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> paymentFeignService<span class="token punctuation">.</span><span class="token function">getPaymentById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>先启动 Eureka 集群 7001/7002</p><p>在启动两个微服务 8001/8002</p><p>启动 OpenFeign</p><p><a href="http://localhost/consumer/payment/get/31">http://localhost/consumer/payment/get/31</a></p><p>Feign自带负载均衡配置项</p></blockquote><br><br><h2 id="Feign-超时控制"><a href="#Feign-超时控制" class="headerlink" title="Feign 超时控制"></a>Feign 超时控制</h2><p><strong>写在客户端</strong></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token comment">## 设置肺功能客户端超时时间（OpenFeign 默认支持 ribbon）</span><span class="token key atrule">ribbon</span><span class="token punctuation">:</span><span class="token comment">## 指的是建立连接所用的时间，适用于网络状况正常的情况下，两端连接所用的时间</span><span class="token key atrule">ReadTimeout</span><span class="token punctuation">:</span> <span class="token number">5000</span><span class="token comment">## 指的是建立连接后从服务器读取到可用资源所用的时间</span><span class="token key atrule">ConnectTimeout</span><span class="token punctuation">:</span> <span class="token number">5000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Feign-日志级别"><a href="#Feign-日志级别" class="headerlink" title="Feign 日志级别"></a>Feign 日志级别</h2><p><code>/config/FeignConfig</code></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">logging</span><span class="token punctuation">:</span><span class="token key atrule">level</span><span class="token punctuation">:</span><span class="token key atrule">com.xxx.xxx.service.PaymentFeignService</span><span class="token punctuation">:</span> debug<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">feign<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span>publicclass <span class="token class-name">FeignConfig</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Bean</span>  <span class="token class-name">Logger</span><span class="token punctuation">.</span>level <span class="token function">feignLoggerLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// 详细日志</span>    <span class="token keyword">return</span> <span class="token class-name">Logger<span class="token punctuation">.</span>Level</span><span class="token punctuation">.</span>FULL<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sprin gCloud | 服务调用 | Ribbon</title>
    <link href="/2022/07/18/SpringCloud%20%7C%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%20%7C%20Ribbon/"/>
    <url>/2022/07/18/SpringCloud%20%7C%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%20%7C%20Ribbon/</url>
    
    <content type="html"><![CDATA[<br><h1 id="Ribbon"><a href="#Ribbon" class="headerlink" title="Ribbon"></a>Ribbon</h1><p><strong><a href="https://github.com/Netflix/ribbon"><font color=#e50815>Netflix Ribbon</font></a></strong><br></p><div style="text-align:center"><img style="width:130px;border-radius:10px" src="https://files.catbox.moe/8iv9bi.png"/></div><br><div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/q188ly.png"/></div><p>Spring Cloud Ribbon是基于Netflix Ribbon实现的一套客户端 负载均衡的工具。</p><blockquote><p>简单的说，Ribbon是Netflix发布的开源项目，主要功能是提供客户端的软件负载均衡算法和服务调用。Ribbon客户端组件提供一系列完善的配置项如连接超时，重试等。简单的说，就是在配置文件中列出Load Balancer(简称LB）后面所有的机器，Ribbon会自动的帮助你基于某种规则 （如简单轮询，随机连接等） 去连接这些机器。我们很容易使用Ribbon实现自定义的负载均衡算法。</p></blockquote><p><strong><font color=#2b61a7>LB 负载均衡（Load Balance）是什么</font></strong></p><p>简单的说就是将用户的请求平摊的分配到多个服务上，从而达到系统的HA（高可用）。常见的负载均衡有软件Nginx， LVS，硬件F5等。</p><p><font color=#2b61a7><strong>Ribbon本地负载均衡客户端 VS Nginx服务端负载均衡区别</strong></font><br>Nginx是服务器负载均衡，客户端所有请求都会交给nginx，然后由nginx实现转发请求。即负载均衡是由服务端实现的。</p><p>Ribbon本地负载均衡，在调用微服务接口时候，会在注册中心上获取注册信息服务列表之后缓存到JVM本地，从而在本地实现RPC远程服务调用技术。</p><br><br><h2 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h2><p><font color=Green><strong>IRule 七大算法</strong></font>：根据特定算法从服务列表中选取一个要访问的服务</p><br><table><thead><tr><th align="left">接口名</th><th>作用</th></tr></thead><tbody><tr><td align="left">com.netflix.loadbalancer.RoundRobinRule</td><td>轮询</td></tr><tr><td align="left">com.netflix.loadbalancer.RandomRule</td><td>随机</td></tr><tr><td align="left">com.netflix.loadbalancer.RetryRule</td><td>先按照RoundRobinRule的策略获取服务，如果获取服务失败则在指定时间内会进行重</td></tr><tr><td align="left">WeightedResponseTimeRule</td><td>对RoundRobinRule的扩展，响应速度越快的实例选择权重越大，越容易被选择</td></tr><tr><td align="left">BestAvailableRule</td><td>会先过滤掉由于多次访问故障而处于断路器跳闸状态的服务，然后选择一个并发量最小的服务</td></tr><tr><td align="left">Availability FilteringRule</td><td>先过滤掉故障实例，再选择并发较小的实例</td></tr></tbody></table><br><p><strong><font color=#e50815>官方文档明确给出了警告：</font></strong><br>这个自定义配置类不能放在<font color=#beb500>@Componentscan</font>所扫描的当前包 下以及子包下，否则我们自定义的这个配蛋类就会被所有的Ribbon客户端所共享，达不到特殊化定制的目的了。</p><blockquote><p>在项目文件夹外创建一个新的文件夹，并</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySelfRule</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Bean</span>  <span class="token keyword">public</span> <span class="token class-name">IRule</span> <span class="token function">myRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// 定义为随机</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RandomRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>主启动类</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@RibbonClient</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"CLOUD-PAYMENT-SERVICE"</span><span class="token punctuation">,</span>configuration<span class="token operator">=</span><span class="token class-name">MySelfRule</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainApplication</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">MainApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br></p><h2 id="Ribbon-负载均衡算法"><a href="#Ribbon-负载均衡算法" class="headerlink" title="Ribbon 负载均衡算法"></a>Ribbon 负载均衡算法</h2><p><b><font color=#2b61a7>轮询算法</font></b>：rest 接口第几次请求数%服务器集群总数量=实际调用服务器位置下标，每次服务重启后 rest 接口计数从 1 开始。</p><h5 id="手写一个负载均衡算法"><a href="#手写一个负载均衡算法" class="headerlink" title="手写一个负载均衡算法"></a>手写一个负载均衡算法</h5><p><font size=2 color=darkgray>（原理+JUC（CAS+自旋锁的复习））</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LoadBalance</span><span class="token punctuation">&#123;</span>  <span class="token class-name">ServiceInstance</span> <span class="token function">instances</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">></span></span> serviceInstances<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><br><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyLB</span> <span class="token keyword">implements</span> <span class="token class-name">LoadBalance</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">AtomicInteger</span> atomicInteger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> current<span class="token punctuation">;</span>    <span class="token keyword">int</span> next<span class="token punctuation">;</span>    <span class="token keyword">do</span><span class="token punctuation">&#123;</span>      current <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>atomicInteger<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      next <span class="token operator">=</span> current <span class="token operator">>=</span> <span class="token number">2147483647</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> current <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>atomicInteger<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span>next<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"---next:"</span><span class="token punctuation">,</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> next<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token class-name">ServiceInstance</span> <span class="token function">instances</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">></span></span> serviceInstance<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> serviceInstance<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> serviceInstance<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// 2147483647</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p> 应用自己的</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span><span class="token punctuation">&#123;</span><span class="token annotation punctuation">@Resource</span><span class="token keyword">private</span> <span class="token class-name">LoadBalance</span> loadBalancer<span class="token punctuation">;</span>  <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/consumer/payment/lb"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPaymentLB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">ServiceInstance</span> instances <span class="token operator">=</span> discoveryCLient<span class="token punctuation">.</span><span class="token function">getInstances</span><span class="token punctuation">(</span><span class="token string">"CLOUD-PAYMENT-SERVICE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>instances <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> instances<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>      <span class="token class-name">ServiceInstances</span> serviceInstance <span class="token operator">=</span> loadBalancer<span class="token punctuation">.</span><span class="token function">instances</span><span class="token punctuation">(</span>instances<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token class-name">URI</span> uri <span class="token operator">=</span> seviceInstances<span class="token punctuation">.</span><span class="token function">getUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>uri<span class="token operator">+</span><span class="token string">"/payment/lb"</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 服务注册 | 总结</title>
    <link href="/2022/07/18/SpringCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%20%7C%20%E6%80%BB%E7%BB%93/"/>
    <url>/2022/07/18/SpringCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%20%7C%20%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<br><table border='0' cellpadding='0' cellspacing='0' width='825' style='border-collapse:  collapse;table-layout:fixed;width:100%'> <col width='131' style='mso-width-source:userset;width:98.25pt'> <col width='126' style='mso-width-source:userset;width:94.5pt'> <col width='145' style='mso-width-source:userset;width:108.75pt'> <col width='148' style='mso-width-source:userset;width:111pt'> <col width='202' style='mso-width-source:userset;width:151.5pt'> <col width='73' style='width:54.75pt'> <tr height='23' style='mso-height-source:userset;height:17.6pt' id='r0'><td height='21' class='x69' width='131' style='height:16.1pt;width:98.25pt;'>组件名</td><td class='x70' width='126' style='width:94.5pt;'>语言</td><td class='x70' width='145' style='width:108.75pt;'>服务健康检查</td><td class='x70' width='148' style='width:111pt;'>对外暴露接口</td><td class='x70' width='202' style='width:151.5pt;'>Spring Cloud 继承</td><td class='x73' width='73' style='width:54.75pt;'>CAP</td> </tr> <tr height='23' style='mso-height-source:userset;height:17.6pt' id='r1'><td height='21' class='x71' style='height:16.1pt;'>Eureka</td><td class='x72'>Java</td><td class='x72'>可配支持</td><td class='x72'>HTTP</td><td class='x72'>已集成</td><td class='x74'>AP</td> </tr> <tr height='23' style='mso-height-source:userset;height:17.6pt' id='r2'><td height='21' class='x71' style='height:16.1pt;'>Consul</td><td class='x72'>Go</td><td class='x72'>支持</td><td class='x72'>HTTP/DNS</td><td class='x72'>已集成</td><td class='x74'>CP</td> </tr> <tr height='23' style='mso-height-source:userset;height:17.6pt' id='r3'><td height='21' class='x71' style='height:16.1pt;'>Zookeeper</td><td class='x72'>Java</td><td class='x72'>支持</td><td class='x72'>客户端</td><td class='x72'>已集成</td><td class='x75'>CP</td> </tr><![if supportMisalignedColumns]> <tr height='0' style='display:none'>  <td width='131' style='width:98.25pt'></td>  <td width='126' style='width:94.5pt'></td>  <td width='145' style='width:108.75pt'></td>  <td width='148' style='width:111pt'></td>  <td width='202' style='width:151.5pt'></td>  <td width='73' style='width:54.75pt'></td> </tr> <![endif]></table><br><br><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%;border-radius:10px" src="https://files.catbox.moe/is21nr.png"  /><br><br><span style="color:darkgray">👆CAP 架构图</span></div><br><blockquote><p>一致性（C）：在<a href="https://baike.baidu.com/item/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/4905336">分布式系统</a>中的所有数据备份，在同一时刻是否同样的值。（等同于所有节点访问同一份最新的数据副本）</p><p>可用性（A）：保证每个请求不管成功或者失败都有响应。</p><p>分区容忍性（P）：系统中任意信息的丢失或失败不会影响系统的继续运作。 </p></blockquote>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 服务注册 | Consul</title>
    <link href="/2022/07/18/SpringCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%20%7C%20Zookeeper/"/>
    <url>/2022/07/18/SpringCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%20%7C%20Zookeeper/</url>
    
    <content type="html"><![CDATA[<br><h1 id="Consul"><a href="#Consul" class="headerlink" title="Consul"></a>Consul</h1><div><div style="width:100%;height:85px;background:#eef7fa;border-radius:10px;text-align:center;padding:22px 0px;"><div><a href="https://learn.hashicorp.com/consul" style="font-size:24px;margin-right:15px"><b>官网</b></a></div></div><div style="margin:5px 0;width:100%;height:85px;background:#eef7fa;border-radius:10px;text-align:center;padding:22px 0px;"><div><a href="https://www.springcloud.cc/spring-cloud-consul.html" style="font-size:24px;margin-right:15px"><b>中文网</b></a></div></div></div><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><strong><font color=orange>Go 语言</font>开发的</strong></p><ul><li>服务注册与发现</li><li>健康检查</li><li>KV 存储</li><li>多数据中心</li><li>可视化 Web 界面</li></ul><p><strong>xml.dependency</strong></p><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-stater-consul-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><br><p><strong>application.yml</strong></p><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> consul<span class="token punctuation">-</span>provider<span class="token punctuation">-</span>payment  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>  <span class="token key atrule">consul</span><span class="token punctuation">:</span>  <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost  <span class="token key atrule">prot</span><span class="token punctuation">:</span> <span class="token number">8500</span>  <span class="token key atrule">discovery</span><span class="token punctuation">:</span>  <span class="token key atrule">service-name</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span>spring.applicatioin.name<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 服务注册 | Zookeeper</title>
    <link href="/2022/07/18/SrpingCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%20%7C%20Zookeeper/"/>
    <url>/2022/07/18/SrpingCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%20%7C%20Zookeeper/</url>
    
    <content type="html"><![CDATA[<div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/1ajd1n.png"/></div><br><h1 id="Zookeeper"><a href="#Zookeeper" class="headerlink" title="Zookeeper"></a>Zookeeper</h1><br><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><ul><li>主启动</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableDiscoveryClient</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token comment">// 主启动</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Run</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">mian</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Run</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>pom.xml</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- pom.xml --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-stater-zookeeper-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excludsions</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>application.yml</li></ul><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span><span class="token key atrule">application</span><span class="token punctuation">:</span><span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>provider<span class="token punctuation">-</span>payment<span class="token key atrule">cloud</span><span class="token punctuation">:</span><span class="token key atrule">zookeeper</span><span class="token punctuation">:</span><span class="token key atrule">connect-string</span><span class="token punctuation">:</span> IP<span class="token punctuation">:</span>端口<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="报错-服务器与jar包版本不一致"><a href="#报错-服务器与jar包版本不一致" class="headerlink" title="报错 | 服务器与jar包版本不一致"></a>报错 | 服务器与jar包版本不一致</h2> <div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-stater-zookeeper-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excludsions</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.4.9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Zookeeper-服务器"><a href="#Zookeeper-服务器" class="headerlink" title="Zookeeper 服务器"></a>Zookeeper 服务器</h2><ul><li>临时节点</li><li>带序号的临时节点</li><li>持久节点</li><li>带序号的持久节点</li></ul><p>一定时间内如果存在则保留，否则就删除。</p><h4 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuraton</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContextConfig</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>  <span class="token annotation punctuation">@LoadBalanced</span>  <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">getRestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderZKController</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> INVOKE_URL<span class="token operator">=</span><span class="token string">"htt o://cloud-provider-payment"</span><span class="token punctuation">;</span>  <span class="token annotation punctuation">@Resource</span>  <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>      <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/consumer/payment/zk"</span><span class="token punctuation">)</span>  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>INVOKE_URL<span class="token operator">+</span><span class="token string">"/payment/zk"</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 服务注册 | Eureka</title>
    <link href="/2022/07/18/SrpingCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%20%7C%20Eureka/"/>
    <url>/2022/07/18/SrpingCloud%20%7C%20%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%20%7C%20Eureka/</url>
    
    <content type="html"><![CDATA[<div style="text-align:center"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/ey90qe.png"/></div><br><h1 id="Eureka"><a href="#Eureka" class="headerlink" title="Eureka"></a>Eureka</h1><br><blockquote><h3 id="Eureka-包括两个组件（C-S-架构-类似于服务器与客户端）"><a href="#Eureka-包括两个组件（C-S-架构-类似于服务器与客户端）" class="headerlink" title="Eureka 包括两个组件（C/S 架构 类似于服务器与客户端）"></a>Eureka 包括两个组件（C/S 架构 类似于服务器与客户端）</h3></blockquote><blockquote><p><strong>Eureka Server <font color=red>提供服务注册服务</font></strong><br>各个微服务节点通过配置启动后，会在Eureka Server中进行注册，这样Eureka Server中的服务注册表中将会存储所有可用服务节点的信息，服务节点的信息可以在界面中直观看到。</p></blockquote><blockquote><p><strong>Eureka Client <font color=red>通过注册中心进行访问</font></strong><br>是个Java客户端，用于简化 Eureka Server 的交互，客户端同时也具备个内置的、使用轮询(round-robin)负载算法的负载均衡器在应用启动后，将会向Eureka Server发送心跳(默认周期为30秒）。如果Eureka Server在多个心跳周期内没有接收到某个节点的心跳，Eureka Server将会从服务注册表中把这个服务节点移除（默认90秒）。</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-netflix-eureka-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-eureka-server --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-netflix-eureka-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- 图形监控https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-web  --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="单机部署-Eureka"><a href="#单机部署-Eureka" class="headerlink" title="单机部署 Eureka"></a>单机部署 Eureka</h2><p><strong>Eureka Server</strong></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableEurekaServer</span> <span class="token comment">// 设置为服务注册中心 EurekaServer</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CloudEurekaServer7001Application</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">CloudEurekaServer7001Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"启动成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">eureka</span><span class="token punctuation">:</span>  <span class="token key atrule">instance</span><span class="token punctuation">:</span>    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> localhost  <span class="token comment">#eureka服务端的实例名字</span>  <span class="token key atrule">client</span><span class="token punctuation">:</span>    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>    <span class="token comment">#表示不向注册中心注册自己</span>    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>   <span class="token comment">#表示自己就是注册中心，职责是维护服务实例，并不需要去检索服务</span>    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>      <span class="token comment">#设置与eureka server交互的地址查询服务和注册服务都需要依赖这个地址</span>      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//$<span class="token punctuation">&#123;</span>eureka.instance.hostname<span class="token punctuation">&#125;</span><span class="token punctuation">:</span>$<span class="token punctuation">&#123;</span>server.port<span class="token punctuation">&#125;</span>/eureka/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><strong>Eureka Client</strong></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CloudConsumerFeignHystrixOrder80Application</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">CloudConsumerFeignHystrixOrder80Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"启动成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">eureka</span><span class="token punctuation">:</span>  <span class="token key atrule">client</span><span class="token punctuation">:</span>    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#是否向注册中心注册自己</span>    <span class="token key atrule">fetchRegistry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#是否从注册中心抓取已有的注册信息 默认true，集群必须设置为true</span>    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>      <span class="token comment">#      设置与eureka server交互的地址查询服务和注册服务都需要依赖这个地址</span>      <span class="token comment">#      defaultZone: http://localhost:7001/eureka #单机版</span>      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka  <span class="token comment">#集群版</span>  <span class="token key atrule">instance</span><span class="token punctuation">:</span>    <span class="token key atrule">instance-id</span><span class="token punctuation">:</span> payment8001    <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token comment">#访问路径可以显示IP地址</span><span class="token comment">#    Eureka客户端向服务端发送心跳的时间间隔，单位为秒(默认是30秒)</span><span class="token comment">#    lease-renewal-interval-in-seconds: 1</span><span class="token comment">#    Eureka服务端在收到最后一次心跳后等待时间上限，单位为秒(默认是90秒)，超时将剔除服务</span><span class="token comment">#    lease-expiration-duration-in-seconds: 2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="多服务器"><a href="#多服务器" class="headerlink" title="多服务器"></a>多服务器</h3><p><strong>相互守望 互相注册</strong></p><br><br><h2 id="服务发现-Discovery"><a href="#服务发现-Discovery" class="headerlink" title="服务发现 Discovery"></a>服务发现 Discovery</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">discovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> serives <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> element <span class="token operator">:</span> services<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"****element:"</span><span class="token operator">+</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">></span></span> instances <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getInstances</span><span class="token punctuation">(</span><span class="token string">"CLOUD_PAYMENT_SERVICE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ServiceInstance</span> instance <span class="token operator">:</span> instances<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">getServiceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\t"</span><span class="token operator">+</span>instance<span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\t"</span><span class="token operator">+</span>instance<span class="token punctuation">.</span><span class="token function">getPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\t"</span><span class="token operator">+</span>instance<span class="token punctuation">.</span><span class="token function">getUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>discoveryClient<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableEurekaClient</span> <span class="token comment">// 启动服务发现</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Run</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Eureka-自我保护机制"><a href="#Eureka-自我保护机制" class="headerlink" title="Eureka 自我保护机制"></a>Eureka 自我保护机制</h2><blockquote><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3></blockquote><blockquote><p>（默认开启）保护模式主要用于一组客户端和Eureka Server之间存在网络分区场景下的保护，一旦进入保护模式，<font color=red><strong>Eureka Server将会尝试保护其服务注册表中的信息，不再删除服务注朋表中的数据，也就是不会注销任何微服务。</strong></font></p></blockquote><blockquote><p>某时刻某一个微服务不可用了，Eureka 不会立刻清理，依旧会对改为服务的信息进行保存。</p><p>属于 CAP 里面的 AP 分支。</p></blockquote><p>为了方式 EurekaClient 可以正常运行，但是与 EurekaServer 网络不同情况下，EurekaServer 不会立刻删除该服务。</p><p><font color=green>默认删除时间为 90 秒。</font></p><h3 id="如何关闭自我保护"><a href="#如何关闭自我保护" class="headerlink" title="如何关闭自我保护"></a>如何关闭自我保护</h3> <div class="code-wrapper"><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment"># 自我保护机制关闭</span><span class="token attr-name">eureka.server.enable-self-preservation</span><span class="token punctuation">=</span><span class="token attr-value">false</span><span class="token attr-name">eureka.server.eviction-interval-timer-in-ms</span><span class="token punctuation">=</span><span class="token attr-value">2000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment"># Eureka 客户端向服务端发送心跳的时间间隔，单位为秒（默认 30 秒）</span><span class="token attr-name">eureka.instance.lease-renewal-interval-in-seconds</span><span class="token punctuation">=</span><span class="token attr-value">1</span><span class="token comment"># Eureka 服务端在收到最后一次心跳后等待时间上线，单位为秒（默认 90 秒）超时则剔除服务</span><span class="token attr-name">eureka.instance.lease-expiration-duration-in-seconds</span><span class="token punctuation">=</span><span class="token attr-value">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>读书笔记 | 王小波 | 黄金时代</title>
    <link href="/2022/07/17/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%8E%8B%E5%B0%8F%E6%B3%A2-%E9%BB%84%E9%87%91%E6%97%B6%E4%BB%A3-1/"/>
    <url>/2022/07/17/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%8E%8B%E5%B0%8F%E6%B3%A2-%E9%BB%84%E9%87%91%E6%97%B6%E4%BB%A3-1/</url>
    
    <content type="html"><![CDATA[<div style="width:100%"><div style="border:1px solid #eae6e6;padding:40px 10px;border-radius:15px;width:50%;text-align:center;margin:0 26%"><img src="https://files.catbox.moe/u27hf7.png" style="width:80%;box-shadow:0 0 25px #050505;border-radius:15px"/></div><div><p><br><br><br></p><h2 id="对「王小波」的第一印象"><a href="#对「王小波」的第一印象" class="headerlink" title="对「王小波」的第一印象"></a>对「王小波」的第一印象</h2><p>​    我是十分喜欢余华的，我喜欢这种故事风格，尽管现在可能会被归为更加潮流的「BE」一词，但是我还是要说余华写的书是「余华风格」。</p><p>​    我不怎么书荒，因为我不怎么看书，我只看我喜欢的作者的书，但也会偶尔刷刷书圈，时长会有人提到一个叫「王小波」的作者，并且我知道他写过一本书叫《一只特立独行的猪》，我应该是没看过这本书的，但是看名字总让我不由得与《男生/女生日记》这一类书籍联系到一起（因为很小的时候在新华书店看到《女生日记》旁边放着一本《什么什么猪》的书），加上「王小波」三个字，总觉得很现代，而《黄金时代》偶尔也会被我错误理解成《小时代》…因此印象里王小波是一位年轻的作家，可能跟郭敬明比较像，也许写过几本都市言情，比较收割年轻少女粉这样的人。</p><p>​    直到前一段时间看完余大爷的《文城》，我书荒了，很突然的也很不经常出现了一次书荒，对余大爷又爱又恨，爱他的字，恨他为什么不多写一些。</p><p>​    终于今天跟朋友逛街的时候，去了一趟书店（我们三个大男人逛街实在无聊了，就去书店里吹空调了），朋友推荐我看一下《黄金时代》，既然无数人提到王小波，那么我也决定认识一下王小波。</p><p>​    用了一下午时间，看完了《黄金时代》，我看书极慢，一本书不会去读第二遍，但是精彩的部分我通常反复阅读，晦涩的部分也会反复推敲、琢磨，中间甚至用到了一次百度百科（因为某个词语涉及到了我的知识盲区，可以猜猜是哪个地方）读完之后便爱上了王小波。</p><h2 id="对「黄金时代」的印象"><a href="#对「黄金时代」的印象" class="headerlink" title="对「黄金时代」的印象"></a>对「黄金时代」的印象</h2><p>​    这是一本很温柔的书，对读者温柔，这并不是余华戏称的那种「因为识字少，所以我的文字很容易理解」的温柔，而是如沐春风般的阅读体验，王小波是造物主，他完美的创造了王二与陈清扬的命运，并且用文字表达了出来；他就像是将每一个文字都安排的恰到好处一般，让读者沉浸其中，几乎意识不到这是一本小说。</p><h2 id="对「黄金时代」的理解"><a href="#对「黄金时代」的理解" class="headerlink" title="对「黄金时代」的理解"></a>对「黄金时代」的理解</h2><p>​    时代背景下的王二与陈清扬二人的爱，愉快的爱，欢快的爱，陈清扬因为王二的一番说辞（在我看来像是骗术），便认可了王二伟大的友情，随后在王二 21 岁生日这一天，结束了王二的童子身。</p><p>​    从第一次夜间的山上，陈清扬是冷冰冰的，她双手枕着头，一声不吭的看着王二、到王二被寡妇锤，她哭肿了双眼跑下山，大喊着“你要是瘫了，我养你一辈子”、再到去山上的草屋看王二、再到两人一起逃、再回来、王二被调回城里做了老师，陈清扬做了院长、北京的旅馆再次敦『伟大的友情』。</p><p>​    与王二的初次，陈清扬是没有爱的，兴许她只是想用这种极端的方式去打破「破鞋」的谣言（通过让谣言变成事实来打破谣言），又或者她真的因为坐牢的丈夫而寂寞难耐，又或者因为她真的是为了敦“伟大的友情”，她定是不爱王二的，随着与王二的相处，她爱上了王二，文中对此有三处描述：</p><blockquote><ol><li>陈清扬在与王二「敦伟大友情」的时候，王二稳了她的脚心，那一刻她扭过头，乌黑的头发盖住了她的脸，王二拨开她头发，见她哭的不行，而她「担心自己会爱别人，担心自己会爱上王二」</li><li>背景的饭店里，陈清扬正在熟睡，王二轻轻解开她的内衣，她醒了，以为王二要做什么，谁知道王二只是吻了她的肚脐，那一刻她吓得不行，因为她「几乎就爱上他了」。</li><li>北京的火车站，陈清扬如实的告诉了王二那「最后一份材料」中的内容，那就是因为在爬山时，王二抱着她拍了两下她的屁股，让她彻底爱上了王二，在那之前王二玷污的是她的身体，从那一刻开始王二玷污了她的心。</li></ol></blockquote><p>​    王小波用了 10 年时间，写了这本书，但是由于时代背景，这本书本应该被改名为「王二的风流往事」，且归为小黄书的那一类，但是王小波不同意，他很生气。</p><p>​    这本书最能表现的是王小波对于「性与爱」的肯定。</p><p>​    陈清扬是矛盾的，当她第一次跑到山上的茅屋去看王二，却看到他一丝不挂露着他的「小和尚」，她生气了，她厌恶，她的白大褂底下一丝不挂的来到这里，却看到这么丑陋的家伙，她是讨厌这个东西的，因为在与丈夫住在一起的每一个夜晚，都有一个这样的东西进入自己的身体。</p><p>​    陈清扬并不喜欢自己的丈夫，她对与丈夫之间的「性」无感，甚至会心生厌恶，由此带来的是对「小和尚」的反感；但是她却能接收王二，爱上王二，她与王二的相处方式令人感到轻松预约，两个人无时无刻不在「敦友谊」，在后山、在茅屋、在树下、在河边、在王二快被冻死的夜里、在刘大爹的家中….她享受这种过程，她会在每次“出公差（被批斗为破鞋）”结束的时候迫不及待的敦友谊、会在王二快冻死时为王二暖身子而敦友谊。</p><hr><p>​    社里的女人们喜欢称呼不是破鞋的人为破鞋，又不喜欢叫真的破鞋为破鞋，因此人们总说陈清扬是破鞋，陈清扬与王二搞破鞋后，他们又不说了，她们知道发生了什么，而陈清扬会有此行为与“她们（社里的女人们）”脱不开关系。</p><p>​    陈清扬的态度一直是很坚决的，她自己没有罪孽，这也是王小波想表达的意思。在丈夫入狱时，她坚守住了自己的贞洁，成为了“好女人”（但是却被人戳脊梁骨叫破鞋），与王二的关系，更像是共患难的夫妻（至少在王二回北京之前是这样），两个人一起面对困难，一起面对人设局，一起逃，她会为王二买猎枪而担心（王二只是想打个鸭子罢了），会因为王二有可能瘫痪而大哭。</p><p>​    在王二被锤了腰的时候，陈清扬的哭是大胆的，她没有站在人群中假装不在乎，也没有仅仅作为医生为王二治病，她的哭，让人们知道了她真的是「破鞋」，她承认了与王二的关系，相比于自己是不是破鞋，她更关心的是王二的身体。</p><hr><p>​    陈清扬是没有罪孽的，王小波借陈清扬的嘴说出了他想说的话，在遇到王二之前，她从未喜欢过性，遇到王二之后，她真的很喜欢这种感觉。</p><hr><p>​    敦友谊，友谊到底是什么，文中多次提到了陈清扬的孤独，「在山川河流之间，如果没有这个人（王二）存在，那她该是多么孤独寂寞啊。」</p><p>​    对于陈清扬来说，王二是她的朋友，是寂寞是的消遣，是青春时期的疯狂，是黄金时代的玩伴。</p><p>​    两个人之间的性，仿佛很纯粹、很干净、很单调但是很浪漫。</p><p>​    在陈清扬到北京之后，两个人又见面了，陈清扬带着金丝框眼镜，穿着薄裙子，像是公司骨干，但是王二还是那副流氓相，就像是陈清扬说的「他变不好了」。</p><p>​    黄金时代是人一生最美好的时间段，在这个美好的时间段中，两个人互相相遇，最后做了一系列疯狂的不被时代背景接收的行为。</p><p>​    </p><hr><p>​    知乎又有种解读说：我们每个人都是时代的王二，只不过大多数都没有遇到陈清扬，而是：</p><blockquote><p>那一天我二十一岁，在我一生的黄金时代。我有好多奢望。我想爱，想吃，还想在一瞬问变成天上半明半暗的云。后来我才知道，生活就是个缓慢受锤的过程，人一天天老下去，奢望也一天天消失，最后变得像挨了锤的牛一样。可是我过二十一岁生日时没有预见到这一点。我觉得自己会永远生猛下去，什么也锤不了我。</p></blockquote><p>​    </p>]]></content>
    
    
    <categories>
      
      <category>读书笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书笔记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>博客 | 测试 Hexo-Fluid-Netlify 的后台编辑功能</title>
    <link href="/2022/07/16/%E5%8D%9A%E5%AE%A2-%E6%B5%8B%E8%AF%95-hexo-fluid-netlify-%E7%9A%84%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%8A%9F%E8%83%BD/"/>
    <url>/2022/07/16/%E5%8D%9A%E5%AE%A2-%E6%B5%8B%E8%AF%95-hexo-fluid-netlify-%E7%9A%84%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%8A%9F%E8%83%BD/</url>
    
    <content type="html"><![CDATA[<div style="background:#dfdfe3;width:100%;height:50px;border-radius:15px;text-align:center"><div style="margin-top:5px;padding:13px"><span><b>这是一段HTML</b></span></div></div><h2 id="这是一个标题"><a href="#这是一个标题" class="headerlink" title="这是一个标题"></a>这是一个标题</h2><ul><li>这是一个小标</li></ul><h2 id="表格："><a href="#表格：" class="headerlink" title="表格："></a>表格：</h2><table><thead><tr><th>表头</th><th>表头</th></tr></thead><tbody><tr><td>单元格</td><td>单元格</td></tr><tr><td>单元格</td><td>单元格</td></tr></tbody></table><p>表格有问题</p><blockquote><p>123<br>1212343</p></blockquote><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/usyuct.png"  /><br><br><span style="color:darkgray">👆博客截图</span></div><br>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>博客</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>中间件 | FastDFS</title>
    <link href="/2022/07/15/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6%20%7C%20FastDFS/"/>
    <url>/2022/07/15/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6%20%7C%20FastDFS/</url>
    
    <content type="html"><![CDATA[<h1 id="分布式文件系统-FastDFS"><a href="#分布式文件系统-FastDFS" class="headerlink" title="分布式文件系统 FastDFS"></a>分布式文件系统 FastDFS</h1><br><div style="width:100%;height:85px;background:#eef7fa;border-radius:10px;text-align:center;padding:22px 0px;"><div><img style="width:25px;border-radius:5px;margin:0 10px  9px 0" src="https://files.catbox.moe/2u957r.png"/><a href="https://github.com/happyfish100/fastdfs" style="font-size:24px;margin-right:15px"><b>Github</b></a></div></div><br><h2 id="1-分布式文件系统应用场景"><a href="#1-分布式文件系统应用场景" class="headerlink" title="1. 分布式文件系统应用场景"></a>1. 分布式文件系统应用场景</h2><p>互联网海量非结构化数据的存储需求</p><ul><li>电商网站：海量商品图片</li><li>视频网站：海量视频文件</li><li>网盘：海量文件</li><li>社交网站：海量图片</li></ul><p><br><br></p><h2 id="2-FastDFS-介绍"><a href="#2-FastDFS-介绍" class="headerlink" title="2.FastDFS 介绍"></a>2.FastDFS 介绍</h2><h3 id="2-1-简介"><a href="#2-1-简介" class="headerlink" title="2.1 简介"></a>2.1 简介</h3><p>​    FastDFS是一个开源的高性能分布式文件系统 (DFS）。它的主要功能包括：文件存储，文件同步和文件访问，以及高容量和负载平衡。主要解决了海量数据存储问题，特别适合以中小文件（建议范国：4KB &lt; file_size&lt;500MB） 为载体的在线服务。<br>​    FastDFS设计是用来存储小文件的，过大的文件处理方案是拆分为小文件，可跟踪小文件的上传情况。如果应用场景都是处理大文件，可能选择其他分布式文件系统方案会更合适。</p><br><h3 id="2-2-特性"><a href="#2-2-特性" class="headerlink" title="2.2 特性"></a>2.2 特性</h3><p>FastDFS为互联网量身定制，充分考虑了冗余备份、负载构衡、线性扩容等机制，并注重高可用、高性能等指标，使用FastDFS很容易搭<br>建一套高性能的文件服务器集群提供文件上传、下载等服务。<br><strong>优点：</strong></p><ul><li><p>文件不分块存储，文件和系统中的文件对应。</p></li><li><p>对文件内容做hash处理，避免出现重复文件，节约磁盘空间。</p></li><li><p>下载文件支持HTTP协议，可基于内置WebServer或外部Web Server。</p></li><li><p>支持在线扩容，动态添加卷。</p></li><li><p>支持文件冗余备份和负载均衡。</p></li><li><p>存储服务器上可以保存文件属性 (meta-data)v2.0网络通信采用ibevent，支持大并发访问，整体性能更好。</p></li></ul><p><strong>缺点</strong></p><ul><li>直接按文件存储，可直接查看文件内容，缺乏文件安全性。</li><li>数据同步无校验，存在静默1口问题，降低系统可用性。</li><li>单线程数据同步，仅适合存储小文件 （4KB到500MB之间）。</li><li>备份数根据存储分卷（分组）决定，缺乏文件备份数设置灵活性。</li><li>单个挂载点异常会导致整个存储节点下线。</li><li>缺乏多机房容灾支持。</li><li>静态的负载均衡机制。</li></ul><p>优点与缺点并存，但针对中小型系统已经完全足够使用了。</p><br><h3 id="2-3-角色"><a href="#2-3-角色" class="headerlink" title="2.3 角色"></a>2.3 角色</h3><ul><li>Tracker server：跟踪服务器，主要做调度工作，起到均衡的作用;负责管理所有的storageserver和 group，每个storage 在启动后会连接 Tracker，告知自己所属 group 等信息，并保持周期性心跳。</li><li>storage server：存储服务器，主要提供容量和备份服务；以group 为单位，每个group内可以有多台 storage server, 数据互为备份。</li><li>Client：客户端，上传下载数据的服务器，也就是我们自己的项目所部署在的服务器。</li></ul><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/quiwiq.png"  /><br><br><span style="color:darkgray">👆FastDFS 架构图</span></div><br>]]></content>
    
    
    <categories>
      
      <category>中间件</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>中间件</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java | 刷题 |</title>
    <link href="/2022/07/13/Java%20%7C%20%E5%88%B7%E9%A2%98/J%20%7C%20/"/>
    <url>/2022/07/13/Java%20%7C%20%E5%88%B7%E9%A2%98/J%20%7C%20/</url>
    
    <content type="html"><![CDATA[<h2 id="Java-刷题"><a href="#Java-刷题" class="headerlink" title="Java | 刷题 |"></a>Java | 刷题 |</h2><hr>]]></content>
    
    
    <categories>
      
      <category>Java | 刷题</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java | 刷题</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java | 刷题 | 接口</title>
    <link href="/2022/07/13/Java%20%7C%20%E5%88%B7%E9%A2%98/J%20%7C%20%E6%8E%A5%E5%8F%A3/"/>
    <url>/2022/07/13/Java%20%7C%20%E5%88%B7%E9%A2%98/J%20%7C%20%E6%8E%A5%E5%8F%A3/</url>
    
    <content type="html"><![CDATA[<h2 id="Java-刷题-接口"><a href="#Java-刷题-接口" class="headerlink" title="Java | 刷题 | 接口"></a>Java | 刷题 | 接口</h2><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">interface</span> <span class="token class-name">Action</span><span class="token punctuation">&#123;</span>      <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Hero</span> <span class="token keyword">implements</span> <span class="token class-name">Action</span><span class="token punctuation">&#123;</span>  <span class="token comment">//……  &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p><strong>接口方法默认是public abstract的，且实现该接口的类中对应的方法的可见性不能小于接口方法的可见性。</strong></p>]]></content>
    
    
    <categories>
      
      <category>Java | 刷题</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java | 刷题</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQL | 刷题笔记</title>
    <link href="/2022/07/13/MySQL/MySQL%20%7C%20%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/07/13/MySQL/MySQL%20%7C%20%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p><br><br><br></p><h2 id="MySQL-（多个）条件判断-OR"><a href="#MySQL-（多个）条件判断-OR" class="headerlink" title="MySQL | （多个）条件判断 | OR"></a>MySQL | （多个）条件判断 | OR</h2><hr><br><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p><strong>OR</strong></p><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">SELECT &#96;device_id&#96;,&#96;gender&#96;,&#96;age&#96;,&#96;university&#96;,&#96;gpa&#96; FROM user_profileWHERE &#96;university&#96;&#x3D;&#39;北京大学&#39; OR &#96;university&#96;&#x3D;&#39;复旦大学&#39; OR &#96;university&#96;&#x3D;&#39;山东大学&#39; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><br><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p><strong>IN</strong></p><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">SELECT device_id,gender,age,university,gpaFROM user_profileWHERE university IN (&quot;北京大学&quot;,&quot;复旦大学&quot;,&quot;山东大学&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><br><h3 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h3><p><strong>FIND_IN_SET</strong></p><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">select device_id,gender,age,university,gpafrom user_profilewhere find_in_set(university,&#39;北京大学,复旦大学,山东大学&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p><br><br><br></p><h2 id="MySQL-去重"><a href="#MySQL-去重" class="headerlink" title="MySQL | 去重"></a>MySQL | 去重</h2><hr><br><h3 id="方法一-1"><a href="#方法一-1" class="headerlink" title="方法一"></a>方法一</h3><p><strong>DISTINCT</strong></p><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">SELECT DISTINCT university from user_profile;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br><h3 id="方法二-1"><a href="#方法二-1" class="headerlink" title="方法二"></a>方法二</h3><p><strong>GROUP BY</strong></p><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">SELECT university from user_profile GROUP BY university;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><br><br><br></p><h2 id="MySQL-通配符"><a href="#MySQL-通配符" class="headerlink" title="MySQL | 通配符"></a>MySQL | 通配符</h2><br><h3 id="匹配任意一个字符"><a href="#匹配任意一个字符" class="headerlink" title="匹配任意一个字符 | _"></a>匹配任意一个字符 | _</h3><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">SELECT * FROM 学生表 WHERE name LIKE &#39;张__&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>查询结果：</p><p>✅张三三</p><p>❌张三</p><p>❌张三四五</p><br><h3 id="匹配0个或多个字符"><a href="#匹配0个或多个字符" class="headerlink" title="匹配0个或多个字符 | %"></a>匹配0个或多个字符 | %</h3><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">SELECT * FROM 学生表 WHERE 姓名 LIKE &#39;张%&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>✅张三三</p><p>✅张三</p><p>✅张三四五</p><br><h3 id="匹配-中的任意一个字符-若要比较的字符是连续的，则可以用连字符“-”表-达"><a href="#匹配-中的任意一个字符-若要比较的字符是连续的，则可以用连字符“-”表-达" class="headerlink" title="匹配[ ]中的任意一个字符(若要比较的字符是连续的，则可以用连字符“-”表 达 )"></a>匹配[ ]中的任意一个字符(若要比较的字符是连续的，则可以用连字符“-”表 达 )</h3><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">SELECT * FROM 学生表 WHERE 姓名 LIKE &#39;[张李刘]%’<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>//查询学生表中姓‘张’、姓‘李’和姓‘刘’的学生的情况。</p><p>✅张三三</p><p>✅李四</p><p>✅刘三四五</p><p>❌王六</p><br><br><h3 id="不匹配任何一个"><a href="#不匹配任何一个" class="headerlink" title="不匹配任何一个 | [^]"></a>不匹配任何一个 | [^]</h3><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">SELECT * FROM 学生表 WHERE 学号 LIKE &#39;[^张李刘]%&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>❌张三三</p><p>❌李四</p><p>❌刘三四五</p><p>✅王六</p><p><br><br><br></p><h2 id="MySQL-排序"><a href="#MySQL-排序" class="headerlink" title="MySQL | 排序"></a>MySQL | 排序</h2><hr><br><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">select ename,sal from emp order by sal desc; 手动指定按照薪水由大到小排序（降序关键字desc）  select ename,sal from emp order by sal asc; 手动指定按照薪水由小到大排序（升序关键字 asc） PS：此处desc是descend的缩写， 用法：select * from 表 order by 字段 desc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><h3 id="补充-查看表结构"><a href="#补充-查看表结构" class="headerlink" title="补充 | 查看表结构"></a>补充 | 查看表结构</h3><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">desc table_name； PS：此处desc是describe的缩写，用法： desc 表名&#x2F;查询语句 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><br><h3 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h3><p>现根据gpa排序，后根据age降序</p><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">select device_id, gpa, age from user_profileorder by gpa asc, age desc;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><br><br><br><h2 id="过滤空值的三种方法："><a href="#过滤空值的三种方法：" class="headerlink" title="过滤空值的三种方法："></a>过滤空值的三种方法：</h2><ul><li><p>WHERE 列名 is not null</p></li><li><p>WHERE 列名 != ‘null’</p></li><li><p>WHERE 列名 &lt;&gt; ‘null’</p></li></ul><br><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql"># NOT NULLSELECT device_id,gender,age,university FROM user_profile where age is not NULL  # 正则SELECT device_id,gender,age,university FROM user_profile where age &lt;&gt;&#39;null&#39; # 比较SELECT device_id,gender,age,university FROM user_profile where age !&#x3D;&#39;null&#39; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>刷题</tag>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 热部署</title>
    <link href="/2022/07/12/SrpingCloud%20%7C%20%E7%83%AD%E9%83%A8%E7%BD%B2/"/>
    <url>/2022/07/12/SrpingCloud%20%7C%20%E7%83%AD%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<br><h2 id="Springboot-热部署"><a href="#Springboot-热部署" class="headerlink" title="Springboot 热部署"></a>Springboot 热部署</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fork</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fork</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>addResources</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>addResources</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><code>Setting-build-Compiler</code></p><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/zz67fs.png"  /><br><br><span style="color:darkgray">👆Setting-build-Compiler</span></div><br>]]></content>
    
    
    <categories>
      
      <category>SpringBoot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【SpringCloud】 入门笔记 | 02 | 支付模块</title>
    <link href="/2022/07/10/SpringCloud%20%7C%2002%20%7C%20%E6%94%AF%E4%BB%98%E6%A8%A1%E5%9D%97/"/>
    <url>/2022/07/10/SpringCloud%20%7C%2002%20%7C%20%E6%94%AF%E4%BB%98%E6%A8%A1%E5%9D%97/</url>
    
    <content type="html"><![CDATA[<br><h1 id="【SpringCloud】-入门笔记-02-支付模块"><a href="#【SpringCloud】-入门笔记-02-支付模块" class="headerlink" title="【SpringCloud】 入门笔记 | 02 | 支付模块"></a>【SpringCloud】 入门笔记 | 02 | 支付模块</h1><p><br><br>      </p><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><ol><li> New Maven Project</li><li>聚合总父工程名字</li><li>Maven 选版本</li><li>工程名字</li><li>字符编码</li><li>注解生效激活</li><li>Java 编译版本选择</li><li>File Type 过滤</li></ol><p><br><br></p><h2 id="创建微服务模块"><a href="#创建微服务模块" class="headerlink" title="创建微服务模块"></a>创建微服务模块</h2><ol><li>建 module</li><li>改 POM</li><li>写 YML</li><li>主启动</li><li>业务类</li></ol><h3 id="Maven-pom-xml"><a href="#Maven-pom-xml" class="headerlink" title="Maven | pom.xml"></a>Maven | pom.xml</h3><ul><li><strong>dependencyManagement：</strong>用来做依赖管理，一般最顶层父 POM 才会有 ；<font color=red><strong>只声明依赖，不实现引入。</strong></font></li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- 用来做依赖管理，一般最顶层父 POM 才会有 --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font size=2 color=darkgray>如果有多个子项目都引用同一个依赖，则可以避免在每个使用的子项目中都声明一个版本号，这样党向省级或者切换到另一个版本时，只需要在顶层父容器里面进行更新，而不需要一个一个修改子项目；另外如果某个子项目需要另外的一个版本，只要声明 version 即可。</font></p><br><br><h3 id="项目内容"><a href="#项目内容" class="headerlink" title="项目内容"></a>项目内容</h3><ul><li>Maven | pom.xml</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>  <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.jim<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>com.jim.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">></span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>Maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!-- 统一管理jar包版本 --></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.build.sourceEncoding</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.build.sourceEncoding</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">></span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>junit.version</span><span class="token punctuation">></span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>junit.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log4j.version</span><span class="token punctuation">></span></span>1.2.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log4j.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>lombok.version</span><span class="token punctuation">></span></span>1.16.18<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>lombok.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mysql.version</span><span class="token punctuation">></span></span>5.1.47<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mysql.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>druid.version</span><span class="token punctuation">></span></span>1.1.16<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>druid.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mybatis.spring.boot.version</span><span class="token punctuation">></span></span>1.3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mybatis.spring.boot.version</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!-- 1、只是声明依赖，并不实际引入，子项目按需声明使用的依赖 --></span>  <span class="token comment">&lt;!-- 2、子项目可以继承父项目的 version 和 scope --></span>  <span class="token comment">&lt;!-- 3、子项目若指定了 version 和 scope，以子项目为准 --></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>      <span class="token comment">&lt;!--spring boot 2.2.2--></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.2.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">></span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>      <span class="token comment">&lt;!--spring cloud Hoxton.SR1--></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>Hoxton.SR1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">></span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>      <span class="token comment">&lt;!--spring cloud alibaba 2.1.0.RELEASE--></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.1.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">></span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;mysql.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;druid.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;mybatis.spring.boot.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;junit.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;log4j.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;lombok.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fork</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fork</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>addResources</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>addResources</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>数据库 | MySQL</li></ul><div class="code-wrapper"><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">CREATE TABLE &#96;payment&#96;(  &#96;id&#96; bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;ID&#39;,  &#96;serial&#96; varchar(200) DEFAULT &#39;&#39;,  PRIMARY KEY(&#96;id&#96;))ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Maven】跳过测试的三种方法</title>
    <link href="/2022/07/08/Maven/%E3%80%90Maven%E3%80%91%E8%B7%B3%E8%BF%87%E6%B5%8B%E8%AF%95%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/"/>
    <url>/2022/07/08/Maven/%E3%80%90Maven%E3%80%91%E8%B7%B3%E8%BF%87%E6%B5%8B%E8%AF%95%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="【Maven】跳过测试的三种方法"><a href="#【Maven】跳过测试的三种方法" class="headerlink" title="【Maven】跳过测试的三种方法"></a>【Maven】跳过测试的三种方法</h1><p>使用Maven打包的时候，可能会因为单元测试打包失败，这时候就需要跳过单元测试。</p><br><br><h2 id="命令行方式跳过测试"><a href="#命令行方式跳过测试" class="headerlink" title="命令行方式跳过测试"></a>命令行方式跳过测试</h2><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">mvn clean install -DskipTestsmvn clean install -Dmaven.test.skip&#x3D;true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><ul><li>DskipTests，不执行<a href="https://so.csdn.net/so/search?q=%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B&spm=1001.2101.3001.7020">测试用例</a>，但编译测试用例类生成相应的class文件至target/test-classes下</li><li>Dmaven.test.skip=true，不执行测试用例，也不编译测试用例类</li></ul><p>使用maven.test.skip，不但跳过单元测试的运行，也跳过测试代码的编译;</p><p>使用 mvn package -DskipTests 跳过单元测试，但是会继续编译。</p><br><br><h2 id="二、pom-xml中配置跳过测试"><a href="#二、pom-xml中配置跳过测试" class="headerlink" title="二、pom.xml中配置跳过测试"></a>二、pom.xml中配置跳过测试</h2><p>可以在pom.xml中添加如下配置来跳过测试：</p><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- maven 打包时跳过测试 --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-surefire-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>skip</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>skip</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><h2 id="三、Idea中配置跳过测试"><a href="#三、Idea中配置跳过测试" class="headerlink" title="三、Idea中配置跳过测试"></a>三、Idea中配置跳过测试</h2><p>1、直接配置</p><p>Maven命令栏的工具栏有下图中的图标，这个图标就是 Skip Tests。点击选中，再用LifeStyle中的打包就会跳过测试.</p><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/ite1px.png"  /></div><p>2、更改Maven配置</p><p>打开配置，找到Maven–&gt;Runner，在VM option中添加 -Dmaven.test.skip=true</p><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/x2xmli.png"  /></div><br>]]></content>
    
    
    <categories>
      
      <category>Maven</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Maven</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【博客】写作代码（图片等）</title>
    <link href="/2022/07/08/%E3%80%90%E5%8D%9A%E5%AE%A2%E3%80%91%E7%9B%B8%E5%85%B3%E5%86%99%E4%BD%9C%E4%BB%A3%E7%A0%81/"/>
    <url>/2022/07/08/%E3%80%90%E5%8D%9A%E5%AE%A2%E3%80%91%E7%9B%B8%E5%85%B3%E5%86%99%E4%BD%9C%E4%BB%A3%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<h2 id="写作标签（图片等）"><a href="#写作标签（图片等）" class="headerlink" title="写作标签（图片等）"></a>写作标签（图片等）</h2><hr><p><br><br><br></p><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">text-align</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span>20px 5px<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span>1px solid #eae6e6<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>15px</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>80%</span><span class="token punctuation">"</span></span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://files.catbox.moe/rdo43m.png<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span>darkgray</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>👆Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/rdo43m.png"  /><br><br><span style="color:darkgray">👆Title</span></div><br><br><br><br><div style="width:100%;height:85px;background:#eef7fa;border-radius:10px;text-align:center;padding:22px 0px;"><div><img style="width:25px;border-radius:5px;margin:0 10px  9px 0" src="https://files.catbox.moe/2u957r.png"/><a href="https://github.com/happyfish100/fastdfs" style="font-size:24px;margin-right:15px"><b>Github</b></a></div></div><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>85px<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span>#eef7fa<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>10px<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span>22px 0px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>25px<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>5px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span>0 10px  9px 0</span><span class="token punctuation">"</span></span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://files.catbox.moe/2u957r.png<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://github.com/happyfish100/fastdfs<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">font-size</span><span class="token punctuation">:</span>24px<span class="token punctuation">;</span><span class="token property">margin-right</span><span class="token punctuation">:</span>15px</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">></span></span>Github<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>博客</tag>
      
      <tag>写作</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud | 入门笔记 | 01 | 版本选择</title>
    <link href="/2022/07/06/SpringCloud%20%7C%2001%20%7C%20%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E/"/>
    <url>/2022/07/06/SpringCloud%20%7C%2001%20%7C%20%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E/</url>
    
    <content type="html"><![CDATA[<br><h1 id="【SpringCloud】-入门笔记-01-版本选择"><a href="#【SpringCloud】-入门笔记-01-版本选择" class="headerlink" title="【SpringCloud】 入门笔记 | 01 | 版本选择"></a>【SpringCloud】 入门笔记 | 01 | 版本选择</h1><p><br><br></p><h2 id="版本关系"><a href="#版本关系" class="headerlink" title="版本关系"></a>版本关系</h2><ul><li><p>SpringCloud 是字母版本 如：A 版 B 版 C 版….H 版，采用名称而非版本号，每解决一个重大 BUG，就会发布一个<code>Service Release</code>版本，建成<code>SRx</code>版本，如 Greenwich.SR2就是 SpringCloud 发布的 Greenwich 版本的第二个 SRX 版本。</p></li><li><p>Springboot 用数字作为版本，如：springboot2.6.0</p></li><li><p><a href="https://spring.io/projects/spring-cloud">SpringCloud 与 SpringBoot 对应关系图</a></p></li></ul><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/07bmdc.png"  /><br><br><span style="color:darkgray">👆SpringCloud 与 SpringBoot 对应关系图</span></div><br><ul><li><a href="https://docs.spring.io/spring-cloud/docs/current/reference/html/">版本选择 查看该版本的  Reference Doc.</a></li></ul><div style="text-align:center;padding:20px 5px;border:1px solid #eae6e6;border-radius:15px"><img style="width:80%" src="https://files.catbox.moe/h9hdg1.png"  /><br><br><span style="color:darkgray">👆版本选择</span></div><br><p><br><br></p><h2 id="SpringCloud-技术升级"><a href="#SpringCloud-技术升级" class="headerlink" title="SpringCloud 技术升级"></a>SpringCloud 技术升级</h2><p><br><br></p><br><div style="text-align:center;"><img style="width:80%;border:1px solid #eae6e6;border-radius:15px" src="https://files.catbox.moe/behl5q.png"/><br><br><span style="color:darkgray">👆SpringCloud 技术升级</span></div><br>  ]]></content>
    
    
    <categories>
      
      <category>SpringCloud</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>SpringCloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】JVM 垃圾回收机制</title>
    <link href="/2022/07/02/%E3%80%90Java%E3%80%91JVM/"/>
    <url>/2022/07/02/%E3%80%90Java%E3%80%91JVM/</url>
    
    <content type="html"><![CDATA[<h2 id="JVM-垃圾回收机制"><a href="#JVM-垃圾回收机制" class="headerlink" title="JVM 垃圾回收机制"></a>JVM 垃圾回收机制</h2><h4 id="定位垃圾的方法："><a href="#定位垃圾的方法：" class="headerlink" title="定位垃圾的方法："></a>定位垃圾的方法：</h4><ul><li><strong>Reference Count（引用计数算法）：</strong>有没有引用指向？有则不是垃圾，没有则是垃圾<ul><li><font color=red>缺点：</font>不可以解决循环引用</li><li>举例：A-&gt;B-&gt;C-&gt;A <code>ABC是一坨垃圾</code></li></ul></li><li><strong>（Root Searching）根可达算法：</strong>从根上往下捋，能捋到的不是垃圾，捋不到的是垃圾</li></ul><h4 id="垃圾清除的方法"><a href="#垃圾清除的方法" class="headerlink" title="垃圾清除的方法"></a>垃圾清除的方法</h4><ul><li>Mark-Sweep：标记清除法<ul><li>没有用的就标记为可用</li></ul></li></ul><div align=center><img src="https://files.catbox.moe/mouvd2.png" style="width:70%"></div><ul><li>Copying 算法：<ul><li>仅可在部分内存内使用引用，当执行垃圾回收的之后，将可用的复制到另一部分的内存，随后清空该内存。</li><li><font color=green>优点：</font>效率高</li><li><font color=red>缺点：</font>浪费内存</li></ul></li></ul><div align=center><img src="https://files.catbox.moe/sp8wp3.png" style="width:70%"></div><ul><li>标记整理算法（处女座算法）<ul><li>作用发现垃圾后，将有用的排列起来</li><li><font color=green>优点：</font></li><li><font color=red>缺点：</font>效率低</li></ul></li></ul><div align=center><img src="https://files.catbox.moe/crzo1q.png" style="width:70%"></div><h4 id="对于内存的管理"><a href="#对于内存的管理" class="headerlink" title="对于内存的管理"></a>对于内存的管理</h4><ul><li>分代模型<ul><li>年轻代 | 老年代</li><li>内存一分为二</li></ul></li><li>分区模型<ul><li>分成一个个的小格子</li></ul></li></ul><div align=center><img src="https://files.catbox.moe/k8aw65.png" style="width:70%"></div><div align=center><img src="https://files.catbox.moe/wadgvq.png" style="width:70%"></div><p><font size=2 color=darkgray>左侧为分代，右侧有分区</font></p><div align=center><img src="https://files.catbox.moe/uooept.png" style="width:70%"></div><p>左侧年轻代，当 new 了新的对象后进入 <code>eden</code>（年轻代），随后用 Copy 算法，将有用的内存复制到 Survivor1，下一次将 Survivor1 中的以及 Eden 中的放入Survivor2（Survivor1与Survivor2 不断交换，总有一个是空的），每次都没回收掉<code>年龄+1</code>，当成长到一定年龄后进入<code>tenured</code>（老年代）。</p><h5 id="Serial（单线程-STW）"><a href="#Serial（单线程-STW）" class="headerlink" title="Serial（单线程 STW）"></a>Serial（单线程 STW）</h5><p><font size=2>A <strong>stop-the-world(STW)</strong>,copying collector which uses a single GC thread.</font></p><p>当垃圾回收器开始干活的时候，所有的线程（业务线程）全部停止。</p><ul><li><font color=green>优点：</font>单 CPU 效率最高，虚拟机是 Client 模式的默认垃圾回收器</li><li><font color=red>缺点：</font>会导致程序卡顿</li></ul><h5 id="Parallel-Scavenge-（多线程-STW）"><a href="#Parallel-Scavenge-（多线程-STW）" class="headerlink" title="Parallel Scavenge （多线程 STW）"></a>Parallel Scavenge （多线程 STW）</h5><p><font size=2>A <strong>stop-the-world(STW)</strong>,copying collector which uses a multiple GC threads.</font></p><ul><li><font color=orange>注意：</font>线程无法无限增加</li><li><font color=green>优点：</font>效率更高</li><li><font color=red>缺点：</font>线程需要切换，同样可能会造成卡顿</li></ul><h5 id="CMS（Concurrent-Mark-Sweep）并发"><a href="#CMS（Concurrent-Mark-Sweep）并发" class="headerlink" title="CMS（Concurrent Mark Sweep）并发"></a>CMS（Concurrent Mark Sweep）并发</h5><ul><li><font color=orange>问题：</font><ul><li>问题 1：可能会产生浮动垃圾（本次标记非垃圾后被弃用了）</li><li>问题 2：已经被标记为垃圾的对象被业务线程建立连接了<ul><li>解决办法 ：三色标记算法</li></ul></li></ul></li><li><font color=green>优点：</font>效率更高</li><li><font color=red>缺点：</font>线程需要切换，同样可能会造成卡顿</li></ul><h1 id="相关算法"><a href="#相关算法" class="headerlink" title="相关算法"></a>相关算法</h1><h2 id="三色标记算法"><a href="#三色标记算法" class="headerlink" title="三色标记算法"></a>三色标记算法</h2><div style="background:darkgray;border-radius:10px;padding:5px 15px 5px 15px">没有遍历到的节点：白色；自己完成标记还没来得及标记 fields ：灰色；自己标记且 fields 全部完成标记：黑色</div><p>优点：下一次只要从灰色开始就可以了，黑色就不用开始了。</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>JVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【服务器】记录一次域名解析 | 隐性 URL</title>
    <link href="/2022/06/30/%E6%9C%8D%E5%8A%A1%E5%99%A8/2022-06-30-%E3%80%90%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%91%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90--%E9%9A%90%E6%80%A7-URL/"/>
    <url>/2022/06/30/%E6%9C%8D%E5%8A%A1%E5%99%A8/2022-06-30-%E3%80%90%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%91%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90--%E9%9A%90%E6%80%A7-URL/</url>
    
    <content type="html"><![CDATA[<h1 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h1><p>配置：</p><ul><li>服务器：腾讯云轻量应用服务器</li><li>系    统：CentOS 8</li></ul><p>买了三个域名的，但是只买了一个服务器，其中一个域名<code>Jime.cc</code>当做这个博客地址了，今天查看了一下，第二个备案的 IP 也已经可以访问了，因此赶紧做一下解析，顺便记录一下。</p><h3 id="解析到-80-端口"><a href="#解析到-80-端口" class="headerlink" title="解析到 80 端口"></a>解析到 80 端口</h3><p>纯纯的普通的域名解析，其他的无所谓，只要让解析的域名跟 IP 地址对应起来就可以。</p><h3 id="解析到非-80-端口"><a href="#解析到非-80-端口" class="headerlink" title="解析到非 80 端口"></a>解析到非 80 端口</h3><p>使用隐性解析，让要做解析的 IP（ 假使为bbb.com ） 跳转此服务器的 80 端口的 IP 上（假使 80 端口的 IP 地址为aaa.com），那么我只要在解析的时候添加记录为：</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">http:&#x2F;&#x2F;aaa.com:8080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><font size=2>前方要加协议，不一定是http。</font></p><p>理解起来很简单，就是你在配置隐性解析的时候，直接 <code>ip+端口号</code> 或者 <code>协议+ip+端口号</code> 是不可以的，而 IP 可以用已经解析过的域名来代替，只要在后面加上端口号就可以（在浏览器地址栏输入aaa.com:8080也可以访问你服务器的 8080 端口）。</p>]]></content>
    
    
    <categories>
      
      <category>服务器</category>
      
    </categories>
    
    
    <tags>
      
      <tag>服务器</tag>
      
      <tag>腾讯云</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【读书笔记】《文城》·余华</title>
    <link href="/2022/06/29/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%90%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E3%80%91%E3%80%8A%E6%96%87%E5%9F%8E%E3%80%8B%C2%B7%E4%BD%99%E5%8D%8E/"/>
    <url>/2022/06/29/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%90%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E3%80%91%E3%80%8A%E6%96%87%E5%9F%8E%E3%80%8B%C2%B7%E4%BD%99%E5%8D%8E/</url>
    
    <content type="html"><![CDATA[<h1 id="《文城》·-余华"><a href="#《文城》·-余华" class="headerlink" title="《文城》· 余华"></a>《文城》· 余华</h1><p>​    最近一段时间看完了余华的《文城》。</p><p>​    书中的故事很有意思，（余华的小说向来很有意思），讲述的是北方的林祥福，在该婚娶的年纪，遇到了南方来的小美与阿强（夫妻关系，谎称兄妹关系），阿强将生（装）病的小美留在了林祥福家，随后小美与林祥福的爱恨情仇。</p><p><br><br></p><hr><br><h4 id="小美"><a href="#小美" class="headerlink" title="小美"></a>小美</h4><p>​    小美是一个命运很悲的人物，自小被过门给沈家做童养媳，在这个家里没有什么地位，基本上聪明贤惠且任劳任怨，也因此在一众童养媳中，她的生活还算是好的。</p><p>​    虽然她聪明伶俐，但是也因为偷偷给了自己弟弟几个钱，导致被自己的婆婆休掉。</p><p>​    故事中，她就像是阿强的“附属品”，从过门 到结婚 到被休 到跟阿强离家出走 到遇到林祥福，她都是一个附属品。对于阿强的话“唯命是从”，无论是正确的还是错误的，她都不会去怀疑阿强，但是会帮阿强承担后果。</p><p>​    在“第一次从林祥福逃走”后，小美带着金条找到了乞讨的阿强（从溪镇的小康混到乞丐），随后发现自己怀孕，并决定回到林祥福随便，这个时候开始阿强成了小美的附属品。书中有句话是这么说的“从这一次开始，两人的身份发生了转变”。而这样的原因皆是沈祖强的少爷心态。这个从小到大衣食无忧的小少爷没有经历过什么磨难，也正因如此他险些落得了个离家出走最后沦为乞丐的结局。</p><br><hr><br><h4 id="阿强（沈祖强）"><a href="#阿强（沈祖强）" class="headerlink" title="阿强（沈祖强）"></a>阿强（沈祖强）</h4><p>​    沈祖强是一个少爷，小美则是一个步步惊心的“仆人”，在《文城·补》中描述了二人的成长经历，因此可以将他的性格特点总结为：</p><h5 id="谎话连篇"><a href="#谎话连篇" class="headerlink" title="谎话连篇"></a>谎话连篇</h5><p>​    忘了阿强是什么时候第一次说出的谎话了，但是当他尝到一次甜头之后，便开始一发不可收拾了，遇到林祥福之后，名字、身份、两人关系、居住地全部都是信口开河。</p><h5 id="不知悔改、不懂反思"><a href="#不知悔改、不懂反思" class="headerlink" title="不知悔改、不懂反思"></a>不知悔改、不懂反思</h5><p>​    沈祖强永远是一种无所谓的状态，这点在他帮小美把风的时候被父母打可以看出来，他摸了摸屁股，想着“就着？！就着？！”</p><h5 id="感性主义、不考虑后果、想一出是一出"><a href="#感性主义、不考虑后果、想一出是一出" class="headerlink" title="感性主义、不考虑后果、想一出是一出"></a>感性主义、不考虑后果、想一出是一出</h5><p>​    在小美被休了之后的一个月，他偷了家里的钱，带着小美去了上海，在快要花完所有的钱后，带着小美去京城，找在京里做官的表舅，但其实他连这个表舅的样子都不知道，甚至从未见过面，只在母亲的口中听说过。</p><h5 id="没有远见、不懂得“细水长流”"><a href="#没有远见、不懂得“细水长流”" class="headerlink" title="没有远见、不懂得“细水长流”"></a>没有远见、不懂得“细水长流”</h5><p>​    这一点在二人前往上海后，随意的无节制开销可以看出来，住宾馆、买旗袍、吃西餐，花完了钱又想起表就来了。</p><h5 id="阿强爱小美吗？"><a href="#阿强爱小美吗？" class="headerlink" title="阿强爱小美吗？"></a>阿强爱小美吗？</h5><p>​    答案肯定是爱的。</p><p>​    虽说小美是阿强从小到大的玩伴，两人的感情在阿强心里可能更要趋近兄妹，但是在小美被休的前一晚，他抱着小美流连忘返，让小美第一次感觉到了他的爱意和不舍。</p><p>​    沈祖强是爱着小美的，但是他从小依靠父母生活，可以理解成是一个没有主见的“妈宝男”，因此在两人出走后的一段时间之后，二人的关系变成了阿强依附着小美，他必须要有一个人来做自己的主心骨，他自己是无法对事物做出客观理性地判断的。</p><br><hr><br><h4 id="婆婆（沈母）"><a href="#婆婆（沈母）" class="headerlink" title="婆婆（沈母）"></a>婆婆（沈母）</h4><p>​    婆婆是一个典型的地主婆，家庭地位无可撼动！</p><p>​    婆婆家里有钱，因此娶了家中的小工做上门女婿，随后生育了阿强，并在阿强小时候找来了小美，将两人抚养长大，婆婆是一个及其精明的人，同时又是家中的顶梁柱（同时还十分扣），她对家中的每一块铜板都了如指掌。</p><p>​    因为婆婆是“主”，而阿强的父亲是上门女婿（没有什么地位），阿强作为一个儿子自不用说，小美作为一个上门女婿更是没地位，因此在整个家里，从来都没有人对婆婆说过“不”，这更是让婆婆眼中揉不得沙子。</p><p>​    在小美偷偷给弟弟钱被发现后，婆婆原本并没有想要休掉她，但是要对她做出惩罚时，父子二人替小美求情，这让婆婆感觉到了危机感，感觉天要炸了！她不允许有人对她说“不”，这也就导致了小美被休。</p><p>​    其实婆婆很爱小美，一家子都很爱小美，她自知如果自己百年后，靠阿强继承自己的家业是不可能的，因此她将希望放在了小美身上。父子二人替小美说话，导致了小美被休，但这也不是她想要的结局，可以想象，如果阿强没有带着小美离家出走，那么最后小美还会回到沈家（婆婆会同意小美回到沈家）。</p><p>​    休掉小美是婆婆的一意孤行，在婆婆百年时，她手握账本，用最后的力气呼喊着“小美、小美……”。</p><p>​    婆婆真的是一个性格很复杂的人，她刀子嘴豆腐心，因为自己的固执，让自己死前都没能看到自己的儿子一眼，也没能看到自己的“传承（小美）”，也许阿强是婆婆的心头肉一般，但是小美在她心里，也像是一个女儿吧。</p><br><hr><br><h4 id="公公"><a href="#公公" class="headerlink" title="公公"></a>公公</h4><p>​    没啥好说的，这个怂蛋是个好人，怂蛋！</p><br><hr><br><h4 id="林祥福"><a href="#林祥福" class="headerlink" title="林祥福"></a>林祥福</h4><p>​    作为故事的主人公，故事的大部分故事都在说林祥福，自幼丧父，母亲给他带到结婚的年纪，甚至还没有来得及给他寻一位佳人，便去了，随后遇到了来自“文城”的小美阿强二人，结婚生子，小美两次跑了，最后一次再也没回来，因此林祥福带着未满一岁的女儿林百家（喝百家奶长大的）一路向南，一路寻找文城与生育过的女子，最后定居在了溪镇，买地、与陈永良开木器社，成了溪镇第二富。</p><p>​    林祥福是个很正直很温柔的人，他无法接受用钱解决自己的“生理问题”，甚至最后决定要去的时候发现自己居然“不行”了，他对子女很温柔，对乡亲很温柔，对陈永良以及他的两个儿子也很温柔，同时他想的很远，看的很多。</p><p>​    林祥福最后救顾益民的时候，愿拼上自己的命为顾益民报仇，最后他死了，被土匪用尖刀戳进了耳根里，死的很突然，林祥福做好准备了，我还没做好准备，一下子有点受不住。</p><p>​    林祥福去找土匪之前，安排好了一切：自己的家产、自己的遗体、林百家的未来（给她找好了未来的婆家，那就是顾益民的大儿子顾同年），但他没料到顾同年吃喝嫖赌最后被卖到了国外当苦力去了。</p><br><hr><br><h4 id="陈永良与李梅莲"><a href="#陈永良与李梅莲" class="headerlink" title="陈永良与李梅莲"></a>陈永良与李梅莲</h4><p>​    这是林祥福来溪镇遇到的第一个人，也是林祥福的家人，他与老婆李美莲跟林祥福一起开木器社，老婆负责家务活，他负责软木活，林祥福负责硬木活，若是没有林百家与陈耀武，三个人与一女两子应该是阖家欢乐到百年，但是他与李美莲却为了林百家的名声与未来选择了离开。</p><p>​    李美莲和陈永良二人把林祥福当兄弟，把林百家当女儿，在林百家被土匪抓走后，李美莲让大儿子去替她；在林百家与陈耀武的事情被发现后，她也选择了离开。</p><p>​    陈永良与李美莲对林百家是大爱，是父母之爱。</p><p>​    在林祥福死后，陈永良发誓要亲手杀了张一斧，但同时他也爱恨分明，知道和尚是个好人，便放过了和尚，并跟他结为兄弟（讲真我觉得大哥的位置应该是林祥福），最后他也是亲手杀了张一斧。</p><br><hr><br><h4 id="林百家"><a href="#林百家" class="headerlink" title="林百家"></a>林百家</h4><p>​    一个懂事、痴情、命苦的女生，自小没了母亲，随后又跟顾同年订了婚（订婚未遂），顾同年没了，随后没了爹，在世间已经没有亲人了（只有田二、田三、田四、田五）。</p><p>​    我是很喜欢林百家的，她天真、烂漫、阳光、敢于挑战命运的枷锁、痴情。她爱着陈耀武，并且一直深爱着，知道被送到上海女子学院学习西方思想、每天张口闭口就是“主啊~”，直到最后陈耀武变心，她都还爱着他。</p><br><hr><br><h4 id="和尚"><a href="#和尚" class="headerlink" title="和尚"></a>和尚</h4><p>​    作为一个土匪来说，他极具人情味儿，跟母亲对话时一句“江湖的事情”可以看出他的无奈，书中对他的描述是他从未大声说过话，紧要关头他的语气还是很温柔，在陈耀武被割耳朵时，他也会夹紧耳朵以减少疼痛，他几次救下了陈耀武等人，最后在林祥福死后与陈永良结拜为兄弟。</p><p>​    和尚是一个好人，也因为这个人的出现，更能凸显出战乱纷飞的年代，老百姓的不容易，善良的人也必须要拿起刀子去宰杀其他人来让自己活下去。</p><p>​    和尚最后死了，死了一个土匪，也死了一个好人。</p><br><hr><br><h4 id="张一斧"><a href="#张一斧" class="headerlink" title="张一斧"></a>张一斧</h4><p>​    与和尚不同的是，张一斧是一个车头彻底的坏人，如果说和尚让人觉得生错了年代、让人感觉到了造化弄人，那么张一斧绝对是赶着这个时间点投的胎，他生性就恶，能杀的绝不打残、能折磨的绝不让他轻易死去、遇到两腿之间没把儿的绝对要解裤腰带，他是个狠人，也是个坏人，他该死，但是却拉上了和尚与林祥福。</p><p>​    他的恶以及脾气让他的兄弟都嫌弃，和上等人投靠他后又走了、在他瞎了之后兄弟将他扔了…..这一切都说明，他是个狠角色、是个十足的土匪头头，但是却得不到人心。</p><p>​    最后被自己的左膀右臂扔了后，小弟们居然把扔他的位置传了出来，那么等待他的结果就只有一个死，正如他的小弟给他枪时笑着说的那句话：“里面就几枚子弹，你的仇家太多了，省着点儿用。”一方面小弟对他没有什么感情，一方面在他瞎了成了累赘之后，还是对小弟们恶语相向，一句话不合适就开骂，也很难不让人厌恶他。</p><p>​    死得好。</p><br><hr><br><h1 id="遗憾"><a href="#遗憾" class="headerlink" title="遗憾"></a>遗憾</h1><p>​    故事中有很多遗憾：</p><ul><li><p>林祥福和孙家姑娘（若没有媒婆的几句话，说不定就没有了所有的遗憾）</p></li><li><p>林祥福和小美的爱情故事：两人的遗憾是建立在了封建社会的思想上，小美到死都觉得自己只是一个阿强的一个物品，一个东西。</p></li><li><p>林百家的爱情：虽然还没订婚，但是她和陈耀武的爱情不被允许。</p></li><li><p>林祥福与小美二人的擦肩而过：林祥福有四次都与小美擦肩而过：</p><ul><li>初来到溪镇，林祥福得到了小美亲手编织的“小人”衣服，由女仆三弄过来的（想想女仆还有可能是林祥福的金条顾的，真气人）</li><li>望着祭坛那边被冻死的人，那里面就有他寻找了一生的小美。</li><li>他问了很多人关于溪镇的阿强和小美，但只跟陈永良一个人说起过自己来溪镇的真正目的，如果和顾益民讲过，那么顾益民一定知道这两个人（他亲自安排人下葬的二人）。</li><li>死后的林祥福和田大一同躺在棺材里，田家四兄弟在一个坟头歇脚撒尿，这坟上刻着“纪小美、沈祖强之墓”，若人有魂魄，此时的二人该说些什么？又是一种什么样的心情（看到这里真的泪目）。</li></ul></li><li><p>林祥福去赎顾益民，却得知顾益民已死，随后抱憾而终。</p></li><li><p>还有一些无关紧要的遗憾，比如婆婆死前念叨着小美的名字、顾同年的去向导致了林百家的未来成了变数等…..</p></li></ul><br><hr><br><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>​    整本书讲了一个爱情悲剧，也是一个时代悲剧，就像是《追风筝的人》那般，开头的故事有多么令人向往，后面的故事就多么令人心酸。余华的读者都说：“余华是一个很幽默的人，他在写稿子的时候想到读者看的哇哇大哭，就忍不住笑出声来。” 这很余华。</p>]]></content>
    
    
    <categories>
      
      <category>读书笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书笔记</tag>
      
      <tag>余华</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Shell】Shell 脚本自动输入密码的三种方式</title>
    <link href="/2022/06/28/%E3%80%90Shell%E3%80%91Shell-%E8%84%9A%E6%9C%AC%E8%87%AA%E5%8A%A8%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/"/>
    <url>/2022/06/28/%E3%80%90Shell%E3%80%91Shell-%E8%84%9A%E6%9C%AC%E8%87%AA%E5%8A%A8%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="Shell-脚本自动输入密码的三种方式"><a href="#Shell-脚本自动输入密码的三种方式" class="headerlink" title="Shell 脚本自动输入密码的三种方式"></a>Shell 脚本自动输入密码的三种方式</h2><br><br><hr><p><font color=orange >注意，如果创建.sh文件后不可以执行，请执行<code>sudo chmod 755 文件名.sh</code>来修改权限。</font></p><hr><br><br><h4 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h4><blockquote><p> 使用 echo “密码” | （管道符）</p><p> 使用场景: sudo 命令</p></blockquote><p>在使用普通用户执行 root 命令时有时候会需要输入密码，并且在输入密码后一段时间不需要再次输入（但是不影响），这时候可以使用</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">echo &quot;密码&quot; | sudo 命令<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>比如我需要一键清空服务器，则可以创建一个<code>clear.sh</code>文件（假使我的密码是 123456）：</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">echo &quot;123456&quot; | sudo rm -rf &#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>那么在执行的时候，我只需要<code>./clear.sh</code>就可以清空我的整个数据库。</p><br><br><h4 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h4><blockquote><p> 重定向</p><p>用重定向方法实现交互的前提是指令需要有参数来指定密码输入方式，如ftp就有-i参数来指定使用标准输入来输入密码</p><p>shell用重定向作为标准输入的用法是：cmd&lt;&lt;delimiter ,shell 会将分界符delimiter之后直到下一个同样的分界符之前的内容作为输入</p><p>使用场景：不仅仅输入一个密码，还需要输入用户名。</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">ftp -i -n 192.168.21.46 &lt;&lt;EOFuser 用户名 密码EOF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><br><br><h4 id="方式三"><a href="#方式三" class="headerlink" title="方式三"></a>方式三</h4><blockquote><p>expect</p><p>echo + 管道符不是什么时候都可以生效（比如我写的自动提交博客脚本最后需要输入我的服务器的 git 仓库密码就不生效），因此我们可以使用 expect 方法来执行。</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">set timeout 30spawn ssh -l 用户名 10.125.25.189expect &quot;password:&quot;send &quot;要输入的密码&quot;    interact<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>这里的语句是这样的：</p><blockquote><ol><li>设置超时时间为30s</li><li><ol><li>spawn 是 expect 的起始语句，可以理解为从此处开始</li><li>spawn 后面的语句是执行 ssh 连接</li></ol></li><li>expect：当发现<code>password:</code>这个字符串后，在后方输入send后面的内容</li><li>send：要输入的密码</li><li>interact：执行完留在远程控制台，不加这句执行完后返回本地控制台 </li></ol></blockquote><h5 id="再举一个例子"><a href="#再举一个例子" class="headerlink" title="再举一个例子"></a>再举一个例子</h5><p>这个例子是我真实的脚本文件（但是磨掉了密码），平时用于往我的服务器中提交 hexo 博客</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">cd &#x2F;Users&#x2F;jim&#x2F;hexoecho &#39;123456&#39; | sudo -S hexo clean sudo hexo g spawn sudo -S hexo dexpect &quot;password:&quot;send &quot;123456&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>首先进入到hexo文件夹下</p><p>因为要用到sudo 来 clean/generate/deploy我的博客，所以我这里使用一个 echo+管道符，输入一次 sudo 命令（短时间内不需要再重复输入，所以我只写了一个）</p><p>generate 一下 hexo 文件</p><p>提交到远程仓库，这里需要输入远程仓库的密码，所以我用<code>spawn</code>标记这句话</p><p>当 <code>expect</code>（发现）到”password:”后执行<code>send</code></p><p>将我的密码 <code>send</code>（发送到）到控制台</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Shell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>服务器</tag>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【日记】两个买糖的小女孩</title>
    <link href="/2022/06/25/%E6%97%A5%E8%AE%B0/%E3%80%90%E6%97%A5%E8%AE%B0%E3%80%91%E4%B8%A4%E4%B8%AA%E4%B9%B0%E7%B3%96%E7%9A%84%E5%B0%8F%E5%A5%B3%E5%AD%A9/"/>
    <url>/2022/06/25/%E6%97%A5%E8%AE%B0/%E3%80%90%E6%97%A5%E8%AE%B0%E3%80%91%E4%B8%A4%E4%B8%AA%E4%B9%B0%E7%B3%96%E7%9A%84%E5%B0%8F%E5%A5%B3%E5%AD%A9/</url>
    
    <content type="html"><![CDATA[<h4 id="2022-6-25-日记：两个买糖果的小女孩"><a href="#2022-6-25-日记：两个买糖果的小女孩" class="headerlink" title="2022.6.25 日记：两个买糖果的小女孩"></a>2022.6.25 日记：两个买糖果的小女孩</h4><br><hr><p>今天周六，去楼下超市买了点吃的，结账的时候前面站着两个小女孩在等收银员找零，小女孩比收银员的桌子高不了多少，站在那里向上张望着数钱的收银员，而我则盯着收银台上的糖果：一个比巴卜，两根棒棒糖。</p><br><p>我并不能直接看到收银员的手，但是能听到他在用一只手从抽屉里一个一个的拿着硬币，然后扔到另一只手里。</p><br><p>这时候前面两个女孩子说话了，她们大概都是小学生，语气很稚嫩，说话却有点…可能说是随爸妈。</p><br><p>“要不就这样吧…”其中一个小女孩说道，她的声音有点怯意，感觉是第一次干这种事儿（但又不像），”不用找了。“</p><br><p>结合刚刚收银员手里传来的硬币生，我很确信他正在不紧不慢的一角一角的数着零钱，而这两位十分年轻的女士有点不耐烦了。</p><br><p>“那怎么可以呢，零钱还是要找的。”收银员如是说道，遂发生了我惊掉下巴的一幕：他抬起手，找给小女孩 13.5 元 RMB…..</p><br><p>我当时真的内心一万头xxx在跑，我拼夕夕 5 块钱买个手机壳还要由于好一会儿，这俩小富婆！！！</p><br><p>随后到我了，我拿上手里的锡纸（这是我买的唯一的商品），然后跟收银员说：“要不就这样吧，算了吧，不用给了。”</p><br><p>（小区门口的超市，天天去，都认识了，请勿模仿。）</p><br><p>然后付了钱，我走了，回去跟朋友说了这件事，他们说：“我们在这里花好几千租一间房子，他们生下来就有这里的房子。”</p><br><p>朋友说的很有道理，但是我还是坚持己见：可以不穷养孩子，但是一定要教育孩子勤俭节约，生活的环境很重啊哟，教育也很重要。</p>]]></content>
    
    
    <categories>
      
      <category>日记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>日记</tag>
      
      <tag>生活中的趣事</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【未完成】Docker 学习笔记</title>
    <link href="/2022/06/25/Docker%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2022/06/25/Docker%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="Docker-学习笔记"><a href="#Docker-学习笔记" class="headerlink" title="Docker 学习笔记"></a>Docker 学习笔记</h1><br><br><h2 id="相关网站"><a href="#相关网站" class="headerlink" title="相关网站"></a>相关网站</h2><p><a href="https://www.docker.com/">Docker官网</a></p><p><a href="https://hub.docker.com/_/tomcat">Docker Hub</a></p><p><a href="https://home.console.aliyun.com/">阿里云镜像加速器（每一位用户都有一个独立的镜像加速工具）</a></p><br><br><br><h2 id="安装并配置"><a href="#安装并配置" class="headerlink" title="安装并配置"></a>安装并配置</h2><hr><h3 id="配置镜像加速器"><a href="#配置镜像加速器" class="headerlink" title="配置镜像加速器"></a>配置镜像加速器</h3><p><a href="https://home.console.aliyun.com/">阿里云镜像加速器（每一位用户都有一个独立的镜像加速工具）</a></p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 在&#x2F;etc下创建&#x2F;docker目录sudo mkdir -p &#x2F;etc&#x2F;docker # 使用 vim 创建一个 daemon.json 文件sudo vim &#x2F;etc&#x2F;docker&#x2F;daemon.json&#123;  &quot;registry-mirrors&quot;: [&quot;镜像地址&quot;] &#125; # 镜像配置生效sudo systemctl daemon-reload # 重启 dockersudo systemctl restart docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="启动、关闭、重启-Docker"><a href="#启动、关闭、重启-Docker" class="headerlink" title="启动、关闭、重启 Docker"></a>启动、关闭、重启 Docker</h2><ul><li>启动 Docker</li></ul><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo systemctl start docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>关闭 Docker</li></ul><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo systemctl stop docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>重启 Docker</li></ul><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo systemctl restart docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h2 id="Docker-相关命令"><a href="#Docker-相关命令" class="headerlink" title="Docker 相关命令"></a>Docker 相关命令</h2><h4 id="1-常用命令"><a href="#1-常用命令" class="headerlink" title="1. 常用命令"></a>1. 常用命令</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 查找镜像名称 （或者可以通过 Docker hub 直接搜索）docker search 镜像名称# 下载镜像docker pull 镜像名称# 具体一些docker pull [选项] [Docker Registey 地址[:端口号]&#x2F;] 镜像名[:标签]# 删除镜像（确保该镜像未被任何容器使用）docker image rmi 镜像&#x2F;ID# 查看历史镜像操作docker history nginx# 用 save 子命令将本地仓库的镜像保存到当前目录下docker save 镜像名称（搭建一个私有的镜像仓库）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="2-查看容器状态"><a href="#2-查看容器状态" class="headerlink" title="2. 查看容器状态"></a>2. 查看容器状态</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">docker ps 查看运行中的容器docker ps -a 查看所有容器<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h4 id="3-Docker-启动-关闭-删除-容器"><a href="#3-Docker-启动-关闭-删除-容器" class="headerlink" title="3. Docker 启动/关闭/删除 容器"></a>3. Docker 启动/关闭/删除 容器</h4><p>启动容器的方式有两种，一种是基于镜像新建一个容器并启动，一种是将终止状态（stopped）的容器重新启动</p><p><strong>docker run 参数 镜像名称:tag 执行的命令</strong></p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># -i 保持和 docker 容器内的交互，启动容器时，运行的命令结束后，容器依然存货，没有退出（默认是会推出，即停止的）# -t 为容器的标准输入虚拟一个 tty# -d 后台运行容器# --rf 容器在启动后，执行完成命令或程序后就销毁# --name 给容器起一个自定义的名字# -p 宿主机：内部端口docker run --rm -d --name tomcat1 -p 8080:8080 tomcat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="停止容器"><a href="#停止容器" class="headerlink" title="停止容器"></a>停止容器</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">## 停止所有容器docker stop name&#x2F;id（容器 id 或者容器名字）docker stop $(docker ps -a -q)docker container stop name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">## 删除容器（删除前要先关闭）docker rm 容器 ID&#x2F;容器名称docker rm $(docker ps -a -q) 删除所有容器<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h4 id="进入容器内部"><a href="#进入容器内部" class="headerlink" title="进入容器内部"></a>进入容器内部</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">docker exec -it 容器名称 bash  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><font size=2 color=darkgray>echo ‘Hello World’&gt;&gt;index.html</font></p><h5 id="拷贝文件"><a href="#拷贝文件" class="headerlink" title="拷贝文件"></a>拷贝文件</h5><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">docker cp 名称:&#x2F;usr&#x2F;local&#x2F;地址 &#x2F;root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h4 id="日志操作"><a href="#日志操作" class="headerlink" title="日志操作"></a>日志操作</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">docker logs 容器名称&#x2F;ID docker logs -f -t --since&#x3D;&quot;2018-12-1&quot; --tail&#x3D;10 qfjy_exam <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h2 id="数据卷"><a href="#数据卷" class="headerlink" title="数据卷"></a>数据卷</h2><p>  <font size=2 color=red>容器内外同步变更</font></p>]]></content>
    
    
    <categories>
      
      <category>Docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
      <tag>服务器</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【部署】前后端分离项目的跨域问题</title>
    <link href="/2022/06/25/%E3%80%90%E9%83%A8%E7%BD%B2%E3%80%91%E8%B7%A8%E5%9F%9F/"/>
    <url>/2022/06/25/%E3%80%90%E9%83%A8%E7%BD%B2%E3%80%91%E8%B7%A8%E5%9F%9F/</url>
    
    <content type="html"><![CDATA[<h1 id="跨域问题"><a href="#跨域问题" class="headerlink" title="跨域问题"></a>跨域问题</h1><h3 id="方式一-前端项目中设置proxy。"><a href="#方式一-前端项目中设置proxy。" class="headerlink" title="方式一  前端项目中设置proxy。"></a>方式一  前端项目中设置proxy。</h3><h3 id="注意，此方法在打包部署时不管用"><a href="#注意，此方法在打包部署时不管用" class="headerlink" title="注意，此方法在打包部署时不管用"></a><font size=2 color=red>注意，此方法在打包部署时不管用</font></h3><p>最近一段时间因为上海疫情封禁在家里，无聊看了下前端，跟着哔哩哔哩手敲了一遍<a href="https://github.com/Jimecc/yeb">”云易办“项目</a>，于是使用了在前端部署 proxy 的方式进行跨域，相关代码如下：</p><p><code>vue/vue.config.js</code></p><div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> proxyObj<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>proxyObj<span class="token punctuation">[</span><span class="token string">'/'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>    ws<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>    <span class="token comment">// 目标地址</span>    target<span class="token operator">:</span><span class="token string">'http://127.0.0.1:8081'</span><span class="token punctuation">,</span>    <span class="token comment">// 发送请求头 host 会被改成 target</span>    changeOrigin<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token comment">//不重写请求地址</span>    pathRewrite<span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token string">'^/'</span><span class="token operator">:</span> <span class="token string">'/'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">&#123;</span>    devServer<span class="token operator">:</span><span class="token punctuation">&#123;</span>        host<span class="token operator">:</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>        port<span class="token operator">:</span><span class="token number">8080</span><span class="token punctuation">,</span>        proxy<span class="token operator">:</span> proxyObj    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    lintOnSave<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    publicPath<span class="token operator">:</span><span class="token string">'./'</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>代码运行很成功，由于我是先写的后端代码，（感觉同时运行一个IDEA 后端和一个 WebStorm 有点吃力）于是我就将后端打成 jar 包后放在了自己的服务器（腾讯云 CentOS8），并且将 target 修改为我的服务器地址，运行很流畅，一点问题都没有。</p><p><font color=red >但是！</font>在我完成前端代码，<code>npm run build</code>生成 dist 文件后，我将 dist 部署到服务器出现了一定的问题：所有的接口全部 404 了，在浏览器中查看 NetWork 的 URL 发现跨域失效了，又变成了自己的端口，因此查询资料（顺便入门了下 Nginx）后，我采用了方法二解决了这一问题。</p><h2 id="方法二-使用-Nginx-跨域"><a href="#方法二-使用-Nginx-跨域" class="headerlink" title="方法二 使用 Nginx 跨域"></a>方法二 使用 Nginx 跨域</h2><p>请先看完：在 b 站的视频中，有一句话我印象很深刻，那就是设置四种基本请求的时候，老师多写了一个 base（代码如下）并且说在企业中很可能会让你突然加一个基本地址那就很难办。</p><div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> base <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">postRequest</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span>params</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        method<span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>        url<span class="token operator">:</span>base<span class="token operator">+</span>url<span class="token punctuation">,</span>        data<span class="token operator">:</span>params    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">putRequest</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span>params</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        method<span class="token operator">:</span><span class="token string">'put'</span><span class="token punctuation">,</span>        url<span class="token operator">:</span>base<span class="token operator">+</span>url<span class="token punctuation">,</span>        data<span class="token operator">:</span>params    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>起初一直没搞懂这个 base 的用途，后来发现，原来是部署的时候有大用。</p><h4 id="开始操作"><a href="#开始操作" class="headerlink" title="开始操作"></a>开始操作</h4><p>首先我们将这个 base 一个值，我这里让他叫做<code>/baseproxy</code>，如下：</p><div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> base <span class="token operator">=</span> <span class="token string">'/baseproxy'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>部署保存后，我们访问地址的路径前面就会多上这样一个字符串，如下图所示：</p><div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 我们访问一下'/login'（假使前端项目跑在 8081 端口）</span><span class="token comment">// 没加之前</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8081</span><span class="token operator">/</span>login<span class="token comment">// 加了之后</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8081</span><span class="token operator">/</span>baseproxy<span class="token operator">/</span>login<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>可以看到加了之后多了一个基本地址，这个时候我们只要在 nginx 的配置文件中设置一下代理，让跳转<code>/baseproxy</code>的访问全部都跳转到另一个地方。</p><p>我们可以在 server 中加一个 location，如下：</p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">location &#x2F;baseurl&#123;proxy_set_header Host $http_host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header REMOTE-HOST $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;&#x2F;&#x2F; proxy_pass http:&#x2F;&#x2F;IP 地址:端口号&#x2F;;  proxy_pass http:&#x2F;&#x2F;110.40.191.51:8081&#x2F;;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="完成后的效果"><a href="#完成后的效果" class="headerlink" title="完成后的效果"></a>完成后的效果</h4><p>加完之后，整端 server 代码如下：</p><div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js">server<span class="token punctuation">&#123;</span>  listen <span class="token number">8080</span><span class="token punctuation">;</span>  server_name yeb<span class="token punctuation">;</span>  location <span class="token operator">/</span> <span class="token punctuation">&#123;</span>    root <span class="token operator">/</span>home<span class="token operator">/</span>www<span class="token operator">/</span>dist<span class="token punctuation">;</span>    index index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>html<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  location <span class="token operator">/</span>baseproxy<span class="token operator">/</span> <span class="token punctuation">&#123;</span>    proxy_set_header Host $http_host<span class="token punctuation">;</span>    proxy_set_header <span class="token constant">X</span><span class="token operator">-</span>Real<span class="token operator">-</span><span class="token constant">IP</span> $remote_addr<span class="token punctuation">;</span>    proxy_set_header <span class="token constant">REMOTE</span><span class="token operator">-</span><span class="token constant">HOST</span> $remote_addr<span class="token punctuation">;</span>    proxy_set_header <span class="token constant">X</span><span class="token operator">-</span>Forwarded<span class="token operator">-</span>For $proxy_add_x_forwarded_for<span class="token punctuation">;</span>    proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">后端IP地址:端口号</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  <span class="token operator">/</span><span class="token number">50</span>x<span class="token punctuation">.</span>html<span class="token punctuation">;</span>  location <span class="token operator">=</span> <span class="token operator">/</span><span class="token number">50</span>x<span class="token punctuation">.</span>html <span class="token punctuation">&#123;</span>  root   html<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本文提到了两种跨域的方式，第一种方式适合开发环境，比较便捷，第二种方式比较适合项目部署（毕竟开发的时候谁用 nginx 吗？）。</p><p>但是，灵机一动，如果将整个 vue 项目完整上传到服务器，然后使用pm2 进行托管，是不是也可以用第一种呢？理论上来说是可以的，可以自己尝试一下。</p>]]></content>
    
    
    <categories>
      
      <category>前后端分离</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前后端分离</tag>
      
      <tag>nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Vue/Error】解决页面与浏览器四周存在一定间距的问题</title>
    <link href="/2022/06/23/%E5%89%8D%E7%AB%AF/vue/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E6%98%AF%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/"/>
    <url>/2022/06/23/%E5%89%8D%E7%AB%AF/vue/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E6%98%AF%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="【Error】Vue-页面与浏览器四周存在一定间距的问题"><a href="#【Error】Vue-页面与浏览器四周存在一定间距的问题" class="headerlink" title="【Error】Vue 页面与浏览器四周存在一定间距的问题"></a>【Error】Vue 页面与浏览器四周存在一定间距的问题</h2><p>将<code>/public/index.html</code>中的 body 标签添加一个 style，代码如下：</p><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span>  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">margin</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span>0px</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noscript</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span>We're sorry but &lt;%= htmlWebpackPlugin.options.title %> doesn't work properly without JavaScript enabled. Please enable it to continue.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noscript</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!-- built files will be auto injected --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
      <tag>前端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】云E办项目后端技术栈整合及代码阅读</title>
    <link href="/2022/06/17/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88for%20CSDN/"/>
    <url>/2022/06/17/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88for%20CSDN/</url>
    
    <content type="html"><![CDATA[<blockquote><p>项目来源：<a href="https://www.bilibili.com/video/BV1ff4y1M7XK?p=52&spm_id_from=333.880.my_history.page.click&vd_source=32c908a2f8edcccb3fa042cf11b101bc">Bilibili:带你从0搭建一个springboot+vue前后端分离的java项目</a></p><p>源码地址：<a href="https://github.com/Jimecc/yeb">https://github.com/Jimecc/yeb</a></p><p>本项目的后端部分我已经完整的部署在了我的个人服务器上，因此：</p><ul><li><p>Swagger2 接口文档：<a href="http://110.40.191.51:8081/doc.html">http://110.40.191.51:8081/doc.html</a></p></li><li><p>只想学前端的朋友可以将自己的前端跨域地址设置为<code>http://110.40.191.51:8081</code>，具体方法<a href="#前端跨域">点击此处</a></p></li></ul><p>开发环境：MacBook air 2020</p><ul><li>IDEA + WebStorm</li><li>MySQL 数据库</li></ul><p>服务器环境：腾讯云 CentOS 8.0</p><p>个人博客地址：<a href="http://jime.cc/">Jime.cc</a></p></blockquote><br><br><br><img src="https://files.catbox.moe/h5sru1.png" style="border:3px solid #9c938a;width:90%;border-radius:10px 100px 10px 0px"><div style="size:13px;text-align:center"><a>👆前端截图</a></div><img src="https://files.catbox.moe/lef8ig.png" style="width:90%;box-shadow: 10px 10px 10px rgba(.5,.5,.5,.5);-moz-box-shadow: 10px 10px 10px rgba(0,0,0,.5);-webkit-box-shadow: 10px 10px 10px rgba(0,0,0,.5);" /><div style="size:13px;text-align:center"><a>👆结构概述</a></div><h1 id="0">后端技术栈</h2><table><thead><tr><th>技术名称</th><th>作用</th><th>关键代码</th></tr></thead><tbody><tr><td>Springboot</td><td>整个后端项目的框架</td><td><a href="#1">跳转至关键代码</a></td></tr><tr><td>Lombok</td><td>用注解代替繁琐的操作、简化开发</td><td><a href="#2">跳转至关键代码</a></td></tr><tr><td>AutoGenerator</td><td>代码生成（数据库生成最基本的pojo、mapper、service、controller 文件）</td><td><a href="#3">跳转至关键代码</a></td></tr><tr><td>Swagger2</td><td>后端接口文档（多用于多人开发或前后端分离项目）</td><td><a href="#4">跳转至关键代码</a></td></tr><tr><td>JWT</td><td>生成（或刷新）token</td><td><a href="#5">跳转至关键代码</a></td></tr><tr><td>Kaptcha</td><td>谷歌的验证码生成器</td><td><a href="#6">跳转至关键代码</a></td></tr><tr><td>Redis</td><td>Menu 操作时，减少数据库吞吐量。</td><td><a href="#6">跳转至关键代码</a></td></tr><tr><td>EasyPOI</td><td>表格操作（导出员工信息/导入员工信息并添加到数据库）</td><td><a href="#7">跳转至关键代码</a></td></tr><tr><td>RabbitMQ</td><td>消息队列机制，我将需要处理的消息以队列的形式放入 RabbitMQ，随后再去读取。</td><td><a href="#8">跳转至关键代码</a></td></tr><tr><td>JavaMail</td><td>Java发送邮件。</td><td><a href="#9">跳转至关键代码</a></td></tr><tr><td>@Scheduled</td><td>这并不是一个技术栈，但是也准备讲一下。</td><td><a href="#10">跳转至关键代码</a></td></tr><tr><td>SpringSecurity</td><td>Springboot的安全技术，用于加密等。</td><td><a href="#11">跳转至关键代码</a></td></tr><tr><td>MyBatisPlus</td><td>这个属于最基础的技术了，这里不多写了。</td><td></td></tr><tr><td>FastDFS</td><td>一个文件管理系统，主要用于存储用户头像，其优点可以查看<a href="https://github.com/happyfish100/fastdfs">FastDFS官网</a></td><td><a href="#13">跳转至关键代码</a></td></tr><tr><td>WebSocket</td><td>服务器向客户端推送消息，一般都用于即时通讯工具（像是 QQ、微信、WhatsApp）</td><td><a href="#14">跳转至关键代码</a></td></tr></tbody></table><p><br><br><br></p><h2 id="1">1.Springboot 关键代码</h1><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YebApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">YebApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font color=darkgray size=2>可以说整个后端有很多地方都是 Springboot 的关键代码，因此我在这里只写了 Springboot 的启动类以及注解。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="2">2.Lombok 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font size=2>以上为 pom.xml 的 dependency </font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token annotation punctuation">@EqualsAndHashCode</span><span class="token punctuation">(</span>callSuper <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>of<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">"t_position"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"Position对象"</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Position</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span>AUTO<span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"职位"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"职位"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@NonNull</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"创建时间"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">"yyy-MM-dd"</span><span class="token punctuation">,</span>timezone<span class="token operator">=</span><span class="token string">"Asia/Shanghai"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> createDate<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"是否启用"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> enabled<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>在实体类（pojo/entity）中使用@Data 取代 setter/getter方法</font></p><p>👆<font size=2>使用 @NoArgsConstructor 与 @AllArgsConstructor 分别取代无参构造与全参构造函数。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AdminController</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"这是 info 日志信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"这是 warnning 日志信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"这是 error 日志信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>使用 @Slf4j 生成log 日志</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="3">3.AutoGenerator 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>generator</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span><span class="token class-name">MybatisPlusException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>toolkit<span class="token punctuation">.</span></span><span class="token class-name">StringPool</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>toolkit<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span></span><span class="token class-name">AutoGenerator</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span></span><span class="token class-name">InjectionConfig</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>config<span class="token punctuation">.</span>po<span class="token punctuation">.</span></span><span class="token class-name">TableInfo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>config<span class="token punctuation">.</span>rules<span class="token punctuation">.</span></span><span class="token class-name">NamingStrategy</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>engine<span class="token punctuation">.</span></span><span class="token class-name">FreemarkerTemplateEngine</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Scanner</span><span class="token punctuation">;</span><span class="token comment">// t_admin,t_admin_role,t_appraise,t_department,t_employee,t_employee_ec,t_employee_remove,t_employee_train,t_joblevel,t_mail_log,t_menu,t_menu_role,t_nation,t_oplog,t_politics_status,t_position,t_role,t_salary,t_salary_adjust,t_sys_msg,t_sys_msg_content</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CodeGenerator</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * &lt;p>     * 读取控制台内容     * &lt;/p>     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">scanner</span><span class="token punctuation">(</span><span class="token class-name">String</span> tip<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">StringBuilder</span> help <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        help<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"请输入"</span> <span class="token operator">+</span> tip <span class="token operator">+</span> <span class="token string">"："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>help<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>scanner<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> ipt <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>ipt<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> ipt<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MybatisPlusException</span><span class="token punctuation">(</span><span class="token string">"请输入正确的"</span> <span class="token operator">+</span> tip <span class="token operator">+</span> <span class="token string">"！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 代码生成器</span>        <span class="token class-name">AutoGenerator</span> mpg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AutoGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 全局配置</span>        <span class="token class-name">GlobalConfig</span> gc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GlobalConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token class-name">String</span> projectPath <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.dir"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        gc<span class="token punctuation">.</span><span class="token function">setOutputDir</span><span class="token punctuation">(</span>projectPath <span class="token operator">+</span> <span class="token string">"/yeb-server/src/main/java"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        gc<span class="token punctuation">.</span><span class="token function">setAuthor</span><span class="token punctuation">(</span><span class="token string">"jim"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//作者</span>        gc<span class="token punctuation">.</span><span class="token function">setOpen</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//是否打开目录</span>        gc<span class="token punctuation">.</span><span class="token function">setBaseResultMap</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//xml开启BaseResultMap</span>        gc<span class="token punctuation">.</span><span class="token function">setBaseColumnList</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//xml 开启BaseColumn</span>        gc<span class="token punctuation">.</span><span class="token function">setSwagger2</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//实体属性 Swagger2 注解</span>        mpg<span class="token punctuation">.</span><span class="token function">setGlobalConfig</span><span class="token punctuation">(</span>gc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 数据源配置</span>        <span class="token class-name">DataSourceConfig</span> dsc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dsc<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://127.0.0.1:3306/yeb?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// dsc.setSchemaName("public");</span>        dsc<span class="token punctuation">.</span><span class="token function">setDriverName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dsc<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dsc<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"12345ioS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dsc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 包配置</span>        <span class="token keyword">final</span> <span class="token class-name">PackageConfig</span> pc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PackageConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//pc.setModuleName(scanner("模块名"));</span>        pc<span class="token punctuation">.</span><span class="token function">setParent</span><span class="token punctuation">(</span><span class="token string">"com.jim.server"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setEntity</span><span class="token punctuation">(</span><span class="token string">"pojo"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setMapper</span><span class="token punctuation">(</span><span class="token string">"mapper"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setService</span><span class="token punctuation">(</span><span class="token string">"service"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setServiceImpl</span><span class="token punctuation">(</span><span class="token string">"service.impl"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setController</span><span class="token punctuation">(</span><span class="token string">"controller"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setPackageInfo</span><span class="token punctuation">(</span>pc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 自定义配置</span>        <span class="token class-name">InjectionConfig</span> cfg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InjectionConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// to do nothing</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token comment">// 如果模板引擎是 freemarker</span>        <span class="token class-name">String</span> templatePath <span class="token operator">=</span> <span class="token string">"/templates/mapper.xml.ftl"</span><span class="token punctuation">;</span>        <span class="token comment">// 如果模板引擎是 velocity</span>        <span class="token comment">// String templatePath = "/templates/mapper.xml.vm";</span>        <span class="token comment">// 自定义输出配置</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FileOutConfig</span><span class="token punctuation">></span></span> focList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 自定义配置会被优先输出</span>        focList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutConfig</span><span class="token punctuation">(</span>templatePath<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">outputFile</span><span class="token punctuation">(</span><span class="token class-name">TableInfo</span> tableInfo<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// 自定义输出文件名 ， 如果你 Entity 设置了前后缀、此处注意 xml 的名称会跟着发生变化！！</span>                <span class="token keyword">return</span> projectPath <span class="token operator">+</span> <span class="token string">"/yeb-server/src/main/resources/mapper/"</span> <span class="token operator">+</span> pc<span class="token punctuation">.</span><span class="token function">getModuleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> tableInfo<span class="token punctuation">.</span><span class="token function">getEntityName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"Mapper"</span> <span class="token operator">+</span> <span class="token class-name">StringPool</span><span class="token punctuation">.</span>DOT_XML<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/*        cfg.setFileCreate(new IFileCreate() &#123;            @Override            public boolean isCreate(ConfigBuilder configBuilder, FileType fileType, String filePath) &#123;                // 判断自定义文件夹是否需要创建                checkDir("调用默认方法创建的目录，自定义目录用");                if (fileType == FileType.MAPPER) &#123;                    // 已经生成 mapper 文件判断存在，不想重新生成返回 false                    return !new File(filePath).exists();                &#125;                // 允许生成模板文件                return true;            &#125;        &#125;);        */</span>        cfg<span class="token punctuation">.</span><span class="token function">setFileOutConfigList</span><span class="token punctuation">(</span>focList<span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setCfg</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 配置模板</span>        <span class="token class-name">TemplateConfig</span> templateConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TemplateConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 配置自定义输出模板</span>        <span class="token comment">//指定自定义模板路径，注意不要带上.ftl/.vm, 会根据使用的模板引擎自动识别</span>        <span class="token comment">// templateConfig.setEntity("templates/entity2.java");</span>        <span class="token comment">// templateConfig.setService();</span>        <span class="token comment">// templateConfig.setController();</span>        templateConfig<span class="token punctuation">.</span><span class="token function">setXml</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setTemplate</span><span class="token punctuation">(</span>templateConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 策略配置</span>        <span class="token class-name">StrategyConfig</span> strategy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StrategyConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//数据库表映射到实体的命名策略</span>        strategy<span class="token punctuation">.</span><span class="token function">setNaming</span><span class="token punctuation">(</span><span class="token class-name">NamingStrategy</span><span class="token punctuation">.</span>underline_to_camel<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//数据库表字段映射到实体的命名策略</span>        strategy<span class="token punctuation">.</span><span class="token function">setColumnNaming</span><span class="token punctuation">(</span><span class="token class-name">NamingStrategy</span><span class="token punctuation">.</span>no_change<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//strategy.setSuperEntityClass("你自己的父类实体,没有就不用设置!");</span>        <span class="token comment">//lombok模型</span>        strategy<span class="token punctuation">.</span><span class="token function">setEntityLombokModel</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//生成RestController</span>        strategy<span class="token punctuation">.</span><span class="token function">setRestControllerStyle</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 公共父类</span>        <span class="token comment">//strategy.setSuperControllerClass("你自己的父类控制器,没有就不用设置!");</span>        <span class="token comment">// 写于父类中的公共字段</span>        <span class="token comment">//strategy.setSuperEntityColumns("id");</span>        strategy<span class="token punctuation">.</span><span class="token function">setInclude</span><span class="token punctuation">(</span><span class="token function">scanner</span><span class="token punctuation">(</span><span class="token string">"表名，多个英文逗号分割"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        strategy<span class="token punctuation">.</span><span class="token function">setControllerMappingHyphenStyle</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//表前缀</span>        strategy<span class="token punctuation">.</span><span class="token function">setTablePrefix</span><span class="token punctuation">(</span><span class="token string">"t_"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span>strategy<span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setTemplateEngine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FreemarkerTemplateEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>这段代码中有独立的 main 函数，可以直接运行此类，运行后在控制台输入数据库表名称，可以直接生成<code>mapper、service、controller、pojo 类</code>，节省无效开发的时间。（本技术使用的是 MyBatis-Plus 的代码自动生成器，具体可以去 MyBatis-Plus 官网查看）</font></p><p>👆<font size=2>代码自动生成在项目中为一个单独的子项目，创建方式：在父项目中创建相一个Maven 项目，然后关联父项目。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="4">4.Swagger2 效果/关键代码</h2><img src="https://files.catbox.moe/kqquye.png" title="pojo 对象" style="width:90%" /><div style="size:2;text-align:center"><a>👆Swagger 对 pojo 的展示</a></div><img src="https://files.catbox.moe/acui25.png"  style="width:90%"  /><div style="size:13px;text-align:center"><a>👆Swagger 对 Controller 接口的展示</a></div><p>🏀 <font size=2>具体操作可以访问<a href="http://110.40.191.51:8081/doc.html">-YebSwagger接口文档-</a>自行尝试</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Swagger2 配置文件</span><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">ApiInfoBuilder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">PathSelectors</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">RequestHandlerSelectors</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">DocumentationType</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>service<span class="token punctuation">.</span>contexts<span class="token punctuation">.</span></span><span class="token class-name">SecurityContext</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>web<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span></span><span class="token class-name">Docket</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>swagger2<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">EnableSwagger2</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@EnableSwagger2</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Swagger2Config</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Docket</span> <span class="token function">createRestApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Docket</span><span class="token punctuation">(</span><span class="token class-name">DocumentationType</span><span class="token punctuation">.</span>SWAGGER_2<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">apis</span><span class="token punctuation">(</span><span class="token class-name">RequestHandlerSelectors</span><span class="token punctuation">.</span><span class="token function">basePackage</span><span class="token punctuation">(</span><span class="token string">"com.jim.server.controller"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">paths</span><span class="token punctuation">(</span><span class="token class-name">PathSelectors</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">securityContexts</span><span class="token punctuation">(</span><span class="token function">securityContexts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">securitySchemes</span><span class="token punctuation">(</span><span class="token function">securitySchemes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">ApiInfo</span> <span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ApiInfoBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"云E办接口文档"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">"云E办接口文档"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">contact</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Contact</span><span class="token punctuation">(</span><span class="token string">"Jim"</span><span class="token punctuation">,</span><span class="token string">"http://localhost:8081/doc.html"</span><span class="token punctuation">,</span><span class="token string">"1234@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token string">"1.0"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApiKey</span><span class="token punctuation">></span></span> <span class="token function">securitySchemes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 设置请求头信息</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApiKey</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ApiKey</span> apiKey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApiKey</span><span class="token punctuation">(</span><span class="token string">"Authorization"</span><span class="token punctuation">,</span><span class="token string">"Authorization"</span><span class="token punctuation">,</span><span class="token string">"Header"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>apiKey<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityContext</span><span class="token punctuation">></span></span> <span class="token function">securityContexts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 设置需要登录认证的路程</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityContext</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">getContextByPath</span><span class="token punctuation">(</span><span class="token string">"/hello/.*"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">SecurityContext</span> <span class="token function">getContextByPath</span><span class="token punctuation">(</span><span class="token class-name">String</span> pathRegex<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">SecurityContext</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">securityReferences</span><span class="token punctuation">(</span><span class="token function">defaultAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">forPaths</span><span class="token punctuation">(</span><span class="token class-name">PathSelectors</span><span class="token punctuation">.</span><span class="token function">regex</span><span class="token punctuation">(</span>pathRegex<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityReference</span><span class="token punctuation">></span></span> <span class="token function">defaultAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityReference</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">AuthorizationScope</span> authorizationScope <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthorizationScope</span><span class="token punctuation">(</span><span class="token string">"global"</span><span class="token punctuation">,</span><span class="token string">"accessEverything"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">AuthorizationScope</span><span class="token punctuation">[</span><span class="token punctuation">]</span> authorizationScopes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthorizationScope</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        authorizationScopes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> authorizationScope<span class="token punctuation">;</span>        result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SecurityReference</span><span class="token punctuation">(</span><span class="token string">"Authorization"</span><span class="token punctuation">,</span>authorizationScopes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/admin"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AdminController</span> <span class="token punctuation">&#123;</span>      <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"获取所有操作员"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Admin</span><span class="token punctuation">></span></span> <span class="token function">getAllAdmins</span><span class="token punctuation">(</span><span class="token class-name">String</span> keywords<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> adminService<span class="token punctuation">.</span><span class="token function">getAllAdmins</span><span class="token punctuation">(</span>keywords<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>在 Controller 层使用 <code>@ApiOperation(value = &quot;名称&quot;</code>) 对接口进行命名，名称为“名称”，可以在接口文档查看的时候看到此名称，如果不写则以方法名称为默认名称（类上也可以用@Api(value=”名称”)</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"Admin对象"</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Admin</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">,</span> <span class="token class-name">UserDetails</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>在 pojo 类中使用<code>@ApiModel</code> 注解让 Swagger 知道当前内容是一个对象类，<code>value</code>为接口文档中显示的名称，<code>description</code>为接口文档中显示的简介。</font></p><p><font size=2>👆在成员属性中用<code>@ApiModelProperty(value = &quot;id&quot;)</code>注释描述属性的名字。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="5">5.JWT 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtTokenUtil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CLAIM_KEY_USERNAME <span class="token operator">=</span> <span class="token string">"sub"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CLAIM_KEY_CREATED <span class="token operator">=</span> <span class="token string">"created"</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.secret&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> secret<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.expiration&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Long</span> expiration<span class="token punctuation">;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 根据用户信息生成 TOKEN     * @Params:  public     */</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">generateToken</span><span class="token punctuation">(</span><span class="token class-name">UserDetails</span> userDetails<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> claims <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        claims<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>CLAIM_KEY_USERNAME<span class="token punctuation">,</span>userDetails<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        claims<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>CLAIM_KEY_CREATED<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>claims<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">generateToken</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 从 token 中获取登录用户名     * @Params:      */</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUserNameFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> username<span class="token punctuation">;</span>        <span class="token comment">// 根据 token 拿一个荷载</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token function">getClaimsFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>            username <span class="token operator">=</span> claims<span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            username <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> username<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 判断 token 是否有效     * @Params:     */</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">validateToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">,</span><span class="token class-name">UserDetails</span> userDetails<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token function">getUserNameFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> username<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span> <span class="token function">isTokenExpired</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 判断 token 是否可以刷新     * @Params:     */</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canRefresh</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">isTokenExpired</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 刷新 token     * @Params:     */</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">refreshToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token function">getClaimsFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>        claims<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>CLAIM_KEY_CREATED<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">generateToken</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 判断 token 是否失效     * @Params:     */</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isTokenExpired</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Date</span> expireDate <span class="token operator">=</span> <span class="token function">getExpiredDateFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> expireDate<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 从 token 中获取过期时间     * @Params:     */</span>    <span class="token keyword">private</span> <span class="token class-name">Date</span> <span class="token function">getExpiredDateFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token function">getClaimsFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> claims<span class="token punctuation">.</span><span class="token function">getExpiration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 从 token 中获取荷载     * @Params:     */</span>    <span class="token keyword">private</span> <span class="token class-name">Claims</span> <span class="token function">getClaimsFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            claims <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> claims<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 根据荷载生成 JWT TOKEN     * @Params:      */</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">generateToken</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> claims<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setClaims</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setExpiration</span><span class="token punctuation">(</span><span class="token function">generateExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">signWith</span><span class="token punctuation">(</span><span class="token class-name">SignatureAlgorithm</span><span class="token punctuation">.</span>HS512<span class="token punctuation">,</span>secret<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 生成 TOKEN 失效时间     * @Params:     */</span>    <span class="token keyword">private</span> <span class="token class-name">Date</span> <span class="token function">generateExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>expiration<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>该类为 JWT 的一个基本方法类，主要使用<code>Jwts.builder()</code>生成一个 token，token 中包含一个用户名与创建时间，后续，前端访问后会将该 token 存储在 windows.session 中（也就是 httpsession)中，每次访问后端都会携带该 session，后端得到 session 也就得到了 token，可以解析出 username 与 Date，以此来判断该用户是否登录、登录是否过期。</font></p><p>👆<font size=2>顺便一提，退出登录后端不进行任何操作，仅返回一个成功码200，前端得到成功码后删除前端存储的 session 就可以了，再次使用就会提醒你要登录了。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SecurityContextHolder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>web<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">WebAuthenticationDetailsSource</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span></span><span class="token class-name">OncePerRequestFilter</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">FilterChain</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtAuthencationTokenFilter</span> <span class="token keyword">extends</span> <span class="token class-name">OncePerRequestFilter</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.tokenHeader&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> tokenHeader<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.tokenHead&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> tokenHead<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">JwtTokenUtil</span> jwtTokenUtil<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">UserDetailsService</span> userDetailsService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doFilterInternal</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> authHeader <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span>tokenHeader<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 存在 token</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> authHeader <span class="token operator">&amp;&amp;</span> authHeader<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>tokenHead<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> authToken <span class="token operator">=</span> authHeader<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>tokenHead<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> username <span class="token operator">=</span> jwtTokenUtil<span class="token punctuation">.</span><span class="token function">getUserNameFromToken</span><span class="token punctuation">(</span>authToken<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// token 存在用户名但是未登录</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> username <span class="token operator">&amp;&amp;</span> <span class="token keyword">null</span> <span class="token operator">==</span> <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> userDetailsService<span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>jwtTokenUtil<span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>authToken<span class="token punctuation">,</span>userDetails<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token class-name">UsernamePasswordAuthenticationToken</span> authenticationToken <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span>userDetails<span class="token punctuation">.</span><span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    authenticationToken<span class="token punctuation">.</span><span class="token function">setDetails</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WebAuthenticationDetailsSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">buildDetails</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authenticationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>🏀<font size=2>还用到了一些相关的过滤器，可以下载源码后查看。</font></p><hr><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="6">6.Kaptcha 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>code<span class="token punctuation">.</span>kaptcha<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">DefaultKaptcha</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>code<span class="token punctuation">.</span>kaptcha<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span><span class="token punctuation">;</span><span class="token comment">/** * 验证码配置类 * @author Jim * @since 1.0.0 */</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CaptchaConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">DefaultKaptcha</span> <span class="token function">defaultKaptcha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//验证码生成器</span>        <span class="token class-name">DefaultKaptcha</span> defaultKaptcha <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultKaptcha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//配置</span>        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//是否有边框</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.border"</span><span class="token punctuation">,</span> <span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//设置边框颜色</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.border.color"</span><span class="token punctuation">,</span> <span class="token string">"105,179,90"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//边框粗细度，默认为1</span>        <span class="token comment">// properties.setProperty("kaptcha.border.thickness","1");</span>        <span class="token comment">//验证码</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.session.key"</span><span class="token punctuation">,</span><span class="token string">"code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证码文本字符颜色 默认为黑色</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.font.color"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//设置字体样式</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.font.names"</span><span class="token punctuation">,</span> <span class="token string">"宋体,楷体,微软雅黑"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//字体大小，默认40</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.font.size"</span><span class="token punctuation">,</span> <span class="token string">"30"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证码文本字符内容范围 默认为abced2345678gfynmnpwx</span>        <span class="token comment">// properties.setProperty("kaptcha.textproducer.char.string", "");</span>        <span class="token comment">//字符长度，默认为5</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.char.length"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//字符间距 默认为2</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.char.space"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证码图片宽度 默认为200</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.image.width"</span><span class="token punctuation">,</span> <span class="token string">"100"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证码图片高度 默认为40</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.image.height"</span><span class="token punctuation">,</span> <span class="token string">"40"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>        defaultKaptcha<span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> defaultKaptcha<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>以上为 <code>Kaptcha</code> 的配置类，主要操作为创建一个<code>DefaultKaptcha</code>对象，并对对象进行配置。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>code<span class="token punctuation">.</span>kaptcha<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">DefaultKaptcha</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiOperation</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>imageio<span class="token punctuation">.</span></span><span class="token class-name">ImageIO</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletOutputStream</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>image<span class="token punctuation">.</span></span><span class="token class-name">BufferedImage</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token comment">/** * 验证码 * * @author zhoubin * @since 1.0.0 */</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CaptchaController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">DefaultKaptcha</span> defaultKaptcha<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"验证码"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/captcha"</span><span class="token punctuation">,</span>produces <span class="token operator">=</span> <span class="token string">"image/jpeg"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">captcha</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 定义response输出类型为image/jpeg类型</span>        response<span class="token punctuation">.</span><span class="token function">setDateHeader</span><span class="token punctuation">(</span><span class="token string">"Expires"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Set standard HTTP/1.1 no-cache headers.</span>        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Cache-Control"</span><span class="token punctuation">,</span> <span class="token string">"no-store, no-cache, must-revalidate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Set IE extended HTTP/1.1 no-cache headers (use addHeader).</span>        response<span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span><span class="token string">"Cache-Control"</span><span class="token punctuation">,</span> <span class="token string">"post-check=0, pre-check=0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Set standard HTTP/1.0 no-cache header.</span>        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Pragma"</span><span class="token punctuation">,</span> <span class="token string">"no-cache"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// return a jpeg</span>        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"image/jpeg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//-------------------生成验证码 begin --------------------------</span>        <span class="token comment">//获取验证码文本内容</span>        <span class="token class-name">String</span> text <span class="token operator">=</span> defaultKaptcha<span class="token punctuation">.</span><span class="token function">createText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"验证码内容："</span><span class="token operator">+</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//将验证码文本内容放入session</span>        request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"captcha"</span><span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//根据文本验证码内容创建图形验证码</span>        <span class="token class-name">BufferedImage</span> image <span class="token operator">=</span> defaultKaptcha<span class="token punctuation">.</span><span class="token function">createImage</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ServletOutputStream</span> outputStream <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            outputStream <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//输出流输出图片，格式为jpg</span>            <span class="token class-name">ImageIO</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span><span class="token string">"jpg"</span><span class="token punctuation">,</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>            outputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">!=</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    outputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//-------------------生成验证码 end --------------------------</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>Controller 获取一个验证码。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">RespBean</span> login <span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">AdminLoginParam</span> adminLoginParam<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> adminService<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>adminLoginParam<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>adminLoginParam<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>adminLoginParam<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>登录接口，验证用户名、密码、验证码。</font></p><p>🏀<font size=2>请注意，当两个用户同时登录的时候，后端会生成两个验证码，那么是不是我若是乱输入，输了其他用户的验证码也会生效呢？这当然是不可能的，如何判断 A 输入的验证码就是后台为 A 生成的验证码（而不是为其他用户生成的验证码）呢？其实在获取验证码的时候，并不是单纯地仅返回了一个图片，而是将验证码的内容放在了HttpServletRequest中，登陆的时候，会带着HttpServletRequest再回来，这样就可以确定该用户的验证码是多少，执行登录的时候，则会判断 request 中的验证码与用户输入的验证码是否一致，具体可以下载源码后查看 LoginService。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="7">7.Redis 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span></span><span class="token class-name">LettuceConnectionFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token class-name">StringRedisSerializer</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">LettuceConnectionFactory</span> connectionFactory<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> template<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>配置 Redis</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>toolkit<span class="token punctuation">.</span></span><span class="token class-name">CollectionUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">ServiceImpl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">AdminUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">MenuMapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Menu</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IMenuService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">ValueOperations</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token comment">/** * &lt;p> *  服务实现类 * &lt;/p> * * @author jim * @since 2022-05-11 */</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MenuServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MenuMapper</span><span class="token punctuation">,</span> <span class="token class-name">Menu</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">IMenuService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">MenuMapper</span> menuMapper<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span> redisTemplate<span class="token punctuation">;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 根据用户id 查询菜单列表     * @Params:     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> <span class="token function">getMenuByAdminId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Integer</span> adminId <span class="token operator">=</span> <span class="token class-name">AdminUtils</span><span class="token punctuation">.</span><span class="token function">getCurrentAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> valueOperations <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> menus <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span><span class="token punctuation">)</span> valueOperations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"menu_"</span><span class="token operator">+</span>adminId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>menus<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            menus <span class="token operator">=</span> menuMapper<span class="token punctuation">.</span><span class="token function">getMenusByAdminId</span><span class="token punctuation">(</span>adminId<span class="token punctuation">)</span><span class="token punctuation">;</span>            valueOperations<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"menu_"</span><span class="token operator">+</span>adminId<span class="token punctuation">,</span>menus<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> menus<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>用户登录后会获取 menu 菜单，为了防止反复渲染造成数据库吞吐量较大，因此每次用户获取 menu 时会现在 Redis 中寻找<code>&quot;menu_&quot;+adminId</code>如果有则直接从 Redis 中获取，否则就从数据库中读取并存储在 Redis 中，存储名称依旧是<code>&quot;menu_&quot;+adminId</code>（得做到一致嘛，不然存储和读取不一致，你怎么存都读取不到）。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="8">8.EasyPOI 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>cn.afterturn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>easypoi-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.1.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>Maven 依赖</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>afterturn<span class="token punctuation">.</span>easypoi<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Excel</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>afterturn<span class="token punctuation">.</span>easypoi<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExcelEntity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">IdType</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableField</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableId</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableName</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">JsonFormat</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiModel</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiModelProperty</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">EqualsAndHashCode</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span></span><span class="token class-name">Accessors</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDate</span><span class="token punctuation">;</span><span class="token comment">/** * &lt;p> *  * &lt;/p> * * @author jim * @since 2022-05-11 */</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@EqualsAndHashCode</span><span class="token punctuation">(</span>callSuper <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Accessors</span><span class="token punctuation">(</span>chain <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">"t_employee"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"Employee对象"</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"员工编号"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span>AUTO<span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"员工姓名"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"员工姓名"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>  <span class="token comment">// 为了方便阅读，这里省略了很多代码（注解都跟【员工姓名】是一样的）</span>       <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"民族"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>exist <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@ExcelEntity</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"民族"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Nation</span> nation<span class="token punctuation">;</span>    <span class="token comment">// 为了方便阅读，这里省略了很多代码（注解都跟【民族】是一样的）</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"工资账套"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>exist <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Salary</span> salary<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>为了方便阅读，具体注解看下方表格</font></p><table><thead><tr><th>注解</th><th>用途</th><th>使用位置</th><th>备注</th></tr></thead><tbody><tr><td>@TableName(“t_employee”)</td><td>对应哪一张数据库表</td><td>类</td><td></td></tr><tr><td>@Excel(name=”工龄”)</td><td>导入导出时纵坐标的标题名字（也就是“姓名、年龄”那一些东西）</td><td>成员属性</td><td></td></tr><tr><td>@TableField(exist = false)</td><td>数据库中不存在，是其他的实体类。</td><td>成员属性</td><td></td></tr><tr><td>@ExcelEntity(name=”职位”)</td><td>与<code>@Excel</code>一样，但是这个用于注释数据库中没有，该 pojo 中引用了其他的 pojo 类。</td><td>成员属性</td><td></td></tr></tbody></table><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token annotation punctuation">@EqualsAndHashCode</span><span class="token punctuation">(</span>callSuper <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>of <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">"t_nation"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"Nation对象"</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Nation</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span>AUTO<span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"民族"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"民族"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@NonNull</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>🏀<font size=2><font color=red>注意：</font>可以看到，由于Employee 数据库表中并没有Nation但是导出的时候有需要用到 <code>Nation.name</code>因此，在 Employee 的成员属性 Nation 中并不是<code>@Excel</code>而是<code>@ExcelEntity</code>，然后再在 Nation 类中的 name 上写一下<code>@Excel</code>，这样执行导入导出的时候，读取到 Nation 时，就会去寻找 Nation 这个 pojo 类，然后再在 Nation 中找<code>@Excel</code>下的成员方法。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="9">9.RabbitMQ 关键代码</h2><h2 id="9.1">消息发送端</h2><p>🏀注意：这里的“消息发送”并不是指 “我给你发送一个消息”，而是“我给 RabbitMQ 消息队列发送一个消息”。</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>update<span class="token punctuation">.</span></span><span class="token class-name">UpdateWrapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">MailConstants</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">MailLog</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IMailLogService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Binding</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">BindingBuilder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">DirectExchange</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Queue</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>connection<span class="token punctuation">.</span></span><span class="token class-name">CachingConnectionFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RabbitTemplate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token comment">/** * @author Jim * @Description rabbitmq配置 * @createTime 2022年05月24日 */</span><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMQConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">CachingConnectionFactory</span> cachingConnectionFactory<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">IMailLogService</span> mailLogService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">RabbitTemplate</span> <span class="token function">rabbitTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">RabbitTemplate</span> rabbitTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RabbitTemplate</span><span class="token punctuation">(</span>cachingConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/**         * 消息确认毁掉，确认消息是否到达 borker         * data: 消息唯一标识         * ack： 确认结果         * cause：失败原因          */</span>        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setConfirmCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>ack<span class="token punctuation">,</span>cause<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> msgId <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>ack<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"suc1-- &#123;&#125;========>消息发送成功"</span><span class="token punctuation">,</span>msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>                mailLogService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UpdateWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MailLog</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">"msgId"</span><span class="token punctuation">,</span>msgId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"err1-- &#123;&#125;========>消息发送失败"</span><span class="token punctuation">,</span>msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/**         * 消息失败回调         * msg： 消息主题         * repCode：响应码         * repText：响应文本         * exchange：交换机         * routingkey：路由键         */</span>        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setReturnCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span>repCode<span class="token punctuation">,</span>repText<span class="token punctuation">,</span>exchange<span class="token punctuation">,</span>routingkey<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"err2-- &#123;&#125;========>消息发送queue时失败"</span><span class="token punctuation">,</span>msg<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> rabbitTemplate<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_QUEUE_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">DirectExchange</span> <span class="token function">directExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DirectExchange</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_EXCHANGE_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">binding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">directExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_ROUTING_KEY_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>以上内容为RabbitMQ 的配置文件</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryWrapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span></span><span class="token class-name">IPage</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>pagination<span class="token punctuation">.</span></span><span class="token class-name">Page</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">ServiceImpl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">MailLogMapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IEmployeeService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>connection<span class="token punctuation">.</span></span><span class="token class-name">CorrelationData</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RabbitTemplate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">DecimalFormat</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDateTime</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span>temporal<span class="token punctuation">.</span></span><span class="token class-name">ChronoUnit</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>UUID<span class="token punctuation">;</span><span class="token comment">/** * &lt;p> *  服务实现类 * &lt;/p> * * @author jim * @since 2022-05-11 */</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">IEmployeeService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">EmployeeMapper</span> employeeMapper<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">MailLogMapper</span> mailLogMapper<span class="token punctuation">;</span>  <span class="token comment">// 添加员工并发送邮件</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">RespBean</span> <span class="token function">addEmp</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 处理合同期限（保留两位小数）</span>        <span class="token class-name">LocalDate</span> beginContract <span class="token operator">=</span> employee<span class="token punctuation">.</span><span class="token function">getBeginContract</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">LocalDate</span> endContract <span class="token operator">=</span> employee<span class="token punctuation">.</span><span class="token function">getEndContract</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> days <span class="token operator">=</span> beginContract<span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span>endContract<span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>DAYS<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">DecimalFormat</span> decimalFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"##.00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        employee<span class="token punctuation">.</span><span class="token function">setContractTerm</span><span class="token punctuation">(</span><span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>decimalFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>days<span class="token operator">/</span><span class="token number">365.00</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> employeeMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Employee</span> emp <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmployee</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 数据库中记录消息</span>            <span class="token class-name">String</span> msgId <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">MailLog</span> mailLog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MailLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setMsgId</span><span class="token punctuation">(</span>msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setEid</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setRouteKey</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_ROUTING_KEY_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setExchange</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_EXCHANGE_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setTryTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">plusMinutes</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MSG_TIMEOUT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setUpdateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLogMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>mailLog<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 发送信息</span>            rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_EXCHANGE_NAME<span class="token punctuation">,</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_ROUTING_KEY_NAME<span class="token punctuation">,</span>emp<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">CorrelationData</span><span class="token punctuation">(</span>msgId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token class-name">RespBean</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"添加成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token class-name">RespBean</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"添加失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>插入员工的同时，会生成一个邮件日志对象<code>MailLog</code>，并将该对象插入到数据库中，然后调用<code>rabbitTemplate.convertAndSend()</code>方法</font></p><p>👆<font size=2>仔细推敲一下这个方法的话，可以发现这并不是执行了一次‘发送’，而是执行了一次写入，这两者之间还是有些区别的；我给你“发送”一封邮件，你会收到这封邮件，但是我将一封邮件执行了一次“写入”，那么他还是在我本地的电脑中，并没有发给你。</font></p><p>👆<font size=2>至于这个邮件写入到了哪里了呢？那当然是 RabbitMQ 消息队列，关于 RabbitMQ 消息队列的详细信息可以查看<a href="https://www.rabbitmq.com/">官网</a>，下载安装可以查看<a href="https://blog.csdn.net/weixin_40584261/article/details/106826044">该博客</a>。由 RabbitMQ 消息队列收到了这封邮件的信息之后，消息会存储在消息队列中，随后通过其他的项目去监听 RabbitMQ 中的内容，只要消息队列里面有了新的消息，那么我就执行一次发送消息（这里使用的是<a href="#Java-Mail 关键代码">Java-Mail</a>）</font>。</p><p><a href="#0">回到顶部</a></p><h2 id="9.2">👇以下内容包含：RabbitMQ 监听，这里是一个与 yeb-server 同级的项目，运行端口是 8082</h2><p>🏀注意：这里是消息接收端，但是并不是“我接收你的消息”，而是“我接收 RabbitMQ 的消息”</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>mail</span><span class="token punctuation">;</span><span class="token comment">/** * @author Jim * @Description 接收邮件 * @createTime 2022年05月24日 */</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MailReceiver</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * author Jim     * 端口监听     */</span>    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_QUEUE_NAME<span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Message:"</span><span class="token operator">+</span>message<span class="token operator">+</span><span class="token string">"\nChannel"</span><span class="token operator">+</span>channel<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>这个方法其实很简单，（并不是原项目中的方法，我删除了大部分关于 Java-Mail 的，放在下面的部分），当 RabbitMQ 消息队列中有了新的消息的时候，<code>@RabbitListener</code>就会监听到，注意我们在上面些消息队列的时候，用的 queue 与此处监听的 queue 一定要一致，监听到消息后获取一个 message 以及一个channel，随后输出 message 与 channel。</p><p><a href="#0">回到顶部</a></p><p><br><br><br><br></p><h2 id="10">10.Java-Mail 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_QUEUE_NAME<span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Employee</span> employee <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> message<span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MailReceiver:  employee = "</span> <span class="token operator">+</span> employee<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">MessageHeaders</span> headers <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> tag <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">AmqpHeaders</span><span class="token punctuation">.</span>DELIVERY_TAG<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"tag = "</span> <span class="token operator">+</span> tag<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> msgId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"spring_returned_message_correlation"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"msgId = "</span> <span class="token operator">+</span> msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">HashOperations</span> hash <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>hash<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token string">"mail_log"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>msgId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">//redis中包含key，说明消息已经被消费</span>                logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"消息已经被消费========>&#123;&#125;"</span><span class="token punctuation">,</span> msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">/**                 * 手动确认消息                 * tag:消息序号                 * multiple:是否多条                 */</span>                channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">MimeMessage</span> msg <span class="token operator">=</span> javaMailSender<span class="token punctuation">.</span><span class="token function">createMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">MimeMessageHelper</span> helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessageHelper</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>mailProperties<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token string">"入职邮件"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setSentDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> employee<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span><span class="token string">"posName"</span><span class="token punctuation">,</span> employee<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span><span class="token string">"joblevelName"</span><span class="token punctuation">,</span> employee<span class="token punctuation">.</span><span class="token function">getJoblevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span><span class="token string">"departmentName"</span><span class="token punctuation">,</span> employee<span class="token punctuation">.</span><span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> mail <span class="token operator">=</span> templateEngine<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span><span class="token string">"mail"</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mail<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//发送邮件</span>            javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"邮件发送成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//将消息id存入redis</span>            hash<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"mail_log"</span><span class="token punctuation">,</span> msgId<span class="token punctuation">,</span> <span class="token string">"OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MailReceiver: redis---> msgId = "</span> <span class="token operator">+</span> msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//手动确认消息</span>            channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                channel<span class="token punctuation">.</span><span class="token function">basicNack</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ioException<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">//ioException.printStackTrace();</span>                logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"消息确认失败=====>&#123;&#125;"</span><span class="token punctuation">,</span> ioException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"MailReceiver + 邮件发送失败========&#123;&#125;"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><a href="#0">回到顶部</a></p><br><h2 id="10.1">@Scheduled 关键代码</h2><p>🪵 由于我们执行发送邮件的时候，不一定可以一次性发送成功，那该怎么办呢？我就不发了？那不太合适吧；我一直尝试发送，也不太合适，因此我们使用<code>@Scheduled</code>注解，让一个方法每隔一段时间扫描一次 MailLog 数据库表，如果里面有状态为‘正在发送’的，那就重新发送一次，如果超过三次都失败了，就将状态标记为‘发送失败’。</p><p><font color=darkgray size=2>为了简化阅读，这里将方法修改为：每隔十秒输出一次“我循环了…”,具体代码可以移步至<a href="https://github.com/Jimecc">我的 GitHub</a> 查看。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0/10 * * * * ?"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mailTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"我循环了...."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>🏀 <font color=red size=2>注意：要在 Main 方法的启动类上加入<code>@EnableScheduling</code>注解才可以。</font> 👇</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableScheduling</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YebApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">YebApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br><br></p><h2 id="11">11.JavaSecurity</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security<span class="token punctuation">.</span>component<span class="token punctuation">.</span></span><span class="token class-name">CustomFilter</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security<span class="token punctuation">.</span>component<span class="token punctuation">.</span></span><span class="token class-name">CustomUrlDecisionManager</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Admin</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IAdminService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ObjectPostProcessor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">AuthenticationManagerBuilder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">HttpSecurity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">WebSecurity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span></span><span class="token class-name">WebSecurityConfigurerAdapter</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>bcrypt<span class="token punctuation">.</span></span><span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>password<span class="token punctuation">.</span></span><span class="token class-name">PasswordEncoder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>web<span class="token punctuation">.</span>access<span class="token punctuation">.</span>intercept<span class="token punctuation">.</span></span><span class="token class-name">FilterSecurityInterceptor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>web<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">UsernamePasswordAuthenticationFilter</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">IAdminService</span> adminService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RestfulAccessDeniedHandler</span> restfulAccessDeniedHandler<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RestAuthorizationEntryPoint</span> restAuthorizationEntryPoint<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">CustomUrlDecisionManager</span> customUrlDecisionManager<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">CustomFilter</span> customFilter<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        auth<span class="token punctuation">.</span><span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">WebSecurity</span> web<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        web<span class="token punctuation">.</span><span class="token function">ignoring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span>                <span class="token string">"/login"</span><span class="token punctuation">,</span>                <span class="token string">"/logout"</span><span class="token punctuation">,</span>                <span class="token string">"/css/**"</span><span class="token punctuation">,</span>                <span class="token string">"/js/**"</span><span class="token punctuation">,</span>                <span class="token string">"/index.html"</span><span class="token punctuation">,</span>                <span class="token string">"favicon.ico"</span><span class="token punctuation">,</span>                <span class="token string">"/doc.html"</span><span class="token punctuation">,</span>                <span class="token string">"/webjars/**"</span><span class="token punctuation">,</span>                <span class="token string">"/swagger-resources/**"</span><span class="token punctuation">,</span>                <span class="token string">"/v2/api-docs/**"</span><span class="token punctuation">,</span>                <span class="token string">"/captcha"</span><span class="token punctuation">,</span>                <span class="token string">"/ws/**"</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span>  <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        http<span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">sessionManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">sessionCreationPolicy</span><span class="token punctuation">(</span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation">.</span>STATELESS<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment">// 所有的请求都要求认证</span>                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">withObjectPostProcessor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObjectPostProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FilterSecurityInterceptor</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token annotation punctuation">@Override</span>                    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">O</span> <span class="token keyword">extends</span> <span class="token class-name">FilterSecurityInterceptor</span><span class="token punctuation">></span></span> <span class="token class-name">O</span> <span class="token function">postProcess</span><span class="token punctuation">(</span><span class="token class-name">O</span> o<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        o<span class="token punctuation">.</span><span class="token function">setAccessDecisionManager</span><span class="token punctuation">(</span>customUrlDecisionManager<span class="token punctuation">)</span><span class="token punctuation">;</span>                        o<span class="token punctuation">.</span><span class="token function">setSecurityMetadataSource</span><span class="token punctuation">(</span>customFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">return</span> o<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">cacheControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        http<span class="token punctuation">.</span><span class="token function">addFilterBefore</span><span class="token punctuation">(</span><span class="token function">jwtAuthencationTokenFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">UsernamePasswordAuthenticationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        http<span class="token punctuation">.</span><span class="token function">exceptionHandling</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">accessDeniedHandler</span><span class="token punctuation">(</span>restfulAccessDeniedHandler<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">authenticationEntryPoint</span><span class="token punctuation">(</span>restAuthorizationEntryPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">UserDetailsService</span> <span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> username <span class="token operator">-></span><span class="token punctuation">&#123;</span>            <span class="token class-name">Admin</span> admin <span class="token operator">=</span> adminService<span class="token punctuation">.</span><span class="token function">getAdminByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">!=</span>admin<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                admin<span class="token punctuation">.</span><span class="token function">setRoles</span><span class="token punctuation">(</span>adminService<span class="token punctuation">.</span><span class="token function">getRoles</span><span class="token punctuation">(</span>admin<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> admin<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">(</span><span class="token string">"用户名或密码不正确"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">JwtAuthencationTokenFilter</span> <span class="token function">jwtAuthencationTokenFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JwtAuthencationTokenFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆配置文件：相关内容里可以查看注解。</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> userDetailsService<span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> userDetails <span class="token operator">||</span> <span class="token operator">!</span> passwordEncoder<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span>userDetails<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token class-name">RespBean</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"用户名或密码不正确"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>userDetails<span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token class-name">RespBean</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"账号被禁用，请联系管理员"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆以上是登录验证：通过 JavaSecurity 中的 UserDetails 来判断用户名与密码是否正确</p><p>🏀注意：PasswordEncoder 也是属于 JavaSecurity 中的一个类，主要用于加密。</p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="12">12.FastDFS 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>csource<span class="token punctuation">.</span>fastdfs<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ClassPathResource</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>multipart<span class="token punctuation">.</span></span><span class="token class-name">MultipartFile</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span><span class="token comment">/** * 文件上传工具类 * * @author zhanglishen * @since 1.0.0 */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FastDFSUtils</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">FastDFSUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> filePath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">"fdfs_client.conf"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">ClientGlobal</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"FastDFS Client Init Fail! "</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 上传文件     * @param file     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> filename <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"File Name :"</span> <span class="token operator">+</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> uploadResults <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token comment">//获取storage客户端</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            storageClient <span class="token operator">=</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//上传</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                uploadResults <span class="token operator">=</span> storageClient<span class="token punctuation">.</span><span class="token function">upload_file</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>filename<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>filename<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"IO Exception when uploadind the file:"</span> <span class="token operator">+</span> filename<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Non IO Exception when uploadind the file:"</span> <span class="token operator">+</span> filename<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"upload_file time used:"</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" ms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证上传结果</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>uploadResults <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> storageClient <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"upload file fail, error code:"</span> <span class="token operator">+</span> storageClient<span class="token punctuation">.</span><span class="token function">getErrorCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//上传成功返回groupName</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"upload file successfully!!!"</span> <span class="token operator">+</span> <span class="token string">"group_name:"</span> <span class="token operator">+</span> uploadResults<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">", remoteFileName:"</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> uploadResults<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> uploadResults<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 获取文件信息     * @param groupName     * @param remoteFileName     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">FileInfo</span> <span class="token function">getFileInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> groupName<span class="token punctuation">,</span><span class="token class-name">String</span> remoteFileName<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> storageClient<span class="token punctuation">.</span><span class="token function">get_file_info</span><span class="token punctuation">(</span>groupName<span class="token punctuation">,</span>remoteFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"IO Exception: Get File from Fast DFS failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Non IO Exception: Get File from Fast DFS failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 下载     * @param groupName     * @param remoteFileName     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">InputStream</span> <span class="token function">downFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> groupName<span class="token punctuation">,</span><span class="token class-name">String</span> remoteFileName<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> storageClient<span class="token punctuation">.</span><span class="token function">download_file</span><span class="token punctuation">(</span>groupName<span class="token punctuation">,</span> remoteFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> inputStream<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"IO Exception: Get File from Fast DFS failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Non IO Exception: Get File from Fast DFS failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 删除文件     * @param groupName     * @param remoteFileName     * @throws Exception     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deleteFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> groupName<span class="token punctuation">,</span><span class="token class-name">String</span> remoteFileName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> storageClient<span class="token punctuation">.</span><span class="token function">delete_file</span><span class="token punctuation">(</span>groupName<span class="token punctuation">,</span> remoteFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"delete file successfully!!!"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 生成Storage客户端     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">StorageClient</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TrackerServer</span> trackerServer <span class="token operator">=</span> <span class="token function">getTrackerServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StorageClient</span><span class="token punctuation">(</span>trackerServer<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> storageClient<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 生成Tracker服务器端     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">TrackerServer</span> <span class="token function">getTrackerServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TrackerClient</span> trackerClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrackerClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">TrackerServer</span> trackerServer <span class="token operator">=</span> trackerClient<span class="token punctuation">.</span><span class="token function">getTrackerServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> trackerServer<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 获取文件路径     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getTrackerUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">TrackerClient</span> trackerClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrackerClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">TrackerServer</span> trackerServer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">StorageServer</span> storageServer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            trackerServer <span class="token operator">=</span> trackerClient<span class="token punctuation">.</span><span class="token function">getTrackerServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            storageServer <span class="token operator">=</span> trackerClient<span class="token punctuation">.</span><span class="token function">getStoreStorage</span><span class="token punctuation">(</span>trackerServer<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token string">"http://"</span><span class="token operator">+</span>storageServer<span class="token punctuation">.</span><span class="token function">getInetSocketAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHostString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":8888/"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆就是一些简单的配置，主要功能为：上传、下载、删除文件；以及一些服务于这三个功能的方法。</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"更新用户头像"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/admin/userface"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">RespBean</span> <span class="token function">updateAdminUserFace</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span><span class="token class-name">Authentication</span> authentication<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> filePath <span class="token operator">=</span> <span class="token class-name">FastDFSUtils</span><span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token class-name">FastDFSUtils</span><span class="token punctuation">.</span><span class="token function">getTrackerUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>filePath<span class="token operator">+</span><span class="token string">"/"</span><span class="token operator">+</span>filePath<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> adminService<span class="token punctuation">.</span><span class="token function">updateAdminUserFace</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>id<span class="token punctuation">,</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆在AdminInfoController 中调用FastDFSUtils实现上传头像的功能。</p><p><a href="#0">回到顶部</a></p><p><br><br><br><br></p><h2 id="13">13.WebSocket 关键代码</h2><h2 id="13.1">配置文件</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">JwtTokenUtil</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span></span><span class="token class-name">Message</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span></span><span class="token class-name">MessageChannel</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>simp<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">ChannelRegistration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>simp<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">MessageBrokerRegistry</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>simp<span class="token punctuation">.</span>stomp<span class="token punctuation">.</span></span><span class="token class-name">StompCommand</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>simp<span class="token punctuation">.</span>stomp<span class="token punctuation">.</span></span><span class="token class-name">StompHeaderAccessor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ChannelInterceptor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">MessageHeaderAccessor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SecurityContextHolder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">EnableWebSocketMessageBroker</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">StompEndpointRegistry</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebSocketMessageBrokerConfigurer</span><span class="token punctuation">;</span><span class="token comment">/** * @author Jim * @Description WebSocket 配置类 * @createTime 2022年05月26日 */</span><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@EnableWebSocketMessageBroker</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSocketConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebSocketMessageBrokerConfigurer</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.tokenHead&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> tokenHead<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">JwtTokenUtil</span> jwtTokenUtil<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">UserDetailsService</span> userDetailsService<span class="token punctuation">;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 添加这个 EndPoint，这样可以在网页通过 websocket 连接上服务     * 也就是我们配置 websocket 服务复制，并且可以指定是否使用 socketJS     * @param registry     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerStompEndpoints</span><span class="token punctuation">(</span><span class="token class-name">StompEndpointRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/**         * 1.将 ws/ep路径注册为 stomp 的端点，用户链接了这个端点就可以进行 websocket 通讯，支持 socketJS         * 2.setAllowedOrigins("*")允许跨域         * wethSockJS() 支持 socketJS 访问         */</span>        registry<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">"/ws/ep"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAllowedOrigins</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withSockJS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 输入通道参数配置     * @param registration     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configureClientInboundChannel</span><span class="token punctuation">(</span><span class="token class-name">ChannelRegistration</span> registration<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        registration<span class="token punctuation">.</span><span class="token function">interceptors</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token class-name">Message</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">preSend</span><span class="token punctuation">(</span><span class="token class-name">Message</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> message<span class="token punctuation">,</span> <span class="token class-name">MessageChannel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">StompHeaderAccessor</span> accessor <span class="token operator">=</span> <span class="token class-name">MessageHeaderAccessor</span><span class="token punctuation">.</span><span class="token function">getAccessor</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token class-name">StompHeaderAccessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//判断是否为连接，如果是，需要获取token，并且设置用户对象</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StompCommand</span><span class="token punctuation">.</span>CONNECT<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>accessor<span class="token punctuation">.</span><span class="token function">getCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token class-name">String</span> token <span class="token operator">=</span> accessor<span class="token punctuation">.</span><span class="token function">getFirstNativeHeader</span><span class="token punctuation">(</span><span class="token string">"Auth-Token"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token class-name">String</span> authToken <span class="token operator">=</span> token<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>tokenHead<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token class-name">String</span> username <span class="token operator">=</span> jwtTokenUtil<span class="token punctuation">.</span><span class="token function">getUserNameFromToken</span><span class="token punctuation">(</span>authToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">//token中存在用户名</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                            <span class="token comment">//登录</span>                            <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> userDetailsService<span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token comment">//验证token是都有效</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span>jwtTokenUtil<span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>authToken<span class="token punctuation">,</span>userDetails<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                <span class="token class-name">UsernamePasswordAuthenticationToken</span> authenticationToken <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> userDetails<span class="token punctuation">.</span><span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authenticationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                                accessor<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span>authenticationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> message<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 配置消息代理     * @param registry     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configureMessageBroker</span><span class="token punctuation">(</span><span class="token class-name">MessageBrokerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 配置代理域，可以配置多个，配置代理的目的地前缀为/queue,可以在配置域上向客户端推送消息</span>        registry<span class="token punctuation">.</span><span class="token function">enableSimpleBroker</span><span class="token punctuation">(</span><span class="token string">"/queue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="13.2">实现聊天功能</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@MessageMapping</span><span class="token punctuation">(</span><span class="token string">"/ws/chat"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleMsg</span><span class="token punctuation">(</span><span class="token class-name">Authentication</span> authentication<span class="token punctuation">,</span> <span class="token class-name">ChatMsg</span> chatMsg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Admin</span> admin <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Admin</span><span class="token punctuation">)</span> authentication<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    chatMsg<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>admin<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    chatMsg<span class="token punctuation">.</span><span class="token function">setFromNickName</span><span class="token punctuation">(</span>admin<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    chatMsg<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    simpMessagingTemplate<span class="token punctuation">.</span><span class="token function">convertAndSendToUser</span><span class="token punctuation">(</span>chatMsg<span class="token punctuation">.</span><span class="token function">getTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"/queue/chat"</span><span class="token punctuation">,</span>chatMsg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆使用simpMessagingTemplate发送消息</p><h3 id="13.3">获取所有管理员（聊天列表）</h2><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">package com.jim.server.controller;import com.jim.server.pojo.Admin;import com.jim.server.service.IAdminService;import io.swagger.annotations.ApiOperation;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import java.util.List;&#x2F;** * @author Jim * @Description 可以跟谁聊天 * @createTime 2022年05月26日 *&#x2F;@RestController@RequestMapping(&quot;&#x2F;chat&quot;)public class ChatController &#123;    @Autowired    private IAdminService adminService;    @ApiOperation(value&#x3D;&quot;获取所有操作员&quot;)    @GetMapping(&quot;&#x2F;admin&quot;)    public List&lt;Admin&gt; getAllAdmins(String keywords)&#123;        return adminService.getAllAdmins(keywords);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><a href="#0">回到顶部</a></p><h1 id="前端跨域"><a href="#前端跨域" class="headerlink" title="前端跨域"></a>前端跨域</h1><p>由于项目前后端分离，前端必须要解决的一个问题便是跨域，否则前后端无法进行联调，因此在<a href="https://www.bilibili.com/video/BV1ff4y1M7XK?p=7&vd_source=32c908a2f8edcccb3fa042cf11b101bc">视频第七集</a>的位置说明了如何实现跨域，具体方法在视频中有介绍，简单描述就是：在 Vue 项目的根目录下创建一个 vue.config.js 文件 👉🏻 在里面配置 proxy 以及 target 目标地址；</p><p>这时候仅需要将 target改成 <code>http://110.40.191.51:8081</code>便可以以我的服务器为后端进行联调开发，具体实现效果如下：</p><img src="https://files.catbox.moe/xy2sry.png" style="width:90%" /><p>实现跨域的方式还有很多种，这是开发过程中比较方便的一种。</p><p><font color=red size=4>公益开放后端，请勿随便修改服务器数据（为了方便别人访问，改了请改回来哦）</p><p><a href="#0">回到顶部</a></p><h1 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h1><p>放一张我胖儿的帅照：</p><div style="text-align:center"><img  src="https://files.catbox.moe/q3ztct.png" style="width:50%;border-radius:1110px 1110px" /></div><p><a href="#0">回到顶部</a></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>代码阅读</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】云E办项目后端技术栈整合及代码阅读</title>
    <link href="/2022/06/17/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91yeb%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88for%20CSDN/"/>
    <url>/2022/06/17/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91yeb%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88for%20CSDN/</url>
    
    <content type="html"><![CDATA[<blockquote><p>项目来源：<a href="https://www.bilibili.com/video/BV1ff4y1M7XK?p=52&spm_id_from=333.880.my_history.page.click&vd_source=32c908a2f8edcccb3fa042cf11b101bc">Bilibili:带你从0搭建一个springboot+vue前后端分离的java项目</a></p><p>源码地址：<a href="https://github.com/Jimecc/yeb">https://github.com/Jimecc/yeb</a></p><p>本项目的后端部分我已经完整的部署在了我的个人服务器上，因此：</p><ul><li><p>Swagger2 接口文档：<a href="http://110.40.191.51:8081/doc.html">http://110.40.191.51:8081/doc.html</a></p></li><li><p>只想学前端的朋友可以将自己的前端跨域地址设置为<code>http://110.40.191.51:8081</code>，具体方法<a href="#前端跨域">点击此处</a></p></li></ul><p>开发环境：MacBook air 2020</p><ul><li>IDEA + WebStorm</li><li>MySQL 数据库</li></ul><p>服务器环境：腾讯云 CentOS 8.0</p><p>个人博客地址：<a href="http://jime.cc/">Jime.cc</a></p></blockquote><br><br><br><img src="https://files.catbox.moe/h5sru1.png" style="border:3px solid #9c938a;width:90%;border-radius:10px 100px 10px 0px"><div style="size:13px;text-align:center"><a>👆前端截图</a></div><img src="https://files.catbox.moe/lef8ig.png" style="width:90%;box-shadow: 10px 10px 10px rgba(.5,.5,.5,.5);-moz-box-shadow: 10px 10px 10px rgba(0,0,0,.5);-webkit-box-shadow: 10px 10px 10px rgba(0,0,0,.5);" /><div style="size:13px;text-align:center"><a>👆结构概述</a></div><h1 id="0">后端技术栈</h2><table><thead><tr><th>技术名称</th><th>作用</th><th>关键代码</th></tr></thead><tbody><tr><td>Springboot</td><td>整个后端项目的框架</td><td><a href="#1">跳转至关键代码</a></td></tr><tr><td>Lombok</td><td>用注解代替繁琐的操作、简化开发</td><td><a href="#2">跳转至关键代码</a></td></tr><tr><td>AutoGenerator</td><td>代码生成（数据库生成最基本的pojo、mapper、service、controller 文件）</td><td><a href="#3">跳转至关键代码</a></td></tr><tr><td>Swagger2</td><td>后端接口文档（多用于多人开发或前后端分离项目）</td><td><a href="#4">跳转至关键代码</a></td></tr><tr><td>JWT</td><td>生成（或刷新）token</td><td><a href="#5">跳转至关键代码</a></td></tr><tr><td>Kaptcha</td><td>谷歌的验证码生成器</td><td><a href="#6">跳转至关键代码</a></td></tr><tr><td>Redis</td><td>Menu 操作时，减少数据库吞吐量。</td><td><a href="#6">跳转至关键代码</a></td></tr><tr><td>EasyPOI</td><td>表格操作（导出员工信息/导入员工信息并添加到数据库）</td><td><a href="#7">跳转至关键代码</a></td></tr><tr><td>RabbitMQ</td><td>消息队列机制，我将需要处理的消息以队列的形式放入 RabbitMQ，随后再去读取。</td><td><a href="#8">跳转至关键代码</a></td></tr><tr><td>JavaMail</td><td>Java发送邮件。</td><td><a href="#9">跳转至关键代码</a></td></tr><tr><td>@Scheduled</td><td>这并不是一个技术栈，但是也准备讲一下。</td><td><a href="#10">跳转至关键代码</a></td></tr><tr><td>SpringSecurity</td><td>Springboot的安全技术，用于加密等。</td><td><a href="#11">跳转至关键代码</a></td></tr><tr><td>MyBatisPlus</td><td>这个属于最基础的技术了，这里不多写了。</td><td></td></tr><tr><td>FastDFS</td><td>一个文件管理系统，主要用于存储用户头像，其优点可以查看<a href="https://github.com/happyfish100/fastdfs">FastDFS官网</a></td><td><a href="#13">跳转至关键代码</a></td></tr><tr><td>WebSocket</td><td>服务器向客户端推送消息，一般都用于即时通讯工具（像是 QQ、微信、WhatsApp）</td><td><a href="#14">跳转至关键代码</a></td></tr></tbody></table><p><br><br><br></p><h2 id="1">1.Springboot 关键代码</h1><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YebApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">YebApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font color=darkgray size=2>可以说整个后端有很多地方都是 Springboot 的关键代码，因此我在这里只写了 Springboot 的启动类以及注解。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="2">2.Lombok 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font size=2>以上为 pom.xml 的 dependency </font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token annotation punctuation">@EqualsAndHashCode</span><span class="token punctuation">(</span>callSuper <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>of<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">"t_position"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"Position对象"</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Position</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span>AUTO<span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"职位"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"职位"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@NonNull</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"创建时间"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">"yyy-MM-dd"</span><span class="token punctuation">,</span>timezone<span class="token operator">=</span><span class="token string">"Asia/Shanghai"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> createDate<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"是否启用"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> enabled<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>在实体类（pojo/entity）中使用@Data 取代 setter/getter方法</font></p><p>👆<font size=2>使用 @NoArgsConstructor 与 @AllArgsConstructor 分别取代无参构造与全参构造函数。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AdminController</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"这是 info 日志信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"这是 warnning 日志信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"这是 error 日志信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>使用 @Slf4j 生成log 日志</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="3">3.AutoGenerator 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>generator</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span><span class="token class-name">MybatisPlusException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>toolkit<span class="token punctuation">.</span></span><span class="token class-name">StringPool</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>toolkit<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span></span><span class="token class-name">AutoGenerator</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span></span><span class="token class-name">InjectionConfig</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>config<span class="token punctuation">.</span>po<span class="token punctuation">.</span></span><span class="token class-name">TableInfo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>config<span class="token punctuation">.</span>rules<span class="token punctuation">.</span></span><span class="token class-name">NamingStrategy</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>engine<span class="token punctuation">.</span></span><span class="token class-name">FreemarkerTemplateEngine</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Scanner</span><span class="token punctuation">;</span><span class="token comment">// t_admin,t_admin_role,t_appraise,t_department,t_employee,t_employee_ec,t_employee_remove,t_employee_train,t_joblevel,t_mail_log,t_menu,t_menu_role,t_nation,t_oplog,t_politics_status,t_position,t_role,t_salary,t_salary_adjust,t_sys_msg,t_sys_msg_content</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CodeGenerator</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * &lt;p>     * 读取控制台内容     * &lt;/p>     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">scanner</span><span class="token punctuation">(</span><span class="token class-name">String</span> tip<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">StringBuilder</span> help <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        help<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"请输入"</span> <span class="token operator">+</span> tip <span class="token operator">+</span> <span class="token string">"："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>help<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>scanner<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> ipt <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>ipt<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> ipt<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MybatisPlusException</span><span class="token punctuation">(</span><span class="token string">"请输入正确的"</span> <span class="token operator">+</span> tip <span class="token operator">+</span> <span class="token string">"！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 代码生成器</span>        <span class="token class-name">AutoGenerator</span> mpg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AutoGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 全局配置</span>        <span class="token class-name">GlobalConfig</span> gc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GlobalConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token class-name">String</span> projectPath <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.dir"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        gc<span class="token punctuation">.</span><span class="token function">setOutputDir</span><span class="token punctuation">(</span>projectPath <span class="token operator">+</span> <span class="token string">"/yeb-server/src/main/java"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        gc<span class="token punctuation">.</span><span class="token function">setAuthor</span><span class="token punctuation">(</span><span class="token string">"jim"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//作者</span>        gc<span class="token punctuation">.</span><span class="token function">setOpen</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//是否打开目录</span>        gc<span class="token punctuation">.</span><span class="token function">setBaseResultMap</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//xml开启BaseResultMap</span>        gc<span class="token punctuation">.</span><span class="token function">setBaseColumnList</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//xml 开启BaseColumn</span>        gc<span class="token punctuation">.</span><span class="token function">setSwagger2</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//实体属性 Swagger2 注解</span>        mpg<span class="token punctuation">.</span><span class="token function">setGlobalConfig</span><span class="token punctuation">(</span>gc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 数据源配置</span>        <span class="token class-name">DataSourceConfig</span> dsc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dsc<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://127.0.0.1:3306/yeb?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// dsc.setSchemaName("public");</span>        dsc<span class="token punctuation">.</span><span class="token function">setDriverName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dsc<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dsc<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"12345ioS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dsc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 包配置</span>        <span class="token keyword">final</span> <span class="token class-name">PackageConfig</span> pc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PackageConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//pc.setModuleName(scanner("模块名"));</span>        pc<span class="token punctuation">.</span><span class="token function">setParent</span><span class="token punctuation">(</span><span class="token string">"com.jim.server"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setEntity</span><span class="token punctuation">(</span><span class="token string">"pojo"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setMapper</span><span class="token punctuation">(</span><span class="token string">"mapper"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setService</span><span class="token punctuation">(</span><span class="token string">"service"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setServiceImpl</span><span class="token punctuation">(</span><span class="token string">"service.impl"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setController</span><span class="token punctuation">(</span><span class="token string">"controller"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setPackageInfo</span><span class="token punctuation">(</span>pc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 自定义配置</span>        <span class="token class-name">InjectionConfig</span> cfg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InjectionConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// to do nothing</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token comment">// 如果模板引擎是 freemarker</span>        <span class="token class-name">String</span> templatePath <span class="token operator">=</span> <span class="token string">"/templates/mapper.xml.ftl"</span><span class="token punctuation">;</span>        <span class="token comment">// 如果模板引擎是 velocity</span>        <span class="token comment">// String templatePath = "/templates/mapper.xml.vm";</span>        <span class="token comment">// 自定义输出配置</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FileOutConfig</span><span class="token punctuation">></span></span> focList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 自定义配置会被优先输出</span>        focList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutConfig</span><span class="token punctuation">(</span>templatePath<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">outputFile</span><span class="token punctuation">(</span><span class="token class-name">TableInfo</span> tableInfo<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// 自定义输出文件名 ， 如果你 Entity 设置了前后缀、此处注意 xml 的名称会跟着发生变化！！</span>                <span class="token keyword">return</span> projectPath <span class="token operator">+</span> <span class="token string">"/yeb-server/src/main/resources/mapper/"</span> <span class="token operator">+</span> pc<span class="token punctuation">.</span><span class="token function">getModuleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> tableInfo<span class="token punctuation">.</span><span class="token function">getEntityName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"Mapper"</span> <span class="token operator">+</span> <span class="token class-name">StringPool</span><span class="token punctuation">.</span>DOT_XML<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/*        cfg.setFileCreate(new IFileCreate() &#123;            @Override            public boolean isCreate(ConfigBuilder configBuilder, FileType fileType, String filePath) &#123;                // 判断自定义文件夹是否需要创建                checkDir("调用默认方法创建的目录，自定义目录用");                if (fileType == FileType.MAPPER) &#123;                    // 已经生成 mapper 文件判断存在，不想重新生成返回 false                    return !new File(filePath).exists();                &#125;                // 允许生成模板文件                return true;            &#125;        &#125;);        */</span>        cfg<span class="token punctuation">.</span><span class="token function">setFileOutConfigList</span><span class="token punctuation">(</span>focList<span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setCfg</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 配置模板</span>        <span class="token class-name">TemplateConfig</span> templateConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TemplateConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 配置自定义输出模板</span>        <span class="token comment">//指定自定义模板路径，注意不要带上.ftl/.vm, 会根据使用的模板引擎自动识别</span>        <span class="token comment">// templateConfig.setEntity("templates/entity2.java");</span>        <span class="token comment">// templateConfig.setService();</span>        <span class="token comment">// templateConfig.setController();</span>        templateConfig<span class="token punctuation">.</span><span class="token function">setXml</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setTemplate</span><span class="token punctuation">(</span>templateConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 策略配置</span>        <span class="token class-name">StrategyConfig</span> strategy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StrategyConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//数据库表映射到实体的命名策略</span>        strategy<span class="token punctuation">.</span><span class="token function">setNaming</span><span class="token punctuation">(</span><span class="token class-name">NamingStrategy</span><span class="token punctuation">.</span>underline_to_camel<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//数据库表字段映射到实体的命名策略</span>        strategy<span class="token punctuation">.</span><span class="token function">setColumnNaming</span><span class="token punctuation">(</span><span class="token class-name">NamingStrategy</span><span class="token punctuation">.</span>no_change<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//strategy.setSuperEntityClass("你自己的父类实体,没有就不用设置!");</span>        <span class="token comment">//lombok模型</span>        strategy<span class="token punctuation">.</span><span class="token function">setEntityLombokModel</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//生成RestController</span>        strategy<span class="token punctuation">.</span><span class="token function">setRestControllerStyle</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 公共父类</span>        <span class="token comment">//strategy.setSuperControllerClass("你自己的父类控制器,没有就不用设置!");</span>        <span class="token comment">// 写于父类中的公共字段</span>        <span class="token comment">//strategy.setSuperEntityColumns("id");</span>        strategy<span class="token punctuation">.</span><span class="token function">setInclude</span><span class="token punctuation">(</span><span class="token function">scanner</span><span class="token punctuation">(</span><span class="token string">"表名，多个英文逗号分割"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        strategy<span class="token punctuation">.</span><span class="token function">setControllerMappingHyphenStyle</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//表前缀</span>        strategy<span class="token punctuation">.</span><span class="token function">setTablePrefix</span><span class="token punctuation">(</span><span class="token string">"t_"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span>strategy<span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">setTemplateEngine</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FreemarkerTemplateEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mpg<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>这段代码中有独立的 main 函数，可以直接运行此类，运行后在控制台输入数据库表名称，可以直接生成<code>mapper、service、controller、pojo 类</code>，节省无效开发的时间。（本技术使用的是 MyBatis-Plus 的代码自动生成器，具体可以去 MyBatis-Plus 官网查看）</font></p><p>👆<font size=2>代码自动生成在项目中为一个单独的子项目，创建方式：在父项目中创建相一个Maven 项目，然后关联父项目。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="4">4.Swagger2 效果/关键代码</h2><img src="https://files.catbox.moe/kqquye.png" title="pojo 对象" style="width:90%" /><div style="size:2;text-align:center"><a>👆Swagger 对 pojo 的展示</a></div><img src="https://files.catbox.moe/acui25.png"  style="width:90%"  /><div style="size:13px;text-align:center"><a>👆Swagger 对 Controller 接口的展示</a></div><p>🏀 <font size=2>具体操作可以访问<a href="http://110.40.191.51:8081/doc.html">-YebSwagger接口文档-</a>自行尝试</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Swagger2 配置文件</span><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">ApiInfoBuilder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">PathSelectors</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">RequestHandlerSelectors</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>spi<span class="token punctuation">.</span></span><span class="token class-name">DocumentationType</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>service<span class="token punctuation">.</span>contexts<span class="token punctuation">.</span></span><span class="token class-name">SecurityContext</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>web<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span></span><span class="token class-name">Docket</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">springfox<span class="token punctuation">.</span>documentation<span class="token punctuation">.</span>swagger2<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">EnableSwagger2</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@EnableSwagger2</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Swagger2Config</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Docket</span> <span class="token function">createRestApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Docket</span><span class="token punctuation">(</span><span class="token class-name">DocumentationType</span><span class="token punctuation">.</span>SWAGGER_2<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">apis</span><span class="token punctuation">(</span><span class="token class-name">RequestHandlerSelectors</span><span class="token punctuation">.</span><span class="token function">basePackage</span><span class="token punctuation">(</span><span class="token string">"com.jim.server.controller"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">paths</span><span class="token punctuation">(</span><span class="token class-name">PathSelectors</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">securityContexts</span><span class="token punctuation">(</span><span class="token function">securityContexts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">securitySchemes</span><span class="token punctuation">(</span><span class="token function">securitySchemes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">ApiInfo</span> <span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ApiInfoBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"云E办接口文档"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">"云E办接口文档"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">contact</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Contact</span><span class="token punctuation">(</span><span class="token string">"Jim"</span><span class="token punctuation">,</span><span class="token string">"http://localhost:8081/doc.html"</span><span class="token punctuation">,</span><span class="token string">"1234@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token string">"1.0"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApiKey</span><span class="token punctuation">></span></span> <span class="token function">securitySchemes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 设置请求头信息</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApiKey</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ApiKey</span> apiKey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApiKey</span><span class="token punctuation">(</span><span class="token string">"Authorization"</span><span class="token punctuation">,</span><span class="token string">"Authorization"</span><span class="token punctuation">,</span><span class="token string">"Header"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>apiKey<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityContext</span><span class="token punctuation">></span></span> <span class="token function">securityContexts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 设置需要登录认证的路程</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityContext</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">getContextByPath</span><span class="token punctuation">(</span><span class="token string">"/hello/.*"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">SecurityContext</span> <span class="token function">getContextByPath</span><span class="token punctuation">(</span><span class="token class-name">String</span> pathRegex<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">SecurityContext</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">securityReferences</span><span class="token punctuation">(</span><span class="token function">defaultAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">forPaths</span><span class="token punctuation">(</span><span class="token class-name">PathSelectors</span><span class="token punctuation">.</span><span class="token function">regex</span><span class="token punctuation">(</span>pathRegex<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityReference</span><span class="token punctuation">></span></span> <span class="token function">defaultAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityReference</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">AuthorizationScope</span> authorizationScope <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthorizationScope</span><span class="token punctuation">(</span><span class="token string">"global"</span><span class="token punctuation">,</span><span class="token string">"accessEverything"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">AuthorizationScope</span><span class="token punctuation">[</span><span class="token punctuation">]</span> authorizationScopes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthorizationScope</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        authorizationScopes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> authorizationScope<span class="token punctuation">;</span>        result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SecurityReference</span><span class="token punctuation">(</span><span class="token string">"Authorization"</span><span class="token punctuation">,</span>authorizationScopes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/admin"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AdminController</span> <span class="token punctuation">&#123;</span>      <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"获取所有操作员"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Admin</span><span class="token punctuation">></span></span> <span class="token function">getAllAdmins</span><span class="token punctuation">(</span><span class="token class-name">String</span> keywords<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> adminService<span class="token punctuation">.</span><span class="token function">getAllAdmins</span><span class="token punctuation">(</span>keywords<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>在 Controller 层使用 <code>@ApiOperation(value = &quot;名称&quot;</code>) 对接口进行命名，名称为“名称”，可以在接口文档查看的时候看到此名称，如果不写则以方法名称为默认名称（类上也可以用@Api(value=”名称”)</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"Admin对象"</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Admin</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">,</span> <span class="token class-name">UserDetails</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>在 pojo 类中使用<code>@ApiModel</code> 注解让 Swagger 知道当前内容是一个对象类，<code>value</code>为接口文档中显示的名称，<code>description</code>为接口文档中显示的简介。</font></p><p><font size=2>👆在成员属性中用<code>@ApiModelProperty(value = &quot;id&quot;)</code>注释描述属性的名字。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="5">5.JWT 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtTokenUtil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CLAIM_KEY_USERNAME <span class="token operator">=</span> <span class="token string">"sub"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CLAIM_KEY_CREATED <span class="token operator">=</span> <span class="token string">"created"</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.secret&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> secret<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.expiration&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Long</span> expiration<span class="token punctuation">;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 根据用户信息生成 TOKEN     * @Params:  public     */</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">generateToken</span><span class="token punctuation">(</span><span class="token class-name">UserDetails</span> userDetails<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> claims <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        claims<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>CLAIM_KEY_USERNAME<span class="token punctuation">,</span>userDetails<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        claims<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>CLAIM_KEY_CREATED<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>claims<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">generateToken</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 从 token 中获取登录用户名     * @Params:      */</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUserNameFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> username<span class="token punctuation">;</span>        <span class="token comment">// 根据 token 拿一个荷载</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token function">getClaimsFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>            username <span class="token operator">=</span> claims<span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            username <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> username<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 判断 token 是否有效     * @Params:     */</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">validateToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">,</span><span class="token class-name">UserDetails</span> userDetails<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token function">getUserNameFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> username<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span> <span class="token function">isTokenExpired</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 判断 token 是否可以刷新     * @Params:     */</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canRefresh</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">isTokenExpired</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 刷新 token     * @Params:     */</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">refreshToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token function">getClaimsFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>        claims<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>CLAIM_KEY_CREATED<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">generateToken</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 判断 token 是否失效     * @Params:     */</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isTokenExpired</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Date</span> expireDate <span class="token operator">=</span> <span class="token function">getExpiredDateFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> expireDate<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 从 token 中获取过期时间     * @Params:     */</span>    <span class="token keyword">private</span> <span class="token class-name">Date</span> <span class="token function">getExpiredDateFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token function">getClaimsFromToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> claims<span class="token punctuation">.</span><span class="token function">getExpiration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 从 token 中获取荷载     * @Params:     */</span>    <span class="token keyword">private</span> <span class="token class-name">Claims</span> <span class="token function">getClaimsFromToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            claims <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> claims<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 根据荷载生成 JWT TOKEN     * @Params:      */</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">generateToken</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> claims<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setClaims</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setExpiration</span><span class="token punctuation">(</span><span class="token function">generateExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">signWith</span><span class="token punctuation">(</span><span class="token class-name">SignatureAlgorithm</span><span class="token punctuation">.</span>HS512<span class="token punctuation">,</span>secret<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 生成 TOKEN 失效时间     * @Params:     */</span>    <span class="token keyword">private</span> <span class="token class-name">Date</span> <span class="token function">generateExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>expiration<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>该类为 JWT 的一个基本方法类，主要使用<code>Jwts.builder()</code>生成一个 token，token 中包含一个用户名与创建时间，后续，前端访问后会将该 token 存储在 windows.session 中（也就是 httpsession)中，每次访问后端都会携带该 session，后端得到 session 也就得到了 token，可以解析出 username 与 Date，以此来判断该用户是否登录、登录是否过期。</font></p><p>👆<font size=2>顺便一提，退出登录后端不进行任何操作，仅返回一个成功码200，前端得到成功码后删除前端存储的 session 就可以了，再次使用就会提醒你要登录了。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SecurityContextHolder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>web<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">WebAuthenticationDetailsSource</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span></span><span class="token class-name">OncePerRequestFilter</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">FilterChain</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtAuthencationTokenFilter</span> <span class="token keyword">extends</span> <span class="token class-name">OncePerRequestFilter</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.tokenHeader&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> tokenHeader<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.tokenHead&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> tokenHead<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">JwtTokenUtil</span> jwtTokenUtil<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">UserDetailsService</span> userDetailsService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doFilterInternal</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> authHeader <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span>tokenHeader<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 存在 token</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> authHeader <span class="token operator">&amp;&amp;</span> authHeader<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>tokenHead<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> authToken <span class="token operator">=</span> authHeader<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>tokenHead<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> username <span class="token operator">=</span> jwtTokenUtil<span class="token punctuation">.</span><span class="token function">getUserNameFromToken</span><span class="token punctuation">(</span>authToken<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// token 存在用户名但是未登录</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> username <span class="token operator">&amp;&amp;</span> <span class="token keyword">null</span> <span class="token operator">==</span> <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> userDetailsService<span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>jwtTokenUtil<span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>authToken<span class="token punctuation">,</span>userDetails<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token class-name">UsernamePasswordAuthenticationToken</span> authenticationToken <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span>userDetails<span class="token punctuation">.</span><span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    authenticationToken<span class="token punctuation">.</span><span class="token function">setDetails</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WebAuthenticationDetailsSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">buildDetails</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authenticationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>🏀<font size=2>还用到了一些相关的过滤器，可以下载源码后查看。</font></p><hr><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="6">6.Kaptcha 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>code<span class="token punctuation">.</span>kaptcha<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">DefaultKaptcha</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>code<span class="token punctuation">.</span>kaptcha<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span><span class="token punctuation">;</span><span class="token comment">/** * 验证码配置类 * @author Jim * @since 1.0.0 */</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CaptchaConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">DefaultKaptcha</span> <span class="token function">defaultKaptcha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//验证码生成器</span>        <span class="token class-name">DefaultKaptcha</span> defaultKaptcha <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultKaptcha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//配置</span>        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//是否有边框</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.border"</span><span class="token punctuation">,</span> <span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//设置边框颜色</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.border.color"</span><span class="token punctuation">,</span> <span class="token string">"105,179,90"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//边框粗细度，默认为1</span>        <span class="token comment">// properties.setProperty("kaptcha.border.thickness","1");</span>        <span class="token comment">//验证码</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.session.key"</span><span class="token punctuation">,</span><span class="token string">"code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证码文本字符颜色 默认为黑色</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.font.color"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//设置字体样式</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.font.names"</span><span class="token punctuation">,</span> <span class="token string">"宋体,楷体,微软雅黑"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//字体大小，默认40</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.font.size"</span><span class="token punctuation">,</span> <span class="token string">"30"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证码文本字符内容范围 默认为abced2345678gfynmnpwx</span>        <span class="token comment">// properties.setProperty("kaptcha.textproducer.char.string", "");</span>        <span class="token comment">//字符长度，默认为5</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.char.length"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//字符间距 默认为2</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.textproducer.char.space"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证码图片宽度 默认为200</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.image.width"</span><span class="token punctuation">,</span> <span class="token string">"100"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证码图片高度 默认为40</span>        properties<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"kaptcha.image.height"</span><span class="token punctuation">,</span> <span class="token string">"40"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>        defaultKaptcha<span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> defaultKaptcha<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>以上为 <code>Kaptcha</code> 的配置类，主要操作为创建一个<code>DefaultKaptcha</code>对象，并对对象进行配置。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>code<span class="token punctuation">.</span>kaptcha<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">DefaultKaptcha</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiOperation</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>imageio<span class="token punctuation">.</span></span><span class="token class-name">ImageIO</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletOutputStream</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>image<span class="token punctuation">.</span></span><span class="token class-name">BufferedImage</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token comment">/** * 验证码 * * @author zhoubin * @since 1.0.0 */</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CaptchaController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">DefaultKaptcha</span> defaultKaptcha<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"验证码"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/captcha"</span><span class="token punctuation">,</span>produces <span class="token operator">=</span> <span class="token string">"image/jpeg"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">captcha</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 定义response输出类型为image/jpeg类型</span>        response<span class="token punctuation">.</span><span class="token function">setDateHeader</span><span class="token punctuation">(</span><span class="token string">"Expires"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Set standard HTTP/1.1 no-cache headers.</span>        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Cache-Control"</span><span class="token punctuation">,</span> <span class="token string">"no-store, no-cache, must-revalidate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Set IE extended HTTP/1.1 no-cache headers (use addHeader).</span>        response<span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span><span class="token string">"Cache-Control"</span><span class="token punctuation">,</span> <span class="token string">"post-check=0, pre-check=0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Set standard HTTP/1.0 no-cache header.</span>        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Pragma"</span><span class="token punctuation">,</span> <span class="token string">"no-cache"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// return a jpeg</span>        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"image/jpeg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//-------------------生成验证码 begin --------------------------</span>        <span class="token comment">//获取验证码文本内容</span>        <span class="token class-name">String</span> text <span class="token operator">=</span> defaultKaptcha<span class="token punctuation">.</span><span class="token function">createText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"验证码内容："</span><span class="token operator">+</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//将验证码文本内容放入session</span>        request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"captcha"</span><span class="token punctuation">,</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//根据文本验证码内容创建图形验证码</span>        <span class="token class-name">BufferedImage</span> image <span class="token operator">=</span> defaultKaptcha<span class="token punctuation">.</span><span class="token function">createImage</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ServletOutputStream</span> outputStream <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            outputStream <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//输出流输出图片，格式为jpg</span>            <span class="token class-name">ImageIO</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span><span class="token string">"jpg"</span><span class="token punctuation">,</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>            outputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">!=</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    outputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//-------------------生成验证码 end --------------------------</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>Controller 获取一个验证码。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">RespBean</span> login <span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">AdminLoginParam</span> adminLoginParam<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> adminService<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>adminLoginParam<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>adminLoginParam<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>adminLoginParam<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>登录接口，验证用户名、密码、验证码。</font></p><p>🏀<font size=2>请注意，当两个用户同时登录的时候，后端会生成两个验证码，那么是不是我若是乱输入，输了其他用户的验证码也会生效呢？这当然是不可能的，如何判断 A 输入的验证码就是后台为 A 生成的验证码（而不是为其他用户生成的验证码）呢？其实在获取验证码的时候，并不是单纯地仅返回了一个图片，而是将验证码的内容放在了HttpServletRequest中，登陆的时候，会带着HttpServletRequest再回来，这样就可以确定该用户的验证码是多少，执行登录的时候，则会判断 request 中的验证码与用户输入的验证码是否一致，具体可以下载源码后查看 LoginService。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="7">7.Redis 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span></span><span class="token class-name">LettuceConnectionFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token class-name">StringRedisSerializer</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">LettuceConnectionFactory</span> connectionFactory<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> template<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>配置 Redis</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>toolkit<span class="token punctuation">.</span></span><span class="token class-name">CollectionUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">ServiceImpl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">AdminUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">MenuMapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Menu</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IMenuService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">ValueOperations</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token comment">/** * &lt;p> *  服务实现类 * &lt;/p> * * @author jim * @since 2022-05-11 */</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MenuServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MenuMapper</span><span class="token punctuation">,</span> <span class="token class-name">Menu</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">IMenuService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">MenuMapper</span> menuMapper<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span> redisTemplate<span class="token punctuation">;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 根据用户id 查询菜单列表     * @Params:     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> <span class="token function">getMenuByAdminId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Integer</span> adminId <span class="token operator">=</span> <span class="token class-name">AdminUtils</span><span class="token punctuation">.</span><span class="token function">getCurrentAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> valueOperations <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span> menus <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">></span></span><span class="token punctuation">)</span> valueOperations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"menu_"</span><span class="token operator">+</span>adminId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>menus<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            menus <span class="token operator">=</span> menuMapper<span class="token punctuation">.</span><span class="token function">getMenusByAdminId</span><span class="token punctuation">(</span>adminId<span class="token punctuation">)</span><span class="token punctuation">;</span>            valueOperations<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"menu_"</span><span class="token operator">+</span>adminId<span class="token punctuation">,</span>menus<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> menus<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>用户登录后会获取 menu 菜单，为了防止反复渲染造成数据库吞吐量较大，因此每次用户获取 menu 时会现在 Redis 中寻找<code>&quot;menu_&quot;+adminId</code>如果有则直接从 Redis 中获取，否则就从数据库中读取并存储在 Redis 中，存储名称依旧是<code>&quot;menu_&quot;+adminId</code>（得做到一致嘛，不然存储和读取不一致，你怎么存都读取不到）。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="8">8.EasyPOI 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>cn.afterturn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>easypoi-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.1.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>Maven 依赖</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>afterturn<span class="token punctuation">.</span>easypoi<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Excel</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>afterturn<span class="token punctuation">.</span>easypoi<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExcelEntity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">IdType</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableField</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableId</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableName</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">JsonFormat</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiModel</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiModelProperty</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">EqualsAndHashCode</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span></span><span class="token class-name">Accessors</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDate</span><span class="token punctuation">;</span><span class="token comment">/** * &lt;p> *  * &lt;/p> * * @author jim * @since 2022-05-11 */</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@EqualsAndHashCode</span><span class="token punctuation">(</span>callSuper <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Accessors</span><span class="token punctuation">(</span>chain <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">"t_employee"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"Employee对象"</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"员工编号"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span>AUTO<span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"员工姓名"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"员工姓名"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>  <span class="token comment">// 为了方便阅读，这里省略了很多代码（注解都跟【员工姓名】是一样的）</span>       <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"民族"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>exist <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@ExcelEntity</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"民族"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Nation</span> nation<span class="token punctuation">;</span>    <span class="token comment">// 为了方便阅读，这里省略了很多代码（注解都跟【民族】是一样的）</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"工资账套"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>exist <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Salary</span> salary<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>为了方便阅读，具体注解看下方表格</font></p><table><thead><tr><th>注解</th><th>用途</th><th>使用位置</th><th>备注</th></tr></thead><tbody><tr><td>@TableName(“t_employee”)</td><td>对应哪一张数据库表</td><td>类</td><td></td></tr><tr><td>@Excel(name=”工龄”)</td><td>导入导出时纵坐标的标题名字（也就是“姓名、年龄”那一些东西）</td><td>成员属性</td><td></td></tr><tr><td>@TableField(exist = false)</td><td>数据库中不存在，是其他的实体类。</td><td>成员属性</td><td></td></tr><tr><td>@ExcelEntity(name=”职位”)</td><td>与<code>@Excel</code>一样，但是这个用于注释数据库中没有，该 pojo 中引用了其他的 pojo 类。</td><td>成员属性</td><td></td></tr></tbody></table><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token annotation punctuation">@EqualsAndHashCode</span><span class="token punctuation">(</span>callSuper <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>of <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">"t_nation"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"Nation对象"</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Nation</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span>AUTO<span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"民族"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"民族"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@NonNull</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>🏀<font size=2><font color=red>注意：</font>可以看到，由于Employee 数据库表中并没有Nation但是导出的时候有需要用到 <code>Nation.name</code>因此，在 Employee 的成员属性 Nation 中并不是<code>@Excel</code>而是<code>@ExcelEntity</code>，然后再在 Nation 类中的 name 上写一下<code>@Excel</code>，这样执行导入导出的时候，读取到 Nation 时，就会去寻找 Nation 这个 pojo 类，然后再在 Nation 中找<code>@Excel</code>下的成员方法。</font></p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="9">9.RabbitMQ 关键代码</h2><h2 id="9.1">消息发送端</h2><p>🏀注意：这里的“消息发送”并不是指 “我给你发送一个消息”，而是“我给 RabbitMQ 消息队列发送一个消息”。</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>update<span class="token punctuation">.</span></span><span class="token class-name">UpdateWrapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">MailConstants</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">MailLog</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IMailLogService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Binding</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">BindingBuilder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">DirectExchange</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Queue</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>connection<span class="token punctuation">.</span></span><span class="token class-name">CachingConnectionFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RabbitTemplate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token comment">/** * @author Jim * @Description rabbitmq配置 * @createTime 2022年05月24日 */</span><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMQConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">CachingConnectionFactory</span> cachingConnectionFactory<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">IMailLogService</span> mailLogService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">RabbitTemplate</span> <span class="token function">rabbitTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">RabbitTemplate</span> rabbitTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RabbitTemplate</span><span class="token punctuation">(</span>cachingConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/**         * 消息确认毁掉，确认消息是否到达 borker         * data: 消息唯一标识         * ack： 确认结果         * cause：失败原因          */</span>        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setConfirmCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>ack<span class="token punctuation">,</span>cause<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> msgId <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>ack<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"suc1-- &#123;&#125;========>消息发送成功"</span><span class="token punctuation">,</span>msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>                mailLogService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UpdateWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MailLog</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">"msgId"</span><span class="token punctuation">,</span>msgId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"err1-- &#123;&#125;========>消息发送失败"</span><span class="token punctuation">,</span>msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/**         * 消息失败回调         * msg： 消息主题         * repCode：响应码         * repText：响应文本         * exchange：交换机         * routingkey：路由键         */</span>        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setReturnCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span>repCode<span class="token punctuation">,</span>repText<span class="token punctuation">,</span>exchange<span class="token punctuation">,</span>routingkey<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"err2-- &#123;&#125;========>消息发送queue时失败"</span><span class="token punctuation">,</span>msg<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> rabbitTemplate<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_QUEUE_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">DirectExchange</span> <span class="token function">directExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DirectExchange</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_EXCHANGE_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">binding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token function">queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token function">directExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_ROUTING_KEY_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>以上内容为RabbitMQ 的配置文件</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">QueryWrapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span></span><span class="token class-name">IPage</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>pagination<span class="token punctuation">.</span></span><span class="token class-name">Page</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">ServiceImpl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">MailLogMapper</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IEmployeeService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>connection<span class="token punctuation">.</span></span><span class="token class-name">CorrelationData</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RabbitTemplate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">DecimalFormat</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDate</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDateTime</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span>temporal<span class="token punctuation">.</span></span><span class="token class-name">ChronoUnit</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>UUID<span class="token punctuation">;</span><span class="token comment">/** * &lt;p> *  服务实现类 * &lt;/p> * * @author jim * @since 2022-05-11 */</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">IEmployeeService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">EmployeeMapper</span> employeeMapper<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">MailLogMapper</span> mailLogMapper<span class="token punctuation">;</span>  <span class="token comment">// 添加员工并发送邮件</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">RespBean</span> <span class="token function">addEmp</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 处理合同期限（保留两位小数）</span>        <span class="token class-name">LocalDate</span> beginContract <span class="token operator">=</span> employee<span class="token punctuation">.</span><span class="token function">getBeginContract</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">LocalDate</span> endContract <span class="token operator">=</span> employee<span class="token punctuation">.</span><span class="token function">getEndContract</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> days <span class="token operator">=</span> beginContract<span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span>endContract<span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>DAYS<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">DecimalFormat</span> decimalFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"##.00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        employee<span class="token punctuation">.</span><span class="token function">setContractTerm</span><span class="token punctuation">(</span><span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>decimalFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>days<span class="token operator">/</span><span class="token number">365.00</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> employeeMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Employee</span> emp <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmployee</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 数据库中记录消息</span>            <span class="token class-name">String</span> msgId <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">MailLog</span> mailLog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MailLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setMsgId</span><span class="token punctuation">(</span>msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setEid</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setRouteKey</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_ROUTING_KEY_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setExchange</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_EXCHANGE_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setTryTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">plusMinutes</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MSG_TIMEOUT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLog<span class="token punctuation">.</span><span class="token function">setUpdateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mailLogMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>mailLog<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 发送信息</span>            rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_EXCHANGE_NAME<span class="token punctuation">,</span><span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_ROUTING_KEY_NAME<span class="token punctuation">,</span>emp<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">CorrelationData</span><span class="token punctuation">(</span>msgId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token class-name">RespBean</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"添加成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token class-name">RespBean</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"添加失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>插入员工的同时，会生成一个邮件日志对象<code>MailLog</code>，并将该对象插入到数据库中，然后调用<code>rabbitTemplate.convertAndSend()</code>方法</font></p><p>👆<font size=2>仔细推敲一下这个方法的话，可以发现这并不是执行了一次‘发送’，而是执行了一次写入，这两者之间还是有些区别的；我给你“发送”一封邮件，你会收到这封邮件，但是我将一封邮件执行了一次“写入”，那么他还是在我本地的电脑中，并没有发给你。</font></p><p>👆<font size=2>至于这个邮件写入到了哪里了呢？那当然是 RabbitMQ 消息队列，关于 RabbitMQ 消息队列的详细信息可以查看<a href="https://www.rabbitmq.com/">官网</a>，下载安装可以查看<a href="https://blog.csdn.net/weixin_40584261/article/details/106826044">该博客</a>。由 RabbitMQ 消息队列收到了这封邮件的信息之后，消息会存储在消息队列中，随后通过其他的项目去监听 RabbitMQ 中的内容，只要消息队列里面有了新的消息，那么我就执行一次发送消息（这里使用的是<a href="#Java-Mail 关键代码">Java-Mail</a>）</font>。</p><p><a href="#0">回到顶部</a></p><h2 id="9.2">👇以下内容包含：RabbitMQ 监听，这里是一个与 yeb-server 同级的项目，运行端口是 8082</h2><p>🏀注意：这里是消息接收端，但是并不是“我接收你的消息”，而是“我接收 RabbitMQ 的消息”</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>mail</span><span class="token punctuation">;</span><span class="token comment">/** * @author Jim * @Description 接收邮件 * @createTime 2022年05月24日 */</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MailReceiver</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * author Jim     * 端口监听     */</span>    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_QUEUE_NAME<span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Message:"</span><span class="token operator">+</span>message<span class="token operator">+</span><span class="token string">"\nChannel"</span><span class="token operator">+</span>channel<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆<font size=2>这个方法其实很简单，（并不是原项目中的方法，我删除了大部分关于 Java-Mail 的，放在下面的部分），当 RabbitMQ 消息队列中有了新的消息的时候，<code>@RabbitListener</code>就会监听到，注意我们在上面些消息队列的时候，用的 queue 与此处监听的 queue 一定要一致，监听到消息后获取一个 message 以及一个channel，随后输出 message 与 channel。</p><p><a href="#0">回到顶部</a></p><p><br><br><br><br></p><h2 id="10">10.Java-Mail 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token class-name">MailConstants</span><span class="token punctuation">.</span>MAIL_QUEUE_NAME<span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Employee</span> employee <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> message<span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MailReceiver:  employee = "</span> <span class="token operator">+</span> employee<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">MessageHeaders</span> headers <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> tag <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">AmqpHeaders</span><span class="token punctuation">.</span>DELIVERY_TAG<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"tag = "</span> <span class="token operator">+</span> tag<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> msgId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"spring_returned_message_correlation"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"msgId = "</span> <span class="token operator">+</span> msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">HashOperations</span> hash <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>hash<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token string">"mail_log"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>msgId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">//redis中包含key，说明消息已经被消费</span>                logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"消息已经被消费========>&#123;&#125;"</span><span class="token punctuation">,</span> msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">/**                 * 手动确认消息                 * tag:消息序号                 * multiple:是否多条                 */</span>                channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">MimeMessage</span> msg <span class="token operator">=</span> javaMailSender<span class="token punctuation">.</span><span class="token function">createMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">MimeMessageHelper</span> helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessageHelper</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>mailProperties<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token string">"入职邮件"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setSentDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> employee<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span><span class="token string">"posName"</span><span class="token punctuation">,</span> employee<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span><span class="token string">"joblevelName"</span><span class="token punctuation">,</span> employee<span class="token punctuation">.</span><span class="token function">getJoblevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            context<span class="token punctuation">.</span><span class="token function">setVariable</span><span class="token punctuation">(</span><span class="token string">"departmentName"</span><span class="token punctuation">,</span> employee<span class="token punctuation">.</span><span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> mail <span class="token operator">=</span> templateEngine<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span><span class="token string">"mail"</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>            helper<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mail<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//发送邮件</span>            javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"邮件发送成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//将消息id存入redis</span>            hash<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"mail_log"</span><span class="token punctuation">,</span> msgId<span class="token punctuation">,</span> <span class="token string">"OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MailReceiver: redis---> msgId = "</span> <span class="token operator">+</span> msgId<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//手动确认消息</span>            channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                channel<span class="token punctuation">.</span><span class="token function">basicNack</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ioException<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">//ioException.printStackTrace();</span>                logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"消息确认失败=====>&#123;&#125;"</span><span class="token punctuation">,</span> ioException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"MailReceiver + 邮件发送失败========&#123;&#125;"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><a href="#0">回到顶部</a></p><br><h2 id="10.1">@Scheduled 关键代码</h2><p>🪵 由于我们执行发送邮件的时候，不一定可以一次性发送成功，那该怎么办呢？我就不发了？那不太合适吧；我一直尝试发送，也不太合适，因此我们使用<code>@Scheduled</code>注解，让一个方法每隔一段时间扫描一次 MailLog 数据库表，如果里面有状态为‘正在发送’的，那就重新发送一次，如果超过三次都失败了，就将状态标记为‘发送失败’。</p><p><font color=darkgray size=2>为了简化阅读，这里将方法修改为：每隔十秒输出一次“我循环了…”,具体代码可以移步至<a href="https://github.com/Jimecc">我的 GitHub</a> 查看。</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0/10 * * * * ?"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mailTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"我循环了...."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>🏀 <font color=red size=2>注意：要在 Main 方法的启动类上加入<code>@EnableScheduling</code>注解才可以。</font> 👇</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableScheduling</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YebApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">YebApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br><br></p><h2 id="11">11.JavaSecurity</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security<span class="token punctuation">.</span>component<span class="token punctuation">.</span></span><span class="token class-name">CustomFilter</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security<span class="token punctuation">.</span>component<span class="token punctuation">.</span></span><span class="token class-name">CustomUrlDecisionManager</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Admin</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IAdminService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ObjectPostProcessor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">AuthenticationManagerBuilder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">HttpSecurity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">WebSecurity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span></span><span class="token class-name">WebSecurityConfigurerAdapter</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>bcrypt<span class="token punctuation">.</span></span><span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>password<span class="token punctuation">.</span></span><span class="token class-name">PasswordEncoder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>web<span class="token punctuation">.</span>access<span class="token punctuation">.</span>intercept<span class="token punctuation">.</span></span><span class="token class-name">FilterSecurityInterceptor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>web<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">UsernamePasswordAuthenticationFilter</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">IAdminService</span> adminService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RestfulAccessDeniedHandler</span> restfulAccessDeniedHandler<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">RestAuthorizationEntryPoint</span> restAuthorizationEntryPoint<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">CustomUrlDecisionManager</span> customUrlDecisionManager<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">CustomFilter</span> customFilter<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        auth<span class="token punctuation">.</span><span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">WebSecurity</span> web<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        web<span class="token punctuation">.</span><span class="token function">ignoring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span>                <span class="token string">"/login"</span><span class="token punctuation">,</span>                <span class="token string">"/logout"</span><span class="token punctuation">,</span>                <span class="token string">"/css/**"</span><span class="token punctuation">,</span>                <span class="token string">"/js/**"</span><span class="token punctuation">,</span>                <span class="token string">"/index.html"</span><span class="token punctuation">,</span>                <span class="token string">"favicon.ico"</span><span class="token punctuation">,</span>                <span class="token string">"/doc.html"</span><span class="token punctuation">,</span>                <span class="token string">"/webjars/**"</span><span class="token punctuation">,</span>                <span class="token string">"/swagger-resources/**"</span><span class="token punctuation">,</span>                <span class="token string">"/v2/api-docs/**"</span><span class="token punctuation">,</span>                <span class="token string">"/captcha"</span><span class="token punctuation">,</span>                <span class="token string">"/ws/**"</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span>  <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        http<span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">sessionManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">sessionCreationPolicy</span><span class="token punctuation">(</span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation">.</span>STATELESS<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment">// 所有的请求都要求认证</span>                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">withObjectPostProcessor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObjectPostProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FilterSecurityInterceptor</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token annotation punctuation">@Override</span>                    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">O</span> <span class="token keyword">extends</span> <span class="token class-name">FilterSecurityInterceptor</span><span class="token punctuation">></span></span> <span class="token class-name">O</span> <span class="token function">postProcess</span><span class="token punctuation">(</span><span class="token class-name">O</span> o<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        o<span class="token punctuation">.</span><span class="token function">setAccessDecisionManager</span><span class="token punctuation">(</span>customUrlDecisionManager<span class="token punctuation">)</span><span class="token punctuation">;</span>                        o<span class="token punctuation">.</span><span class="token function">setSecurityMetadataSource</span><span class="token punctuation">(</span>customFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">return</span> o<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">cacheControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        http<span class="token punctuation">.</span><span class="token function">addFilterBefore</span><span class="token punctuation">(</span><span class="token function">jwtAuthencationTokenFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">UsernamePasswordAuthenticationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        http<span class="token punctuation">.</span><span class="token function">exceptionHandling</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">accessDeniedHandler</span><span class="token punctuation">(</span>restfulAccessDeniedHandler<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">authenticationEntryPoint</span><span class="token punctuation">(</span>restAuthorizationEntryPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">UserDetailsService</span> <span class="token function">userDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> username <span class="token operator">-></span><span class="token punctuation">&#123;</span>            <span class="token class-name">Admin</span> admin <span class="token operator">=</span> adminService<span class="token punctuation">.</span><span class="token function">getAdminByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">!=</span>admin<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                admin<span class="token punctuation">.</span><span class="token function">setRoles</span><span class="token punctuation">(</span>adminService<span class="token punctuation">.</span><span class="token function">getRoles</span><span class="token punctuation">(</span>admin<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> admin<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">(</span><span class="token string">"用户名或密码不正确"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">JwtAuthencationTokenFilter</span> <span class="token function">jwtAuthencationTokenFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JwtAuthencationTokenFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆配置文件：相关内容里可以查看注解。</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> userDetailsService<span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> userDetails <span class="token operator">||</span> <span class="token operator">!</span> passwordEncoder<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span>userDetails<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token class-name">RespBean</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"用户名或密码不正确"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>userDetails<span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token class-name">RespBean</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"账号被禁用，请联系管理员"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆以上是登录验证：通过 JavaSecurity 中的 UserDetails 来判断用户名与密码是否正确</p><p>🏀注意：PasswordEncoder 也是属于 JavaSecurity 中的一个类，主要用于加密。</p><p><a href="#0">回到顶部</a></p><p><br><br><br></p><h2 id="12">12.FastDFS 关键代码</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>csource<span class="token punctuation">.</span>fastdfs<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ClassPathResource</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>multipart<span class="token punctuation">.</span></span><span class="token class-name">MultipartFile</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span><span class="token comment">/** * 文件上传工具类 * * @author zhanglishen * @since 1.0.0 */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FastDFSUtils</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">FastDFSUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> filePath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">"fdfs_client.conf"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">ClientGlobal</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"FastDFS Client Init Fail! "</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 上传文件     * @param file     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> filename <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"File Name :"</span> <span class="token operator">+</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> uploadResults <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token comment">//获取storage客户端</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            storageClient <span class="token operator">=</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//上传</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                uploadResults <span class="token operator">=</span> storageClient<span class="token punctuation">.</span><span class="token function">upload_file</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>filename<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>filename<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"IO Exception when uploadind the file:"</span> <span class="token operator">+</span> filename<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Non IO Exception when uploadind the file:"</span> <span class="token operator">+</span> filename<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"upload_file time used:"</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" ms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//验证上传结果</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>uploadResults <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> storageClient <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"upload file fail, error code:"</span> <span class="token operator">+</span> storageClient<span class="token punctuation">.</span><span class="token function">getErrorCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//上传成功返回groupName</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"upload file successfully!!!"</span> <span class="token operator">+</span> <span class="token string">"group_name:"</span> <span class="token operator">+</span> uploadResults<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">", remoteFileName:"</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> uploadResults<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> uploadResults<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 获取文件信息     * @param groupName     * @param remoteFileName     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">FileInfo</span> <span class="token function">getFileInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> groupName<span class="token punctuation">,</span><span class="token class-name">String</span> remoteFileName<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> storageClient<span class="token punctuation">.</span><span class="token function">get_file_info</span><span class="token punctuation">(</span>groupName<span class="token punctuation">,</span>remoteFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"IO Exception: Get File from Fast DFS failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Non IO Exception: Get File from Fast DFS failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 下载     * @param groupName     * @param remoteFileName     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">InputStream</span> <span class="token function">downFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> groupName<span class="token punctuation">,</span><span class="token class-name">String</span> remoteFileName<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> storageClient<span class="token punctuation">.</span><span class="token function">download_file</span><span class="token punctuation">(</span>groupName<span class="token punctuation">,</span> remoteFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> inputStream<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"IO Exception: Get File from Fast DFS failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Non IO Exception: Get File from Fast DFS failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 删除文件     * @param groupName     * @param remoteFileName     * @throws Exception     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deleteFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> groupName<span class="token punctuation">,</span><span class="token class-name">String</span> remoteFileName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> storageClient<span class="token punctuation">.</span><span class="token function">delete_file</span><span class="token punctuation">(</span>groupName<span class="token punctuation">,</span> remoteFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"delete file successfully!!!"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 生成Storage客户端     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">StorageClient</span> <span class="token function">getStorageClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TrackerServer</span> trackerServer <span class="token operator">=</span> <span class="token function">getTrackerServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">StorageClient</span> storageClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StorageClient</span><span class="token punctuation">(</span>trackerServer<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> storageClient<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 生成Tracker服务器端     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">TrackerServer</span> <span class="token function">getTrackerServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TrackerClient</span> trackerClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrackerClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">TrackerServer</span> trackerServer <span class="token operator">=</span> trackerClient<span class="token punctuation">.</span><span class="token function">getTrackerServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> trackerServer<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 获取文件路径     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getTrackerUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">TrackerClient</span> trackerClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TrackerClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">TrackerServer</span> trackerServer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">StorageServer</span> storageServer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            trackerServer <span class="token operator">=</span> trackerClient<span class="token punctuation">.</span><span class="token function">getTrackerServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            storageServer <span class="token operator">=</span> trackerClient<span class="token punctuation">.</span><span class="token function">getStoreStorage</span><span class="token punctuation">(</span>trackerServer<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token string">"http://"</span><span class="token operator">+</span>storageServer<span class="token punctuation">.</span><span class="token function">getInetSocketAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHostString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":8888/"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆就是一些简单的配置，主要功能为：上传、下载、删除文件；以及一些服务于这三个功能的方法。</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"更新用户头像"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/admin/userface"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">RespBean</span> <span class="token function">updateAdminUserFace</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span><span class="token class-name">Authentication</span> authentication<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> filePath <span class="token operator">=</span> <span class="token class-name">FastDFSUtils</span><span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token class-name">FastDFSUtils</span><span class="token punctuation">.</span><span class="token function">getTrackerUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>filePath<span class="token operator">+</span><span class="token string">"/"</span><span class="token operator">+</span>filePath<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> adminService<span class="token punctuation">.</span><span class="token function">updateAdminUserFace</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>id<span class="token punctuation">,</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆在AdminInfoController 中调用FastDFSUtils实现上传头像的功能。</p><p><a href="#0">回到顶部</a></p><p><br><br><br><br></p><h2 id="13">13.WebSocket 关键代码</h2><h2 id="13.1">配置文件</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jim<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">JwtTokenUtil</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span></span><span class="token class-name">Message</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span></span><span class="token class-name">MessageChannel</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>simp<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">ChannelRegistration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>simp<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">MessageBrokerRegistry</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>simp<span class="token punctuation">.</span>stomp<span class="token punctuation">.</span></span><span class="token class-name">StompCommand</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>simp<span class="token punctuation">.</span>stomp<span class="token punctuation">.</span></span><span class="token class-name">StompHeaderAccessor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ChannelInterceptor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">MessageHeaderAccessor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SecurityContextHolder</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">EnableWebSocketMessageBroker</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">StompEndpointRegistry</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebSocketMessageBrokerConfigurer</span><span class="token punctuation">;</span><span class="token comment">/** * @author Jim * @Description WebSocket 配置类 * @createTime 2022年05月26日 */</span><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@EnableWebSocketMessageBroker</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSocketConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebSocketMessageBrokerConfigurer</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;jwt.tokenHead&#125;"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> tokenHead<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">JwtTokenUtil</span> jwtTokenUtil<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">UserDetailsService</span> userDetailsService<span class="token punctuation">;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 添加这个 EndPoint，这样可以在网页通过 websocket 连接上服务     * 也就是我们配置 websocket 服务复制，并且可以指定是否使用 socketJS     * @param registry     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerStompEndpoints</span><span class="token punctuation">(</span><span class="token class-name">StompEndpointRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/**         * 1.将 ws/ep路径注册为 stomp 的端点，用户链接了这个端点就可以进行 websocket 通讯，支持 socketJS         * 2.setAllowedOrigins("*")允许跨域         * wethSockJS() 支持 socketJS 访问         */</span>        registry<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">"/ws/ep"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAllowedOrigins</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withSockJS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 输入通道参数配置     * @param registration     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configureClientInboundChannel</span><span class="token punctuation">(</span><span class="token class-name">ChannelRegistration</span> registration<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        registration<span class="token punctuation">.</span><span class="token function">interceptors</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token class-name">Message</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">preSend</span><span class="token punctuation">(</span><span class="token class-name">Message</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> message<span class="token punctuation">,</span> <span class="token class-name">MessageChannel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">StompHeaderAccessor</span> accessor <span class="token operator">=</span> <span class="token class-name">MessageHeaderAccessor</span><span class="token punctuation">.</span><span class="token function">getAccessor</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token class-name">StompHeaderAccessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//判断是否为连接，如果是，需要获取token，并且设置用户对象</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StompCommand</span><span class="token punctuation">.</span>CONNECT<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>accessor<span class="token punctuation">.</span><span class="token function">getCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token class-name">String</span> token <span class="token operator">=</span> accessor<span class="token punctuation">.</span><span class="token function">getFirstNativeHeader</span><span class="token punctuation">(</span><span class="token string">"Auth-Token"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token class-name">String</span> authToken <span class="token operator">=</span> token<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>tokenHead<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token class-name">String</span> username <span class="token operator">=</span> jwtTokenUtil<span class="token punctuation">.</span><span class="token function">getUserNameFromToken</span><span class="token punctuation">(</span>authToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">//token中存在用户名</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                            <span class="token comment">//登录</span>                            <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> userDetailsService<span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token comment">//验证token是都有效</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span>jwtTokenUtil<span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>authToken<span class="token punctuation">,</span>userDetails<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                <span class="token class-name">UsernamePasswordAuthenticationToken</span> authenticationToken <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> userDetails<span class="token punctuation">.</span><span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authenticationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                                accessor<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span>authenticationToken<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> message<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * @Author: Jim     * @Description: 配置消息代理     * @param registry     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configureMessageBroker</span><span class="token punctuation">(</span><span class="token class-name">MessageBrokerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 配置代理域，可以配置多个，配置代理的目的地前缀为/queue,可以在配置域上向客户端推送消息</span>        registry<span class="token punctuation">.</span><span class="token function">enableSimpleBroker</span><span class="token punctuation">(</span><span class="token string">"/queue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="13.2">实现聊天功能</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@MessageMapping</span><span class="token punctuation">(</span><span class="token string">"/ws/chat"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleMsg</span><span class="token punctuation">(</span><span class="token class-name">Authentication</span> authentication<span class="token punctuation">,</span> <span class="token class-name">ChatMsg</span> chatMsg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Admin</span> admin <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Admin</span><span class="token punctuation">)</span> authentication<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    chatMsg<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>admin<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    chatMsg<span class="token punctuation">.</span><span class="token function">setFromNickName</span><span class="token punctuation">(</span>admin<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    chatMsg<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    simpMessagingTemplate<span class="token punctuation">.</span><span class="token function">convertAndSendToUser</span><span class="token punctuation">(</span>chatMsg<span class="token punctuation">.</span><span class="token function">getTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"/queue/chat"</span><span class="token punctuation">,</span>chatMsg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>👆使用simpMessagingTemplate发送消息</p><h3 id="13.3">获取所有管理员（聊天列表）</h2><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">package com.jim.server.controller;import com.jim.server.pojo.Admin;import com.jim.server.service.IAdminService;import io.swagger.annotations.ApiOperation;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import java.util.List;&#x2F;** * @author Jim * @Description 可以跟谁聊天 * @createTime 2022年05月26日 *&#x2F;@RestController@RequestMapping(&quot;&#x2F;chat&quot;)public class ChatController &#123;    @Autowired    private IAdminService adminService;    @ApiOperation(value&#x3D;&quot;获取所有操作员&quot;)    @GetMapping(&quot;&#x2F;admin&quot;)    public List&lt;Admin&gt; getAllAdmins(String keywords)&#123;        return adminService.getAllAdmins(keywords);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><a href="#0">回到顶部</a></p><h1 id="前端跨域"><a href="#前端跨域" class="headerlink" title="前端跨域"></a>前端跨域</h1><p>由于项目前后端分离，前端必须要解决的一个问题便是跨域，否则前后端无法进行联调，因此在<a href="https://www.bilibili.com/video/BV1ff4y1M7XK?p=7&vd_source=32c908a2f8edcccb3fa042cf11b101bc">视频第七集</a>的位置说明了如何实现跨域，具体方法在视频中有介绍，简单描述就是：在 Vue 项目的根目录下创建一个 vue.config.js 文件 👉🏻 在里面配置 proxy 以及 target 目标地址；</p><p>这时候仅需要将 target改成 <code>http://110.40.191.51:8081</code>便可以以我的服务器为后端进行联调开发，具体实现效果如下：</p><img src="https://files.catbox.moe/xy2sry.png" style="width:90%" /><p>实现跨域的方式还有很多种，这是开发过程中比较方便的一种。</p><p><font color=red size=4>公益开放后端，请勿随便修改服务器数据（为了方便别人访问，改了请改回来哦）</p><p><a href="#0">回到顶部</a></p><h1 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h1><p>放一张我胖儿的帅照：</p><div style="text-align:center"><img  src="https://files.catbox.moe/q3ztct.png" style="width:50%;border-radius:1110px 1110px" /></div><p><a href="#0">回到顶部</a></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>进阶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MarkDown 写作笔记（链接篇）</title>
    <link href="/2022/06/17/markdown/Markdown%20%E8%B7%B3%E8%BD%AC/"/>
    <url>/2022/06/17/markdown/Markdown%20%E8%B7%B3%E8%BD%AC/</url>
    
    <content type="html"><![CDATA[<h1 id="MarkDown-写作笔记（链接篇）"><a href="#MarkDown-写作笔记（链接篇）" class="headerlink" title="MarkDown 写作笔记（链接篇）"></a>MarkDown 写作笔记（链接篇）</h1><p><br><br></p><h2 id="普通外链"><a href="#普通外链" class="headerlink" title="普通外链"></a>普通外链</h2><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html">[超链接名字](连接 url)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>示例：</p><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html">[点我打开百度](www.baidu.com)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><a href="https://www.baidu.com/">点我打开百度</a></p><p>注意事项：记得加上<code>https://</code>或者<code>http://</code></p><p><br><br><br><br></p><h2 id="文章内跳转"><a href="#文章内跳转" class="headerlink" title="文章内跳转"></a>文章内跳转</h2><h3 id="方式一（不推荐）"><a href="#方式一（不推荐）" class="headerlink" title="方式一（不推荐）"></a>方式一（不推荐）</h3><p>使用 <code>&lt;a&gt;</code>标签直接跳转到某一个目录：</p><p>示例：</p><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#文章内跳转<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>点我跳转到【文章内跳转】<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><a href="#文章内跳转">点我跳转到【文章内跳转】</a></p><p>这种方式仅在 Markdown 文件内有效，放在博客中转换成 html后可能会失效。</p><h3 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h3><p>对目录设置锚点</p><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>123<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>这是锚点<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>123<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>用方式一跳转<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>[用方式二跳转](#123)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p><span id="123">这是锚点</span></p><p><a href="#123">用方式一跳转</a><br><a href="#123">用方式二跳转</a></p>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Markdown</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MarkDown 写作笔记（图片篇）</title>
    <link href="/2022/06/17/markdown/Markdown%20%E5%9B%BE%E7%89%87/"/>
    <url>/2022/06/17/markdown/Markdown%20%E5%9B%BE%E7%89%87/</url>
    
    <content type="html"><![CDATA[<h1 id="MarkDown-写作笔记（图片篇）"><a href="#MarkDown-写作笔记（图片篇）" class="headerlink" title="MarkDown 写作笔记（图片篇）"></a>MarkDown 写作笔记（图片篇）</h1><p><br><br></p><h2 id="图床工具"><a href="#图床工具" class="headerlink" title="图床工具"></a>图床工具</h2><p>之前用的图床工具不可以用了，因此又发现了一个 utools 自带的图床，很好用。安装 utools，复制图片，alt/option+space 打开 utools 就可以上传到图床，里面会有 url/html/markdown的选择。</p><p>是个开发者都应该知道 utools。</p><p><br><br><br><br></p><h2 id="图片居中"><a href="#图片居中" class="headerlink" title="图片居中"></a>图片居中</h2><p>Markdown 的插入图片不太方便操作，建议直接使用 html 的<code>&lt;img&gt;</code>标签，然后用<code>&lt;div&gt;</code>套住它，并在 div 中设置居中。</p><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>图片地址<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>div><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>图片大小等可以直接在 img 标签中加<code>style=&quot;&quot;</code>。</p><p>示例：</p><div class="code-wrapper"><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://files.catbox.moe/ltfc1r.png<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>90%</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><div align=center><img src="https://files.catbox.moe/ltfc1r.png" style="width:90%"></div>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Markdown</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【IDEA】IDEA 爆红的几种解决方法</title>
    <link href="/2022/06/16/IDEA/%E3%80%90IDEA%E3%80%91IDEA-%E7%88%86%E7%BA%A2%E7%9A%84%E5%87%A0%E7%A7%8D%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <url>/2022/06/16/IDEA/%E3%80%90IDEA%E3%80%91IDEA-%E7%88%86%E7%BA%A2%E7%9A%84%E5%87%A0%E7%A7%8D%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="IDEA-爆红的几种解决方法"><a href="#IDEA-爆红的几种解决方法" class="headerlink" title="IDEA 爆红的几种解决方法"></a>IDEA 爆红的几种解决方法</h2><h3 id="检查-pom-xml的图标是否是蓝色的小m，如果不是则说明未以Maven项目加载"><a href="#检查-pom-xml的图标是否是蓝色的小m，如果不是则说明未以Maven项目加载" class="headerlink" title="检查 pom.xml的图标是否是蓝色的小m，如果不是则说明未以Maven项目加载"></a>检查 pom.xml的图标是否是蓝色的小<code>m</code>，如果不是则说明未以Maven项目加载</h3><p>解决方法：找到 pom.xml -&gt; 右键-&gt; Maven-&gt; addAsMavenProject</p><div style="text-align:center;"><img src="https://files.catbox.moe/lndbm7.png" style="height:500px"></div><h3 id="检查项目所用的-JDK-版本是否正确"><a href="#检查项目所用的-JDK-版本是否正确" class="headerlink" title="检查项目所用的 JDK 版本是否正确"></a>检查项目所用的 JDK 版本是否正确</h3><p>解决方法：project structure -&gt; Project</p><div style="text-align:center;"><img src="https://files.catbox.moe/onpcwl.png" style="height:500px"></div><h3 id="检查-Maven-的位置（以及选择的版本）"><a href="#检查-Maven-的位置（以及选择的版本）" class="headerlink" title="检查 Maven 的位置（以及选择的版本）"></a>检查 Maven 的位置（以及选择的版本）</h3><p>解决方法：Preferences -&gt; Build, Execution, Deployment -&gt; Build Tools -&gt; Maven</p><div style="text-align:center;"><img src="https://files.catbox.moe/hswya5.png" style="height:500px"></div><h3 id="IDEA-缓存导致"><a href="#IDEA-缓存导致" class="headerlink" title="IDEA 缓存导致"></a>IDEA 缓存导致</h3><p>File -&gt; Invalidate Caches</p><div style="text-align:center;"><img src="https://files.catbox.moe/a1iytd.png" style="height:500px"></div>]]></content>
    
    
    <categories>
      
      <category>IDEA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IDEA</tag>
      
      <tag>Error</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【SpringSecurity】三种放行方式 antMatchers &amp;&amp; regexMatchers &amp;&amp; mvcMatchers</title>
    <link href="/2022/06/16/JavaSecurity/antMatchers/"/>
    <url>/2022/06/16/JavaSecurity/antMatchers/</url>
    
    <content type="html"><![CDATA[<h1 id="SpringSecurity-三种放行方式"><a href="#SpringSecurity-三种放行方式" class="headerlink" title="SpringSecurity 三种放行方式"></a>SpringSecurity 三种放行方式</h1><p><strong>permitAll() == access(“permitAll()”)</strong><br><strong>hasAnyRole(“abc”,”ABCA”) == access(hasAnyRole(“abc”,”ABCA”))</strong></p><h2 id="antMatchers"><a href="#antMatchers" class="headerlink" title="antMatchers"></a>antMatchers</h2><p><font  size=2>特点：使用 ant 参数，不限数量（可变参数）</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>      <span class="token comment">// 允许访问的页面</span>http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// 放行多个页面</span>        <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/login.html"</span><span class="token punctuation">,</span><span class="token string">"/error.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// 指定请求方式并放行</span>        <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token class-name">HttpMethod</span><span class="token punctuation">.</span>POST<span class="token punctuation">,</span><span class="token string">"/demo"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// 使用通配符</span>        <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/js/**"</span><span class="token punctuation">,</span><span class="token string">"/css/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li><code>?</code>匹配一个字符</li><li><code>*</code>匹配0 个或多个字符</li><li><code>**</code>匹配 0 个或多个目录</li></ul><h2 id="regexMatchers"><a href="#regexMatchers" class="headerlink" title="regexMatchers"></a>regexMatchers</h2><p><font  size=2>特点：使用正则表达式</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>      <span class="token comment">// 允许访问的页面</span>http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token punctuation">.</span><span class="token function">regexMatchers</span><span class="token punctuation">(</span><span class="token string">".+[.]png"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="mvcMatchers"><a href="#mvcMatchers" class="headerlink" title="mvcMatchers"></a>mvcMatchers</h2><p><font size=2>特点：可以使用 <code>servlet.path</code></font></p><p><font size=2>全局前置路径</font><code>application.properties</code></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">spring<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>path<span class="token operator">=</span><span class="token operator">/</span>xxxx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Override</span>  <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>    <span class="token comment">// 允许访问的页面</span>      http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token punctuation">.</span><span class="token function">mvcMatchers</span><span class="token punctuation">(</span><span class="token string">"/login.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">servletPath</span><span class="token punctuation">(</span><span class="token string">"/xxxx"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h1 id="权限控制"><a href="#权限控制" class="headerlink" title="权限控制"></a>权限控制</h1><h4 id="控制角色与权限"><a href="#控制角色与权限" class="headerlink" title="控制角色与权限"></a>控制角色与权限</h4><p><font size=2>两种方法，四种情况</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// new 一个用户，</span><span class="token comment">// 有两个权限：admin,normal</span><span class="token comment">// 有一个角色 ROLE_abc</span><span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">,</span> <span class="token class-name">AuthorityUtils</span><span class="token punctuation">.</span><span class="token function">commaSeparatedStringToAuthorityList</span><span class="token punctuation">(</span><span class="token string">"admin,normal,ROLE_abc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// 一个 Authority</span>  <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main1.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span>  <span class="token comment">// 多个 Authority</span>        <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main2.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAnyAuthority</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"adminA"</span><span class="token punctuation">)</span>  <span class="token comment">// 一个 ROLE_</span>  <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main3.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span>  <span class="token comment">// 多个 ROLE_</span>        <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main4.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasAnyRole</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">,</span><span class="token string">"ABCA"</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font size=2>注意，给定权限要以<code>ROLE_</code>开头，但是判断权限的时候<font color=red>不可以有</font><code>ROLE_</code>。</font></p><h4 id="控制-IP"><a href="#控制-IP" class="headerlink" title="控制 IP"></a>控制 IP</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/main2.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasIpAddress</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h1 id="使用注解放行"><a href="#使用注解放行" class="headerlink" title="使用注解放行"></a>使用注解放行</h1><p>启动类上加上<code>@EnableGlobalMethodSecurity(securedEnabled=true)</code></p><ul><li><code>@Secured(&quot;ROLE_abc&quot;) </code><ul><li>位置：方法 | 类</li></ul></li><li><code>PreAuthorize</code><ul><li>位置：方法|类</li><li>允许以 <code>ROLE_</code>开头，也可以不用 <code>ROLE_</code>开头</li></ul></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableGlobalMethodSecurity</span><span class="token punctuation">(</span>securedEnabled<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>prePostEnabled <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token punctuation">)</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringSecurityApplication</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SpringSecurityApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@PreAuthorize</span><span class="token punctuation">(</span><span class="token string">"hasRole('ROLE_name'"</span><span class="token punctuation">)</span>"<span class="token punctuation">)</span>@<span class="token operator">*</span><span class="token class-name">Mapping</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token string">"Success"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="记住我"><a href="#记住我" class="headerlink" title="记住我"></a>记住我</h2><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * @author Jim * @Description * @createTime 2022年06月28日 */</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>      <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">UserDetailsServiceImpl</span> userDetailsService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>      <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>       <span class="token comment">// 记住我</span>        http<span class="token punctuation">.</span><span class="token function">rememberMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment">// 登录逻辑</span>                <span class="token punctuation">.</span><span class="token function">userDetailsService</span><span class="token punctuation">(</span>userDetailsService<span class="token punctuation">)</span>                <span class="token comment">// 持久层对象</span>                <span class="token punctuation">.</span><span class="token function">tokenRepository</span><span class="token punctuation">(</span><span class="token function">jdbcTokenRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">PersistentTokenRepository</span> <span class="token function">jdbcTokenRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">JdbcTokenRepositoryImpl</span> jdbcTokenRepository <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcTokenRepositoryImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        jdbcTokenRepository<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 自动建表 第一次启动需要，第二次启动需要注释掉</span>        jdbcTokenRepository<span class="token punctuation">.</span><span class="token function">setCreateTableOnStartup</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span>  jdbcTokenRepository<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="常见认证机制"><a href="#常见认证机制" class="headerlink" title="常见认证机制"></a>常见认证机制</h2><p>OAuth2</p>]]></content>
    
    
    <categories>
      
      <category>Security</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Security</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【初探篇】 Nginx 负载均衡</title>
    <link href="/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91-Nginx-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    <url>/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91-Nginx-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="Nginx-负载均衡机制"><a href="#Nginx-负载均衡机制" class="headerlink" title="Nginx 负载均衡机制"></a>Nginx 负载均衡机制</h1><p>配置文件位置<code>/usr/local/nginx/conf/nginx.conf</code></p><h3 id="方式一：轮询、权重、备用机器、下线"><a href="#方式一：轮询、权重、备用机器、下线" class="headerlink" title="方式一：轮询、权重、备用机器、下线"></a>方式一：轮询、权重、备用机器、下线</h3><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 配置多个代理，名字叫 abcdefg，下方可用，可以轮询（并且配置权重）upstream abcdefg&#123;# 权重为 8 的及其server 110.40.191.50:80 weight&#x3D;8;#备用机器  server 110.40.191.51:80 backup;  # down 下线，不参与轮询  server 110.40.191.52:80 down;&#125;server &#123;        listen       80;        server_name  localhost;        location &#x2F; &#123;        # 配置代理proxy_pass http:&#x2F;&#x2F;abcdefg;        &#125;        error_page   500 502 503 504  &#x2F;50x.html;        location &#x3D; &#x2F;50x.html &#123;            root   html;        &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=gray size=2>缺点：无法保持会话。</font></p><h3 id="方式二：ip-hash"><a href="#方式二：ip-hash" class="headerlink" title="方式二：ip_hash"></a>方式二：ip_hash</h3><p>不太用（不适合当下大环境，更换 ip 之后重新 hash，那么我在旅行中的火车上一直更换移动基站，就一直 hash）</p><h3 id="方式三-least-conn"><a href="#方式三-least-conn" class="headerlink" title="方式三 least_conn"></a>方式三 least_conn</h3><p>最少连接数访问（不太常用、不太合理）</p><p>有可能因为我配置的权重较低，导致其连接数较少。</p><h3 id="方式四：fair"><a href="#方式四：fair" class="headerlink" title="方式四：fair"></a>方式四：fair</h3><p>根据后端服务器响应时间来转发请求（需要安装插件）</p><h3 id="方式五：-url-hash"><a href="#方式五：-url-hash" class="headerlink" title="方式五： url_hash"></a>方式五： url_hash</h3><p>（定向流量转发）根据 url 取 hash 值，相同的 hash 值转发到同一个服务器上</p>]]></content>
    
    
    <categories>
      
      <category>中间件</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>中间件</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【初探篇】 Nginx 创建脚本文件（交由 systemctl 控制）</title>
    <link href="/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91Nginx%20%E5%88%9B%E5%BB%BA%20systemctl%20%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6/"/>
    <url>/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91Nginx%20%E5%88%9B%E5%BB%BA%20systemctl%20%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>中间件</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>初探篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Nginx】 Nginx 全</title>
    <link href="/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91%E5%85%A8/"/>
    <url>/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91%E5%85%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="相关配置说明"><a href="#相关配置说明" class="headerlink" title="相关配置说明"></a>相关配置说明</h2><p>服务器版本：CentOS8 来自腾讯云的轻量级服务器，大家可以去淘宝买，48/年</p><p>Nginx 版本：<a href="http://nginx.org/download/nginx-1.2.1.tar.gz">nginx-1.2.1.tar.gz</a></p><p><br><br><br></p><h2 id="安装-Nginx"><a href="#安装-Nginx" class="headerlink" title="安装 Nginx"></a>安装 Nginx</h2><ul><li><p>下载 Nginx 安装包<a href="http://nginx.org/download/">【下载链接】</a></p></li><li><p>上传到 CentOS 任意地址（可以放在<code>/home/your_username/</code>下）</p></li><li><p>使用下面命令解压缩</p></li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">tar zxvf nginx-*.tar.gx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>使用下列命令进入包内（注意，版本不同请手动替换<code>*</code>，也可以灵活使用 <code>tab 键</code>）</li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">cd nginx-*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>使用下列命令查看相关依赖</li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">.&#x2F;configure<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>执行下列命令（可能是将依赖放到<code>/usr/local/nginx</code>文件夹下，但是这个文件夹是安装 nginx 的文件夹，请大佬们解惑）</li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>执行以下两个命令进行安装</li></ul><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">makemake install<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><ul><li><font color=red>注意：</font>这边可能会遇到两个问题，如如果遇到请参考下面方法，没有遇到就跳过：</li></ul></br><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h4 id="基础配置说明"><a href="#基础配置说明" class="headerlink" title="基础配置说明"></a>基础配置说明</h4><p>配置文件位置 <code>/usr/local/nginx/conf/index.conf</code></p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 开启进程数量worker_processes  1;# 默认可以有多少个连接events &#123;    worker_connections  1024;&#125;# http &#123;# 引入其他依赖文件 # mime.types 是请求头    include       mime.types;        default_type  application&#x2F;octet-stream;# 零拷贝    sendfile        on;# 保持连接，超时时间    keepalive_timeout  65;# 一个主机    server &#123;    # 监听端口号        listen       80;        # 主机名称        server_name  localhost;# url 一个主机下面可以有好几个 location 默认页        location &#x2F; &#123;            root   html;            index  index.html index.htm;        &#125;        #        error_page   500 502 503 504  &#x2F;50x.html;        location &#x3D; &#x2F;50x.html &#123;            root   html;        &#125;    &#125;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>mime.types文件</p><div class="code-wrapper"><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">types <span class="token punctuation">&#123;</span>    text<span class="token operator">/</span>html                             html htm shtml<span class="token punctuation">;</span>    text<span class="token operator">/</span>css                              css<span class="token punctuation">;</span>    text<span class="token operator">/</span>xml                              xml<span class="token punctuation">;</span>   …………此处省略很多    video<span class="token operator">/</span>x<span class="token operator">-</span>ms<span class="token operator">-</span>wmv                        wmv<span class="token punctuation">;</span>    video<span class="token operator">/</span>x<span class="token operator">-</span>msvideo                       avi<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h1 id="Nginx-创建脚本文件"><a href="#Nginx-创建脚本文件" class="headerlink" title="Nginx 创建脚本文件"></a>Nginx 创建脚本文件</h1><p><font size=2 color=darkgray>nginx.service</font></p><ul><li>新建一个脚本文件：<code>/usr/lib/systemd/system/nginx.service</code>（允许使用<code>systemctl</code>管理 nginx）</li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[Unit]Description&#x3D;nginx   -   web serverAfter&#x3D;network.target remote-fs.target nss-lookup.target[Service]Type&#x3D;forkingPIDFile&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;logs&#x2F;nginx.pidExecStartPre&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -t -c &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;nginx.confExecStart&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -c &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;nginx.confExecReload&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -s reloadExecStop&#x3D;&#x2F;url&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -s stopExecQuit&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -s quitPrivateTmp&#x3D;true[Install]WantedBy&#x3D;multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h1 id="Nginx-负载均衡机制"><a href="#Nginx-负载均衡机制" class="headerlink" title="Nginx 负载均衡机制"></a>Nginx 负载均衡机制</h1><p>配置文件位置<code>/usr/local/nginx/conf/nginx.conf</code></p><h4 id="方式一：轮询、权重、备用机器、下线"><a href="#方式一：轮询、权重、备用机器、下线" class="headerlink" title="方式一：轮询、权重、备用机器、下线"></a>方式一：轮询、权重、备用机器、下线</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 配置多个代理，名字叫 abcdefg，下方可用，可以轮询（并且配置权重）upstream abcdefg&#123;# 权重为 8 的及其server 110.40.191.50:80 weight&#x3D;8;#备用机器  server 110.40.191.51:80 backup;  # down 下线，不参与轮询  server 110.40.191.52:80 down;&#125;server &#123;        listen       80;        server_name  localhost;        location &#x2F; &#123;        # 配置代理proxy_pass http:&#x2F;&#x2F;abcdefg;        &#125;        error_page   500 502 503 504  &#x2F;50x.html;        location &#x3D; &#x2F;50x.html &#123;            root   html;        &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=gray size=2>缺点：无法保持会话。</font></p><h4 id="方式二：ip-hash"><a href="#方式二：ip-hash" class="headerlink" title="方式二：ip_hash"></a>方式二：ip_hash</h4><p>不太用（不适合当下大环境，更换 ip 之后重新 hash，那么我在旅行中的火车上一直更换移动基站，就一直 hash）</p><h4 id="方式三-least-conn"><a href="#方式三-least-conn" class="headerlink" title="方式三 least_conn"></a>方式三 least_conn</h4><p>最少连接数访问（不太常用、不太合理）</p><p>有可能因为我配置的权重较低，导致其连接数较少。</p><h4 id="方式四：fair"><a href="#方式四：fair" class="headerlink" title="方式四：fair"></a>方式四：fair</h4><p>根据后端服务器响应时间来转发请求（需要安装插件）</p><h4 id="方式五：-url-hash"><a href="#方式五：-url-hash" class="headerlink" title="方式五： url_hash"></a>方式五： url_hash</h4><p>（定向流量转发）根据 url 取 hash 值，相同的 hash 值转发到同一个服务器上</p><h1 id="动静分离"><a href="#动静分离" class="headerlink" title="动静分离"></a>动静分离</h1><p>两台服务器，其中B负责跑项目，A机器负责代理到 B 机器(B机器中不包含 css|js</p><p>|img文件)</p><p>A 机器：</p><h4 id="方式一"><a href="#方式一" class="headerlink" title="方式一:"></a>方式一:</h4><p><font size=3>直接将需要的静态文件全部写全</font></p><p><code>/usr/local/nginx/conf/nginx.conf</code></p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">location &#x2F; &#123;# 代理转发到 B，其中ipAddress与port分别为B中的ip以及端口proxy_pass ipAddress:port;&#125;# A机器中的 css 文件的位置，存储在&#x2F;nginx&#x2F;html下（可以自己更换位置）location &#x2F;css&#123;  root html;  index index.html index.htm;&#125;# A机器中的 js 文件的位置，存储在&#x2F;nginx&#x2F;html下（可以自己更换位置）location &#x2F;js&#123;  root html;  index index.html index.htm;&#125;# A机器中的 img 文件的位置，存储在&#x2F;nginx&#x2F;html下（可以自己更换位置）location &#x2F;img&#123;  root html;  index index.html index.htm;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="方式二：正则匹配"><a href="#方式二：正则匹配" class="headerlink" title="方式二：正则匹配"></a>方式二：正则匹配</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">location &#x2F; &#123;# 代理转发到 B，其中ipAddress与port分别为B中的ip以及端口proxy_pass ipAddress:port;&#125;# location ~*(css|js|img)&#123;  root html;  index index.html index.htm;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>中间件</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>中间件</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【初探篇】 Nginx 动静分离（css\js\img与 html 分离）</title>
    <link href="/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91-Nginx-%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/"/>
    <url>/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91-Nginx-%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>中间件</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>初探篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【初探篇】 安装 Nginx</title>
    <link href="/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91-Nginx%20%E5%AE%89%E8%A3%85/"/>
    <url>/2022/06/09/nginx/%E3%80%90%E5%88%9D%E6%8E%A2%E7%AF%87%E3%80%91-Nginx%20%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h2 id="相关配置说明"><a href="#相关配置说明" class="headerlink" title="相关配置说明"></a>相关配置说明</h2><p>服务器版本：CentOS8 来自腾讯云的轻量级服务器，大家可以去淘宝买，48/年</p><p>Nginx 版本：<a href="http://nginx.org/download/nginx-1.2.1.tar.gz">nginx-1.2.1.tar.gz</a></p><p><br><br><br></p><h2 id="安装-Nginx"><a href="#安装-Nginx" class="headerlink" title="安装 Nginx"></a>安装 Nginx</h2><ul><li><p>下载 Nginx 安装包<a href="http://nginx.org/download/">【下载链接】</a></p></li><li><p>上传到 CentOS 任意地址（可以放在<code>/home/your_username/</code>下）</p></li><li><p>使用下面命令解压缩</p></li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">tar zxvf nginx-*.tar.gx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>使用下列命令进入包内（注意，版本不同请手动替换<code>*</code>，也可以灵活使用 <code>tab 键</code>）</li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">cd nginx-*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>使用下列命令查看相关依赖</li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">.&#x2F;configure<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>执行下列命令（可能是将依赖放到<code>/usr/local/nginx</code>文件夹下，但是这个文件夹是安装 nginx 的文件夹，请大佬们解惑）</li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>执行以下两个命令进行安装</li></ul><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">makemake install<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><ul><li><font color=red>注意：</font>这边可能会遇到两个问题，如如果遇到请参考下面方法，没有遇到就跳过：</li></ul></br><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h4 id="基础配置说明"><a href="#基础配置说明" class="headerlink" title="基础配置说明"></a>基础配置说明</h4><p>配置文件位置 <code>/usr/local/nginx/conf/index.conf</code></p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 开启进程数量worker_processes  1;# 默认可以有多少个连接events &#123;    worker_connections  1024;&#125;# http &#123;# 引入其他依赖文件 # mime.types 是请求头    include       mime.types;        default_type  application&#x2F;octet-stream;# 零拷贝    sendfile        on;# 保持连接，超时时间    keepalive_timeout  65;# 一个主机    server &#123;    # 监听端口号        listen       80;        # 主机名称        server_name  localhost;# url 一个主机下面可以有好几个 location 默认页        location &#x2F; &#123;            root   html;            index  index.html index.htm;        &#125;        #        error_page   500 502 503 504  &#x2F;50x.html;        location &#x3D; &#x2F;50x.html &#123;            root   html;        &#125;    &#125;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>mime.types文件</p><div class="code-wrapper"><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">types <span class="token punctuation">&#123;</span>    text<span class="token operator">/</span>html                             html htm shtml<span class="token punctuation">;</span>    text<span class="token operator">/</span>css                              css<span class="token punctuation">;</span>    text<span class="token operator">/</span>xml                              xml<span class="token punctuation">;</span>   …………此处省略很多    video<span class="token operator">/</span>x<span class="token operator">-</span>ms<span class="token operator">-</span>wmv                        wmv<span class="token punctuation">;</span>    video<span class="token operator">/</span>x<span class="token operator">-</span>msvideo                       avi<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h1 id="Nginx-创建脚本文件"><a href="#Nginx-创建脚本文件" class="headerlink" title="Nginx 创建脚本文件"></a>Nginx 创建脚本文件</h1><p><font size=2 color=darkgray>nginx.service</font></p><ul><li>新建一个脚本文件：<code>/usr/lib/systemd/system/nginx.service</code>（允许使用<code>systemctl</code>管理 nginx）</li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[Unit]Description&#x3D;nginx   -   web serverAfter&#x3D;network.target remote-fs.target nss-lookup.target[Service]Type&#x3D;forkingPIDFile&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;logs&#x2F;nginx.pidExecStartPre&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -t -c &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;nginx.confExecStart&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -c &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;nginx.confExecReload&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -s reloadExecStop&#x3D;&#x2F;url&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -s stopExecQuit&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx -s quitPrivateTmp&#x3D;true[Install]WantedBy&#x3D;multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h1 id="Nginx-负载均衡机制"><a href="#Nginx-负载均衡机制" class="headerlink" title="Nginx 负载均衡机制"></a>Nginx 负载均衡机制</h1><p>配置文件位置<code>/usr/local/nginx/conf/nginx.conf</code></p><h4 id="方式一：轮询、权重、备用机器、下线"><a href="#方式一：轮询、权重、备用机器、下线" class="headerlink" title="方式一：轮询、权重、备用机器、下线"></a>方式一：轮询、权重、备用机器、下线</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 配置多个代理，名字叫 abcdefg，下方可用，可以轮询（并且配置权重）upstream abcdefg&#123;# 权重为 8 的及其server 110.40.191.50:80 weight&#x3D;8;#备用机器  server 110.40.191.51:80 backup;  # down 下线，不参与轮询  server 110.40.191.52:80 down;&#125;server &#123;        listen       80;        server_name  localhost;        location &#x2F; &#123;        # 配置代理proxy_pass http:&#x2F;&#x2F;abcdefg;        &#125;        error_page   500 502 503 504  &#x2F;50x.html;        location &#x3D; &#x2F;50x.html &#123;            root   html;        &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=gray size=2>缺点：无法保持会话。</font></p><h4 id="方式二：ip-hash"><a href="#方式二：ip-hash" class="headerlink" title="方式二：ip_hash"></a>方式二：ip_hash</h4><p>不太用（不适合当下大环境，更换 ip 之后重新 hash，那么我在旅行中的火车上一直更换移动基站，就一直 hash）</p><h4 id="方式三-least-conn"><a href="#方式三-least-conn" class="headerlink" title="方式三 least_conn"></a>方式三 least_conn</h4><p>最少连接数访问（不太常用、不太合理）</p><p>有可能因为我配置的权重较低，导致其连接数较少。</p><h4 id="方式四：fair"><a href="#方式四：fair" class="headerlink" title="方式四：fair"></a>方式四：fair</h4><p>根据后端服务器响应时间来转发请求（需要安装插件）</p><h4 id="方式五：-url-hash"><a href="#方式五：-url-hash" class="headerlink" title="方式五： url_hash"></a>方式五： url_hash</h4><p>（定向流量转发）根据 url 取 hash 值，相同的 hash 值转发到同一个服务器上</p><h1 id="动静分离"><a href="#动静分离" class="headerlink" title="动静分离"></a>动静分离</h1><p>两台服务器，其中B负责跑项目，A机器负责代理到 B 机器(B机器中不包含 css|js</p><p>|img文件)</p><p>A 机器：</p><h4 id="方式一"><a href="#方式一" class="headerlink" title="方式一:"></a>方式一:</h4><p><font size=3>直接将需要的静态文件全部写全</font></p><p><code>/usr/local/nginx/conf/nginx.conf</code></p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">location &#x2F; &#123;# 代理转发到 B，其中ipAddress与port分别为B中的ip以及端口proxy_pass ipAddress:port;&#125;# A机器中的 css 文件的位置，存储在&#x2F;nginx&#x2F;html下（可以自己更换位置）location &#x2F;css&#123;  root html;  index index.html index.htm;&#125;# A机器中的 js 文件的位置，存储在&#x2F;nginx&#x2F;html下（可以自己更换位置）location &#x2F;js&#123;  root html;  index index.html index.htm;&#125;# A机器中的 img 文件的位置，存储在&#x2F;nginx&#x2F;html下（可以自己更换位置）location &#x2F;img&#123;  root html;  index index.html index.htm;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="方式二：正则匹配"><a href="#方式二：正则匹配" class="headerlink" title="方式二：正则匹配"></a>方式二：正则匹配</h4><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">location &#x2F; &#123;# 代理转发到 B，其中ipAddress与port分别为B中的ip以及端口proxy_pass ipAddress:port;&#125;# location ~*(css|js|img)&#123;  root html;  index index.html index.htm;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>中间件</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>中间件</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【纠错篇】 安装 Nginx 报错</title>
    <link href="/2022/06/09/nginx/%E3%80%90%E7%BA%A0%E9%94%99%E7%AF%87%E3%80%91-%E5%AE%89%E8%A3%85-Nginx-%E6%8A%A5%E9%94%99/"/>
    <url>/2022/06/09/nginx/%E3%80%90%E7%BA%A0%E9%94%99%E7%AF%87%E3%80%91-%E5%AE%89%E8%A3%85-Nginx-%E6%8A%A5%E9%94%99/</url>
    
    <content type="html"><![CDATA[<h1 id="在-CentOS8-上安装-Nginx-遇到的问题以及解决办法"><a href="#在-CentOS8-上安装-Nginx-遇到的问题以及解决办法" class="headerlink" title="在 CentOS8 上安装 Nginx 遇到的问题以及解决办法"></a>在 CentOS8 上安装 Nginx 遇到的问题以及解决办法</h1><ul><li><font color=red>注意：</font>这边可能会遇到两个问题，如如果遇到请参考下面方法，没有遇到就跳过：</li></ul><img style="width:900px" src="https://files.catbox.moe/pzzehv.png"><p><font size=4 color=orange>对于问题 1</font>：进入到:<code>/解压缩后的文件夹下的/objs</code>下，使用 vim 打开 Makefile 并删除下列代码中的<code>-Werror</code></p><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 删除前CFLAGS &#x3D;  -pipe  -O -W -Wall -Wpointer-arith -Wno-unused-parameter -Werror -g　# 删除后CFLAGS &#x3D;  -pipe  -O -W -Wall -Wpointer-arith -Wno-unused-parameter -g　<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=orange size-4>问题 2</font>：进入到下方文件夹，使用 vim 打开<code>ngx-user.c</code>后注释掉下面一行代码</p><img style="width:900px" src="https://files.catbox.moe/4an2rk.png"><div class="code-wrapper"><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">cd.current_salt[0] &#x3D; ~salt[0];<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>两个问题修改之后的效果：</p><img style="width:600px" src="https://files.catbox.moe/et9ri8.png"><img style="width:600px" src="https://files.catbox.moe/6pxib8.png"><hr><p><font color=#7baf23 size=2>问题已解决！</font></p>]]></content>
    
    
    <categories>
      
      <category>中间件</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>纠错篇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】 泛型</title>
    <link href="/2022/03/23/%E3%80%90Java%E3%80%91-%E6%B3%9B%E5%9E%8B/"/>
    <url>/2022/03/23/%E3%80%90Java%E3%80%91-%E6%B3%9B%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h2><hr><h3 id="泛型类"><a href="#泛型类" class="headerlink" title="泛型类"></a>泛型类</h3><p>为类设置一个泛型，然后可以在类中使用它</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>  <span class="token keyword">private</span> <span class="token class-name">T</span> name<span class="token punctuation">;</span>  <span class="token keyword">private</span> <span class="token class-name">T</span> address<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">T</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAddress</span><span class="token punctuation">(</span><span class="token class-name">T</span> address<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> name<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> address<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    p<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="泛型方法-普通泛型方法-静态方法"><a href="#泛型方法-普通泛型方法-静态方法" class="headerlink" title="泛型方法 | 普通泛型方法 | 静态方法"></a>泛型方法 | <font size=2>普通泛型方法 | 静态方法</font></h3><p>泛型方法在定义泛型的类型的时候可以脱离类</p><p>比如类是<code>&lt;T&gt;</code>而类可以写成<code>&lt;M&gt;</code>，然后传什么参数都可以</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 普通方法</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person3</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">"正在睡觉"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// 泛型方法</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person3</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>  <span class="token comment">// 普通泛型方法</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">T</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">"正在睡觉"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token comment">// 静态泛型方法</span>  <span class="token comment">// 静态泛型方法中的类型占位符与类中的泛型占位符没有关系</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">W</span><span class="token punctuation">></span></span> <span class="token keyword">void</span> <span class="token function">show1</span><span class="token punctuation">(</span><span class="token class-name">W</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"静态方法"</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">"正在睡觉"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">></span></span> <span class="token class-name">E</span> <span class="token function">show2</span><span class="token punctuation">(</span><span class="token class-name">E</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> name<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show3</span><span class="token punctuation">(</span><span class="token class-name">A</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"普通泛型方法"</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">"未指定类型"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 调用普通泛型方法</span>    <span class="token class-name">Person3</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person3</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    p<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token string">"Test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 调用静态泛型方法</span>    <span class="token class-name">Person3</span><span class="token punctuation">.</span><span class="token function">show1</span><span class="token punctuation">(</span><span class="token string">"你好世界"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Person3</span><span class="token punctuation">.</span><span class="token function">show2</span><span class="token punctuation">(</span><span class="token string">"你好世界"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    p<span class="token punctuation">.</span><span class="token function">show3</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    p<span class="token punctuation">.</span><span class="token function">show3</span><span class="token punctuation">(</span><span class="token string">"Hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="泛型接口"><a href="#泛型接口" class="headerlink" title="泛型接口"></a>泛型接口</h2><ol><li>实现接口的时候可以指定具体的泛型类型</li><li>如果实现的时候没有指定，那么必须要在这个实现类中声明一个泛型给接口用</li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 接口</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PerInt</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">T</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="实现接口的时候直接指定泛型"><a href="#实现接口的时候直接指定泛型" class="headerlink" title="实现接口的时候直接指定泛型"></a>实现接口的时候直接指定泛型</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 实现类 在实现的时候定义泛型的类型</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerIntImpl</span> <span class="token keyword">implements</span> <span class="token class-name">PerInt</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="不实现相关方法"><a href="#不实现相关方法" class="headerlink" title="不实现相关方法"></a>不实现相关方法</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 实现类 不指定方法</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PerIntImpl2</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">PerInt</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">T</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 调用</span><span class="token class-name">PerIntImpl</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerIntImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    p<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">PerIntImpl1</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerIntImpl1</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="泛型擦除模式"><a href="#泛型擦除模式" class="headerlink" title="泛型擦除模式"></a>泛型擦除模式</h3><ol><li>在编码时候写的泛型类型，在反射阶段（代码编译阶段）会将泛型类型给擦除掉，所以对比以下两个泛型才会是一致的。</li><li>擦除模式就是在编码运行期间将反省全部去掉</li><li>为什么要使用擦除模式？<ol><li>为了兼容 JDK 老版本的编码</li></ol></li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">private</span> <span class="token class-name">T</span> name<span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">T</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> name<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"方法被调用"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> p  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> p1<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>        <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span>  p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> p3<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>        <span class="token comment">// Person4 p2 = new Person();</span><span class="token comment">// Person4 p3 = new Person();  </span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="泛型通配符"><a href="#泛型通配符" class="headerlink" title="泛型通配符"></a>泛型通配符</h2><p>泛型通配符</p><p>通配符：由于java 中的继承关系，在泛型中不做任何声明修饰的情况下是不被认可的，所以要使用通配符进行处理</p><p>通配符 一般使用 ? 来表示，可以理解为 ? 是泛型中所有类的父类</p><p>接下来会使用通配符在反省中将 java 中的继承关系重新绑定</p><p>通配符的上边界与下边界(excends 与 super )</p><p>java 中的继承并不是泛型中的继承</p><p>java 中的父子类关系在泛型中并不是父子类关系</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">private</span> <span class="token class-name">T</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">T</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> name<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Number</span><span class="token punctuation">></span></span> p  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Number</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    p1<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    p<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用 ? 之后正常，不使用 ? 会报错 </span>    p<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 正常</span>        <span class="token comment">// 只有 java 中的父子关系泛型是不认的</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><h4 id="extends-与-super"><a href="#extends-与-super" class="headerlink" title="extends 与 super"></a>extends 与 super</h4><p> ? excends T 代表可以传进来 T本身 或者 T的子类（ 比如 Integer 与 Number ） 上边界<br> ? super T 代表可以传进来 T本身 或者 T的父类     下边界</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ? excends T 代表可以传进来 T本身 或者 T的子类（ 比如 Integer 与 Number ） 上边界</span><span class="token comment">// ? super T 代表可以传进来 T本身 或者 T的父类 下边界</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">private</span> <span class="token class-name">T</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">T</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> name<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>      <span class="token comment">// 如果是 super 的话则应该是可以传入 T 和 T 的父类</span>  <span class="token comment">// 表示可以传入 T 和 T 的子类</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> excends <span class="token class-name">T</span><span class="token punctuation">></span></span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Number</span><span class="token punctuation">></span></span> p  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Number</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Person</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person4</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    p1<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    p<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用 ? 之后正常，不使用 ? 会报错 </span>    p<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 正常</span>        <span class="token comment">// 只有 java 中的父子关系泛型是不认的</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>什么时候用上边界？</p><p>在读取 T 这个类型数据的时候，但不写入数据的时候，使用上边界</p><p>什么时候使用下边界？</p><p>需要写入数据但是不需要读取的时候，使用下边界</p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>进阶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【服务器】在 CentOS 服务器部署 Springboot 项目(使用pm2托管)</title>
    <link href="/2022/03/22/%E3%80%90%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%91%E5%9C%A8-CentOS-%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2-Springboot-%E9%A1%B9%E7%9B%AE(%E4%BD%BF%E7%94%A8pm2-)/"/>
    <url>/2022/03/22/%E3%80%90%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%91%E5%9C%A8-CentOS-%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2-Springboot-%E9%A1%B9%E7%9B%AE(%E4%BD%BF%E7%94%A8pm2-)/</url>
    
    <content type="html"><![CDATA[<div class="note note-success">            <h2 id="在CentOS-服务器部署-Springboot-项目"><a href="#在CentOS-服务器部署-Springboot-项目" class="headerlink" title="在CentOS 服务器部署 Springboot 项目"></a>在CentOS 服务器部署 Springboot 项目</h2>          </div><div class="note note-primary">            <h4 id="准备工作-安装-JDk"><a href="#准备工作-安装-JDk" class="headerlink" title="准备工作 | 安装 JDk"></a>准备工作 | 安装 JDk</h4>          </div><span class="label label-warning">依次</span>执行下列命令，查看自己的处理器型号并安装对应的 jdk<p><font size=2 color=Orange><font color=red>注意！</font>wget 并不是唯一下载文件的方式，如果下载太慢或者下载失败，可以考虑其他方式（比如我就是下载到本地后，用宝塔上传到服务器，解压缩重命名等一系列操作都是在宝塔完成的。</font></p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 查看处理器型号 运行结果 x86_64uname -m# 执行下列命令，进入 &#96;&#x2F;usr&#x2F;local&#96; 文件夹下并创建 jdk 文件夹并进入该文件夹cd &#x2F;usr&#x2F;localmkdir jdkcd jdk# 使用 wget+url 的方式下载相应的 jdk 压缩文件（推荐）wget https:&#x2F;&#x2F;www.oracle.com&#x2F;java&#x2F;technologies&#x2F;downloads&#x2F;#license-lightbox#执行下列命令，解压缩文件 并 移动到 &#96;jdk1.8&#96; 文件夹下（压缩包文件名可能不一致，可以使用 ls 命令查看文件夹下有哪些文件sudo tar -xvf jdk-8u144-linux-x64.tar.gzmv jdk-8u144-linux-x64 jdk1.8# 删除压缩包rm -rf jdk-8u144-linux-x64.tar.gz# 修改环境变量（注意一定要在 root 模式下执行）sudo vim &#x2F;etc&#x2F;profile# 在该文件内加入以下内容 （vim 的基本使用操作不再赘述，可以去我的博客里面搜索&#96;vim&#96;找到相应的文档）# 记得查看 file 地址是否正确export JAVA_HOME&#x3D;&#x2F;usr&#x2F;local&#x2F;jdk&#x2F;jdk1.8export JRE_HOME&#x3D;&#x2F;usr&#x2F;local&#x2F;jdk&#x2F;jdk1.8&#x2F;jreexport CLASSPATH&#x3D;.:$JAVA_HOME&#x2F;LIB&#x2F;DT.JAR:$JAVA_HOME&#x2F;lib&#x2F;tools.jar:$JAVA_HOME&#x2F;lib:$CLASSPATHexport PATH&#x3D;$JAVA_HOME&#x2F;bin:$PATH# 使用 esc + :wq 保存并退出文档后，执行下列命令，使配置生效sudo source &#x2F;etc&#x2F;profile# 使用下列命令查看是否生效java -version# 显示下列提示时，安装成功java version &quot;1.8.0_144&quot; Java(TM) SE Runtime Environment (build 1.8.0_144-b03) Java HotSpot(TM) 64-Bit Server VM (build 25.77-b03, mixed mode)# 不成功请回过头检查哪一步操作错误了，尤其是环境变量的文件地址是否正确（记得常使用 ls 随时查看）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <h4 id="在本地将项目打成-jar-包"><a href="#在本地将项目打成-jar-包" class="headerlink" title="在本地将项目打成 jar 包"></a>在本地将项目打成 jar 包</h4>          </div><p>打开 IDEA 后，在右侧的 <span class="label label-success">Maven</span> 菜单中，执行一次’ <span class="label label-success">package</span> ‘，随后 Maven 会在左侧目录树中自动生成 target 目录，打开即可在下面找到与项目名同名的项目名称<span class="label label-success">.jar</span> 文件，将其上传到服务器的任意文件夹下（我推荐创建一个新的文件夹’/home/JavaDemo ‘并存放到该文件夹下）</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 执行下列命令，进入到该文件夹下（文件夹名称按你的来）cd &#x2F;home&#x2F;JavaDemo# 执行下列命令，启动 Springboot 项目java -jar 项目名称.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>执行上述命令后，可以看到控制台开始打印日志，则项目启动成功</p><p><br><br><br><br></p><hr><p>原本到这里应该就结束了，但是与 Hexo 项目一样，当你关闭 ssh 窗口后，ssh 连接断开，项目就会自动关闭了（该操作相当于你关闭了本地的 terminal 端口并且在跳出来的小弹窗中选择了<span class="label label-danger">kill</span>这个进程。</p><p>于是接下来就要思考，如何保证 Springboot 项目稳定运行不关闭呢？在之前进行 Hexo 部署的时候，我考虑的解决方案是保持 ssh 长连接，首先不能关闭窗口这就比较麻烦，我本地的机器一关机服务器也不能用了，我还不如部署到本地；其次如果一段时间不进行操作，ssh 也会自动失去连接（这一点应该可以设置，但是我并没有进行尝试，毕竟这种方法太鸡肋了）。</p><p>于是就想到了 pm2，将项目交由 pm2 托管，无论 ssh 连接如何都无所谓。</p><div class="note note-success">            <h2 id="使用-pm2-托管-Springboot-项目"><a href="#使用-pm2-托管-Springboot-项目" class="headerlink" title="使用 pm2 托管 Springboot 项目"></a>使用 pm2 托管 Springboot 项目</h2>          </div><div class="note note-primary">            <h4 id="安装-pm2"><a href="#安装-pm2" class="headerlink" title="安装 pm2"></a>安装 pm2</h4>          </div><ul><li>安装 nodejs</li><li>npm install pm2 -g</li></ul><div class="note note-primary">            <h4 id="创建托管文件"><a href="#创建托管文件" class="headerlink" title="创建托管文件"></a>创建托管文件</h4>          </div><p>在项目的同级目录下创建一个 name.json 文件（name 随你取，直接叫 name 也可以）</p><p>将下列代码复制到 name.json 文件夹中去</p><div class="code-wrapper"><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-server"</span><span class="token punctuation">,</span>    <span class="token property">"script"</span><span class="token operator">:</span> <span class="token string">"/usr/local/jdk/jdk8/bin/java"</span><span class="token punctuation">,</span>    <span class="token property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token string">"-jar"</span><span class="token punctuation">,</span>        <span class="token string">"demo4.jar"</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"exec_interpreter"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    <span class="token property">"exec_mode"</span><span class="token operator">:</span> <span class="token string">"fork"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>name 进程名称（显示在<code>pm2 list</code>命令中）</li><li>script 执行进程名称，如果需要执行PHP脚本则填写php解释器的路径，本文为java(找到你的 jdk/bin/java)</li><li>args 传给执行进程的参数，多个参数以数组单元分割</li><li>exec_interpreter NodeJs解析器，本文不适用</li><li>exec_mode 执行模式[cluster|fork]这个针对NodeJs应用的配置，非NodeJs应用统一fork</li></ul><p>保存并退出文件</p><br><div class="note note-primary">            <h4 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h4>          </div><p>使用下列指令启动 pm2 项目</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pm2 start name.json<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>项目启动后，控制台不会有任何输出，可以直接使用浏览器或者 postman 进行访问测试。</p><p>进行其他操作可以参考下列命令</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 查看目前 pm2 托管了哪些项目pm2 list# 每一个交由 pm2 托管的项目都会获得一个 id，下列的 0 就是 一个 id# 停止某个 pm2 项目（ 0是 进程id 想关哪个就关哪个）pm2 stop 0# 已经交由 pm2 托管的项目，再次启动的话无需找到相应的 js&#x2F;JSON 文件，只需 start 相应的进程 id 就可以pm2 start 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><p><br><br><br></p><div class="note note-primary">            <h2 id="访问效果"><a href="#访问效果" class="headerlink" title="访问效果"></a>访问效果</h2>          </div><p>此时已经关闭了 ssh 连接了</p><p><img src="https://img-blog.csdnimg.cn/36b0c50031f6433eb6d94ffbd9f772f2.png" alt="访问效果"></p>]]></content>
    
    
    <categories>
      
      <category>服务器</category>
      
    </categories>
    
    
    <tags>
      
      <tag>服务器</tag>
      
      <tag>项目部署</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【服务器】在腾讯云上启用 Nexus 私服的一些问题</title>
    <link href="/2022/03/22/%E3%80%90%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%91%E5%9C%A8%E8%85%BE%E8%AE%AF%E4%BA%91%E4%B8%8A%E5%90%AF%E7%94%A8-Nexus-%E7%A7%81%E6%9C%8D%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/"/>
    <url>/2022/03/22/%E3%80%90%E6%9C%8D%E5%8A%A1%E5%99%A8%E3%80%91%E5%9C%A8%E8%85%BE%E8%AE%AF%E4%BA%91%E4%B8%8A%E5%90%AF%E7%94%A8-Nexus-%E7%A7%81%E6%9C%8D%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="在腾讯云上启用-Nexus-私服的一些问题"><a href="#在腾讯云上启用-Nexus-私服的一些问题" class="headerlink" title="在腾讯云上启用 Nexus 私服的一些问题"></a>在腾讯云上启用 Nexus 私服的一些问题</h1><hr><h3 id="Linux-服务器信息"><a href="#Linux-服务器信息" class="headerlink" title="Linux 服务器信息"></a>Linux 服务器信息</h3><blockquote><p>Linux VM-4-17-centos 4.18.0-305.19.1.el8_4.x86_64 #1 SMP Wed Sep 15 15:39:39 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</p><p>x86_64</p></blockquote><p><br><br><br><br><br></p><div class="note note-primary">            <p><strong>报错</strong></p>          </div><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c">WARNING<span class="token operator">:</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>WARNING<span class="token operator">:</span> Detected execution as <span class="token string">"root"</span> user<span class="token punctuation">.</span>  This is NOT recommended<span class="token operator">!</span>WARNING<span class="token operator">:</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>Starting nexus<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-success">            <p><strong>解决方案</strong></p>          </div><p>对于这个问题网上给出了很多的解决办法，但是既然给出的问题是“<span class="label label-danger">不能使用 root用户</span>”，那么我的解决方案就是使用<span class="label label-success">exit</span>命令退出 <span class="label label-danger">root</span> 模式后重新启动。</p><div class="note note-primary">            <p><strong>问题</strong></p>          </div><p>由于 Nexus 的默认端口 8081 与开发中的 8080 比较接近，一般开发中我会将 8081 作为第二项目的启动接口（比如 Vue 等），因此我将 Nexus 的默认端口修改为了 3939。</p><div class="note note-success">            <p><strong>修改方法如下：</strong></p>          </div><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 执行以下命令 | 打开 nexus 的默认配置文件vim .&#x2F;etc&#x2F;nexus-default.properties# 添加以下代码后重启 Nexusapplication-port&#x3D;3939<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <p><strong>问题</strong></p>          </div><p>明明安装了 jdk1.8，配置好了环境变量，但是运行还是出现以下错误</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">No suitable Java Virtual Machine could be found on your system.The version of the JVM must be at least 1.8 and at most 1.8.Please define INSTALL4J_JAVA_HOME to point to a suitable JVM.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><div class="note note-success">            <p><strong>解决方案</strong></p>          </div><p>在使用 vim 打开  /usr/local/nexus/nexus-3.38.0-01/bin/nexu</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 使用 vim 打开 bin 文件夹下的 nexus 文件vim &#x2F;usr&#x2F;local&#x2F;nexus&#x2F;nexus-3.38.0-01&#x2F;bin&#x2F;nexus# 添加如下代码INSTALL4J_JAVA_HOME_OVERRIDE&#x3D;&#x2F;usr&#x2F;local&#x2F;jdk&#x2F;jdk8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="关于-vim"><a href="#关于-vim" class="headerlink" title="关于 vim"></a>关于 vim</h2><p>如果不熟悉 vim 操作的话可以<a href="http://110.40.191.51/2021/10/10/%E3%80%90%E8%AE%B0%E3%80%91Vim%EF%BD%9C%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6/">点击此处</a>查看 vim 相关操作</p>]]></content>
    
    
    <categories>
      
      <category>服务器</category>
      
    </categories>
    
    
    <tags>
      
      <tag>服务器</tag>
      
      <tag>Maven</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【IDEA】Mac IDEA 快捷键</title>
    <link href="/2022/03/20/IDEA/%E3%80%90IDEA%E3%80%91Mac-IDEA-%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    <url>/2022/03/20/IDEA/%E3%80%90IDEA%E3%80%91Mac-IDEA-%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="Mac-Idea-快捷键"><a href="#Mac-Idea-快捷键" class="headerlink" title="Mac Idea 快捷键"></a>Mac Idea 快捷键</h1><hr><h3 id="构造函数、set-get方法、toString、Override、Implement、Test"><a href="#构造函数、set-get方法、toString、Override、Implement、Test" class="headerlink" title="构造函数、set/get方法、toString、Override、Implement、Test"></a>构造函数、set/get方法、toString、Override、Implement、Test</h3><div style="align-items: center;display:flex;height:50px;text-align:center;background:#29313B;border-radius:25px;border:1px solid #eae6e6;"><span style="margin-left:45%;color:white;font-size:20px;font-family:黑体">Command+N</span></div><br><div style="text-align:center"><img src="https://files.catbox.moe/ntxubg.png" style="width:200px"  /></div>]]></content>
    
    
    <categories>
      
      <category>IDEA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IDEA</tag>
      
      <tag>快捷键</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Springboot】 约定大于配置</title>
    <link href="/2022/03/19/%E3%80%90Springboot%E3%80%91Springboot-%E7%BA%A6%E5%AE%9A%E5%A4%A7%E4%BA%8E%E9%85%8D%E7%BD%AE/"/>
    <url>/2022/03/19/%E3%80%90Springboot%E3%80%91Springboot-%E7%BA%A6%E5%AE%9A%E5%A4%A7%E4%BA%8E%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="Springboot-约定大于配置"><a href="#Springboot-约定大于配置" class="headerlink" title="Springboot 约定大于配置"></a>Springboot 约定大于配置</h2><hr><div class="note note-primary">            <h4 id="关于约定大于配置。"><a href="#关于约定大于配置。" class="headerlink" title="关于约定大于配置。"></a>关于约定大于配置。</h4>          </div><p>首先这是一种开发思想，并不是说 Springboot 创造了这种思想，而是 Springboot 实践了这一思想。</p><div class="note note-primary">            <h4 id="Springboot-对于这种思想的实现过程"><a href="#Springboot-对于这种思想的实现过程" class="headerlink" title="Springboot 对于这种思想的实现过程"></a>Springboot 对于这种思想的实现过程</h4>          </div><p>在我们创建 Springboot 项目的时候，框架会根据pom 文件中的dependencies 对项目做出相关配置（好比我们在使用了 web 依赖后，不再需要手动配置 Tomcat，框架自动配置好），这一操作可以大大简化开发，节省很多不必要的操作。</p><p>但是默认配置的并不一定是最好的。某些项目可能需要 DIY，如果仅提供默认配置，那么肯定会不满足一些用户的需求，因此 Springboot 巧妙地利用容器，让用户可以自己 DIY。</p><p>具体的实现过程就是，Springboot 利用@ConfigurationOnMiss 注解，判断容器中是否有 A 实例化对象，如果没有则创建一个默认的 A 实例化对象以供用户使用，有则不进行操作。</p><div class="note note-primary">            <h4 id="SpringBoot中的约定"><a href="#SpringBoot中的约定" class="headerlink" title="SpringBoot中的约定"></a>SpringBoot中的约定</h4>          </div><p>1、Maven的目录结构。默认有resources文件夹,存放资源配置文件。src-main-resources,src-main-java。默认的编译生成的类都在targe文件夹下面<br>2、spring boot默认的配置文件必须是，也只能是application.命名的yml文件或者properties文件，且唯一<br>3、application.yml中默认属性。数据库连接信息必须是以spring: datasource: 为前缀；多环境配置。该属性可以根据运行环境自动读取不同的配置文件；端口号、请求路径等</p><div class="note note-primary">            <h4 id="相关注解"><a href="#相关注解" class="headerlink" title="相关注解"></a>相关注解</h4>          </div><hr><table><thead><tr><th>注解</th><th>作用</th></tr></thead><tbody><tr><td><font color=orange>@Configuration</font></td><td>告诉容器这是一个配置类</td></tr><tr><td><font color=orange>@Bean</font></td><td>创建一个实例化对象</td></tr><tr><td><font color=orange>@ConfigurationOnMiss</font></td><td>判断容器中是否有这个实例化对象，有则执行注解下方的方法（通常是创建一个默认的实例化对象）</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Springboot</tag>
      
      <tag>入门</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Vue】入门与进阶（尚未完成进阶部分）</title>
    <link href="/2022/03/17/%E3%80%90Vue%E3%80%91-Vue-%EF%BD%9C-%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6%EF%BC%88%E5%B0%9A%E6%9C%AA%E5%AE%8C%E6%88%90%E8%BF%9B%E9%98%B6%E9%83%A8%E5%88%86%EF%BC%89/"/>
    <url>/2022/03/17/%E3%80%90Vue%E3%80%91-Vue-%EF%BD%9C-%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6%EF%BC%88%E5%B0%9A%E6%9C%AA%E5%AE%8C%E6%88%90%E8%BF%9B%E9%98%B6%E9%83%A8%E5%88%86%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<div class="note note-primary">            <h4 id="笔记地址"><a href="#笔记地址" class="headerlink" title="笔记地址"></a>笔记地址</h4><p><a href="https://github.com/Jimecc/Vue_Study">https://github.com/Jimecc/Vue_Study</a></p>          </div><p>目前还未整理成笔记</p>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
      <tag>前端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】Java 内部类</title>
    <link href="/2022/03/14/%E3%80%90Java%E3%80%91Java%20%E5%86%85%E9%83%A8%E7%B1%BB/"/>
    <url>/2022/03/14/%E3%80%90Java%E3%80%91Java%20%E5%86%85%E9%83%A8%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h2 id="Java-内部类"><a href="#Java-内部类" class="headerlink" title="Java 内部类"></a>Java 内部类</h2><p>一般来说，类和类之间是互相独立的，但是内部类的出现打破了这种独立关系，让一个类成为另外一个类的内部信息，和成员变量、成员方法等同级别。</p><h4 id="为什么要使用内部类"><a href="#为什么要使用内部类" class="headerlink" title="为什么要使用内部类"></a>为什么要使用内部类</h4><p>采用内部类可以隐藏细节和内部结构，封装性更好，让程序的结构更加合理。</p><div class="note note-primary">            <h3 id="非静态内部类"><a href="#非静态内部类" class="headerlink" title="非静态内部类"></a>非静态内部类</h3>          </div><p>非静态内部类的使用就是将内部类作为外部类的一个成员变量/成员方法来使用，所以必须依赖外部类的对象才能调用，用法与成员变量/成员方法是一致的。</p><div class="note note-primary">            <h4 id="类中的内部类"><a href="#类中的内部类" class="headerlink" title="类中的内部类"></a>类中的内部类</h4>          </div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 类文件</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OutClass</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InnerClass</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token class-name">String</span> innerName<span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"InnerClashh display"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>innerName<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token class-name">InnerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>innerName <span class="token operator">=</span> <span class="token string">"Inner Class"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Main 方法运行体</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo4Application</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//        SpringApplication.run(Demo4Application.class,args);</span>        <span class="token comment">// 非静态内部类（类种类）</span>        <span class="token class-name">OutClass</span> outClass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OutClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">OutClass<span class="token punctuation">.</span>InnerClass</span> innerClass <span class="token operator">=</span> outClass<span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token class-name">InnerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        innerClass<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <h4 id="方法体中的内部类"><a href="#方法体中的内部类" class="headerlink" title="方法体中的内部类"></a>方法体中的内部类</h4>          </div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OutClass</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> outerName<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">class</span> <span class="token class-name">InnerClass</span><span class="token punctuation">&#123;</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Method Inner class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">InnerClass</span> innerClass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InnerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        innerClass<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Main 方法运行体</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo4Application</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">OutClass</span> outClass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OutClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        outClass<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <h3 id="静态内部类"><a href="#静态内部类" class="headerlink" title="静态内部类"></a>静态内部类</h3>          </div><p>静态内部类的构造不需要依赖于外部类对象，类中的所有静态组件都不需要依赖于任何对象，可以直接通过类本身进行构造。</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StaticClass</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">InnerClass</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token class-name">InnerName</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token class-name">InnerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>InnerName</span> <span class="token operator">=</span> <span class="token string">"Inner Name 123"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"InnerClass Display"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">InnerName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// 运行体 1 Main 方法</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ags<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">InnerClass</span> innerClass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InnerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        innerClass<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo4Application</span> <span class="token punctuation">&#123;</span><span class="token comment">// 运行体 2 Main 方法</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">StaticClass<span class="token punctuation">.</span>InnerClass</span> innerClass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StaticClass<span class="token punctuation">.</span>InnerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        innerClass<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <h3 id="匿名内部类"><a href="#匿名内部类" class="headerlink" title="匿名内部类"></a>匿名内部类</h3>          </div><p>没有名字的内部类，直接在外部类中实现一个接口，并将实现信息写在其中。</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo4Application</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// 匿名内部类</span>        <span class="token class-name">MyInterface</span> myInterface <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello Interface"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token class-name"><span class="token namespace">myInterface<span class="token punctuation">.</span></span>Hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>进阶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【学】 Java 手动/自动 拆箱装箱</title>
    <link href="/2022/03/12/%E3%80%90%E5%AD%A6%E3%80%91Java%E8%87%AA%E5%8A%A8%E8%A3%85%E7%AE%B1%E4%B8%8E%E6%8B%86%E7%AE%B1/"/>
    <url>/2022/03/12/%E3%80%90%E5%AD%A6%E3%80%91Java%E8%87%AA%E5%8A%A8%E8%A3%85%E7%AE%B1%E4%B8%8E%E6%8B%86%E7%AE%B1/</url>
    
    <content type="html"><![CDATA[<h1 id="Java-自动装箱与拆箱"><a href="#Java-自动装箱与拆箱" class="headerlink" title="Java 自动装箱与拆箱"></a>Java 自动装箱与拆箱</h1><div class="note note-primary">            <h2 id="基本类与包装类"><a href="#基本类与包装类" class="headerlink" title="基本类与包装类"></a>基本类与包装类</h2>          </div><table><thead><tr><th align="center">基本类</th><th align="center">大小</th><th align="center">包装类</th></tr></thead><tbody><tr><td align="center">boolean</td><td align="center">/</td><td align="center">Boolean</td></tr><tr><td align="center">char</td><td align="center">16bit</td><td align="center">Character</td></tr><tr><td align="center">byte</td><td align="center">8bit</td><td align="center">Byte</td></tr><tr><td align="center">short</td><td align="center">16bit</td><td align="center">Short</td></tr><tr><td align="center">int</td><td align="center">32bit</td><td align="center">Integer</td></tr><tr><td align="center">long</td><td align="center">64bit</td><td align="center">Long</td></tr><tr><td align="center">float</td><td align="center">32bit</td><td align="center">Float</td></tr><tr><td align="center">double</td><td align="center">64bit</td><td align="center">Double</td></tr><tr><td align="center">void</td><td align="center">/</td><td align="center">Void</td></tr><tr><td align="center"><font color=white>——————————————————————</font></td><td align="center"><font color=white>——————————————————————</font></td><td align="center"><font color=white>——————————————————————</font></td></tr></tbody></table><div class="note note-primary">            <h2 id="为什么会有自动装箱与拆箱"><a href="#为什么会有自动装箱与拆箱" class="headerlink" title="为什么会有自动装箱与拆箱"></a>为什么会有自动装箱与拆箱</h2>          </div><img src="https://img-blog.csdnimg.cn/ebc60d289ca849c3b51cca2e6831619d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiN6aOf6Iqx55Sf55qE54yr,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" alt="装箱拆箱" style="zoom:50%;" /><p>如图所示，当我新建一个 <code>List&lt;int&gt;</code>的时候，代码报错了，可以看到 IDEA 提示我可以通过 java.lang.Integer 来替换 int。</p><p>包括 List、Map在内的许多方法都只能使用包装类，因此拆箱与装箱是有存在的必要的。</p><div class="note note-primary">            <h2 id="手动拆箱、装箱"><a href="#手动拆箱、装箱" class="headerlink" title="手动拆箱、装箱"></a>手动拆箱、装箱</h2>          </div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> inta <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">// 自定义一个 Integer 类型的变量</span><span class="token class-name">Integer</span> integer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span><span class="token string">"20"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 使用 intValue()方法 手动拆箱</span><span class="token keyword">int</span> int2 <span class="token operator">=</span> integer<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 使用 valueOf ()方法 手动装箱</span><span class="token class-name">Integer</span> integer3 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>inta<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 实现了 String 类型到 int 类型的转换</span>inta <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 实现了 int 类型到 Sting 类型的转换</span><span class="token class-name">String</span> str1 <span class="token operator">=</span> <span class="token string">""</span><span class="token operator">+</span>inta<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"转换的字符串是："</span><span class="token operator">+</span>str1<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <h2 id="自从-Java1-5-之后，Java-便可以实现自动装箱拆箱。"><a href="#自从-Java1-5-之后，Java-便可以实现自动装箱拆箱。" class="headerlink" title="自从 Java1.5 之后，Java 便可以实现自动装箱拆箱。"></a>自从 Java1.5 之后，Java 便可以实现自动装箱拆箱。</h2>          </div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 从 JDK1.5 开始，增加了自动拆箱与自动装箱</span><span class="token comment">// 自动装箱</span><span class="token class-name">Integer</span> it2 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">// 自动拆箱</span><span class="token keyword">int</span> int3 <span class="token operator">=</span> it2<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <h2 id="一些有意思的东西"><a href="#一些有意思的东西" class="headerlink" title="一些有意思的东西"></a>一些有意思的东西</h2>          </div><div class="note note-primary">            <h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3>          </div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Integer</span> i <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span><span class="token class-name">Integer</span> j <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i <span class="token operator">==</span> j <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span><span class="token class-name">Integer</span> k <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">;</span><span class="token class-name">Integer</span> p <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>k <span class="token operator">==</span> p <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span><span class="token class-name">Integer</span> c <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">128</span><span class="token punctuation">;</span><span class="token class-name">Integer</span> d <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">128</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c <span class="token operator">==</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span><span class="token class-name">Integer</span> e <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">129</span><span class="token punctuation">;</span><span class="token class-name">Integer</span> f <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">129</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e <span class="token operator">==</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3>          </div><p>Integer.class在装载（Java虚拟机启动）时，其内部类型IntegerCache的static块即开始执行，实例化并暂存数值在-128到127之间的Integer类型对象。当自动装箱int型值在-128到127之间时，即直接返回IntegerCache中暂存的Integer类型对象。</p><div class="note note-success">            <h3 id="提问"><a href="#提问" class="headerlink" title="提问"></a>提问</h3>          </div><p>如何对比范围在[-128,128]之外的 Integer 类型是否相等？</p><div class="note note-success">            <h3 id="解答"><a href="#解答" class="headerlink" title="解答"></a>解答</h3>          </div><p>使用<span class="label label-primary">integer1.equals( integer2 )</span></p>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>基础</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Error】Springboot 整合 Swagger2 报错问题的两种解决方案</title>
    <link href="/2022/03/10/%E3%80%90Java%E3%80%91Springboot_Swagger/"/>
    <url>/2022/03/10/%E3%80%90Java%E3%80%91Springboot_Swagger/</url>
    
    <content type="html"><![CDATA[<h1 id="【Error】Springboot-整合-Swagger2-报错问题的两种解决方案-不食花生的猫"><a href="#【Error】Springboot-整合-Swagger2-报错问题的两种解决方案-不食花生的猫" class="headerlink" title="【Error】Springboot 整合 Swagger2 报错问题的两种解决方案 | 不食花生的猫"></a>【Error】Springboot 整合 Swagger2 报错问题的两种解决方案 | <font size=2 color=darkgray>不食花生的猫</font></h1><hr><br><div class="note note-default">            <ul><li><p>Springboot - 2.6.4 <font size=3 color=darkgray>Springboot 版本信息</font></p></li><li><p>Swagger - 2.9.2  <font size=3 color=darkgray>Swagger2版本信息</font></p></li></ul>          </div><span id="more"></span><br><table><tr><td bgcolor=orange>报错信息如下</td></tr></table><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">2022-03-18 01:43:38.127 ERROR 45845 --- [o-8080-Acceptor] org.apache.tomcat.util.net.Acceptor      : Socket accept failedjava.nio.channels.AsynchronousCloseException: nullat java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:205) ~[na:1.8.0_211]at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:257) ~[na:1.8.0_211]at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:545) ~[tomcat-embed-core-9.0.58.jar:9.0.58]at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:78) ~[tomcat-embed-core-9.0.58.jar:9.0.58]at org.apache.tomcat.util.net.Acceptor.run(Acceptor.java:129) ~[tomcat-embed-core-9.0.58.jar:9.0.58]at java.lang.Thread.run(Thread.java:748) [na:1.8.0_211]2022-03-18 01:43:38.149  INFO 45845 --- [  restartedMain] ConditionEvaluationReportLoggingListener : Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.2022-03-18 01:43:38.176 ERROR 45845 --- [  restartedMain] o.s.boot.SpringApplication               : Application run failedorg.springframework.context.ApplicationContextException: Failed to start bean 'documentationPluginsBootstrapper'; nested exception is java.lang.NullPointerException<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br></p><div class="note note-info">            <p><font color=orange size=4>解决方案一</font> | <font colot=white size=3 >降低 pom 文件中 parent 的版本</font></p>          </div><ul><li>原因：由于 Springboot 版本过高，与 Swagger 不兼容，所以降低 Springboot 版本</li><li>方案：在 application.properties 文件中，将 parent 中的 version 修改为 2.5.9</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.5.9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--        &lt;version>2.6.4&lt;/version>--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br></p><div class="note note-info">            <p><font color=orange size=4> 解决方案二 </font> | <font colot=white size=3 > 仅修改配置文件 </font></p>          </div><ul><li>在 application.properties 配置文件中，加入下面一行代码</li></ul><div class="code-wrapper"><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">spring.mvc.pathmatch.matching-strategy</span><span class="token punctuation">=</span><span class="token attr-value">ANT_PATH_MATCHER</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><br><br></p><div class="note note-success">            <p>修改结束后，启动项目访问：localhost:8080/swagger-ui.html 即可访问</p>          </div><p>​    </p>]]></content>
    
    
    <categories>
      
      <category>Error</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Error</tag>
      
      <tag>Springboot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Maven】入门与进阶</title>
    <link href="/2022/03/10/Maven/%E3%80%90%E4%B8%AD%E9%97%B4%E4%BB%B6%20%7C%20Maven%E3%80%91Maven%EF%BD%9C%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6/"/>
    <url>/2022/03/10/Maven/%E3%80%90%E4%B8%AD%E9%97%B4%E4%BB%B6%20%7C%20Maven%E3%80%91Maven%EF%BD%9C%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h1 id="第一章-Maven-基础-不食花生的猫"><a href="#第一章-Maven-基础-不食花生的猫" class="headerlink" title="第一章 Maven 基础   不食花生的猫"></a>第一章 <strong>Maven 基础</strong>   <font color=darkgray size=2><strong>不食花生的猫</strong></font></h1><hr><br><h3 id="相关网页地址"><a href="#相关网页地址" class="headerlink" title="相关网页地址"></a>相关网页地址</h3><ul><li><p><strong>视频地址：</strong><a href="https://www.bilibili.com/video/BV1Ah411S7ZE?p=1">https://www.bilibili.com/video/BV1Ah411S7ZE?p=1</a></p></li><li><p><strong>依赖查询：</strong><a href="https://mvnrepository.com/">https://mvnrepository.com/</a></p></li><li><p><strong>Maven ：</strong><a href="https://maven.apache.org/plugins/index.html">https://maven.apache.org/plugins/index.html</a></p></li><li><p><strong>Nexus  ：</strong><a href="https://help.sonatype.com/repomanager3/product-information/download">https://help.sonatype.com/repomanager3/product-information/download</a></p></li></ul><br><h2 id="Maven-标签"><a href="#Maven-标签" class="headerlink" title="Maven 标签"></a>Maven 标签</h2><p><strong>resources:</strong> 资源文件配置信息</p><p><strong>resource:</strong> 资源文件配置信息</p><p><strong>testResources:</strong> test 资源文件配置信息</p><p><strong>testResource:</strong> test 资源文件配置信息</p><p><strong>dependencies</strong></p><p><strong>groupId</strong>：    【组织 ID】定义当前 Maven 项目隶属组织名称（通常是域名反写，例如 org.mybaits)</p><p><strong>artifactId</strong>:     【项目 ID】定义当前 Maven 项目名称（通常是模块名称，例如 CRM、SMS）</p><p><strong>version</strong>：    【版本号】定义当前项目的版本号</p><p><strong>packaging</strong>：    【jar/war】定义该项目的打包方式</p><p> <strong>optional：</strong>      是否对上级隐藏 true / false</p><p><strong>exclusions:</strong>        排除掉某些</p><p><strong>exclusion：</strong>    具体排除掉哪一个 ()</p>  <span class="label label-default"> 注意：不写版本 见代码片段 1.2</span><p><strong>scope:</strong>        范围</p><ul><li>在主程序范围能不能用 【 main 文件夹范围内 】</li><li>在测试范围能不能用【 test 】</li><li>是否参与打包【 package 】</li></ul><p><strong>dependencyManagement：</strong>【依赖管理】 在 父pom 中做依赖管理</p><p><strong>build</strong></p><ul><li><strong>build</strong> 构建</li><li><strong>plugins</strong> 插件（们）</li><li><strong>plugin</strong> 插件</li></ul><span class="label label-primary"> 代码片段 1.1</span><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--执行--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!--执行位置</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">></span></span>jar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- 参考声明周期全过程 --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">></span></span> generate-test-resources <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><span class="label label-success"> 表 1.1 scope 范围</span><table><thead><tr><th><strong>scope 参数</strong></th><th><strong>主程序</strong></th><th><strong>测试程序</strong></th><th><strong>参与打包</strong></th><th><strong>典型</strong></th></tr></thead><tbody><tr><td>compile</td><td>🙆🏻‍♀️</td><td>🙆🏻‍♀️</td><td>🙆🏻‍♀️</td><td>log4j</td></tr><tr><td>test</td><td></td><td>🙆🏻‍♀️</td><td></td><td>junit</td></tr><tr><td>provided</td><td>🙆🏻‍♀️</td><td>🙆🏻‍♀️</td><td></td><td>servlet-api</td></tr><tr><td>runtime</td><td></td><td></td><td>🙆🏻‍♀️</td><td>jdbc</td></tr></tbody></table><span class="label label-success"> 表 1.2 scope 以来传递中的范围问题</span><table><thead><tr><th><strong>项目 2 \ 项目 1</strong></th><th><strong>compile</strong></th><th><strong>test</strong></th><th><strong>provided</strong></th><th><strong>runtime</strong></th></tr></thead><tbody><tr><td><strong>compile</strong></td><td>compile</td><td>test</td><td>provided</td><td>runtime</td></tr><tr><td><strong>test</strong></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>provided</strong></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>runtime</strong></td><td>runtime</td><td>test</td><td>provided</td><td>runtime</td></tr></tbody></table><span class="label label-primary">代码 1.2 排除下级依赖</span><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>父类 组名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>  (定义 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span> 之后可以删除)    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>父类 artifactId<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>父类 版本<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>  (定义 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span> 之后可以删除)    <span class="token comment">&lt;!--排除掉以下--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">></span></span>         <span class="token comment">&lt;!-- 排除掉 a--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>a 的 groupId<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>a 的 artifactId<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><h2 id="依赖传递"><a href="#依赖传递" class="headerlink" title="依赖传递"></a><strong>依赖传递</strong></h2><ul><li>若 b 项目引用 a 项目作为依赖，那么 a 项目引用的依赖 b 也引用</li><li>直接依赖：直接引用的依赖</li><li>间接依赖：通过引用其他项目获取其他项目的依赖</li></ul><p><strong>依赖冲突问题</strong></p><ul><li>深度优先原则：层级越浅优先级越高（直接依赖＞间接以依赖）</li><li>声明优先原则：两个间接以来全都是 2 层，那么看引用他们依赖的 a 与 b ，谁在前面使用谁的</li><li>后者覆盖原则：当同一个 pom 文件中出现了同一个依赖的不同版本，后者覆盖前者</li><li>对上级隐藏    ：true </li><li>排除下级依赖：</li></ul><h2 id="Maven-生命周期与插件"><a href="#Maven-生命周期与插件" class="headerlink" title="Maven 生命周期与插件"></a><strong>Maven 生命周期与插件</strong></h2><p><strong>全部过程</strong></p><ul><li>validate 校验</li><li>initialize 初始化</li><li>generate-sources 生成源代码</li><li>process-sources 处理源代码</li><li>generate-resources 生成资源文件</li><li>process-resources 处理资源文件</li><li>compile 编译   </li><li>process-classes 处理类文件</li><li>generate-test-sources 处理测试源代码</li><li>process-test-sources 生成测试源代码</li><li>generate-test-resources 生成测试资源文件</li><li>process-test-resources 处理测试资源文件</li><li>test-compile 编译测试源码</li><li>process-test-classes 处理测试类文件</li><li>test 测试   </li><li>prepare-package 准备打包</li><li>package 打包   </li><li>pre-integration-test 集成测试前</li><li>integration-test 集成测试</li><li>post-integration-test 集成测试后</li><li>verify 验证</li><li>install 安装   </li><li>deploy 部署   </li></ul><p><br><br><br></p><h1 id="第二章-Maven-高级"><a href="#第二章-Maven-高级" class="headerlink" title="第二章 Maven 高级"></a>第二章 Maven 高级</h1><hr><h3 id="分模块开发思路"><a href="#分模块开发思路" class="headerlink" title="分模块开发思路"></a><strong>分模块开发思路</strong></h3><ul><li>将 controller 层、service 层等都单独划分为一个单独的 Maven 模块，通过接口进行连接</li></ul><h2 id="配置管理-（插件同理）"><a href="#配置管理-（插件同理）" class="headerlink" title="配置管理  |  （插件同理）"></a><strong>配置管理  |</strong>  <strong>（插件同理）</strong></h2><p>配置一个新的 pom 文件用于管理所有的 pom</p><p><strong>packaging:</strong></p><ul><li><strong>聚合 pom</strong></li><li><strong>后端 jar</strong></li><li><strong>web war</strong></li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">></span></span> pom <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- 说明此文件专门用于配置管理 --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modules</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span> 各层级文件的名称 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>../ssm_pojo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>../ssm_dao<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>../ssm_service<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>../ssm_controller<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>    ……<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modules</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a><strong>继承</strong></h3><p>在 父 pom 文件中定义所有的依赖</p><p>父 pom</p><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            也可以写自己的项目，没两样        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>子 pom        dependency 中不用写 version  </p><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- 父工程 pom.xml 文件的地址--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">></span></span>  ../ssm/pom.xml <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>relativePath</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="同理插件也可以继承，同样删除"><a href="#同理插件也可以继承，同样删除" class="headerlink" title="同理插件也可以继承，同样删除"></a><strong>同理插件也可以继承，同样删除</strong></h3><ol><li><strong>继承与聚合</strong></li></ol><ul><li><p>作用</p></li><li><ul><li>聚合用于快速构建项目</li><li>继承用于快速配置</li></ul></li><li><p>相同点</p></li><li><ul><li>聚合与继承的 pom.xml 文件打包方式均为 pom，可以将两种关系只做到同一个 pom 文件中</li><li>聚合与集成均属于设计型模块，并无实际的模块内容。</li></ul></li><li><p>不同点</p></li><li><ul><li>聚合是在当前模块中的配置关系，聚合可以感知到参与聚合的模块有哪些</li><li>继承是在子模块中配置关系，父模块无法感知哪些模块集成了自己</li></ul></li></ul><p><br><br><br></p><h1 id="第三章-自定义变量"><a href="#第三章-自定义变量" class="headerlink" title="第三章 自定义变量"></a>第三章 <strong>自定义变量</strong></h1><hr><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring.version</span><span class="token punctuation">></span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring.version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 使用格式 --></span>$&#123;spring.version&#125;<span class="token comment">&lt;!-- 直接使用项目的 version --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 读取 settings.xml 文件中的值 --></span>$&#123;settings.localRepository&#125;<span class="token comment">&lt;!-- 读取 Java 系统属性 --></span>$&#123;user.home&#125;<span class="token comment">&lt;!-- 使用： mvn help:system 可以查看系统环境变量 --></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br><br></p><h1 id="第四章-版本管理"><a href="#第四章-版本管理" class="headerlink" title="第四章 版本管理"></a>第四章 <strong>版本管理</strong></h1><hr><h2 id="工程版本"><a href="#工程版本" class="headerlink" title="工程版本"></a><strong>工程版本</strong></h2><ul><li><p>SNAPSHOT（快照版本）</p></li><li><ul><li>项目开发过程中，为方便团队成员合作，解决模块间互相依赖和实时更新的问题，开发者对每个模块进行构建的时候，输出的临时性版本叫做快照版本（测试阶段版本）</li><li>快照版本会随着开发的进站不断更新</li></ul></li><li><p>RELEASE（发布版本）</p></li><li><ul><li>项目开发到进入阶段里程碑后，向团队外部发布较为稳定的版本，这种版本对应的构建文件是稳定的，几遍进行功能的后续开发，也不会改变当前发布版本的内容，这种版本成为发布版本</li></ul></li></ul><h2 id="功能版本号约定"><a href="#功能版本号约定" class="headerlink" title="功能版本号约定"></a><strong>功能版本号约定</strong></h2><ul><li><p>约定规范</p></li><li><ul><li>&lt;主版本&gt;.&lt;次版本&gt;.&lt;增量版本&gt;.&lt;里程碑版本&gt;</li><li>主版本：表示项目重大架构的变更，如 Spring5 相较于 Spring4 </li><li>次版本：表示有较大的的功能增加和变化，或者全面系统的修复漏洞</li><li>增量版本：表示有重大漏洞修复</li><li>里程碑版本：表示一个版本的里程碑（版本内部》。这样的版本同下一个正式版本相比，相对来说不是很稳定，有待更多的测试</li></ul></li><li><p>范例</p></li><li><ul><li>5.1.9.RELEASE</li></ul></li></ul><p><br><br><br></p><h1 id="第五章-多环境"><a href="#第五章-多环境" class="headerlink" title="第五章 多环境"></a>第五章 多环境</h1><hr><h2 id="配置资源文件对应信息"><a href="#配置资源文件对应信息" class="headerlink" title="配置资源文件对应信息"></a><strong>配置资源文件对应信息</strong></h2><ul><li>在 pom 文件中设定配置文件路径</li><li>开启加载 pom 属性过滤功能</li><li>使用  ${属性名}  格式引用 pom 属性</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdbc.username</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdbc.username</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>../ssm_dao/src/main/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>$&#123;project.basedir&#125;/src/main/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment"># jdbc.properties </span><span class="token attr-name">jdbc.username</span><span class="token punctuation">=</span><span class="token attr-value">$&#123;jdbc.username&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h2 id="定义-生产-开发-环境"><a href="#定义-生产-开发-环境" class="headerlink" title="定义 生产/开发 环境"></a><strong>定义 生产/开发 环境</strong></h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profiles</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- 定义具体的环境：生产环境 --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- 定义环境唯一名称 --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span> pro_env <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- 定义环境中专用的属性值 --></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdbc.url</span><span class="token punctuation">></span></span> url1 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdbc.url</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--  默认使用这个配置  --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeByDefault</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeByDefault</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- 定义具体的环境：开发环境 --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span> dev_env <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>         <span class="token comment">&lt;!-- 定义环境中专用的属性值 --></span>         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdbc.url</span><span class="token punctuation">></span></span> url2 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdbc.url</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profiles</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a><strong>使用</strong></h2><ul><li><ol><li><strong>maven 中加入一个新的生命周期</strong></li><li><strong>指令为：install -P dev_env</strong></li></ol></li><li></li><li></li><li><p><br><br><br></p></li><li></li></ul><h1 id="第六章-跳过测试"><a href="#第六章-跳过测试" class="headerlink" title="第六章 跳过测试"></a><strong>第六章 跳过测试</strong></h1><hr><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a><strong>使用场景</strong></h2><ul><li>整体模块功能未开发</li><li>模块中某个功能未开发完毕</li><li>单个功能更新调试导致其他功能失败</li><li>快速打包</li><li>……</li></ul><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a><strong>使用方法</strong></h2><p>插件：maven helper</p><ol><li>方案 1：直接使用 IDEA 进行屏蔽</li><li>方案 2：选中 pom 文件，右键 run以下命令：install -D skipTests</li><li>方案 3：build 中设置跳过测试</li></ol><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-surefire-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.22.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- 跳过测试 --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>skipTest</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>skipTest</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>                <span class="token comment">&lt;!-- 指定测试 --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/Demotest.java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>                                <span class="token comment">&lt;!-- 排除以下进行测试 --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excludes</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude</span><span class="token punctuation">></span></span>**/User*Test.java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclude</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excludes</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span>           <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br><br></p><h1 id="第七章-Nexus-私服"><a href="#第七章-Nexus-私服" class="headerlink" title="第七章 Nexus 私服"></a><strong>第七章</strong> <strong>Nexus 私服</strong></h1><hr><h2 id="Nexus私服"><a href="#Nexus私服" class="headerlink" title="Nexus私服"></a><strong>Nexus私服</strong></h2><ul><li><p>地址：<a href="https://help.sonatype.com/repomanager3/product-information/download">https://help.sonatype.com/repomanager3/product-information/download</a></p></li><li><p>启动：进入 bin 文件夹 nexus run    </p></li><li><p>访问：localhost:8081</p></li></ul><h2 id="仓库分类"><a href="#仓库分类" class="headerlink" title="仓库分类"></a><strong>仓库分类</strong></h2><ol><li><ol><li><p>宿主仓库 hosted</p></li><li><ol><li><p>保存无法从中央仓库获取的资源</p></li><li><ol><li>自主研发</li><li>第三方非开源项目</li></ol></li></ol></li><li><p>代理仓库 proxy</p></li><li><ol><li>代理远程仓库，通过 nexus 访问其他公共仓库，例如中央仓库</li></ol></li><li><p>仓库组 group</p></li><li><ol><li><p>将若干个仓库组成一个群组，简化配置</p></li><li><p>仓库组不能保存资源，属于设计型仓库</p><br><br></li></ol></li></ol></li></ol><h2 id="Idea-与-Nexus-私服"><a href="#Idea-与-Nexus-私服" class="headerlink" title="Idea 与 Nexus 私服"></a><strong>Idea 与 Nexus 私服</strong></h2><ul><li>Maven settings.xml 文件中的配置</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servers</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>server</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>jim-release<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>server</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>server</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>jim-snapshots<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>server</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servers</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrors</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>jim<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">></span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>去 Nexus 私服仓库复制 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrors</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>发布  【 maven deploy  】</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>distributionManagement</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repository</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- settings.server 中的 ID --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repository</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>distributionManagement</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br><br></p><h1 id="第八章-其他"><a href="#第八章-其他" class="headerlink" title="第八章 其他"></a><strong>第八章</strong> <strong>其他</strong></h1><hr><h2 id="settings-xml"><a href="#settings-xml" class="headerlink" title="settings.xml"></a><strong>settings.xml</strong></h2><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- 本地仓库地址 --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localRepository</span><span class="token punctuation">></span></span>/Users/hsk/DevTools/mavenRepository<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localRepository</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrors</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--次镜像唯一标识符，用来区分不同的 mirror 元素--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>nexus-aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--对那种仓库进行镜像，简单来说就是代替那个仓库--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">></span></span>central<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--镜像名称--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>Nexus aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>--镜像</span> <span class="token attr-name">url</span> <span class="token attr-name">--</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>http://maven.aliyun.com/nexus/content/groups/public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrors</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Maven-生命周期全过程"><a href="#Maven-生命周期全过程" class="headerlink" title="Maven 生命周期全过程"></a><strong>Maven 生命周期全过程</strong></h2><ul><li>validate 校验</li><li>initialize 初始化</li><li>generate-sources 生成源代码</li><li>process-sources 处理源代码</li><li>generate-resources 生成资源文件</li><li>process-resources 处理资源文件</li><li>compile 编译   </li><li>process-classes 处理类文件</li><li>generate-test-sources 处理测试源代码</li><li>process-test-sources 生成测试源代码</li><li>generate-test-resources 生成测试资源文件</li><li>process-test-resources 处理测试资源文件</li><li>test-compile 编译测试源码</li><li>process-test-classes 处理测试类文件</li><li>test 测试   </li><li>prepare-package 准备打包</li><li>package 打包   </li><li>pre-integration-test 集成测试前</li><li>integration-test 集成测试</li><li>post-integration-test 集成测试后</li><li>verify 验证</li><li>install 安装   </li><li>deploy 部署   </li></ul>]]></content>
    
    
    <categories>
      
      <category>中间件</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Maven</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【生活】记录被惊讶到的一天</title>
    <link href="/2021/10/12/%E6%97%A5%E8%AE%B0/%E3%80%90%E7%94%9F%E6%B4%BB%E3%80%91%E8%AE%B0%E5%BD%95%E8%A2%AB%E6%83%8A%E8%AE%B6%E5%88%B0%E7%9A%84%E4%B8%80%E5%A4%A9/"/>
    <url>/2021/10/12/%E6%97%A5%E8%AE%B0/%E3%80%90%E7%94%9F%E6%B4%BB%E3%80%91%E8%AE%B0%E5%BD%95%E8%A2%AB%E6%83%8A%E8%AE%B6%E5%88%B0%E7%9A%84%E4%B8%80%E5%A4%A9/</url>
    
    <content type="html"><![CDATA[<h2 id="我今天被惊到了！"><a href="#我今天被惊到了！" class="headerlink" title="我今天被惊到了！"></a>我今天被惊到了！</h2><div class="note note-primary">            <p>起因</p>          </div><p>事情是这个样子的，前几天我在国外某论坛冲浪的时候，遇到了一个人A称呼E为师傅，遇到了问题E还对A进行指导。我顿时对其二人产生了兴趣，交流之后发现E是一个大二的学生，当心的心情大概就是；呵，小朋友就喜欢这个样子。</p><p>虽然仅比我小几岁，但是我还是从心里把自己当成一个大人，在知晓年龄之前我们一直称呼E为【大E哥】，知道比我小以后，我甚至差点一度看轻他，但是并没能轻视太久。</p><p>下午因为要查询Pagermaid机器人的相关指令，我便使用谷歌搜索了一下，进了一个大佬的博客，其实网络上Pagermaid的相关指令很多，但是这篇博客排第二，仅在官网（Github）下面，我就点进去了，这片博客的首页及下方布局是这个样子：</p><p><img src="https://i.loli.net/2021/10/12/6TM1QadP3EK8rsz.png" alt="E&#39;sblog"></p><p>当时只觉得比较二次元，还有点凌乱，随后想看看这篇博客上还有什么别的营养，于是点了【主页｜Home】按钮，随后就柳暗花明又一村了，因为跳转的不是首页，而是这样子的界面：</p><p><img src="https://i.loli.net/2021/10/12/hL7ZTew4yxPMCaG.png"></p><p>当时我人都傻了，心里直问这是什么呀！！</p><p>随后就在这个界面上看了一会儿，嗯营养也很丰富！里面有很多的小工具，还是很方便的！</p><hr><p>当然这并没有结束，我觉得如此花里胡哨的Blog里面应该全是营养，于是我就去他的主页看了看，果然全是营养！</p><hr><p>这个时候我就特想联系到这个博客的博主！于是乎我就！看到了这个桌面上有我常玩的国外社区链接，我就点进去了，试图联系他。</p><div class="note note-primary">            <p>结果：这个时候惊人的事情发生了！！他居然就是大E哥！！</p>          </div><p>果断把大E哥的Blog加入我的友链，想看的话可以点击最上方<a href="http://110.40.191.51/links/">【Links】</a>去看一下。</p><p>嗯….然后我就试着把Ylui，也就是这个桌面给配置了一下，很简单，Github上的东西安装起来永远都很简单，要么双击，要么一条命令，要么clone一下一条命令。</p><p>这个桌面属于第三者，想尝试一下的可以去我的博客[【好物小记】]（<a href="http://110.40.191.51/2021/09/30/%E5%A5%BD%E7%89%A9%E5%B0%8F%E8%AE%B0/%EF%BC%89%EF%BC%8C%E5%88%92%E5%88%B0%E6%9C%80%E4%B8%8B%E6%96%B9%E6%89%BE%E5%88%B0Ylui%E5%8D%B3%E5%8F%AF%E8%BF%9B%E5%85%A5%E5%AE%98%E7%BD%91%E3%80%82">http://110.40.191.51/2021/09/30/好物小记/），划到最下方找到Ylui即可进入官网。</a></p><p><br><br></p><div class="note note-primary">            <p>然而，这并不是全部，大E哥甚至还有自己的视频网站…….</p>          </div>]]></content>
    
    
    <categories>
      
      <category>日记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>日记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Linux】Vim｜入门与进阶</title>
    <link href="/2021/10/10/%E3%80%90%E8%AE%B0%E3%80%91Vim%EF%BD%9C%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6/"/>
    <url>/2021/10/10/%E3%80%90%E8%AE%B0%E3%80%91Vim%EF%BD%9C%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="Linux-基本操作-vim-篇"><a href="#Linux-基本操作-vim-篇" class="headerlink" title="Linux 基本操作 vim 篇"></a>Linux 基本操作 vim 篇</h2><hr><p><br><br><br></p><h3 id="vim-简介"><a href="#vim-简介" class="headerlink" title="vim 简介"></a>vim 简介</h3><hr><p>vim 是 Linux 上最基本的文本编辑工具，其地位像是 Windows 自带的记事本工具，还要少数的 Linux 系统自带 leafpad 编辑器，leafpad 的操作界面更像是 Win 的记事本，可以使用鼠标切换光标，自由删除，并且点击左上角的文件可以进行保存；但是 vim 编辑器却像是一个简单的指令工具，其操作必须依靠指令来完成，但是如果不会使用 vim 的话，是无法完成很多操作的，甚至对大多数只集成了 vim 的系统来说，不会使用 vim ，甚至无法安装 leafpad ，而在 Linux 系统中，刚装完的系统（国产系统除外）一定要进行换源，这时候就要使用到一个编辑器工具，如果你的系统只有 vim，最好还是学习一下如何使用 vim；</p><p><br><br></p><h3 id="vim-三种模式"><a href="#vim-三种模式" class="headerlink" title="vim 三种模式"></a>vim 三种模式</h3><hr><ul><li>只读模式：使用 vim 打开文件为  只读模式，此时只可以查看文件内容，无法对文件进行编辑；</li><li>插入模式：即 编辑模式 ，此时可以对文件进行编辑，字符的插入或删除等操作；</li><li>底行模式：类似于终端的命令行，此时可以输入命令，选择是保存文件 / 保存并退出 / 不保存退出 / 强制退出 等；</li></ul><p><br><br></p><h2 id="vim-基本命令"><a href="#vim-基本命令" class="headerlink" title="vim 基本命令"></a>vim 基本命令</h2><hr><p><font color=DarkGray size=2>基本的编辑命令，学会后可以流畅操作 vim 编辑器；</font></p><hr><ul><li>在进入 vim 之前，建议使用：sudo su 命令进入超级管理员模式，否则一些系统级的文件即使你编辑了，也无法进行保存；</li><li>打开文件：打开控制终端，输入 vim + 一个文本的名字，就可以打开这个文本（打开当前目录下的文件只需要输入文件名，打开其他目录下的文件需要输入绝对地址）；这个时候是“只读”模式，无法对文件进行编辑；</li><li>编辑命令：进入文件之后，点击<code>i</code>（insert 缩写），进入编辑模式，这个时候可以自使用上下左右四个键控制光标，使用删除键删除，或输入任意字符；</li><li>底行模式：对文件编辑好之后，点一下<code>Esc</code>键，进入底行模式，此时可以输入命令选择对文件的操作，基本命令如下（注：以冒号开头）：</li></ul><div class="note note-primary">            <p>常用基础命令</p>          </div><table><thead><tr><th>指令</th><th>效果</th><th>备注</th></tr></thead><tbody><tr><td>：wq</td><td>保存 并 退出</td><td>保存文件并退出文件，返回到命令终端界面；</td></tr><tr><td>：q</td><td>退出</td><td>不保存，直接退出文件，返回到命令终端界面；</td></tr><tr><td>：q！</td><td>强制退出</td><td>提示无法保存的时候，加！可以强制退出文件，此时的文件缓存在内存中，并不会存回磁盘中；</td></tr><tr><td>：wq！</td><td>强制保存并退出</td><td>此时文件会被强制保存，并退出回到命令终端；</td></tr></tbody></table><p><br><br></p><h2 id="vim-进阶命令"><a href="#vim-进阶命令" class="headerlink" title="vim 进阶命令"></a>vim 进阶命令</h2><hr><p><font color=DarkGray size=2>进阶指令，学会后操作更方便，相当于魔法加成；</font></p><hr><div class="note note-primary">            <p>光标控制</p>          </div><table><thead><tr><th>指令</th><th>效果</th><th>备注</th></tr></thead><tbody><tr><td>:num</td><td>让光标跳到第 Xnum行首</td><td>只会跳到行首</td></tr><tr><td>:nd</td><td>删除第 n 行</td><td>d:delete</td></tr><tr><td>:n , md</td><td>从第 n 行删到第 m 行</td><td>m 不能超过最后一行，否则提示无效</td></tr></tbody></table><div class="note note-primary">            <p>快速复制粘贴</p>          </div><table><thead><tr><th>指令</th><th>效果</th><th>备注</th></tr></thead><tbody><tr><td>:n,my</td><td>复制第 n 行到 m 行的内容</td><td>按 p 粘贴（Paste）</td></tr><tr><td>:n,md</td><td>剪切第 n 行到 m 行的内容</td><td>按 p 粘贴（Paste）</td></tr></tbody></table><div class="note note-primary">            <p>文本编辑（效果类似于各类编辑器的“编辑”功能）</p>          </div><table><thead><tr><th>指令</th><th>效果</th><th>备注</th></tr></thead><tbody><tr><td>：%s#old#new#g</td><td>全局替换</td><td>g：全局 ；#不是代替空格用的，不可以删除；</td></tr><tr><td>：num s#old#new#g</td><td>在第 num 行查找old并将其替换成new</td><td>相对于上一条命令，加了一个范围：某一行；</td></tr><tr><td>：n  , m s#old#new#g</td><td>在第 n 到 m 行查找old并将其替换成new</td><td>相对于上一条命令，扩大了范围，多行；-</td></tr></tbody></table><div class="note note-primary">            <p>文件操作</p>          </div><table><thead><tr><th>指令</th><th>效果</th><th>备注</th></tr></thead><tbody><tr><td>vsp xxx.c</td><td>左右分屏打开 xxx.c 文件</td><td>分屏应该很常见了，可以理解吧</td></tr><tr><td>sp  xxx.c</td><td>上下分屏打开 xxx.c 文件</td><td></td></tr><tr><td>:w new xxx.c</td><td>将当前文件另存为 xxx.c 文件</td><td>可以使用绝对地址</td></tr><tr><td>:n ,mw new xxx.c</td><td>将当前文件的第 n 到 m 行另存为 xxx.c 文件</td><td>使用时候注意不要少了 <code>w</code></td></tr><tr><td>:0r  /etc/hosts</td><td>将/etc/hosts文件中的内容导入到此文件的开头</td><td></td></tr><tr><td>:$r /etc/hosts</td><td>将/etc/hosts文件中的内容导入到此文件的结尾</td><td></td></tr></tbody></table><div class="note note-primary">            <p>搜索内容</p>          </div><table><thead><tr><th>指令</th><th>效果</th><th>备注</th></tr></thead><tbody><tr><td>/word</td><td>在文件中搜索<code>word</code>这个单词</td><td></td></tr><tr><td>n</td><td>向下查找（下一个）</td><td></td></tr><tr><td>N</td><td>向上查找（上一个）</td><td></td></tr><tr><td>/word\c</td><td><font color=7baf23>忽略大小写</font>,在文件中搜索<code>word</code>这个单词</td><td></td></tr><tr><td>:noh</td><td>取消高亮</td><td>退出“查找模式”</td></tr></tbody></table><div class="note note-warning">            <p>本博客搬运自我的博客园，原作者亦是本人，转载请注明出处。</p>          </div>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>进阶</tag>
      
      <tag>Linux</tag>
      
      <tag>vim</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【维护小破站】解决Hexo在服务器上断开SSH链接后就自动断开的问题</title>
    <link href="/2021/10/10/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91%E8%A7%A3%E5%86%B3Hexo%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E6%96%AD%E5%BC%80SSH%E9%93%BE%E6%8E%A5%E5%90%8E%E5%B0%B1%E8%87%AA%E5%8A%A8%E6%96%AD%E5%BC%80%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <url>/2021/10/10/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91%E8%A7%A3%E5%86%B3Hexo%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E6%96%AD%E5%BC%80SSH%E9%93%BE%E6%8E%A5%E5%90%8E%E5%B0%B1%E8%87%AA%E5%8A%A8%E6%96%AD%E5%BC%80%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="如题"><a href="#如题" class="headerlink" title="如题"></a>如题</h2><hr><div class="note note-primary">            <p>闲话</p>          </div><p>为了让博客在国内可以访问，我放弃了GithubPage，选择使用服务器，当弄好一切之后却发现，只能保持SSH链接状态才能进行访问，这可真的要了老命，总不能一直连接着吧，什么时候我出个门网一断就不行了，用树莓派的话倒是可以，但是如果家里停电的话也凉凉（况且这种方式还不如直接部署在树莓派里），于是我果断放弃，开始寻找新的办法。</p><ul><li>解决方案一：Nginx托管，参考的<a href="https://blog.csdn.net/qq_41684621/article/details/102934590">兮动人的【博客】</a><ul><li>既然Nginx可以托管Vue项目那么Hexo应该也是不成问题的</li><li>但是看博客里写的好像很麻烦，我就试图寻找其他方法</li></ul></li><li>解决方案二：pm2后台运行，参考<a href="https://blog.csdn.net/m0_43584016/article/details/104997625">德鲁大叔撸代码的【博客】</a><ul><li>这种方式比较简单，类似于写脚本后台跑</li><li>具体实现如下</li></ul></li></ul><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><div class="note note-primary">            <h3 id="解决方案，PM2后台运行Hexo"><a href="#解决方案，PM2后台运行Hexo" class="headerlink" title="解决方案，PM2后台运行Hexo"></a>解决方案，PM2后台运行Hexo</h3>          </div><p>服务器端使用如下指令全局安装pm2（请先安装nodejs）</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install -g pm2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>进入Hexo博客根目录下，创建一个文件run.js文件，并将如下内容复制进去</p><div class="code-wrapper"><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">&#123;</span> exec <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'hexo server -p 4000'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>     <span class="token comment">//指定端口</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">exec error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>error<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>    <span class="token keyword">return</span>  <span class="token punctuation">&#125;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">stdout: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>stdout<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">stderr: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>stderr<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>唯一要修改的地方只有端口号，由于默认便是4000所以我这里也选择了4000端口</p><p>退出并且保存，并且在同级目录下执行一下指令，让此脚本跑起来：</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pm2 start run.js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>看到以下内容就是运行成功了，可以关掉ssh远程并且尝试访问自己的博客。</p><p><img src="https://i.loli.net/2021/10/10/khHDbUI4MRJSLAa.png"></p><div class="note note-primary">            <h3 id="其他相关命令"><a href="#其他相关命令" class="headerlink" title="其他相关命令"></a>其他相关命令</h3>          </div><div class="note note-success">            <p>创建文件夹：mkdir filename</p>          </div><div class="note note-success">            <p>创建文件: touch name.xxx</p>          </div><div class="note note-success">            <p>Vim的相关指令请<a href="http://110.40.191.51:4000/2021/10/10/Vim%EF%BD%9C%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6/">【点击此处】</a></p>          </div>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>维护小破站</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【维护小破站】搭建Fluid并美化</title>
    <link href="/2021/10/09/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91Fluid%E7%BE%8E%E5%8C%96/"/>
    <url>/2021/10/09/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91Fluid%E7%BE%8E%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h2 id="闲聊"><a href="#闲聊" class="headerlink" title="闲聊"></a>闲聊</h2><hr><div class="note note-primary">            <p>很离谱，刚搭建完成NexT没几天，就决定更换主题了</p>          </div><p>其实在最初接触Hexo的时候，我便搭建过Fluid博客，那大概已经是两年前了，同时介绍Hexo给我的前辈也是使用的Fluid，但是那次的博客没有进行保存，本地运行结束之后便弃用了。</p><p>而在最近搭建NexT主题的时候，频繁遇到<a href="http://theme-next.iissnan.com/">NexT主题的配置文档</a>，其页面非常的美观且比较严肃，于是便想用NexT实现一下这个界面，这其中遇到的最大问题便是文章的Banner图片的插入，在其中我参考了<a href="https://zhuanlan.zhihu.com/p/75353138">这一篇文章</a>，文章发表于2019年，所使用的配置已经有些过时了，研究了半小时的代码之后，终于实现了，只不过Banner图片只是卡在中间，一点都不美观，于是乎我就进入了<a href="https://hexo.io/themes/">Hexo主题</a>，想找一款合适的，最后锁定了Fluid。</p><hr><p>不知道大家有没有跟我一样的感觉，大多数的Fluid用户都是二次元，这也让我对Fluid一开始的印象不是很好，所以才有了后面尝试了Zzoman和NexT，当然我也很清楚Hexo的样子都是看个人的，而且Fluid装饰起来也很简单，如果要加乱七八糟的功能的话同样也会很麻烦，但是我这次是<strong>求简避烦</strong>，因此在搭建的时候基本只要对着Fluid的<span class="label label-warning">主题配置文件</span>不断修改就行了，于是今天下午最主要的工作就是盯着<span class="label label-warning">主题配置文件</span>来来回回看了四五遍，顺便修改了一些其他内容。</p><h2 id="美化"><a href="#美化" class="headerlink" title="美化"></a>美化</h2><hr><div class="note note-primary">            <p>开始美化</p>          </div><div class="note note-success">            <p>Part 1:  1～400行代码</p>          </div><table><thead><tr><th>序号</th><th align="left">目标</th><th>改动地方（行数）</th><th>原来是</th><th>改成了</th></tr></thead><tbody><tr><td>1</td><td align="left">修改菜单栏分隔符为 ｜</td><td>- 29</td><td>-</td><td>｜</td></tr><tr><td>2</td><td align="left">关闭打字效果</td><td>- 82</td><td>true</td><td>false</td></tr><tr><td>3</td><td align="left">默认是“亮”模式</td><td>- 123</td><td>auto</td><td>light</td></tr><tr><td>4</td><td align="left">修改了一些默认的颜色，这个自己改动</td><td>- 128 ～ 184</td><td></td><td></td></tr><tr><td>5</td><td align="left">更改了字体大小</td><td>- 189</td><td>18px</td><td>13px</td></tr><tr><td>6</td><td align="left">站点统计</td><td>- 214</td><td></td><td></td></tr><tr><td>7</td><td align="left">导航栏修改了标题并且将英文改成了中文</td><td>- 290</td><td>English</td><td>中文</td></tr><tr><td>8</td><td align="left">Banner（背景图）关闭了视觉差并更换图片为目前的图片</td><td>- 346</td><td>parallax: false</td><td>parallax: true</td></tr><tr><td>9</td><td align="left">网站统计</td><td>- 396</td><td>暂时没有配置完，需要配置LearnCloud</td><td></td></tr></tbody></table><div class="note note-success">            <p>Part 2:  400～800行</p>          </div><table><thead><tr><th>序号</th><th align="left">目标</th><th>改动地方（行数）</th><th>原来是</th><th>改成了</th></tr></thead><tbody><tr><td>1</td><td align="left">Banner默认图，这里我没有修改代码；<br />而是复制文件到image之后改了文件名称。</td><td>- 431</td><td>默认背景图</td><td>现在背景图</td></tr><tr><td>2</td><td align="left">副标题改成自己喜欢的</td><td>- 450</td><td>忘了</td><td>这里看下面，一会儿详细介绍。</td></tr><tr><td>3</td><td align="left">文章页（没什么要修改的）</td><td>- 500</td><td></td><td></td></tr><tr><td>4</td><td align="left">开启【文章最后更新】</td><td>- 565</td><td>Content:false</td><td>Content:true</td></tr><tr><td>5</td><td align="left">评论【这里用的是Livere】</td><td>- 645</td><td>false</td><td>true</td></tr><tr><td>6</td><td align="left">更改Banner图的高度</td><td>- 790 ～ 933</td><td>banner_img_height:60</td><td>banner_img_height: 25</td></tr><tr><td>7</td><td align="left">友情链接</td><td>- 899 ～ 933</td><td></td><td></td></tr></tbody></table><div class="note note-success">            <div class="code-wrapper"><pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;br&gt;&lt;br&gt;&lt;font size&#x3D;6&gt; 保持饥饿 保持快乐 &lt;&#x2F;font&gt; &lt;br&gt; &lt;br&gt;&lt;font size&#x3D;3&gt;Stay Hungry &amp; be Happy &amp;nbsp; &amp;nbsp;&amp;nbsp; &amp;nbsp;&lt;&#x2F;font&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><code>&lt;br&gt;</code>是换行</p><p><code>&lt;font size&gt;</code>是文字格式</p><p><code>&amp;nbsp;</code>是空格，为了让<code>&amp;</code>符号剧中</p>          </div><div class="note note-success">            <p>除此之外还修改了<code>themes/fluid/languages/de.yml</code>文件，将英文全部改成了中文；</p><p>这里的内容修改的是菜单栏分隔符前面的内容（title）与除主页与文章页以外其他页面的副标题（subtitle）。</p>          </div><div class="note note-success">            <p>另外，为了将下方的露出来的小头头给砍掉，我对<code>themes/f/source/css/_pages/_base/_widget/board.styl</code>文件进行了修改，修改如下：</p><div class="code-wrapper"><pre class="line-numbers language-stylus" data-language="stylus"><code class="language-stylus"><span class="token selector">#board</span>  <span class="token comment">// position relative</span>  <span class="token property-declaration"><span class="token property">margin-top</span> <span class="token number">-2</span><span class="token unit">rem</span></span>  <span class="token property-declaration"><span class="token property">background-color</span> <span class="token func"><span class="token function">var</span><span class="token punctuation">(</span><span class="token operator">-</span>-board-bg-color<span class="token punctuation">)</span></span></span>  <span class="token property-declaration"><span class="token property">transition</span> background-color <span class="token number">.9</span><span class="token unit">s</span> ease-<span class="token operator">in</span>-out</span>  <span class="token property-declaration"><span class="token property">border-radius</span> <span class="token number">0.1</span><span class="token unit">rem</span></span>  <span class="token property-declaration"><span class="token property">z-index</span> <span class="token number">3</span></span>  <span class="token comment">//-webkit-box-shadow 0 12px 15px 0 rgba(0, 0, 0, 0.24), 0 17px 50px 0 rgba(0, 0, 0, 0.19)</span>  <span class="token comment">//box-shadow 0 12px 15px 0 rgba(0, 0, 0, 0.24), 0 17px 50px 0 rgba(0, 0, 0, 0.19)</span>  <span class="token comment">// 第一行是凸起</span>  <span class="token comment">// 最后两行是阴影</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>          </div><p><img src="https://i.loli.net/2021/10/09/kdYTK42JVfGxyUl.png"></p><h2 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h2><div class="note note-primary">            <p>最终效果</p>          </div><p><img src="https://i.loli.net/2021/10/09/m2sFMHQIj5bS9Nf.png" alt="最终效果图"></p><div class="note note-primary">            <p>结束，由于从原网页荡下来的图片分辨率不是很高，所以自己P了一张背景图。</p>          </div>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>维护小破站</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【维护小破站】博客重新搭建</title>
    <link href="/2021/10/07/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91%E5%8D%9A%E5%AE%A2%E9%87%8D%E6%96%B0%E6%90%AD%E5%BB%BA/"/>
    <url>/2021/10/07/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91%E5%8D%9A%E5%AE%A2%E9%87%8D%E6%96%B0%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h2 id="前言-吐槽一下遇到的离谱问题"><a href="#前言-吐槽一下遇到的离谱问题" class="headerlink" title="前言 吐槽一下遇到的离谱问题"></a>前言 <font size=3>吐槽一下遇到的离谱问题</font></h2><div class="note note-danger">            <p>很离谱！很奇葩！把本地的博客放到了TencentCloud之后，默认语言变成了阿拉伯文！</p>          </div><p>找了很久的问题，最后确认是NexT<span class="label label-primary">主题配置文件</span>出了问题，最后索性直接重新搭建了。</p><p><img src="https://i.loli.net/2021/10/07/AB7XDgIbhe5yCmq.png" alt="阿拉伯文版博客"></p><br><br><h2 id="前期准备相关配置及版本"><a href="#前期准备相关配置及版本" class="headerlink" title="前期准备相关配置及版本"></a>前期准备<font size=3>相关配置及版本</font></h2><hr><div class="note note-primary">            <p>相关配置：</p><ul><li>MacBook M1 Air</li><li>NexT version 8.8.0</li><li>Tencent Cloud CentOS 8.2 64bit</li><li>Nodejs 14.16.1</li><li>文件传输：<a href="bt.cn">宝塔</a></li></ul>          </div><hr><br><br><h2 id="开始安装"><a href="#开始安装" class="headerlink" title="开始安装"></a>开始安装</h2><h3 id="安装-宝塔"><a href="#安装-宝塔" class="headerlink" title="安装 宝塔"></a>安装 宝塔</h3><p>在TencentCloud 安装Hexo与NexT主题很简单，使用<span class="label label-primary">git</span>与<span class="label label-primary">vim</span>便可以完成，但是仅仅使用<span class="label label-primary">vim</span>来修改配置则太麻烦了，况且美化的过程工作量还不小，询问过<a href="https://imfurry.com/">【狐狸】</a>之后，采取了他的办法，用宝塔来实现一个简单的“桌面”，宝塔的安装命令如下：</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># CentOSyum install -y wget &amp;&amp; wget -O install.sh http:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install_6.0.sh &amp;&amp; sh install.sh# Ubuntu&#x2F;Deepinwget -O install.sh http:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install-ubuntu_6.0.sh &amp;&amp; sudo bash install.sh# Debianwget -O install.sh http:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install-ubuntu_6.0.sh &amp;&amp; bash install.sh# Fedorawget -O install.sh http:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install_6.0.sh &amp;&amp; bash install.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h3><ul><li>安装Nodejs</li><li>使用<span class="label label-primary">npm</span>直接安装hexo</li><li>详情请见<a href="http://110.40.191.51:4000/2021/09/29/Hexo%E6%90%AD%E5%BB%BA%E6%97%A5%E8%AE%B01-%E5%AE%89%E8%A3%85Hexo%E5%8D%9A%E5%AE%A2/">【Hexo博客安装】</a></li></ul><h3 id="安装NexT主题"><a href="#安装NexT主题" class="headerlink" title="安装NexT主题"></a>安装NexT主题</h3><ul><li>去<a href="https://github.com/next-theme/hexo-theme-next">NexT主题仓库</a>克隆下来</li></ul><div class="note note-danger">            <p>git clone  <a href="https://github.com/next-theme/hexo-theme-next.git">https://github.com/next-theme/hexo-theme-next.git</a> </p>          </div><ul><li>打开Hexo配置文件 并将theme改为next</li></ul><p>![图片](/Users/hsk/Library/Application Support/typora-user-images/MyMac_2021-10-07 下午4.44.57.png)</p><ul><li>更多配置详情请看<a href="http://110.40.191.51:4000/2021/09/30/Hexo%E6%90%AD%E5%BB%BA%E6%97%A5%E8%AE%B02-%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%961/?highlight=hexo">【NexT主题升级】</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>维护小破站</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【维护小破站】博客重新搭建</title>
    <link href="/2021/10/07/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91%E5%8D%9A%E5%AE%A2%E9%87%8D%E6%96%B0%E6%90%AD%E5%BB%BA%E7%9A%84%E5%89%AF%E6%9C%AC/"/>
    <url>/2021/10/07/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91%E5%8D%9A%E5%AE%A2%E9%87%8D%E6%96%B0%E6%90%AD%E5%BB%BA%E7%9A%84%E5%89%AF%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<h2 id="前言-吐槽一下遇到的离谱问题"><a href="#前言-吐槽一下遇到的离谱问题" class="headerlink" title="前言 吐槽一下遇到的离谱问题"></a>前言 <font size=3>吐槽一下遇到的离谱问题</font></h2><div class="note note-danger">            <p>很离谱！很奇葩！把本地的博客放到了TencentCloud之后，默认语言变成了阿拉伯文！</p>          </div><p>找了很久的问题，最后确认是NexT<span class="label label-primary">主题配置文件</span>出了问题，最后索性直接重新搭建了。</p><p><img src="https://i.loli.net/2021/10/07/AB7XDgIbhe5yCmq.png" alt="阿拉伯文版博客"></p><br><br><h2 id="前期准备相关配置及版本"><a href="#前期准备相关配置及版本" class="headerlink" title="前期准备相关配置及版本"></a>前期准备<font size=3>相关配置及版本</font></h2><hr><div class="note note-primary">            <p>相关配置：</p><ul><li>MacBook M1 Air</li><li>NexT version 8.8.0</li><li>Tencent Cloud CentOS 8.2 64bit</li><li>Nodejs 14.16.1</li><li>文件传输：<a href="bt.cn">宝塔</a></li></ul>          </div><hr><br><br><h2 id="开始安装"><a href="#开始安装" class="headerlink" title="开始安装"></a>开始安装</h2><h3 id="安装-宝塔"><a href="#安装-宝塔" class="headerlink" title="安装 宝塔"></a>安装 宝塔</h3><p>在TencentCloud 安装Hexo与NexT主题很简单，使用<span class="label label-primary">git</span>与<span class="label label-primary">vim</span>便可以完成，但是仅仅使用<span class="label label-primary">vim</span>来修改配置则太麻烦了，况且美化的过程工作量还不小，询问过<a href="https://imfurry.com/">【狐狸】</a>之后，采取了他的办法，用宝塔来实现一个简单的“桌面”，宝塔的安装命令如下：</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># CentOSyum install -y wget &amp;&amp; wget -O install.sh http:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install_6.0.sh &amp;&amp; sh install.sh# Ubuntu&#x2F;Deepinwget -O install.sh http:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install-ubuntu_6.0.sh &amp;&amp; sudo bash install.sh# Debianwget -O install.sh http:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install-ubuntu_6.0.sh &amp;&amp; bash install.sh# Fedorawget -O install.sh http:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install_6.0.sh &amp;&amp; bash install.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h3><ul><li>安装Nodejs</li><li>使用<span class="label label-primary">npm</span>直接安装hexo</li><li>详情请见<a href="http://110.40.191.51:4000/2021/09/29/Hexo%E6%90%AD%E5%BB%BA%E6%97%A5%E8%AE%B01-%E5%AE%89%E8%A3%85Hexo%E5%8D%9A%E5%AE%A2/">【Hexo博客安装】</a></li></ul><h3 id="安装NexT主题"><a href="#安装NexT主题" class="headerlink" title="安装NexT主题"></a>安装NexT主题</h3><ul><li>去<a href="https://github.com/next-theme/hexo-theme-next">NexT主题仓库</a>克隆下来</li></ul><div class="note note-danger">            <p>git clone  <a href="https://github.com/next-theme/hexo-theme-next.git">https://github.com/next-theme/hexo-theme-next.git</a> </p>          </div><ul><li>打开Hexo配置文件 并将theme改为next</li></ul><p>![图片](/Users/hsk/Library/Application Support/typora-user-images/MyMac_2021-10-07 下午4.44.57.png)</p><ul><li>更多配置详情请看<a href="http://110.40.191.51:4000/2021/09/30/Hexo%E6%90%AD%E5%BB%BA%E6%97%A5%E8%AE%B02-%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%961/?highlight=hexo">【NexT主题升级】</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>维护小破站</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo 写作标签</title>
    <link href="/2021/10/01/%E5%8D%9A%E5%AE%A2/%E3%80%90%E5%86%99%E5%8D%9A%E5%AE%A2%E3%80%91How-to-Write/"/>
    <url>/2021/10/01/%E5%8D%9A%E5%AE%A2/%E3%80%90%E5%86%99%E5%8D%9A%E5%AE%A2%E3%80%91How-to-Write/</url>
    
    <content type="html"><![CDATA[<p><img src="https://i.loli.net/2021/10/03/dZwz94l3PH25G6a.png" alt="博客出处：谁把钱丢了"></p><h2 id="Hexo-Next-标签"><a href="#Hexo-Next-标签" class="headerlink" title="Hexo/Next 标签"></a>Hexo/Next 标签</h2><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>效果：</p><div class="code-wrapper"><pre class="line-numbers language-command" data-language="command"><code class="language-command">这是一行代码<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>代码：</p><div class="code-wrapper"><pre class="line-numbers language-C++" data-language="C++"><code class="language-C++">&#123;% codeblock lang:command %&#125;这是一行代码&#123;% endcodeblock %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h3 id="文本居中"><a href="#文本居中" class="headerlink" title="文本居中"></a>文本居中</h3><p>效果：<br>Fluid 中不能用 ，Next 中可以。</p><p>代码：</p><div class="code-wrapper"><pre class="line-numbers language-C++" data-language="C++"><code class="language-C++">&#123;% cq %&#125;四郎，那年杏花微雨，你说你是果郡王。也许从一开始，便都是错的。&#123;% endcq %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h3 id="note"><a href="#note" class="headerlink" title="note"></a>note</h3><p>效果：</p><div class="note note-default">            <p>default</p>          </div><div class="note note-primary">            <p>primary</p>          </div><div class="note note-success">            <p>success</p>          </div><div class="note note-info">            <p>info</p>          </div><div class="note note-warning">            <p>warning</p>          </div><div class="note note-danger">            <p>danger</p>          </div><p>_config 文件配置关键字：note, 我的配置如下：</p><div class="code-wrapper"><pre class="line-numbers language-command" data-language="command"><code class="language-command">style: flaticons: trueborder_radius: 3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>代码：</p><div class="code-wrapper"><pre class="line-numbers language-C++" data-language="C++"><code class="language-C++">&#123;% note default %&#125;default&#123;% endnote %&#125;&#123;% note primary %&#125;primary&#123;% endnote %&#125;&#123;% note success %&#125;success&#123;% endnote %&#125;&#123;% note info %&#125;info&#123;% endnote %&#125;&#123;% note warning %&#125;warning&#123;% endnote %&#125;&#123;% note danger %&#125;danger&#123;% endnote %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="label"><a href="#label" class="headerlink" title="label"></a>label</h3><p>_config 文件配置关键字：Label , 需要用的话把值设为true即可。<br>效果：</p><span class="label label-default">默认</span><span class="label label-primary">主要</span><span class="label label-success">成功</span><span class="label label-info">信息</span><span class="label label-warning">警告</span><span class="label label-danger">危险</span><p>代码：</p><div class="code-wrapper"><pre class="line-numbers language-C++" data-language="C++"><code class="language-C++">&#123;% label default@默认 %&#125;&#123;% label primary@主要 %&#125;&#123;% label success@成功 %&#125;&#123;% label info@信息 %&#125;&#123;% label warning@警告 %&#125;&#123;% label danger@危险 %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Tabs"><a href="#Tabs" class="headerlink" title="Tabs"></a>Tabs</h3><p>效果：<br>Fluid 中不可用，Next 中可以。</p><p>代码：</p><div class="code-wrapper"><pre class="line-numbers language-&#123;%" data-language="&#123;%"><div class="caption"><span>tabs emoji %&#125;</span></div><code class="language-&#123;%">&#123;% tabs emoji %&#125;&lt;!-- tab --&gt;:smile:&lt;!-- endtab --&gt;&lt;!-- tab --&gt;:laughing:&lt;!-- endtab --&gt;&lt;!-- tab --&gt;:relaxed:&lt;!-- endtab --&gt;&#123;% endtabs %&#125;&#96;&#96;&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="引用句子"><a href="#引用句子" class="headerlink" title="引用句子"></a>引用句子</h3><p>代码：</p><div class="code-wrapper"><pre class="line-numbers language-C++" data-language="C++"><code class="language-C++">&#123;% blockquote 王小波 http:&#x2F;&#x2F;www.bwsk.com&#x2F;xd&#x2F;w&#x2F;wangxiaobo&#x2F;hjsd&#x2F;index.html 黄金时代 %&#125;那一天我二十一岁，在我一生的黄金时代。我有好多奢望。我想爱，想吃，还想在一瞬间变成天上半明半暗的云。&#123;% endblockquote %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>效果：</p><blockquote><p>那一天我二十一岁，在我一生的黄金时代。我有好多奢望。我想爱，想吃，还想在一瞬间变成天上半明半暗的云。</p><footer><strong>王小波</strong><cite><a href="http://www.bwsk.com/xd/w/wangxiaobo/hjsd/index.html">黄金时代</a></cite></footer></blockquote><h3 id="其他标签"><a href="#其他标签" class="headerlink" title="其他标签"></a>其他标签</h3><p>在 <a href="https://hexo.io/docs/tag-plugins.html">Hexo标签</a> 和 <a href="https://theme-next.iissnan.com/tag-plugins.html">Next内置标签</a> 可以找到。</p><h2 id="自定义标签"><a href="#自定义标签" class="headerlink" title="自定义标签"></a>自定义标签</h2><h3 id="数字块"><a href="#数字块" class="headerlink" title="数字块"></a>数字块</h3><p>参考 <a href="https://blog.guanqr.com/study/blog/hexo-theme-next-customization/#%E6%95%B0%E5%AD%97%E5%9D%97">这个</a> 设置。</p><p>效果：<br><span id="inline-toc">1.</span><br><span id="inline-toc">2.</span><br><span id="inline-toc">3.</span></p><h2 id="颜色表"><a href="#颜色表" class="headerlink" title="颜色表"></a>颜色表</h2><hr><p><font color=DarkRed>███ ：DarkRed</font></p><p><font color=DarkYellow>███ ：DarkYellow</font></p><p><font color=red>███ ：red</font></p><p><font color=DarkOrange>███ ：DarkOrange</font></p><p><font color=Orange>███ ：Orange</font></p><p><font color=Yellow>███ ：Yellow</font></p><p><font color=LightYellow>███ ：LightYellow</font></p><p><font color=DarkGreen>███ ：DarkGreen</font></p><p><font color=Green>███ ：Green</font></p><p><font color=7baf23 >███ ：7baf23 </font></p><p><font color=LightGreen>███ ：LightGreen</font></p><p><font color=DarkBlue>███ ：DarkBlue</font></p><p><font color=Blue>███ ：Blue</font></p><p><font color=LigBlue>███ ：LigBlue</font></p><p><font color=LightBlue>███ ：LightBlue</font></p><p><font color=Purple>███ ：Purple</font></p><p><font color=DPurple>███ ：Purple</font></p><p><a href="https://blog.csdn.net/qq_25824243/article/details/74435757">【其他】</a></p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><span id="inline-toc">1.</span><a href="https://blog.guanqr.com/study/blog/hexo-theme-next-customization">Hexo-NexT 主题个性优化</a><br><span id="inline-toc">2.</span><a href="https://yfzhou.coding.me/2018/08/27/Hexo-Next%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96%EF%BC%89/">Hexo-Next搭建个人博客（主题优化）</a></p>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>博客</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【好物小记】好物小记</title>
    <link href="/2021/09/30/%E3%80%90%E5%A5%BD%E7%89%A9%E5%B0%8F%E8%AE%B0%E3%80%91%E5%A5%BD%E7%89%A9%E5%B0%8F%E8%AE%B0/"/>
    <url>/2021/09/30/%E3%80%90%E5%A5%BD%E7%89%A9%E5%B0%8F%E8%AE%B0%E3%80%91%E5%A5%BD%E7%89%A9%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p><img src="https://i.loli.net/2021/10/01/vC9zH5f8ipwyg1r.png" alt="猫猫图"></p><span id="more"></span><br><div class="note note-primary">            <p>记录一个好用且白嫖的服务器<a href="https://railway.app/">【Railway】</a></p>          </div><p><img src="https://i.loli.net/2021/10/06/AaZlURcN6L3zSdI.png" alt="RailWay"></p><br><div class="note note-primary">            <p>记录大牛自己开发的SSH工具<a href="https://www.nuoshell.com/">【NuoShell】</a>，（Royal也好用就是得付费）</p>          </div><p><img src="https://i.loli.net/2021/10/06/iTUYGOejRF3cmqd.png" alt="NuoShell界面-因为有我两个服务器的IP我就不详细展示啦"></p><p><img src="https://i.loli.net/2021/10/06/puOArsBQUzI5K2a.png" alt="NuoShell官网"></p><br><div class="note note-primary">            <p>记录宝塔控制面板<a href="bt.cn">【bt.cn】</a>，有他在服务器方便一万倍呀～</p>          </div> <p><font size=2 color=darkgray>常用命令 ： /etc/init.d/bt default</font></p><p><img src="https://i.loli.net/2021/10/06/lT25wSLF1VXYKOJ.png" alt="宝塔"></p><br><div class="note note-primary">            <p>记录好用的Mac终端工具<a href="https://github.com/Eugeny/tabby">【Tabby】</a></p>          </div> <p><img src="https://i.loli.net/2021/10/08/19ZfwB4pPQJWOhE.png" alt="Tabby终端工具"></p><div class="note note-primary">            <p><a href="http://110.40.191.51:5000/">【Ylui】</a>)桌面，这个真的爱了，Blog的格调瞬间上去了，<a href="https://ylui.yuri2.cn/">官网</a> 在此。</p>          </div> <p><img src="https://i.loli.net/2021/10/12/DMuotX6EOHFL9Tl.png" alt="Ylui桌面"></p><br><br><div class="note note-primary">            <p><strong>Spline 轻量化3D 制作工具，个人版永久免费。</strong></p>          </div> <img src="https://files.catbox.moe/lp8zxa.jpeg" style="width:88%;border-radius:20px;box-shadow:0 0 25px #cac6c6"  />]]></content>
    
    
    <categories>
      
      <category>好物小记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>好物小记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】static 关键字</title>
    <link href="/2021/09/30/%E3%80%90Java%E3%80%91static-%E5%85%B3%E9%94%AE%E5%AD%97/"/>
    <url>/2021/09/30/%E3%80%90Java%E3%80%91static-%E5%85%B3%E9%94%AE%E5%AD%97/</url>
    
    <content type="html"><![CDATA[<h2 id="static"><a href="#static" class="headerlink" title="static"></a>static</h2><p>静态的内容在内存中是保留一份的并且各个对象共享</p><p>静态方法中不能使用 this</p><p>一般使用类名访问</p><ol><li>数据共享</li><li>属于类的，并不属于对象</li><li>优先于对象产生</li></ol><p>通用构造器，静态构造器</p><p>创建对象过程（简单）</p><ol><li>静态构造器</li><li>通用构造器</li><li>构造方法-&gt;创建对象</li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">&#123;</span>  <span class="token class-name">String</span> name<span class="token punctuation">;</span>  <span class="token keyword">static</span> <span class="token class-name">String</span> country <span class="token operator">=</span> <span class="token string">"大清"</span><span class="token punctuation">;</span>  <span class="token class-name">String</span> address<span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">String</span> address<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token comment">// -------------------------------------------------</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Person</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"李铁柱"</span><span class="token punctuation">,</span><span class="token string">"八大胡同"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Person</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"李小花"</span><span class="token punctuation">,</span><span class="token string">"朝阳门"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 大清亡了</span>    p1<span class="token punctuation">.</span>country <span class="token operator">=</span> <span class="token string">"民国"</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 民国</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 民国</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>基础</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【维护小破站】Hexo搭建日记2-主题优化1</title>
    <link href="/2021/09/30/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91Hexo%E6%90%AD%E5%BB%BA%E6%97%A5%E8%AE%B02-%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%961/"/>
    <url>/2021/09/30/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91Hexo%E6%90%AD%E5%BB%BA%E6%97%A5%E8%AE%B02-%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%961/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>NexT主题在更新到8.0版本之后，将许多8.0之前需要自己改代码的部分全部添加到了_config.yml文件中去了，配置十分简单，需要自己更改代码的地方简直少之又少。</p><span id="more"></span><p>在前两次搭建NexT的时候，用的都是7.x版本的NexT，所使用的修改也都是网上一搜一大把的，但是最近看了<a href="https://www.jmyblog.top/themeUpgrade/?highlight=hexo">这一篇博客</a>之后，发现事情并不简单：由于团队之间的争执，NexT更换了维护团队，并且更换了仓库，因此赶紧Clone新的仓库，然后开始配置。</p><p><img src="https://i.loli.net/2021/06/25/oliLXKknhpUQG51.png" alt="当下NexT持有者的解释"></p><hr>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>维护小破站</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【维护小破站】Hexo上传至 github仓库</title>
    <link href="/2021/09/30/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91Hexo%E8%BF%9E%E6%8E%A5github%20%E4%BB%93%E5%BA%93/"/>
    <url>/2021/09/30/%E5%8D%9A%E5%AE%A2/%E3%80%90Hexo%E3%80%91Hexo%E8%BF%9E%E6%8E%A5github%20%E4%BB%93%E5%BA%93/</url>
    
    <content type="html"><![CDATA[<h2 id="如题"><a href="#如题" class="headerlink" title="如题"></a>如题</h2><p>以下所有的设置都只是为了从本地仓库上载到自己的Github仓库而非clone，因为hexo博客的特点就是在本地创建库，生成相应的文件后使用命令<code>hexo d</code>上载到自己的博客仓库，因此连接自己的GitHub仓库是必不可少的步骤，否则只能localhost看看了，其他人无法访问的。</p><span id="more"></span><h3 id="正文开始"><a href="#正文开始" class="headerlink" title="正文开始"></a>正文开始</h3><hr><p>在终端中运行以下命令（这是四条命令的组合命令，请将所有的Mail与UserName改成自己的用户名和ID）：</p><div class="note note-default">            <p>git config –global user.name “username”  &amp;&amp;  git config –global user.email “<a href="mailto:&#101;&#109;&#97;&#105;&#x6c;&#64;&#x67;&#109;&#97;&#105;&#108;&#46;&#99;&#x6f;&#x6d;">&#101;&#109;&#97;&#105;&#x6c;&#64;&#x67;&#109;&#97;&#105;&#108;&#46;&#99;&#x6f;&#x6d;</a>“ &amp;&amp;  ssh-keygen -t rsa -C “<a href="mailto:&#x65;&#109;&#x61;&#x69;&#x6c;&#64;&#103;&#109;&#x61;&#105;&#x6c;&#x2e;&#99;&#x6f;&#x6d;">&#x65;&#109;&#x61;&#x69;&#x6c;&#64;&#103;&#109;&#x61;&#105;&#x6c;&#x2e;&#99;&#x6f;&#x6d;</a>“ &amp;&amp; cat ~/.ssh/id_rsa.pub</p>          </div><p>执行过后会输出自己的 <span class="label label-info">Key值</span> ，然后打开Github-点击右上角头像-设置</p><p><img src="https://i.loli.net/2021/09/30/B4GNzqDkYxCaZEh.png"></p><p>选择 SSH &amp; GPG Keys</p><p><img src="https://i.loli.net/2021/09/30/Cm1QlABhTdfp4H9.png"></p><p>点击右上角的New SSH KEY 将自己一开始获取的 <span class="label label-info">Key值</span> 复制进去就好了，记得提交哦～</p><p><img src="https://i.loli.net/2021/09/30/rE4gb7aCS8Rqoec.png"></p><p>嗯结束了，结束的有些突然，但是还是结束了</p>]]></content>
    
    
    <categories>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>维护小破站</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】super 的使用</title>
    <link href="/2021/08/31/%E3%80%90Java%E3%80%91super%20%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2021/08/31/%E3%80%90Java%E3%80%91super%20%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="super-的使用"><a href="#super-的使用" class="headerlink" title="super 的使用"></a>super 的使用</h1><p>如果 B 继承了 A，那么 B 可以通过 super 来调用 A 中的方法。</p><br><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 父类 A</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sayhello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 子类 B</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">extends</span> <span class="token class-name">A</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// B 继承了 A，通过 super 调用父类中的方法</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">sayhello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 主类 main 方法</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo4Application</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">B</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      b<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 输出结果</span><span class="token class-name">A</span><span class="token class-name">Hello</span><span class="token class-name">B</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>基础</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Linux】Debian 系 Kali 使用 Wine 虚拟机安装 QQ/微信 等常用软件</title>
    <link href="/2021/03/10/%E3%80%90Linux%E3%80%91Debian-%E7%B3%BB-Kali-%E4%BD%BF%E7%94%A8-Wine-%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85-QQ%E5%BE%AE%E4%BF%A1-%E7%AD%89%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/"/>
    <url>/2021/03/10/%E3%80%90Linux%E3%80%91Debian-%E7%B3%BB-Kali-%E4%BD%BF%E7%94%A8-Wine-%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85-QQ%E5%BE%AE%E4%BF%A1-%E7%AD%89%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><br><p>前一段时间在 Kali 上安装了 Deepin-wine ，并且安装了QQ/微信，链接及教程<a href="https://www.cnblogs.com/hskcool/p/14227695.html">【点击此处】</a>可以查看，但是这种方式安装 wine 虚拟机存在小小的问题，具体如下：</p><blockquote><ul><li>在 Ubuntu 上安装较顺利，但是 Kali 上安装出现的问题较多</li><li>安装 KDE-install.sh的过程中提示 i386 错误<ul><li>使用 <code>apt -f install</code>并不能解决这个依赖问题</li><li>直接安装以来也提示报错</li></ul></li><li>忽略依赖直接安装，结束后虽然安装了 QQ/微信 但是打不开</li><li>仅能安装大牛打包的 <code>deb</code> 文件，不能安装 Windows 上的 <code>.exe</code> 文件，所以选择有限（大概不超过10种）</li><li>正确安装好软件之后，由于字体不匹配，中文全部由小方框代替<ul><li>可以移植 Windows 的中文字体来解决这一问题，但是比较麻烦</li><li>也许将系统语言调整成中文也可以解决，但是我没有尝试过</li></ul></li></ul></blockquote><p>前一段时间我在网上闲逛的时候，发现了另一种安装方式，类似于在 Linux 上构造一个微型的 Windows 虚拟机，基本上解决了如上的所有问题，具体如下：</p><blockquote><ul><li>无 i386 报错</li><li>中文正常显示</li><li>可以直接安装 <code>.exe</code> 文件</li></ul></blockquote><p>具体安装过程看以下博客（原文地址在博客结尾会写出）：</p><br><br><br><br><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><br><br><h4 id="开启kali的i386支持"><a href="#开启kali的i386支持" class="headerlink" title="开启kali的i386支持"></a>开启kali的i386支持</h4><hr><blockquote><p>开启支持：dpkg –add-architecture  i386<br>更新一下：apt updata &amp;&amp; apt upgrade</p></blockquote><br><h4 id="安装wine并设置环境变量"><a href="#安装wine并设置环境变量" class="headerlink" title="安装wine并设置环境变量"></a>安装wine并设置环境变量</h4><hr><p>因为 Kali 默认安装wine64 ，所以使用如下命令安装wine32：</p><blockquote><p>apt install wine32</p></blockquote><p>安装结束后在<code>～/.bashrc</code>文件（在root模式下，使用自己常用的如 vim 或 leafpad 打开就可以）最后添加以下环境变量，默认使用wine32</p><blockquote><p> export WINEPREFIX=~/win32<br> export WINEARCH=win32</p></blockquote><p> 安装winetricks 以用来安装wine所需的支持库</p><blockquote><p> apt-get install winetrick5</p></blockquote><p>加载一下环境变量</p><blockquote><p>source ~/.bashrc </p></blockquote><p>安装一下支持文件</p><blockquote><p>apt install winbind<br>apt install wine32-preloader<br>winetricks riched20</p></blockquote><br><h4 id="安装微信"><a href="#安装微信" class="headerlink" title="安装微信"></a>安装微信</h4><hr><p>去<a href="https://weixin.qq.com/cgi-bin/readtemplate?uin=&stype=&promote=&fr=&lang=zh_CN&ADTAG=&check=false&nav=download&t=weixin_download_list&loc=readtemplate,weixin,body,6">【微信官网】</a>下载微信的 <code>.exe</code> 安装包，并使用以下命令进行安装：</p><blockquote><p>wine WeChatSetup.exe </p></blockquote><p>安装结束，桌面会出现微信的图标，双击打开就可以正常使用了，界面如下：</p><div align=center><img style="width:350px" src="https://img2020.cnblogs.com/blog/2159067/202102/2159067-20210216215846765-289127058.png" alt="二维码"></div><br><br><br><br><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><hr><blockquote><ul><li>如果在安装过程中出现任何错误，请回到前一步重新执行</li><li>如果在安装过程中更新环境变量出现错误，请忽略</li><li><a href="https://blog.csdn.net/wislove/article/details/96199363?ops_request_misc=&request_id=&biz_id=102&utm_term=kali%20%E5%AE%89%E8%A3%85%20wine&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-96199363.first_rank_v2_pc_rank_v29&spm=1018.2226.3001.4187">博客原文地址</a></li></ul></blockquote>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Debian</tag>
      
      <tag>Kali</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【学】左程云 算法的 概念 与 性质</title>
    <link href="/2021/03/03/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E7%AE%97%E6%B3%95%E7%9A%84-%E6%A6%82%E5%BF%B5-%E4%B8%8E-%E6%80%A7%E8%B4%A8/"/>
    <url>/2021/03/03/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E7%AE%97%E6%B3%95%E7%9A%84-%E6%A6%82%E5%BF%B5-%E4%B8%8E-%E6%80%A7%E8%B4%A8/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="【左程云-01】算法的-概念-与-性质"><a href="#【左程云-01】算法的-概念-与-性质" class="headerlink" title="【左程云 01】算法的 概念 与 性质"></a>【左程云 01】算法的 概念 与 性质</h3><p><br><br><br></p><p><font color=DarkGray size=2>算法要求：在保证时间复杂度最低的前提下，尽可能减小空间复杂度与常数项时间复杂度；</font></p><hr><br><h4 id="优劣算法评估"><a href="#优劣算法评估" class="headerlink" title="优劣算法评估"></a>优劣算法评估</h4><ul><li><font color=7baf23 >时间</font>复杂度（流程决定）<ul><li>忽略低阶项 与 高阶项的系数，留下来的就是时间复杂度；</li><li>如一个流程最后得到的算式是 3 * N<sup>4</sup> + 4 * N<sup>2</sup> + C ，则最终时间复杂度就是 O( N<sup>4</sup> )  </li></ul></li><li>额外<font color=7baf23 >空间</font>复杂度（流程决定）<ul><li>与功能无关，必须自己开辟的额外空间</li><li>用户要求的功能，（如复制一个数组），则实现这个功能所使用的代码空间不算</li></ul></li><li>常数项时间（实现细节决定）</li></ul><br><br><h4 id="常数与非常数时间操作"><a href="#常数与非常数时间操作" class="headerlink" title="常数与非常数时间操作"></a>常数与非常数时间操作</h4><ul><li><p>什么是<font color=DarkOrange>常数</font>时间操作？</p><ul><li><p>概念：一个数据改变偏移量，操作所需要的时间不变就是常数时间操作；</p></li><li><p>实例：从数组中取第一个与取第100000个元素所需要的时间一样，则这就是一个常数操作；</p></li><li><p>常见的此类操作：</p><ul><li>加 / 减 / 乘 / 除 / 取余 ：<code>+</code>  <code>-</code> <code>* </code> <code>/</code> <code>%</code></li><li>常见的位运算操作（&gt;&gt; / &gt;&gt;&gt; / &lt;&lt; / | &amp; / ^ 等）</li><li>赋值、比较、自增、自减操作等</li><li>数组寻址操作</li></ul></li></ul></li><li><p>什么是<font color=orange>非</font>常数时间操作：</p><ul><li>除了常数时间操作都是非常数时间操作；</li><li>举例：LinkedList，寻址的时候需要遍历；</li></ul></li><li><p>排序算法中的常见优劣性</p></li></ul><p><font color=darkgray size=2> 尽量可以背下来； </font></p><hr><table><thead><tr><th>中文名称</th><th>英文名称</th><th>平均时间复杂度</th><th>最坏时间复杂度</th><th>最好时间复杂度</th><th>空间复杂度</th><th>稳定性</th></tr></thead><tbody><tr><td>选择排序</td><td>Selection</td><td>n²</td><td>n²</td><td>n²</td><td>1</td><td><font color=red>×</font></td></tr><tr><td>冒泡排序</td><td>Bubble</td><td>n²</td><td>n²</td><td>n</td><td>1</td><td><font color = 7baf23> √</font></td></tr><tr><td>插入排序<font color = 7baf23> √</font></td><td>Insertion</td><td>n²</td><td>n²</td><td>n</td><td>1</td><td><font color = 7baf23> √</font></td></tr><tr><td>堆排序<font color = 7baf23>     √</font></td><td>Heap</td><td>n log<sub>2</sub> n</td><td>n log<sub>2</sub> n</td><td>n log<sub>2</sub> n</td><td>1</td><td><font color=red>×</font></td></tr><tr><td>希尔排序</td><td>Shell</td><td>n<sup>1.3</sup></td><td>n<sup>2</sup></td><td>n</td><td>1</td><td><font color=red>×</font></td></tr><tr><td>归并排序<font color = 7baf23> √</font></td><td>Merge</td><td>n log<sub>2</sub> n</td><td>n log<sub>2</sub> n</td><td>n log<sub>2</sub> n</td><td>n</td><td><font color = 7baf23>√</font></td></tr><tr><td>快速排序<font color = 7baf23> √</font></td><td>Quick</td><td>n log<sub>2</sub> n</td><td>n<sup>2</sup></td><td>n log<sub>2</sub> n</td><td>log<sub>2</sub> n</td><td><font color=red>×</font></td></tr><tr><td>桶排序</td><td>Bucket</td><td>n + k</td><td>n<sup>2</sup></td><td>n</td><td>n + k</td><td><font color = 7baf23>√</font></td></tr><tr><td>计数排序</td><td>Counting</td><td>n + k</td><td>n + k</td><td>n + k</td><td>n + k</td><td><font color = 7baf23>√</font></td></tr><tr><td>基数排序</td><td>Radix</td><td>n * k</td><td>n * k</td><td>n * k</td><td>n + k</td><td><font color = 7baf23>√</font></td></tr></tbody></table><blockquote><p>举例：插入排序的最优与最差时间复杂度</p><ul><li>最优例子：【0 1 2 3 4 5 6 】</li><li>最差例子：【6 5 4 3 2 1 0 】</li></ul></blockquote><hr><p><br><br></p><h4 id="合理使用对数器"><a href="#合理使用对数器" class="headerlink" title="合理使用对数器"></a>合理使用对数器</h4><hr><br><blockquote><ul><li>认识对数器<ul><li>想要测试的 方法 a</li><li>实现复杂度不好但使用以实现的 方法 b</li><li>实现一个随机样本产生器</li><li>把 方法 a 和 方法 b 跑相同的随机样本，看得到的结果是否一致</li><li>如果一个随机样本使比对结果不一致，打印样本进行人工干预，改对 方法 a 和 方法 b；</li><li>当样本数量很多时比对测试依然正确，则可以确定方法 a 已经正确。 </li></ul></li></ul></blockquote><p><br><br><br><br></p><h3 id="算法示例（重要！）"><a href="#算法示例（重要！）" class="headerlink" title="算法示例（重要！）"></a>算法示例（重要！）</h3><hr><br><ul><li>从一个长度为 n 的 <font color=DarkOrange>有序数组 </font>中寻找一个数字 m；</li></ul><blockquote><p>方法一：遍历： O（ n ）</p><p>方法二：二分查找法： O（ log<sub>2</sub> N ）</p></blockquote><br><hr><br><ul><li>从一个长度为 n 的 <font color=red> <strong>无</strong> </font> <font color=DarkOrange>序数组（相邻不等）</font> 中寻找一个局部最小值（任意一个）；</li></ul><blockquote><p>略</p></blockquote><br><hr><br><ul><li>一个数组中有一种数出现了奇数次，其他的都是偶数次，找出这个奇数次的数字：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 用一个 0 从头异或到尾，最后这个 0 数字就会变成 那个 奇数数字；</span><span class="token keyword">int</span> eor <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span>  arr <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>eor <span class="token operator">=</span> aor<span class="token operator">^</span>arr<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><hr><br><ul><li>abcde 五个数字异或的结果一样，顺序无所谓（ 满足 <font color= 7baa2>交换律</font> 与 <font color= 7baf23>结合律</font> ）</li></ul><blockquote><p>异或<font color=Orange>常用公式</font>：</p><blockquote><p>0  ^ N == N</p><p>N ^ N == 0</p></blockquote><p>a b 两个数字交换值：（自己推导一下，很简单，不懂得可以看推导过程 <strong>A01</strong>。）</p><p>a = a ^ b</p><p>b = a ^ b</p><p>a = a ^ b</p></blockquote><br><hr><br><ul><li>一个数字，取出最右侧的 1 ，如 14 二进制之后变成【 1 1 <u><code>1</code></u> 0】 取出下划线的 <code>1</code></li></ul><blockquote><p>如 要计算的是 a</p><p>则 b = a取反 + 1</p><p>a = a ^ b;</p></blockquote><br><hr><br><ul><li>一个数组中有两种数（这两个数字不相等且 a ! = 0,b != 0 ）出现了奇数次，其他的都是偶数次，找出这两种奇数次的数字：</li></ul><blockquote><p>根据第三题的理论：好比这两个数字是 a 和 b，eor 异或之后 得到的结果是 a ^ b（a != b）</p><p>根据第五题的理论：eor 一定在某一个位置有个1（记此位置为 n ），那这个位置对于 a 和 b 来说，一定不一样，（a 和 b 在这一位上一定一个是 0 一个是 1）</p><p>那整个数组一定可以分为两大类 ：第n位为 0 的数 与 第n位为 1 的数，出现偶数次的数无论怎么分都无所谓，所以执行下面的步骤：</p><p>eor异或之前 + 一个条件，只要第 n 位为 0 （或者只异或 为 1的）</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> rightOne <span class="token operator">=</span> eor <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">~</span>eor <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 取出最右侧的那个 1</span><span class="token keyword">int</span> onlyOne  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// eor'</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> rightOne<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     onlyOne <span class="token operator">^=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>onlyOne<span class="token operator">+</span><span class="token string">""</span><span class="token operator">+</span><span class="token punctuation">(</span>eor<span class="token operator">^</span>onlyOne<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>那么一个数已经出来了，就是eor，另一个数就是 eor ^ eor’ （ eor 异或上 eor 取反）</p></blockquote><br><hr><br><ul><li>找一个二进制数字中所有的 1</li></ul><blockquote><p>找出最右侧的 1 记为 rightOne</p><p>rightOne 与 这个数字 异或，这就消除了最右侧的 1</p><p>重复第一步与第二部，直到找不到 rightOne</p></blockquote><p><br><br><br><br></p><h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><hr><br><h4 id="推导过程-A01"><a href="#推导过程-A01" class="headerlink" title="推导过程 A01"></a>推导过程 A01</h4><blockquote><p>甲 乙 两个数字交换值，让int a = 甲，int b = 乙：</p><ul><li>a = a ^ b </li></ul><blockquote><p>此时 a = 甲 ^ 乙 ;b = 乙;</p></blockquote><ul><li>b = a ^ b</li></ul><blockquote><p>此时 b = 甲 ^ 乙 ^ 乙;（由于 a 在上一步已经等于 “甲 ^ 乙” 了）</p></blockquote><blockquote><p>根据公式：N ^ N == 0，所以 b ^ b == 0；（异或满足交换定律，运算顺序无所谓）</p></blockquote><blockquote><p>根据公式：0 ^ N == N，所以  a ^ 0 == a ， 所以 b = a;</p></blockquote><ul><li>a = a ^ b</li></ul><blockquote><p>此时的 a == 甲 ^ 乙，b == 甲，所以这个算是可以写成：a = 甲 ^ 乙 ^ 甲；</p></blockquote><blockquote><p>所以得到 a = 乙（原理同第二步）</p></blockquote></blockquote><hr><br><h4 id="二分法注意事项："><a href="#二分法注意事项：" class="headerlink" title="二分法注意事项："></a>二分法注意事项：</h4><blockquote><p>方法一：mid = ( L + R ) / 2</p><p>改    进：mid = L + ( R - L ) / 2</p><p>N / 2 == N &gt;&gt; 1    （位运算速度比除运算快）</p><p>mid = L + ( R - L ) &gt;&gt; 1</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】跨域 以及 解决跨域的三种办法</title>
    <link href="/2021/02/15/%E3%80%90Java%E3%80%91%E8%B7%A8%E5%9F%9F-%E4%BB%A5%E5%8F%8A-%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E7%9A%84%E4%B8%89%E7%A7%8D%E5%8A%9E%E6%B3%95/"/>
    <url>/2021/02/15/%E3%80%90Java%E3%80%91%E8%B7%A8%E5%9F%9F-%E4%BB%A5%E5%8F%8A-%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E7%9A%84%E4%B8%89%E7%A7%8D%E5%8A%9E%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="跨域-以及-解决跨域的三种办法"><a href="#跨域-以及-解决跨域的三种办法" class="headerlink" title="跨域 以及 解决跨域的三种办法"></a>跨域 以及 解决跨域的三种办法</h1><p>浏览器的同源策略</p><p>协议、域名、端口三者全部相同才算是同源</p><div class="note note-primary">            <h3 id="解决方案一"><a href="#解决方案一" class="headerlink" title="解决方案一"></a>解决方案一</h3>          </div><p>目标方法上添加<span class="label label-success"></span>注解</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/hello"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@CrossOrigin</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token class-name">HelloController</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token string">"Hello "</span><span class="token operator">+</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <h3 id="解决方案二"><a href="#解决方案二" class="headerlink" title="解决方案二"></a>解决方案二</h3>          </div><p>添加 CORS 过滤器</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span></span><span class="token class-name">CorsConfiguration</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span></span><span class="token class-name">UrlBasedCorsConfigurationSource</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span></span><span class="token class-name">CorsFilter</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CorsConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">CorsFilter</span> <span class="token function">corsFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">CorsConfiguration</span> corsConfiguration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CorsConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 允许那些域通过</span>        corsConfiguration<span class="token punctuation">.</span><span class="token function">addAllowedOrigin</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 允许哪些头字段</span>        corsConfiguration<span class="token punctuation">.</span><span class="token function">addAllowedHeader</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 允许哪些请求方式 GET/POST</span>        corsConfiguration<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">UrlBasedCorsConfigurationSource</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlBasedCorsConfigurationSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        source<span class="token punctuation">.</span><span class="token function">registerCorsConfiguration</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">,</span>corsConfiguration<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CorsFilter</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="note note-primary">            <h3 id="解决方案三"><a href="#解决方案三" class="headerlink" title="解决方案三"></a>解决方案三</h3>          </div><p>实现 WebMvcConfigurer 接口，重写 addCorsMappings 方法</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">CorsRegistry</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebMvcConfigurer</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Controller</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CorsConfiguration</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCorsMappings</span><span class="token punctuation">(</span><span class="token class-name">CorsRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        registry<span class="token punctuation">.</span><span class="token function">addMapping</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">allowedOriginPatterns</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span><span class="token string">"POST"</span><span class="token punctuation">,</span><span class="token string">"PUT"</span><span class="token punctuation">,</span><span class="token string">"DELETE"</span><span class="token punctuation">,</span><span class="token string">"HEAD"</span><span class="token punctuation">,</span><span class="token string">"POTIONS"</span><span class="token punctuation">)</span>                <span class="token comment">// 允许携带 cookie</span>                <span class="token punctuation">.</span><span class="token function">allowCredentials</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>                <span class="token comment">// 3600 秒内浏览器不必再次访问</span>                <span class="token punctuation">.</span><span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token number">3600</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">allowedHeaders</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Error】权限 不够/ 受阻 一类问题的解决方法</title>
    <link href="/2021/01/05/%E3%80%90Linux%E3%80%91-%E6%9D%83%E9%99%90-%E4%B8%8D%E5%A4%9F-%E5%8F%97%E9%98%BB-%E4%B8%80%E7%B1%BB%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <url>/2021/01/05/%E3%80%90Linux%E3%80%91-%E6%9D%83%E9%99%90-%E4%B8%8D%E5%A4%9F-%E5%8F%97%E9%98%BB-%E4%B8%80%E7%B1%BB%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><hr><p>在 Linux 中可能会遇到两种权限问题，第一种只要在命令最前方＋<code>sudo</code>便可以执行，这是使用 root 身份进行执行，另一种则不仅会出现在使用命令中，如在某个文件夹右击删除某个内容时，也会出现<code>权限不够，是否跳过？</code>这一类提示，这时候只要执行如下命令便可以解决：</p><blockquote><p>chmod 777 文件（或文件夹）名称</p></blockquote><p>在所有使用 root 无法解决，或在图形用户化界面操作无法解决时，都可以打开 终端 并且输入如上命令解决</p><br><br><h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><hr><p>如果对你有帮助的话，可以【关注】作者，且右下角可对作者进行打赏哦</p>]]></content>
    
    
    <categories>
      
      <category>Error</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Error</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Springboot】Spring Framework 5 框架</title>
    <link href="/2021/01/05/%E3%80%90Springboot%E3%80%91Spring-Framework-5-%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/"/>
    <url>/2021/01/05/%E3%80%90Springboot%E3%80%91Spring-Framework-5-%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="Spring-Framework-5-框架系列"><a href="#Spring-Framework-5-框架系列" class="headerlink" title="Spring Framework 5 框架系列"></a>Spring Framework 5 框架系列</h3><p><br><br><br></p><h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><hr><ul><li><p>什么是Spring？</p><ul><li>Spring 是一个轻量级的<em>（对象）</em>控制翻转（IOC/DI）和面向切面编程（AOP）的对象容器框架；</li><li>极大简化开发过程，降低开发难度；</li></ul></li><li><p>什么是控制翻转（IOC）？</p><blockquote><p><font color=#f90>Spring 用户相当于窃取 Spring 成果的存在</font></p><p>举例：</p><p>我 想要生一个孩子</p><p>我 需要付出的代价是：生孩子、喂奶、教他读书……</p><p>我 生孩子的目的是：玩儿、洗完、赚钱、养老……</p><p>现在有一个第三方机构，可以帮我完成生孩子所付出的代价，也就是可以替我生产、喂奶、教学</p><p>所以我只要等着玩孩子、让他洗碗、赚钱就可以了</p></blockquote></li><li><p>什么是 依赖注入（DI） ？</p><ul><li>对象 <code>new</code> 出来之后，由 <code>Spring</code> 来决定 <code>set</code> 跟 <code>get</code></li><li><code>IOC</code>是思想，<code>DI</code>是解决方案</li></ul></li><li><p>下载</p><ul><li>官网（文档最底部）下载最新版的<code>dist</code>压缩包</li></ul></li></ul><hr><p><br><br></p><h4 id="五个核心-jar-包"><a href="#五个核心-jar-包" class="headerlink" title="五个核心 jar 包"></a>五个核心 jar 包</h4><hr><div class="code-wrapper"><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">commons-logging-1.2.jarspring-beans-5.1.7.RELEASE.jarspring-context-5.1.7.RELEASE.jarspring-core-5.1.7.RELEASE.jarspring-expression-5.1.7.RELEASE.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=#f890 size=2>commons-lang.3.3.9.jar 需要自己<code>下载</code></font></p><p><br><br></p><h4 id="控制翻转-IOC-依赖注入-DI"><a href="#控制翻转-IOC-依赖注入-DI" class="headerlink" title="控制翻转 IOC 依赖注入 DI"></a>控制翻转 IOC 依赖注入 DI</h4><hr><ul><li>引用核心类</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestGetBean</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 原始方法 创建对象</span>        <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// 控制翻转后 创建对象</span>        <span class="token class-name">ClsssPathXmlApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"applicationContext.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// ↑ ↑  通过 ClassPath 查找 xml 文件 applicationContext.xml</span>        <span class="token comment">// ↑ ↑  通过 ApplicationContext（应用程序上下文） 查找 应用程序上下文</span>        <span class="token comment">// 有了上面两个就可以通过 ctx 进行 getBean 了</span>        <span class="token class-name">Object</span> bean <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">)</span>ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"person"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        bean<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        bean<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// -------- 分割线 ---------</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span>bean<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span>bean<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>配置文件 applicationContext.xml 中</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 添加</span><span class="token operator">&lt;</span>beans …… <span class="token operator">></span><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"person"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.…….Person"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="解耦合-amp-amp-属性"><a href="#解耦合-amp-amp-属性" class="headerlink" title="解耦合 &amp;&amp; 属性"></a>解耦合 &amp;&amp; 属性</h4><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span> <span class="token comment">// Lombok 注释：替代set / get / toString 方法</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">&#123;</span><span class="token keyword">private</span> <span class="token class-name">Food</span> foot<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Food</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> hungry<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">……</span> <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>person<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…….Person<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zhangsan<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>constructor-arg</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>18<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>constructor-arg</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>food<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>food<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>constructor-arg</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=#f890 size=2> <code>&lt;constructor-arg name=&quot;name&quot; value=&quot;zhangsan&quot;&gt;&lt;/constructor-arg&gt;</code></font></p><p><font color=#f890 size=2> 其中：constructor-arg是<code>属性</code>，value是<code>值</code>，ref代表<code>引用其他的类</code></font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Food</span> food <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"food"</span><span class="token punctuation">,</span><span class="token class-name">Food</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> a <span class="token operator">=</span> <span class="token class-name">ToStringBuilder</span><span class="token punctuation">.</span><span class="token function">reflectionToString</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Sout</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><hr><h4 id="ApplicationContext-xml-文件的详情"><a href="#ApplicationContext-xml-文件的详情" class="headerlink" title="ApplicationContext.xml 文件的详情"></a>ApplicationContext.xml 文件的详情</h4><hr><div class="code-wrapper"><pre class="line-numbers language-xxxml" data-language="xxxml"><code class="language-xxxml">&lt;project xmlns&#x3D;&quot;http:&#x2F;&#x2F;maven.apache.org&#x2F;POM&#x2F;4.0.0&quot; &lt;!--这里只是一个标签--&gt;xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;maven.apache.org&#x2F;POM&#x2F;4.0.0 http:&#x2F;&#x2F;maven.apache.org&#x2F;xsd&#x2F;maven-4.0.0.xsd&quot;&gt;&lt;modelVersion&gt;4.0.0&lt;&#x2F;modelVersion&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=#f890 size=2>xml文件的定义</font></p><hr><ul><li>加载多个配置文件</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 文件一： ApplicationContext.xml</span><span class="token comment">// 文件二： ApplicationContext-service.xml</span><span class="token comment">// 调用：</span><span class="token comment">// 方法一：</span><span class="token class-name">ClassPathXmlApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"ApplicationContext.xml"</span><span class="token punctuation">,</span><span class="token string">"ApplicationContext-service.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 方法二：</span><span class="token comment">//将字符串定义成一个数组</span><span class="token comment">// 方法三：在一个 XML 文件中使用</span><span class="token operator">&lt;</span><span class="token keyword">import</span> <span class="token namespace">resource</span><span class="token operator">=</span><span class="token string">"applicationContext-service1.xml"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token keyword">import</span> <span class="token namespace">resource</span><span class="token operator">=</span><span class="token string">"applicationContext-service2.xml"</span><span class="token operator">></span><span class="token comment">// 优化</span><span class="token operator">&lt;</span><span class="token keyword">import</span> <span class="token namespace">resource</span><span class="token operator">=</span><span class="token string">"application-*.xml"</span><span class="token operator">></span>    <span class="token comment">// ………………</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><hr><ul><li>将 <code>new</code> 换成 <code>&lt;bean id=&quot;xxx&quot; class=&quot;xxx.class&quot;&gt;&lt;/bean&gt;</code></li><li>将<code>set</code>换成 <code>&lt;constructor-arg name=&quot;xxx&quot; value=&quot;xxx&quot;&gt;&lt;/constructor-arg&gt;</code></li><li>配置文件的开头部分的功能</li><li>引用 一个 / 多个 配置文件的方式</li></ul><hr><p><br><br></p><h4 id="使用-Spring"><a href="#使用-Spring" class="headerlink" title="使用 Spring"></a>使用 Spring</h4><hr><ul><li>引用核心类</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestGetBean</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">ClsssPathXmlApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"applicationContext.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// ↑ ↑  通过 ClassPath 查找 xml 文件 applicationContext.xml</span>        <span class="token comment">// ↑ ↑  通过 ApplicationContext（应用程序上下文） 查找 应用程序上下文</span>        <span class="token comment">// 有了上面两个就可以通过 ctx 进行 getBean 了</span>        <span class="token class-name">Object</span> bean <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">)</span>ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"person"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        bean<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        bean<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// -------- 分割线 ---------</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span>bean<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span>bean<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>配置文件 applicationContext.xml 中</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 添加</span><span class="token operator">&lt;</span>beans …… <span class="token operator">></span><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"person"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.…….Person"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br></p><p><br><br></p><h3 id="补充学习"><a href="#补充学习" class="headerlink" title="补充学习"></a>补充学习</h3><br><br><h5 id="什么是-单例？"><a href="#什么是-单例？" class="headerlink" title="什么是 单例？"></a>什么是 单例？</h5><hr><ul><li>应用程序在运行的时候只出来一个对象；</li><li><a href="https://blog.csdn.net/qq_42857603/article/details/83375057">单例对象（ 顺便 复习一下 饱汉/饿汉 模式）</a></li></ul><hr><p><br><br></p><h4 id="什么是-Bean？"><a href="#什么是-Bean？" class="headerlink" title="什么是 Bean？"></a>什么是 Bean？</h4><hr><p>bean ，作为一个英文单词的意思是豆子，在 Spring 框架中，Bean 的意思就是一个实体，好比我创建一个 Son.java 如下：</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Son</span><span class="token punctuation">&#123;</span><span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>那么这个类就是一个 Bean 对象，你创建的所有实体，每一个实体都是一个 Bean；</p><p><br><br></p><h4 id="MVC-简介（-什么是MVC？）"><a href="#MVC-简介（-什么是MVC？）" class="headerlink" title="MVC 简介（ 什么是MVC？）"></a>MVC 简介（ 什么是MVC？）</h4><hr><ul><li>缘起：<ul><li>最初没有 MVC 的时候，只是一个简单的基于<font color=#f52g>请求 / 响应</font>的流模式</li><li>Serviet(request / response) 【请求】 →  Service【处理业务逻辑】 → jsp【展示】 </li><li>【Model 控制层】一个业务逻辑都有一个 <strong>具体的类</strong> 来处理，将所有的 <strong>类</strong> 整合起来，称作 <code>Service</code></li><li>【View    视图层】展示 <strong>结果</strong> 的一个层，jsp、下载 等</li><li>【Controller 接收层】接收前端给的数据层，接收之后给 <strong>Model</strong> 层来处理</li></ul></li></ul><hr><p><br><br></p><h4 id="SSM-结构"><a href="#SSM-结构" class="headerlink" title="SSM 结构"></a>SSM 结构</h4><p><font color=DarkGray size=2>Spring / SpringMVC / Mybatis</font></p><hr><ul><li>Spring 作用：<code>new</code> 对象<ul><li>DI 依赖注入（Controller 需要 Service，每次<code>new</code>一个十分消耗性能，<code>DI</code> 可以优化性能）；<ul><li><code>service</code>（单例） - 处理逻辑</li><li><code>DAO</code>（单例） - 处理数据库</li><li><code>pojo</code>（多例） - 不归<code>Spring</code>容器管理</li></ul></li></ul></li><li>SpringMVC ：<ul><li>一个MVC框架</li></ul></li><li>MyBatis：<ul><li>（使用 xml 文件）操作数据库</li></ul></li></ul><hr><p><br><br></p><h4 id="为什么用单例？"><a href="#为什么用单例？" class="headerlink" title="为什么用单例？"></a>为什么用单例？</h4><hr><ul><li>性能好（节省内存）；</li><li>迸发情况下，容易产生 <strong>线程安全</strong> 问题；</li><li>容器（如：Spring）接到请求，每一个请求都是一个 <strong>线程</strong> ；</li></ul><hr><p><br><br></p><h4 id="单例类的注意事项："><a href="#单例类的注意事项：" class="headerlink" title="单例类的注意事项："></a>单例类的注意事项：</h4><hr><ul><li>不能有状态数据，如果有要非常小心；</li><li>一个线程改了，另一个线程读了这个样子；</li><li><code>ThreadLocal</code> 用来做线程隔离的，线程 与 线程之间不共享，但是 某些实体类或者某些方法中写了<code>private</code>的属性（可以使用<code>set</code>来修改），一个刚<code>set</code>完（或者还没<code>set</code>结束），另一个就也来<code>set</code>了；</li></ul><hr><p><br><br></p><h4 id="Spring-的作用域"><a href="#Spring-的作用域" class="headerlink" title="Spring 的作用域"></a>Spring 的作用域</h4><p><font color = DarkGray size=2>这三个 <code>Person</code>完全一模一样，存储地址也一样；</font> </p><hr><blockquote><p>ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext(“applicationContext.xml”);</p><p>Person person1 = ctx.getBean(“person”,Person.class);</p><p>Person person2 = ctx.getBean(“person”,Person.class);</p><p>Person person3 = ctx.getBean(“person”,Person.class);</p></blockquote><hr><p><br><br></p><h4 id="6-种（单例）作用域"><a href="#6-种（单例）作用域" class="headerlink" title="6 种（单例）作用域"></a>6 种（单例）作用域</h4><hr><ul><li><p>singleton   scope 单例作用域</p></li><li><p>prototype  scope 原型作用域</p></li><li><p>websocket scope 基于连接 连接断开的时候对象就消失</p></li><li><p>request 基于请求的，请求打过来，对象就出来（只出来一次）</p></li><li><p>session 基于登录的，对象登陆了，就 new 一个对象（只有一个）</p></li><li><p>application 基于应用程序，应用程序启动，就 new 一个对象</p></li></ul><hr><p><br><br></p><h4 id="ApplicationContext-xml-文件中加入-作用域的方式"><a href="#ApplicationContext-xml-文件中加入-作用域的方式" class="headerlink" title="ApplicationContext.xml 文件中加入 作用域的方式"></a>ApplicationContext.xml 文件中加入 作用域的方式</h4><p><font color=GrayGreen size=2>做了以上更改之后，<code>new</code>出来的三个对象地址不一样了；</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>person<span class="token punctuation">"</span></span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prototype<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.…….Person<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>和树不困<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><hr><p><br><br></p><h4 id="Spring-对象生产的两种方式（只有两种）"><a href="#Spring-对象生产的两种方式（只有两种）" class="headerlink" title="Spring 对象生产的两种方式（只有两种）"></a>Spring 对象生产的两种方式（只有两种）</h4><hr><ul><li>单例：singleton （每次去的都是同一个），包括<ul><li>websocket </li><li>request </li><li>session </li><li>application </li><li>以上四种<font color=#f890>绑定了生命周期</font>，在一个生命周期内不会有两个不同的对象，getBean 的时候永远都是同一个对象；</li></ul></li><li>new 出来： （scope = “prototype”）</li></ul><hr><p><font color=LSDJR>当 scope = “prototype” 的时候，每次 getBean 都是新的 Bean，否则都是一个 Bean；</font></p><p><br><br></p><h3 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h3><p><font color=DarkGray size=2>创建一个工厂接口，需要什么直接传参生成；</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Car</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AoDi</span> <span class="token keyword">implements</span> <span class="token class-name">Car</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"奥迪A7"</span>；    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"100w"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaoMa</span> <span class="token keyword">implements</span> <span class="token class-name">Car</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"宝马R7"</span>；    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"120w"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 工厂方法</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CarFactory</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">Car</span> <span class="token function">getCar</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Aodi"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            retrun <span class="token keyword">new</span> <span class="token class-name">Aodi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">&#123;</span>            retrun <span class="token keyword">new</span> <span class="token class-name">BaoMa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"无法生产这辆车"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Car</span> car <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CarFac</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><hr><ul><li>在 ApplicationContext.xml 中定义这个工厂</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>carFactory<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.…….carFactory<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>car<span class="token punctuation">"</span></span> <span class="token attr-name">factory-bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>carFactory<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--需要 set 方法--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Aodi<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-JAVA" data-language="JAVA"><code class="language-JAVA">ClassPathXmlApplicationContext ctx &#x3D; new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);Car car &#x3D; ctx.getBean(&quot;car&quot;,Car.class);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><hr><p><br><br></p><h4 id="循环引用（强引用）"><a href="#循环引用（强引用）" class="headerlink" title="循环引用（强引用）"></a>循环引用（强引用）</h4><p><font color=DARKGRAY size=2>A引用B / B引用C / C引用A： JVM计数器，当检测到还在被引用的时候就不会销毁它，所以这三个永远都不会被销毁，容易造成<font color=#f123>内存溢出</font>；</font></p><hr><ul><li>在 Spring 中可以检测这种错误的做法，并作出提醒</li><li>单例模式是可以允许这样引用的，但是 new 或者 prototype  是不允许的</li><li>同时有 单例模式 &amp; prototype 模式是允许的， 并且<font color=7baf23 >单例对象的引用对象也变成了单例的。</font></li></ul><hr><p><br><br></p><h3 id="Spring-初始化-Bean-的四种方式（初始化顺序）"><a href="#Spring-初始化-Bean-的四种方式（初始化顺序）" class="headerlink" title="Spring 初始化 Bean 的四种方式（初始化顺序）"></a>Spring 初始化 Bean 的四种方式（初始化顺序）</h3><hr><ul><li>按照 Bean 标签的顺序</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">// ApplicationContext.cml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>a<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>………….A.class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p><font color=DarkGray size=2><code>&lt;bean&gt;</code>标签的位置越靠前，则初始化越早；</font></p><hr><ul><li>先加载 depends-on=” “ 依赖于:</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">// ApplicationContext.cml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>a<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>………….A.class<span class="token punctuation">"</span></span> <span class="token attr-name">depends-on</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>B<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p><font color=DarkGray size=2>A depends-on B，则在初始化 A 之前一定会初始化 B；</font></p><hr><ul><li>懒加载</li></ul><p><font color=DarkGray size=2><code>&lt;lazy-init=&quot;true&quot;&gt;</code>，用到哪个加载哪个，不用到不加载。</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>a<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…….class<span class="token punctuation">"</span></span> <span class="token attr-name">lazy-init</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><hr><ul><li>强 / 弱引用</li></ul><hr><blockquote><p>强引用：A完全持有一个类B，如果A不初始化，则这个类完全不能运行；<br>弱引用：A在一个方法里面用到了B的某一个属性值，不初始化B顶多A 的方法会报废；</p></blockquote><hr><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>a<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…….class<span class="token punctuation">"</span></span> <span class="token attr-name">lazy-init</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>b<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…….class<span class="token punctuation">"</span></span> <span class="token attr-name">lazy-init</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>null</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>null</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>b<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…….class<span class="token punctuation">"</span></span> <span class="token attr-name">lazy-init</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 运行结果(TtoStringBuilder)：</span>b<span class="token punctuation">.</span>getName <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// 空指针</span>a<span class="token punctuation">.</span>getName <span class="token operator">=</span>  <span class="token comment">// 空字符串</span>a<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// true</span>b<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 报错</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br></p><h4 id="自动装配"><a href="#自动装配" class="headerlink" title="自动装配"></a>自动装配</h4><p><font color=DarkGray size=2>byName 匹配 ID ，A 里面引用的是 b 所以 B 的 id=”b”可以，但是byType引用的是 C 这个类型；</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>A<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…….A<span class="token punctuation">"</span></span> <span class="token attr-name">autowire</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>byName<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>b<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…….B<span class="token punctuation">"</span></span> <span class="token attr-name">autowire</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>byType<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>C<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>…….C<span class="token punctuation">"</span></span> <span class="token attr-name">autowire</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>byName<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><ul><li>配置默认装配的类型</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">………………</span> <span class="token attr-name">default-autowire</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>byType<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span><span class="token punctuation">></span></span> …… <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><br><br><h4 id="学习要求"><a href="#学习要求" class="headerlink" title="学习要求"></a>学习要求</h4><hr><ul><li>掌握作用域</li><li>掌握单例</li><li>理解 MVC 与 SSM</li><li>掌握工厂方式</li></ul><hr><p><br><br><br><br></p><h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><hr><p><br><br><br></p><h4 id="Spring-的执行流程"><a href="#Spring-的执行流程" class="headerlink" title="Spring 的执行流程"></a>Spring 的执行流程</h4><hr><p><img src="https://img-blog.csdnimg.cn/20210113144940866.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hza18wMw==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><blockquote><p>我们从前端访问Controller层，又从Controller层访问数据库，就可以到达一个简单的 Spring 框架，但是这样执行的话 Controller 层既要接收前端数据 又要 处理数据 还要对接数据库，所以将“处理数据”这一部分单独划分出去，作为 Service 层，将 “ 对接数据库 ” 这一部分 分离出去，所谓,Mapper层，也就是常说的 Dao 层。</p></blockquote><p>由于前端给出的访问不可能一次只有一个，所以我们实例化的对象不能是单例的，否则ABCD同时登陆的话，登录的可能是同一个用户。<br><br><br>为了让代码看起来更简洁，所以可以在 Application.xml 中写入 Bean 对象，直接实例化便可以 创建 / 引用 一个对象；<br><br><br>由于我们在编程的时候广泛使用注解，所以我们将逐个注解细分,常用注解如下：</p><br><table><thead><tr><th>注解名称</th><th>用途</th><th>备注</th></tr></thead><tbody><tr><td>@Controller</td><td>Controller层</td><td>用于标注当前是Controller层</td></tr><tr><td>@Service</td><td>Service层</td><td>用于标注当前是Service层</td></tr><tr><td>@Mapper</td><td>Mapper层</td><td>用于标注当前是Mapper层</td></tr><tr><td>@autowire</td><td>任意层</td><td>用于自动装配，下方举例子</td></tr><tr><td>@value</td><td>测试时给初值</td><td></td></tr><tr><td>@Data</td><td>get / set  / toString 方法的汇总</td><td>在实体类的最上方写上这个方法则不用再写set / get 方法，当然你可以对方法进行重写</td></tr><tr><td>@Override</td><td>方法重写的时候标注在上面，可以自动检错；</td><td></td></tr></tbody></table><ul><li>autowire 说明</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//在Mapper层创建一个 SonService.java 的接口，用于连接数据库读取 Son 这个实体</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SonController</span><span class="token punctuation">&#123;</span> <span class="token comment">// Son 的 Controller 层</span><span class="token annotation punctuation">@autowire</span> <span class="token class-name">Sonservice</span> sonService <span class="token comment">// 这样就创建了一个 SonService 的接口</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>son<span class="token punctuation">></span></span> sonList <span class="token operator">=</span> sonService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//这样就能获取 son 数据库中所有的数据</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Springboot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【修理】电脑维修 显卡错误（错误代码：43）</title>
    <link href="/2021/01/05/%E3%80%90%E4%BF%AE%E7%90%86%E3%80%91%E7%94%B5%E8%84%91%E7%BB%B4%E4%BF%AE-%E6%98%BE%E5%8D%A1%E9%94%99%E8%AF%AF%EF%BC%88%E9%94%99%E8%AF%AF%E4%BB%A3%E7%A0%81%EF%BC%9A43%EF%BC%89/"/>
    <url>/2021/01/05/%E3%80%90%E4%BF%AE%E7%90%86%E3%80%91%E7%94%B5%E8%84%91%E7%BB%B4%E4%BF%AE-%E6%98%BE%E5%8D%A1%E9%94%99%E8%AF%AF%EF%BC%88%E9%94%99%E8%AF%AF%E4%BB%A3%E7%A0%81%EF%BC%9A43%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id="电脑维修-显卡错误（错误代码：43）"><a href="#电脑维修-显卡错误（错误代码：43）" class="headerlink" title="电脑维修 显卡错误（错误代码：43）"></a>电脑维修 显卡错误（错误代码：43）</h3><hr><p><br><br></p><h4 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h4><hr><p>今晚使用朋友的电脑的时候，重击了一下回车键，导致蓝屏，引起的原因在于：在之前拆机的时候，该朋友撕掉了键盘与主板之间的保护膜，导致键盘直接撞击主板原件，造成短路或主板原件松动。</p><ul><li>方案一：卸载驱动-重装驱动（<font color=red>失败</font>）</li><li>方案二：重装系统-从零开始（<font color=red>失败</font>）</li><li>方案三：拆机检查（<font color=7baf23 >成功</font>）</li></ul><br><br><h4 id="拆机描述"><a href="#拆机描述" class="headerlink" title="拆机描述"></a>拆机描述</h4><p><font color=Darkgray size=2>重装系统还没有解决问题的时候，我怀疑是静电或者击穿的问题，拆机之后发现键盘背面有个撞击出现的小凹槽；</font></p><hr><ul><li>拆后盖、固态、天线、主板……</li><li>检查主板，在与 <code>回车键</code> 接壤的地方，有个元件最上方的焊锡有轻微磨损，键盘背面有撞击形成的小凹槽；</li><li>释放静电（拔掉包括<code>bios</code>电子在内的所有的电源；）</li><li>由于常年没有拆机，散热板与主板粘合在一起，所以 GPU 上的散热管没能拆下来；</li><li>顺便清了个灰；</li><li>组装电脑，并且开始重装系统；</li><li>使用驱动精灵安装 N 卡 驱动；</li><li>安装成功；</li></ul><br><br><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><hr><ul><li>并没有完全的找出故障在哪儿，只能说是因为电脑的不正当使用导致的问题，在这里建议键盘轻轻敲击，且不要随便从电脑里拿掉一些 <font color=#f890>看似无用</font> 的东西；</li><li>电脑出现问题，有个口诀是：重装驱动解决 50% 的问题，重装系统解决 99% 的问题，换电脑解决 100 %的问题，但是重装系统与换电脑之间还有一个小屏障，就是给主板放电，解决 99.99% 的问题；</li><li>大部分问题，比如无故蓝屏、黑屏、死机、无法开机 等问题，都有可能是主板静电造成的，所以换电脑之前，一定要试一下给主板放电；<br><br><br></li></ul><h4 id="放张主板的图"><a href="#放张主板的图" class="headerlink" title="放张主板的图"></a>放张主板的图</h4><hr><br><p><img src="https://img2020.cnblogs.com/blog/2159067/202101/2159067-20210105120230675-2074013727.png"></p><p><img src="https://img2020.cnblogs.com/blog/2159067/202101/2159067-20210105120308191-1907092098.png"></p>]]></content>
    
    
    <categories>
      
      <category>修理</category>
      
    </categories>
    
    
    <tags>
      
      <tag>修理</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Linux】 编程环境搭建 JDK、Node.js、Npm、Yarn、Redis、Maven的安装与搭建</title>
    <link href="/2020/11/21/%E3%80%90Linux%E3%80%91-%E7%BC%96%E7%A8%8B%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-JDK%E3%80%81Node.js%E3%80%81Npm%E3%80%81Yarn%E3%80%81Redis%E3%80%81Maven%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E6%90%AD%E5%BB%BA/"/>
    <url>/2020/11/21/%E3%80%90Linux%E3%80%91-%E7%BC%96%E7%A8%8B%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-JDK%E3%80%81Node.js%E3%80%81Npm%E3%80%81Yarn%E3%80%81Redis%E3%80%81Maven%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h3 id="Linux-编程环境搭建-JDK、Node-js、Npm、Yarn、Redis、Maven的安装与搭建"><a href="#Linux-编程环境搭建-JDK、Node-js、Npm、Yarn、Redis、Maven的安装与搭建" class="headerlink" title="Linux 编程环境搭建 JDK、Node.js、Npm、Yarn、Redis、Maven的安装与搭建"></a>Linux 编程环境搭建 JDK、Node.js、Npm、Yarn、Redis、Maven的安装与搭建</h3><p><br><br></p><h3 id="JDK-的搭建："><a href="#JDK-的搭建：" class="headerlink" title="JDK 的搭建："></a>JDK 的搭建：</h3><hr><p><font color=DarkGray size=2><font color=red>注：</font>在进行所有的步骤之前，为了方便，请在终端输入<code>sudo su</code>进入管理员模式;</font>【注：右侧目录可以跳转查看文章】</p><hr><p><br><br></p><h4 id="下载资源："><a href="#下载资源：" class="headerlink" title="下载资源："></a>下载资源：</h4><hr><ul><li>点击进入<a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html"><font color=#00BFFF>Oracle官网</font></a>下载 JDK，版本要求如下如所示：</li></ul><p><img src="https://img-blog.csdnimg.cn/2020112109190774.png" alt="在这里插入图片描述"><br><br></p><br><h4 id="解压缩资源："><a href="#解压缩资源：" class="headerlink" title="解压缩资源："></a>解压缩资源：</h4><hr><ul><li>打开终端，使用 <code>cd Downloads</code>命令，进入<code>下载</code>文件夹，然后执行下面命令，对下载好的压缩文件夹进行解压缩，命令如下：</li></ul><blockquote><p>tar -zxvf jdk-<font color=7baf23>(按 <code>tab</code>键补全) </font> -C /usr/local/salt/</p></blockquote><p><font size=2 color=DarkGray>    补充：这一步也可以拆分成<code>tar -zxvf jdk</code>压缩包，然后再<code>mv</code> 解压缩文件夹 到<code>/usr/local/salt</code>文件夹 ；</font></p><ul><li>解释：这条命令的意思是将<code>jdk-8u271-linux-x64.tar.gz</code>这个压缩文件解压到 <code>/usr/local/salt</code> 目录下，但其实移动路径无所谓，最好是<code>/usr/local</code> ，这样可以与我的安装进度保持一致，<code>salt</code>（盐）是我自己创建的文件夹，里面存放着我编程需要的大部分东西，比如 redis、node.js等。 </li><li>进入解压缩文件夹的根目录下，我的是 <code>/usr/local/salt/</code>，使用命令：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">mv jdk<span class="token operator">-</span><span class="token number">8</span>u271<span class="token operator">-</span>linux<span class="token operator">-</span>x64 jdk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><font color=DarkGray size=2>这条命令简单理解成<code>重命名</code>，将冗长的文件夹重命名成<code>jdk</code>，方便以后使用，毕竟每次用到的时候都要输入大长串字符不太方便吧。</font><br><img src="https://img-blog.csdnimg.cn/20201121093445604.png#pic_center" alt="在这里插入图片描述"><br></p><h4 id="添加环境变量："><a href="#添加环境变量：" class="headerlink" title="添加环境变量："></a>添加环境变量：</h4><hr><ul><li>使用如下命令，进入<code>profile</code>文件，编辑环境变量，对 vim 编辑器不是很熟练的可以<a href="https://www.cnblogs.com/C-Noah/p/14223399.html">【点击此处】</a>进我博客查看：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>进入之后，轻点一下键盘上的 <code>i</code> 键，进入 &gt; 编辑模式 &lt; ;</li><li>将光标移动到文档的 <font color=#f890>最末尾</font>，直接输入 <font color=#f890>或</font> 复制粘贴以下内容（Linux下的粘贴快捷键是： <code>ctrl</code> + <code>shift</code> + <code>V</code> ）内容如下：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">#JAVA <span class="token number">1.8</span> <span class="token class-name">HOME</span>JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>salt<span class="token operator">/</span>jdkCLASSPATH<span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">:</span>$JAVA_HOME<span class="token operator">/</span>bin<span class="token punctuation">.</span>tools<span class="token punctuation">.</span>jarPATH<span class="token operator">=</span>$JAVA_HOME<span class="token operator">/</span>bin<span class="token operator">:</span>$PATHexport JAVA_HOME CLASSPATH PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=7baf23 size=2>其中，第一行是注解，第二行是刚刚在<code>usr/local/</code>下的压缩包的根目录，我这里多了一个<code>salt</code>文件夹，因为我把<code>jdk</code>文件夹放在了<code>salt</code>下，你的路径根据你自己的来。剩下三行不用变；</font></p><hr><ul><li>粘贴完成之后，点击<code>Esc</code>键，进入底行模式（如果你不知道并且想知道什么是“底行模式”的话，可以<a href="https://www.cnblogs.com/C-Noah/p/14223399.html">【点击此处】</a>进我博客查看）,输入<code>：wq</code>（保存并退出），点击回车；</li></ul><h4 id="检查"><a href="#检查" class="headerlink" title="检查"></a>检查</h4><hr><ul><li>在命令行输入 <code>java -version</code> 查看是否安装成功，如果出现了版本信息则成功，比如我的机子，版本信息如下：<br><img src="https://img-blog.csdnimg.cn/20201121094908963.png" alt="描述信息"><br>就安装成功了～<br></li><li><font color=#f123>如果没有</font>，那就执行以下命令：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">source <span class="token operator">/</span>etc<span class="token operator">/</span>profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>然后再执行<code>java -version</code>就会出现版本信息，如果还是没有的话，请检查你的环境变量路径是否正确，并在更改路径后将 &gt; 配置环境变量 &lt; 这一步及下面的所有步骤执行一遍；</li></ul><p><br><br></p><h3 id="Nodejs-npm-yarn-的安装-与-搭建："><a href="#Nodejs-npm-yarn-的安装-与-搭建：" class="headerlink" title="Nodejs / npm /yarn 的安装 与 搭建："></a>Nodejs / npm /yarn 的安装 与 搭建：</h3><hr><p><font color=DarkGray size=2><font color=red>注：</font>在进行所有的步骤之前，为了方便，请在终端输入<code>sudo su</code>进入管理员模式;</font></p><hr><p><br><br></p><h4 id="下载资源：-1"><a href="#下载资源：-1" class="headerlink" title="下载资源："></a>下载资源：</h4><ul><li>进入<a href="http://nodejs.cn/download/"><font color=#00BFFF>NodeJs官网</font></a>下载文件，版本要求如下图所示:<br><img src="https://img2020.cnblogs.com/blog/2159067/202101/2159067-20210105024729755-1017970495.png"></li></ul><br><h4 id="操作文件夹："><a href="#操作文件夹：" class="headerlink" title="操作文件夹："></a>操作文件夹：</h4><hr><ul><li>打开 终端 ，使用 <code>cd Downloads</code> 进入<code>下载</code>文件夹～</li></ul><br><ul><li>使用如下命令，将压缩文件解压缩至<code>/usr/local/salt</code>文件夹下：</li></ul><blockquote><p>tar xf node-v14.15.0-linux-x64.tar.xz -C /usr/local/salt/</p></blockquote><div class="code-wrapper"><pre><code>&lt;font color=DarkGray size=2&gt;&lt;font color=#f890 &gt;注：&lt;/font&gt;`salt`(盐)是我自己创建的用来存储编程环境的文件夹，如果你充分了解命令行以及文件夹结构，可以去掉salt文件夹，否则，建议跟随步骤执行；&lt;/font&gt;</code></pre></div><br><ul><li>在终端中使用<code>cd /usr/local/salt</code>进入<code>/usr/local/salt</code>文件夹下，然后运行如下命令：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">mv node<span class="token operator">-</span>v14<span class="token punctuation">.</span><span class="token number">15.0</span><span class="token operator">-</span>linux<span class="token operator">-</span>x64 nodejs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><font color=DarkGray size=2>    此命令可以简单理解成重命名，目的是将<font color=#f890 size=2>冗长</font>的文件夹名称<font color=#f890 size=2>重命名</font>成<code>nodejs</code></font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">ls <span class="token comment">//此命令可以查看当前文件夹下的所有的文件以及文件夹，可以检查一下是否出现了nodejs文件夹</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br><ul><li>执行<code>cd nodejs</code>命令进入nodejs文件夹下（接下来一步许多教程建议复制粘贴，但是这里建议直接使用软链接，比较方便，也不会破坏文件的结构）。</li></ul><br><ul><li>依次执行如下两条命令，创建软连接：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">ln <span class="token operator">-</span>s <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>salt<span class="token operator">/</span>nodejs<span class="token operator">/</span>bin<span class="token operator">/</span>node <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>binln <span class="token operator">-</span>s <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>salt<span class="token operator">/</span>nodejs<span class="token operator">/</span>bin<span class="token operator">/</span>npm <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p><font color=DarkGray size=2>软连接：功能类似于<code>Windows</code>的桌面快捷方式，将命令放在这个文件夹下，可以全局执行（即可以在任意位置使用node 以及 npm）</font><br><br></p><h4 id="检查-1"><a href="#检查-1" class="headerlink" title="检查"></a>检查</h4><hr><ul><li>连续执行两次<code>cd ..</code> 回退到<code>local</code>文件夹下，使用<code>cd bin</code>进入<code>local</code>下的<code>bin</code>目录，使用<code>ls</code>命令查看是否存在<code>npm</code> 与 <code>node</code>文件，如果提示如下，则成功：</li></ul><p><img src="https://img-blog.csdnimg.cn/20201121104734809.png" alt="在这里插入图片描述"><br><br></p><ul><li>在任意位置，执行 <code>node -v</code> 或 <code>npm -v</code>，如果出现版本信息，则安装成功，如下：</li></ul><p><img src="https://img-blog.csdnimg.cn/20201121104834339.png" alt="在这里插入图片描述"><br><br></p><h4 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h4><hr><ul><li><p>进如<code>salt</code>文件夹，执行<code>rm -rf nodejs</code>命令删除<code>nodejs</code> 文件夹（<code>-rf</code>  用来删除文件夹，不带 <code>-rf</code> 只能删除文件或压缩文件等）：</p></li><li><p>进入<code>/usr/local/bin</code>文件夹，使用如下命令删除<code>npm</code> 与 <code>node</code></p></li></ul><blockquote><p>rm node<br>rm npm</p></blockquote><ul><li>卸载完成</li></ul><br><br><h3 id="安装-cnpm"><a href="#安装-cnpm" class="headerlink" title="安装 cnpm"></a>安装 cnpm</h3><hr><ul><li>在安装完 Nodejs 后，执行命令（下载资源命令）：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">npm install <span class="token operator">-</span>g cnpm <span class="token operator">--</span>registry<span class="token operator">=</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>registry<span class="token punctuation">.</span>npm<span class="token punctuation">.</span>taobao<span class="token punctuation">.</span>org<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>当出现如下提示的时候，下载成功：</li></ul><p><img src="https://img-blog.csdnimg.cn/2020112120350955.png#pic_center" alt="在这里插入图片描述"><br>     <font color=#f123 size=2>如果没有上述提示，或提示<code>Error</code>，则使用<code>Ctrl</code> + <code>C</code>退出，然后多执行几次（原因：npm是从国外下资源，较慢，易出错；）。</font></p><ul><li>为 cnpm 创建软连接： </li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">ln <span class="token operator">-</span>s <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>salt<span class="token operator">/</span>nodejs<span class="token operator">/</span>bin<span class="token operator">/</span>cnpm <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><font color=Darkgray size=2>注意：较左侧的第一个地址中的<code>salt</code>（盐）文件夹，是我自行创建，用来存储变成环境的，你们可以自行取舍。</font></p><ul><li>在终端中（任意位置）输入命令：<code>cnpm -version</code>，若出现以下内容，则安装成功：</li></ul><p><img src="https://img-blog.csdnimg.cn/20201121204026530.png" alt="在这里插入图片描述"></p><ul><li><p>若是<code>bash：cnpm：command not found</code> 或 <code>bash：cnpm ：未找到命令</code>，则删除<code>/usr/local/bin</code>目录下的<code>cnpm</code>，重新创建一次链接，并检查软连接命令中是否少了<code>-s</code>。<br><img src="https://img-blog.csdnimg.cn/20201121204242450.png" alt="在这里插入图片描述"></p><p><font color=Darkgray size=2>上图就是安装错误的提示，因为我创建软连接的时候少了<code>-s</code>，执行删除命令<code>rm /usr/local/bin/cnpm</code>就可以了；</font></p></li></ul><p>补充 ： 一键安装 - git ：</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">sudo apt<span class="token operator">-</span>get install git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><br><br></p><h3 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h3><hr><p><font color=DarkGray size=2>安装前建议执行命令<code>sudo su</code>进入超级管理员模式；</p><hr><p><br><br></p><h4 id="下载资源"><a href="#下载资源" class="headerlink" title="下载资源"></a>下载资源</h4><hr><ul><li>点击<a href="https://redis.io/"><font color=#00BFFF>NodeJs官网</font></a>下载（版本如下图所示）: <img src="https://img-blog.csdnimg.cn/2020112114110396.png" alt="在这里插入图片描述"><br></li></ul><h4 id="操作文件夹"><a href="#操作文件夹" class="headerlink" title="操作文件夹"></a>操作文件夹</h4><hr><ul><li>使用命令<code>cd Downloads</code>进入Downloads文件夹，执行下列命令:</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">tar <span class="token operator">-</span>zxvf redis<span class="token operator">-</span><span class="token number">6.0</span><span class="token number">.9</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><font color = DarkGray size=2>以上命令是解压缩 [ - 压缩文件 - ]</font></p><ul><li>执行下列命令，移动解压后的文件夹:</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">mv redis<span class="token operator">-</span><span class="token number">6.0</span><span class="token number">.9</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>salt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><font color = DarkGray size=2>将压缩后的文件夹移动到<code>/usr/local/salt</code>下,其中<code>salt(盐)</code>文件是我自己创建的用来存储环境的；</font></p><ul><li>使用命令<code>cd /usr/local/salt</code>进入<code>salt</code>文件夹,使用命令:</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">mv redis<span class="token operator">-</span><span class="token number">6.0</span><span class="token number">.9</span> redis<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><font color = DarkGray size=2>简单理解来就是重命名,把<code>redis-6.0.9 </code> 重命名 成 <code>redis</code>；</font></p><ul><li>使用<code>cd redis</code>命令,进入<code>redis</code>文件夹,执行以下命令:</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">make <span class="token comment">// 编译</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>执行结束之后,<code>redis</code>目录下出现了<code>redis.conf</code>文件与<code>src</code>文件夹；执行<code>cd src</code> 进入<code>src</code>文件夹,然后执行如下命令:</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">make install<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>运行结束,安装完成(如下图所示):<br><img src="https://img-blog.csdnimg.cn/20201121143926753.png#pic_center" alt="哈哈哈"><br></li></ul><h4 id="启-动-Redis"><a href="#启-动-Redis" class="headerlink" title="启 动 Redis"></a>启 动 Redis</h4><hr><ul><li>在任意目录下执行：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">redis<span class="token operator">-</span>server <span class="token operator">&amp;</span> redis<span class="token operator">-</span>cli<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4><hr><ul><li>点击搜索<a href="https://www.baidu.com/"> - redis命令</a>大全 - <img src="file:///C:\Users\Hsk\AppData\Local\Temp\SGPicFaceTpBq\13092\0FB51D94.png" alt="img"></li></ul><p><br><br></p><h3 id="安装-Maven"><a href="#安装-Maven" class="headerlink" title="安装 Maven"></a>安装 Maven</h3><hr><p><font color=DarkGray size=2>安装前建议执行命令<code>sudo su</code>进入超级管理员模式；</font></p><hr><p><br><br></p><h4 id="下载资源-1"><a href="#下载资源-1" class="headerlink" title="下载资源"></a>下载资源</h4><hr><ul><li><a href="http://maven.apache.org/download.cgi">点击进入官网下载Maven</a>，版本如下图所示：</li></ul><p><img src="https://img-blog.csdnimg.cn/20201122223231667.png" alt="在这里插入图片描述"></p><ul><li>执行如下命令，解压缩文件夹至 <code>/usr/local/salt</code>文件夹：</li></ul><blockquote><p>tar -zxvf apache-maven-3.6.3-bin.tar.gz -C /usr/local/salt/</p></blockquote><p><font color=DarkGray size=2>其中<code>salt</code>文件夹是我自己创建用于存储<code>nodejs</code>、<code>mvn</code>等工具的文件夹，创建与否自行斟酌；</font><br><br></p><ul><li>执行<code>cd salt</code><font color=#f890 size=2>(如果你也有这个文件夹的话)</font>执行以下命令，将 冗长 的文件夹名称变成 简洁 的<code>mvn</code>：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">mv apache<span class="token operator">-</span>maven<span class="token operator">-</span><span class="token number">3.6</span><span class="token number">.3</span><span class="token operator">-</span>bin mvn````<span class="token operator">-</span> 在任意位置执行`vim <span class="token operator">/</span>etc<span class="token operator">/</span>profile`命令，进入`profile`文件中，在文件最末尾添加以下内容，为`mvn`增加环境变量：```java#MAVEN_HOME mvnMAVEN_HOME<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>salt<span class="token operator">/</span>mvnexport MAVEN_HOMEexport PATH<span class="token operator">=</span>$<span class="token punctuation">&#123;</span>PATH<span class="token punctuation">&#125;</span><span class="token operator">:</span>$<span class="token punctuation">&#123;</span>MAVEN_HOME<span class="token punctuation">&#125;</span><span class="token operator">/</span>bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=DarkGray size=2>其中第二行是你刚刚存储<code>mvn</code>文件夹的绝对路径，依情况自行更改。</font></p><ul><li>保存退出，输入以下命令，让系统读取一下<code>profile</code>文件：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">source <span class="token operator">/</span>etc<span class="token operator">/</span>profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br><h4 id="检查-2"><a href="#检查-2" class="headerlink" title="检查"></a>检查</h4><hr><ul><li>终端中（任意位置）输入<code>mvn -h</code>命令，如果显示结果如下，则安装成功：</li></ul><p><img src="https://img-blog.csdnimg.cn/20201122224556237.png" alt="Nodejs官网截图"><br><br></p>]]></content>
    
    
    <categories>
      
      <category>环境搭建</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>环境搭建</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【试】HashCat 参数</title>
    <link href="/2020/11/21/%E3%80%90%E8%AF%95%E3%80%91HashCat-%E5%8F%82%E6%95%B0/"/>
    <url>/2020/11/21/%E3%80%90%E8%AF%95%E3%80%91HashCat-%E5%8F%82%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<h3 id="HashCat-参数"><a href="#HashCat-参数" class="headerlink" title="HashCat 参数"></a>HashCat 参数</h3><hr><p>直接运行hashcat（分为32和64位版本）会提示使用参数：</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Usage</span><span class="token operator">:</span>hashcat64 <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> hash<span class="token operator">|</span>hashfile<span class="token operator">|</span>hccapxfile <span class="token punctuation">[</span>dictionary<span class="token operator">|</span>mask<span class="token operator">|</span>directory<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>也即hashcat [选项] 破解的哈希值或hash文件、hccapx文件 [字典|掩码|目录] …</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Hccapxfile</span>对应无线包，其对应破解哈希类型为“<span class="token operator">-</span>m <span class="token number">2500</span> <span class="token operator">=</span> WPA<span class="token operator">/</span>WPA2”。<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br><br><h4 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h4><ul><li>普通</li></ul><div class="code-wrapper"><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">-m, —hash-type=NUM           哈希类别，其NUM值参考其帮助信息下面的哈希类别值，其值为数字。如果不指定m值则默认指md5，例如-m 1800是sha512 Linux加密。-a, --attack-mode=NUM         攻击模式，其值参考后面对参数。“-a 0”字典攻击，“-a 1” 组合攻击；“-a 3”掩码攻击。 -V, —version                 版本信息     -h, --help                   帮助信息。    --quiet                       安静的模式, 抑制输出<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>基准测试</li></ul> <div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">-</span>b<span class="token punctuation">,</span> <span class="token operator">--</span>benchmark                       测试计算机破解速度和显示硬件相关信息<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>杂项</li></ul> <div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">--</span>hex<span class="token operator">-</span>salt                     salt值是用十六进制给出的<span class="token operator">--</span>hex<span class="token operator">-</span>charset                  设定字符集是十六进制给出<span class="token operator">--</span>runtime<span class="token operator">=</span>NUM                  运行数秒（NUM值）后的中止会话<span class="token operator">--</span>status                       启用状态屏幕的自动更新<span class="token operator">--</span>status<span class="token operator">-</span>timer<span class="token operator">=</span>NUM             状态屏幕更新秒值<span class="token operator">--</span>status<span class="token operator">-</span>automat               以机器可读的格式显示状态视图<span class="token operator">--</span>session                      后跟会话名称，主要用于中止任务后的恢复破解。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>文件</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">-</span>o<span class="token punctuation">,</span>  <span class="token operator">--</span>outfile<span class="token operator">=</span>FILE             定义哈希文件恢复输出文件<span class="token operator">--</span>outfile<span class="token operator">-</span>format<span class="token operator">=</span>NUM            定义哈希文件输出格式，见下面的参考资料<span class="token operator">--</span>outfile<span class="token operator">-</span>autohex<span class="token operator">-</span>disable       禁止使用十六进制输出明文<span class="token operator">-</span>p<span class="token punctuation">,</span>  <span class="token operator">--</span>separator<span class="token operator">=</span>CHAR           为哈希列表<span class="token operator">/</span>输出文件定义分隔符字符<span class="token operator">--</span>show                          仅仅显示已经破解的密码<span class="token operator">--</span>left                          仅仅显示未破解的密码<span class="token operator">--</span>username                      忽略hash表中的用户名，对linux文件直接进行破解，不需要进行整理。<span class="token operator">--</span>remove                        移除破解成功的hash，当hash是从文本中读取时有用，避免自己手工移除已经破解的hash<span class="token operator">--</span>stdout                        控制台模式<span class="token operator">--</span>potfile<span class="token operator">-</span>disable               不写入pot文件<span class="token operator">--</span>debug<span class="token operator">-</span>mode<span class="token operator">=</span>NUM                定义调试模式（仅通过使用规则进行混合），参见下面的参考资料<span class="token operator">--</span>debug<span class="token operator">-</span>file<span class="token operator">=</span>FILE               调试规则的输出文件（请参阅调试模式）<span class="token operator">-</span>e<span class="token punctuation">,</span> <span class="token operator">--</span>salt<span class="token operator">-</span>file<span class="token operator">=</span>FILE            定义加盐文件列表<span class="token operator">--</span>logfile<span class="token operator">-</span>disable               禁止logfile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>资源</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">-</span>c<span class="token punctuation">,</span> <span class="token operator">--</span>segment<span class="token operator">-</span>size<span class="token operator">=</span>NUM       字典文件缓存大小（<span class="token class-name">M</span>）<span class="token operator">-</span>n<span class="token punctuation">,</span> <span class="token operator">--</span>threads<span class="token operator">=</span>NUM            线程数<span class="token operator">-</span>s<span class="token punctuation">,</span>  <span class="token operator">--</span>words<span class="token operator">-</span>skip<span class="token operator">=</span>NUM        跳过单词数<span class="token operator">-</span>l<span class="token punctuation">,</span> <span class="token operator">--</span>words<span class="token operator">-</span>limit<span class="token operator">=</span>NUM        限制单词数<span class="token punctuation">(</span>分布式<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>规则</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">  <span class="token operator">-</span>r<span class="token punctuation">,</span> <span class="token operator">--</span>rules<span class="token operator">-</span>file<span class="token operator">=</span>FILE             使用规则文件<span class="token operator">:</span> <span class="token operator">-</span>r <span class="token number">1.</span>rule， <span class="token operator">-</span>g<span class="token punctuation">,</span>  <span class="token operator">--</span>generate<span class="token operator">-</span>rules<span class="token operator">=</span>NUM          随机生成规则<span class="token operator">--</span>generate<span class="token operator">-</span>rules<span class="token operator">-</span>func<span class="token operator">-</span>min<span class="token operator">=</span>          每个随机规则最小值<span class="token operator">--</span>generate<span class="token operator">-</span>rules<span class="token operator">-</span>func<span class="token operator">-</span>max<span class="token operator">=</span>          每个随机规则最大值<span class="token operator">--</span>generate<span class="token operator">-</span>rules<span class="token operator">-</span>seed<span class="token operator">=</span>NUM           强制RNG种子数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>自定义字符集</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token operator">--</span>custom<span class="token operator">-</span>charset1<span class="token operator">=</span>CS  用户定义的字符集<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">--</span>custom<span class="token operator">-</span>charset2<span class="token operator">=</span>CS  例如<span class="token operator">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">--</span>custom<span class="token operator">-</span>charset3<span class="token operator">=</span>CS <span class="token operator">--</span>custom<span class="token operator">-</span>charset1<span class="token operator">=</span><span class="token operator">?</span>dabcdef <span class="token operator">:</span> 设置<span class="token operator">?</span><span class="token number">1</span> 为<span class="token number">0123456789</span>abcdef<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">--</span>custom<span class="token operator">-</span>charset4<span class="token operator">=</span>CS   <span class="token operator">-</span><span class="token number">2</span>mycharset<span class="token punctuation">.</span>hcchr <span class="token operator">:</span> 设置 <span class="token operator">?</span><span class="token number">2</span> 包含在mycharset<span class="token punctuation">.</span>hcchr<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><br><h4 id="攻击模式"><a href="#攻击模式" class="headerlink" title="攻击模式"></a>攻击模式</h4><hr><p>大小写转换攻击:</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">--</span>toggle<span class="token operator">-</span>min<span class="token operator">=</span>NUM              在字典中字母的最小值<span class="token operator">--</span>toggle<span class="token operator">-</span>max<span class="token operator">=</span>NUM              在字典中字母的最大值   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>使用掩码攻击模式:</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">--</span>increment                   使用增强模式<span class="token operator">--</span>increment<span class="token operator">-</span>min<span class="token operator">=</span>NUM           增强模式开始值<span class="token operator">--</span>increment<span class="token operator">-</span>max<span class="token operator">=</span>NUM           增强模式结束值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>排列攻击模式</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">--</span>perm<span class="token operator">-</span>min<span class="token operator">=</span>NUM                过滤比NUM数小的单词<span class="token operator">--</span>perm<span class="token operator">-</span>max<span class="token operator">=</span>NUM                过滤比NUM数大的单词<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><ul><li>查找表攻击模式:</li></ul><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">-t, --table-file&#x3D;FILE        表文件--table-min&#x3D;NUM               在字典中的最小字符值--table-max&#x3D;NUM               在字典中的最大字符值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>打印攻击模式:</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">--</span>pw<span class="token operator">-</span>min<span class="token operator">=</span>NUM                  如果长度大于NUM，则打印候选字符 <span class="token operator">--</span>pw<span class="token operator">-</span>max<span class="token operator">=</span>NUM                  如果长度小于NUM，则打印候选字符<span class="token operator">--</span>elem<span class="token operator">-</span>cnt<span class="token operator">-</span>min<span class="token operator">=</span>NUM            每个链的最小元素数<span class="token operator">--</span>elem<span class="token operator">-</span>cnt<span class="token operator">-</span>max<span class="token operator">=</span>NUM            每个链的最大元素数<span class="token operator">--</span>wl<span class="token operator">-</span>dist<span class="token operator">-</span>len                 从字典表中计算输出长度分布<span class="token operator">--</span>wl<span class="token operator">-</span>max<span class="token operator">=</span>NUM                  从字典文件中加载NUM个单词，设置<span class="token number">0</span>禁止加载。<span class="token operator">--</span><span class="token keyword">case</span><span class="token operator">-</span>permute                在字典中对每一个单词进行反转<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><br><h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><hr><ul><li>输出文件格式:</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token number">1</span> <span class="token operator">=</span> hash<span class="token punctuation">[</span><span class="token operator">:</span>salt<span class="token punctuation">]</span><span class="token number">2</span> <span class="token operator">=</span> plain 明文<span class="token number">3</span> <span class="token operator">=</span> hash<span class="token punctuation">[</span><span class="token operator">:</span>salt<span class="token punctuation">]</span><span class="token operator">:</span>plain<span class="token number">4</span> <span class="token operator">=</span> hex_plain<span class="token number">5</span> <span class="token operator">=</span> hash<span class="token punctuation">[</span><span class="token operator">:</span>salt<span class="token punctuation">]</span><span class="token operator">:</span>hex_plain<span class="token number">6</span> <span class="token operator">=</span> plain<span class="token operator">:</span>hex_plain<span class="token number">7</span> <span class="token operator">=</span> hash<span class="token punctuation">[</span><span class="token operator">:</span>salt<span class="token punctuation">]</span><span class="token operator">:</span>plain<span class="token operator">:</span>hex_plain<span class="token number">8</span> <span class="token operator">=</span> crackpos<span class="token number">9</span> <span class="token operator">=</span> hash<span class="token punctuation">[</span><span class="token operator">:</span>salt<span class="token punctuation">]</span><span class="token operator">:</span>crackpos<span class="token number">10</span> <span class="token operator">=</span> plain<span class="token operator">:</span>crackpos<span class="token number">11</span> <span class="token operator">=</span> hash<span class="token punctuation">[</span><span class="token operator">:</span>salt<span class="token punctuation">]</span><span class="token operator">:</span>plain<span class="token operator">:</span>crackpos<span class="token number">12</span> <span class="token operator">=</span> hex_plain<span class="token operator">:</span>crackpos<span class="token number">13</span> <span class="token operator">=</span> hash<span class="token punctuation">[</span><span class="token operator">:</span>salt<span class="token punctuation">]</span><span class="token operator">:</span>hex_plain<span class="token operator">:</span>crackpos<span class="token number">14</span> <span class="token operator">=</span> plain<span class="token operator">:</span>hex_plain<span class="token operator">:</span>crackpos<span class="token number">15</span> <span class="token operator">=</span> hash<span class="token punctuation">[</span><span class="token operator">:</span>salt<span class="token punctuation">]</span><span class="token operator">:</span>plain<span class="token operator">:</span>hex_plain<span class="token operator">:</span>crackpos<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>调试模式输出文件 (for hybrid mode only, by using rules):</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token number">1</span> <span class="token operator">=</span> save finding rule  <span class="token number">2</span> <span class="token operator">=</span> save original word<span class="token number">3</span> <span class="token operator">=</span> save original word and finding rule<span class="token number">4</span> <span class="token operator">=</span> save original word<span class="token punctuation">,</span> finding rule andmodified plain<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>内置的字符集:</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">?</span>l <span class="token operator">=</span> abcdefghijklmnopqrstuvwxyz 代表小写字母<span class="token operator">?</span>u <span class="token operator">=</span> ABCDEFGHIJKLMNOPQRSTUVWXYZ 代表大写字母<span class="token operator">?</span>d <span class="token operator">=</span> <span class="token number">0123456789</span> 代表数字<span class="token operator">?</span>s <span class="token operator">=</span> <span class="token operator">!</span>"#$<span class="token operator">%</span><span class="token operator">&amp;</span>'<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">+</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">.</span>/<span class="token operator">:</span><span class="token punctuation">;</span><span class="token operator">&lt;=</span><span class="token operator">></span><span class="token operator">?</span>@<span class="token punctuation">[</span>\<span class="token punctuation">]</span><span class="token operator">^</span>_`<span class="token punctuation">&#123;</span><span class="token operator">|</span><span class="token punctuation">&#125;</span><span class="token operator">~</span>  代表特殊字符<span class="token operator">?</span>a <span class="token operator">=</span> <span class="token operator">?</span>l<span class="token operator">?</span>u<span class="token operator">?</span>d<span class="token operator">?</span>s 大小写数字及特殊字符的组合<span class="token operator">?</span>b <span class="token operator">=</span> <span class="token number">0x00</span> <span class="token operator">-</span> <span class="token number">0xff</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>攻击模式</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token number">0</span> <span class="token operator">=</span> <span class="token class-name">Straight</span> （字典破解）<span class="token number">1</span> <span class="token operator">=</span> <span class="token class-name">Combination</span> （组合破解）<span class="token number">2</span> <span class="token operator">=</span> <span class="token class-name">Toggle</span><span class="token operator">-</span><span class="token class-name">Case</span> （大小写转换）<span class="token number">3</span> <span class="token operator">=</span> <span class="token class-name">Brute</span><span class="token operator">-</span>force（掩码暴力破解）<span class="token number">4</span> <span class="token operator">=</span> <span class="token class-name">Permutation</span>（序列破解）<span class="token number">5</span> <span class="token operator">=</span> <span class="token class-name">Table</span><span class="token operator">-</span><span class="token class-name">Lookup</span>（查表破解）<span class="token number">6</span> <span class="token operator">=</span> <span class="token class-name">Hybrid</span> dict <span class="token operator">+</span> mask 字典加掩码破解<span class="token number">7</span> <span class="token operator">=</span> <span class="token class-name">Hybrid</span> mask <span class="token operator">+</span> dict 掩码<span class="token operator">+</span>字典破解<span class="token number">8</span> <span class="token operator">=</span> <span class="token class-name">Prince</span>（王子破解）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>哈希类型</li></ul><p>有关哈希具体值示例可以参考 <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">  <span class="token number">0</span> <span class="token operator">=</span> <span class="token class-name">MD5</span>  <span class="token number">10</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>$pass<span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">20</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span>$pass<span class="token punctuation">)</span>  <span class="token number">30</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">unicode</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">40</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span><span class="token function">unicode</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">50</span> <span class="token operator">=</span> HMAC<span class="token operator">-</span>MD5 <span class="token punctuation">(</span>key <span class="token operator">=</span> $pass<span class="token punctuation">)</span>  <span class="token number">60</span> <span class="token operator">=</span> HMAC<span class="token operator">-</span>MD5 <span class="token punctuation">(</span>key <span class="token operator">=</span> $salt<span class="token punctuation">)</span>  <span class="token number">100</span> <span class="token operator">=</span> <span class="token class-name">SHA1</span>  <span class="token number">110</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span>$pass<span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">120</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span>$pass<span class="token punctuation">)</span>  <span class="token number">130</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">unicode</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">140</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span><span class="token function">unicode</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">150</span> <span class="token operator">=</span> HMAC<span class="token operator">-</span>SHA1 <span class="token punctuation">(</span>key <span class="token operator">=</span> $pass<span class="token punctuation">)</span>  <span class="token number">160</span> <span class="token operator">=</span> HMAC<span class="token operator">-</span>SHA1 <span class="token punctuation">(</span>key <span class="token operator">=</span> $salt<span class="token punctuation">)</span>  <span class="token number">200</span> <span class="token operator">=</span> <span class="token class-name">MySQL323</span>  <span class="token number">300</span> <span class="token operator">=</span> <span class="token class-name">MySQL4</span><span class="token number">.1</span><span class="token operator">/</span><span class="token class-name">MySQL5</span>  <span class="token number">400</span> <span class="token operator">=</span> phpass<span class="token punctuation">,</span> <span class="token function">MD5</span><span class="token punctuation">(</span><span class="token class-name">Wordpress</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">MD5</span><span class="token punctuation">(</span>phpBB3<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MD5</span><span class="token punctuation">(</span><span class="token class-name">Joomla</span><span class="token punctuation">)</span>  <span class="token number">500</span> <span class="token operator">=</span> md5crypt<span class="token punctuation">,</span> <span class="token function">MD5</span><span class="token punctuation">(</span><span class="token class-name">Unix</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">FreeBSD</span> MD5<span class="token punctuation">,</span><span class="token class-name">Cisco</span><span class="token operator">-</span>IOS <span class="token class-name">MD5</span>  <span class="token number">900</span> <span class="token operator">=</span> <span class="token class-name">MD4</span>  <span class="token number">1000</span> <span class="token operator">=</span> <span class="token class-name">NTLM</span>  <span class="token number">1100</span> <span class="token operator">=</span> <span class="token class-name">Domain</span> <span class="token class-name">Cached</span> <span class="token class-name">Credentials</span> <span class="token punctuation">(</span>DCC<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">MSCache</span>  <span class="token number">1400</span> <span class="token operator">=</span> <span class="token class-name">SHA256</span>  <span class="token number">1410</span> <span class="token operator">=</span> <span class="token function">sha256</span><span class="token punctuation">(</span>$pass<span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">1420</span> <span class="token operator">=</span> <span class="token function">sha256</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span>$pass<span class="token punctuation">)</span>  <span class="token number">1430</span> <span class="token operator">=</span> <span class="token function">sha256</span><span class="token punctuation">(</span><span class="token function">unicode</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">1431</span> <span class="token operator">=</span> <span class="token function">base64</span><span class="token punctuation">(</span><span class="token function">sha256</span><span class="token punctuation">(</span><span class="token function">unicode</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">1440</span> <span class="token operator">=</span> <span class="token function">sha256</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span><span class="token function">unicode</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">1450</span> <span class="token operator">=</span> HMAC<span class="token operator">-</span>SHA256 <span class="token punctuation">(</span>key <span class="token operator">=</span> $pass<span class="token punctuation">)</span>  <span class="token number">1460</span> <span class="token operator">=</span> HMAC<span class="token operator">-</span>SHA256 <span class="token punctuation">(</span>key <span class="token operator">=</span> $salt<span class="token punctuation">)</span>  <span class="token number">1600</span> <span class="token operator">=</span> md5apr1<span class="token punctuation">,</span> <span class="token function">MD5</span><span class="token punctuation">(</span>APR<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Apache</span> <span class="token class-name">MD5</span>  <span class="token number">1700</span> <span class="token operator">=</span> <span class="token class-name">SHA512</span>  <span class="token number">1710</span> <span class="token operator">=</span> <span class="token function">sha512</span><span class="token punctuation">(</span>$pass<span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">1720</span> <span class="token operator">=</span> <span class="token function">sha512</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span>$pass<span class="token punctuation">)</span>  <span class="token number">1730</span> <span class="token operator">=</span> <span class="token function">sha512</span><span class="token punctuation">(</span><span class="token function">unicode</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">1740</span> <span class="token operator">=</span> <span class="token function">sha512</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span><span class="token function">unicode</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">1750</span> <span class="token operator">=</span> HMAC<span class="token operator">-</span>SHA512 <span class="token punctuation">(</span>key <span class="token operator">=</span> $pass<span class="token punctuation">)</span>  <span class="token number">1760</span> <span class="token operator">=</span> HMAC<span class="token operator">-</span>SHA512 <span class="token punctuation">(</span>key <span class="token operator">=</span> $salt<span class="token punctuation">)</span>  <span class="token number">1800</span> <span class="token operator">=</span> SHA<span class="token operator">-</span><span class="token function">512</span><span class="token punctuation">(</span><span class="token class-name">Unix</span><span class="token punctuation">)</span>  <span class="token number">2400</span> <span class="token operator">=</span> <span class="token class-name">Cisco</span><span class="token operator">-</span>PIX <span class="token class-name">MD5</span>  <span class="token number">2410</span> <span class="token operator">=</span> <span class="token class-name">Cisco</span><span class="token operator">-</span>ASA <span class="token class-name">MD5</span>  <span class="token number">2500</span> <span class="token operator">=</span> WPA<span class="token operator">/</span><span class="token class-name">WPA2</span>  <span class="token number">2600</span> <span class="token operator">=</span> <span class="token class-name">Double</span> <span class="token class-name">MD5</span>  <span class="token number">3200</span> <span class="token operator">=</span> bcrypt<span class="token punctuation">,</span> <span class="token class-name">Blowfish</span><span class="token punctuation">(</span><span class="token class-name">OpenBSD</span><span class="token punctuation">)</span>  <span class="token number">3300</span> <span class="token operator">=</span> <span class="token function">MD5</span><span class="token punctuation">(</span><span class="token class-name">Sun</span><span class="token punctuation">)</span>  <span class="token number">3500</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">3610</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">)</span><span class="token punctuation">.</span>$pass<span class="token punctuation">)</span>  <span class="token number">3710</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">3720</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>$pass<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">3800</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span>$pass<span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">3910</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">4010</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">4110</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>$pass<span class="token punctuation">.</span>$salt<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">4210</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>$username<span class="token punctuation">.</span><span class="token number">0.</span>$pass<span class="token punctuation">)</span>  <span class="token number">4300</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">strtoupper</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">4400</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">4500</span> <span class="token operator">=</span> <span class="token class-name">Double</span> <span class="token class-name">SHA1</span>  <span class="token number">4600</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">4700</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span>$pass<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token number">4800</span> <span class="token operator">=</span> <span class="token function">MD5</span><span class="token punctuation">(</span><span class="token class-name">Chap</span><span class="token punctuation">)</span><span class="token punctuation">,</span> iSCSI CHAP authentication  <span class="token number">4900</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span>$salt<span class="token punctuation">.</span>$pass<span class="token punctuation">.</span>$salt<span class="token punctuation">)</span>  <span class="token number">5000</span> <span class="token operator">=</span> SHA<span class="token operator">-</span><span class="token function">3</span><span class="token punctuation">(</span><span class="token class-name">Keccak</span><span class="token punctuation">)</span>  <span class="token number">5100</span> <span class="token operator">=</span> <span class="token class-name">Half</span> <span class="token class-name">MD5</span>  <span class="token number">5200</span> <span class="token operator">=</span> <span class="token class-name">Password</span> <span class="token class-name">Safe</span> SHA<span class="token operator">-</span><span class="token number">256</span>  <span class="token number">5300</span> <span class="token operator">=</span> IKE<span class="token operator">-</span>PSK <span class="token class-name">MD5</span>  <span class="token number">5400</span> <span class="token operator">=</span> IKE<span class="token operator">-</span>PSK <span class="token class-name">SHA1</span>  <span class="token number">5500</span> <span class="token operator">=</span> <span class="token class-name">NetNTLMv1</span><span class="token operator">-</span>VANILLA <span class="token operator">/</span> <span class="token class-name">NetNTLMv1</span><span class="token operator">-</span><span class="token class-name">ESS</span>  <span class="token number">5600</span> <span class="token operator">=</span> <span class="token class-name">NetNTLMv2</span>  <span class="token number">5700</span> <span class="token operator">=</span> <span class="token class-name">Cisco</span><span class="token operator">-</span>IOS <span class="token class-name">SHA256</span>  <span class="token number">5800</span> <span class="token operator">=</span> <span class="token class-name">Android</span> <span class="token class-name">PIN</span>  <span class="token number">6300</span> <span class="token operator">=</span> AIX <span class="token punctuation">&#123;</span>smd5<span class="token punctuation">&#125;</span>  <span class="token number">6400</span> <span class="token operator">=</span> AIX <span class="token punctuation">&#123;</span>ssha256<span class="token punctuation">&#125;</span>  <span class="token number">6500</span> <span class="token operator">=</span> AIX <span class="token punctuation">&#123;</span>ssha512<span class="token punctuation">&#125;</span>  <span class="token number">6700</span> <span class="token operator">=</span> AIX <span class="token punctuation">&#123;</span>ssha1<span class="token punctuation">&#125;</span>  <span class="token number">6900</span> <span class="token operator">=</span> GOST<span class="token punctuation">,</span> GOST <span class="token class-name">R</span> <span class="token number">34.11</span><span class="token operator">-</span><span class="token number">94</span>  <span class="token number">7000</span> <span class="token operator">=</span> <span class="token class-name">Fortigate</span> <span class="token punctuation">(</span><span class="token class-name">FortiOS</span><span class="token punctuation">)</span>  <span class="token number">7100</span> <span class="token operator">=</span> OS <span class="token class-name">X</span> v10<span class="token punctuation">.</span><span class="token number">8</span><span class="token operator">+</span>  <span class="token number">7200</span> <span class="token operator">=</span> GRUB <span class="token number">2</span>  <span class="token number">7300</span> <span class="token operator">=</span> IPMI2 RAKP HMAC<span class="token operator">-</span><span class="token class-name">SHA1</span>  <span class="token number">7400</span> <span class="token operator">=</span> sha256crypt<span class="token punctuation">,</span> <span class="token function">SHA256</span><span class="token punctuation">(</span><span class="token class-name">Unix</span><span class="token punctuation">)</span>  <span class="token number">7900</span> <span class="token operator">=</span> <span class="token class-name">Drupal7</span>  <span class="token number">8400</span> <span class="token operator">=</span> WBB3<span class="token punctuation">,</span> <span class="token class-name">Woltlab</span> <span class="token class-name">Burning</span> <span class="token class-name">Board</span> <span class="token number">3</span>  <span class="token number">8900</span> <span class="token operator">=</span> scrypt  <span class="token number">9200</span> <span class="token operator">=</span> <span class="token class-name">Cisco</span> $<span class="token number">8</span>$  <span class="token number">9300</span> <span class="token operator">=</span> <span class="token class-name">Cisco</span> $<span class="token number">9</span>$  <span class="token number">9800</span> <span class="token operator">=</span> <span class="token class-name">Radmin2</span> <span class="token number">10000</span> <span class="token operator">=</span> <span class="token class-name">Django</span> <span class="token punctuation">(</span>PBKDF2<span class="token operator">-</span>SHA256<span class="token punctuation">)</span> <span class="token number">10200</span> <span class="token operator">=</span> <span class="token class-name">Cram</span> <span class="token class-name">MD5</span> <span class="token number">10300</span> <span class="token operator">=</span> SAP CODVN <span class="token class-name">H</span> <span class="token punctuation">(</span>PWDSALTEDHASH<span class="token punctuation">)</span> iSSHA<span class="token operator">-</span><span class="token number">1</span> <span class="token number">11000</span> <span class="token operator">=</span> <span class="token class-name">PrestaShop</span> <span class="token number">11100</span> <span class="token operator">=</span> <span class="token class-name">PostgreSQL</span> <span class="token class-name">Challenge</span><span class="token operator">-</span><span class="token class-name">ResponseAuthentication</span> <span class="token punctuation">(</span>MD5<span class="token punctuation">)</span> <span class="token number">11200</span> <span class="token operator">=</span> <span class="token class-name">MySQL</span> <span class="token class-name">Challenge</span><span class="token operator">-</span><span class="token class-name">Response</span> <span class="token class-name">Authentication</span><span class="token punctuation">(</span>SHA1<span class="token punctuation">)</span> <span class="token number">11400</span> <span class="token operator">=</span> SIP digest authentication <span class="token punctuation">(</span>MD5<span class="token punctuation">)</span> <span class="token number">99999</span> <span class="token operator">=</span> <span class="token class-name">Plaintext</span>特殊哈希类型   <span class="token number">11</span> <span class="token operator">=</span> <span class="token class-name">Joomla</span> <span class="token operator">&lt;</span> <span class="token number">2.5</span><span class="token number">.18</span>   <span class="token number">12</span> <span class="token operator">=</span> <span class="token class-name">PostgreSQL</span>   <span class="token number">21</span> <span class="token operator">=</span> osCommerce<span class="token punctuation">,</span> xt<span class="token operator">:</span><span class="token class-name">Commerce</span>   <span class="token number">23</span> <span class="token operator">=</span> <span class="token class-name">Skype</span>  <span class="token number">101</span> <span class="token operator">=</span> nsldap<span class="token punctuation">,</span> SHA<span class="token operator">-</span><span class="token function">1</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Netscape</span> <span class="token class-name">LDAPSHA</span>  <span class="token number">111</span> <span class="token operator">=</span> nsldaps<span class="token punctuation">,</span> SSHA<span class="token operator">-</span><span class="token function">1</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Netscape</span> <span class="token class-name">LDAPSSHA</span>  <span class="token number">112</span> <span class="token operator">=</span> <span class="token class-name">Oracle</span> <span class="token class-name">S</span><span class="token operator">:</span> <span class="token class-name">Type</span> <span class="token punctuation">(</span><span class="token class-name">Oracle</span> <span class="token number">11</span><span class="token operator">+</span><span class="token punctuation">)</span>  <span class="token number">121</span> <span class="token operator">=</span> SMF <span class="token operator">></span> v1<span class="token punctuation">.</span><span class="token number">1</span>  <span class="token number">122</span> <span class="token operator">=</span> OS <span class="token class-name">X</span> v10<span class="token punctuation">.</span><span class="token number">4</span><span class="token punctuation">,</span> v10<span class="token punctuation">.</span><span class="token number">5</span><span class="token punctuation">,</span> v10<span class="token punctuation">.</span><span class="token number">6</span>  <span class="token number">123</span> <span class="token operator">=</span> <span class="token class-name">EPi</span>  <span class="token number">124</span> <span class="token operator">=</span> <span class="token class-name">Django</span> <span class="token punctuation">(</span>SHA<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token number">131</span> <span class="token operator">=</span> <span class="token function">MSSQL</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span>  <span class="token number">132</span> <span class="token operator">=</span> <span class="token function">MSSQL</span><span class="token punctuation">(</span><span class="token number">2005</span><span class="token punctuation">)</span>  <span class="token number">133</span> <span class="token operator">=</span> <span class="token class-name">PeopleSoft</span>  <span class="token number">141</span> <span class="token operator">=</span> <span class="token class-name">EPiServer</span> <span class="token number">6.</span>x <span class="token operator">&lt;</span> v4 <span class="token number">1421</span> <span class="token operator">=</span> hMailServer <span class="token number">1441</span> <span class="token operator">=</span> <span class="token class-name">EPiServer</span> <span class="token number">6.</span>x <span class="token operator">></span> v4 <span class="token number">1711</span> <span class="token operator">=</span> SSHA<span class="token operator">-</span><span class="token function">512</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> LDAP <span class="token punctuation">&#123;</span>SSHA512<span class="token punctuation">&#125;</span> <span class="token number">1722</span> <span class="token operator">=</span> OS <span class="token class-name">X</span> v10<span class="token punctuation">.</span><span class="token number">7</span> <span class="token number">1731</span> <span class="token operator">=</span> <span class="token function">MSSQL</span><span class="token punctuation">(</span><span class="token number">2012</span> <span class="token operator">&amp;</span> <span class="token number">2014</span><span class="token punctuation">)</span> <span class="token number">2611</span> <span class="token operator">=</span> vBulletin <span class="token operator">&lt;</span> v3<span class="token punctuation">.</span><span class="token number">8.5</span> <span class="token number">2612</span> <span class="token operator">=</span> <span class="token class-name">PHPS</span> <span class="token number">2711</span> <span class="token operator">=</span> vBulletin <span class="token operator">></span> v3<span class="token punctuation">.</span><span class="token number">8.5</span> <span class="token number">2811</span> <span class="token operator">=</span> IPB2<span class="token operator">+</span><span class="token punctuation">,</span> <span class="token class-name">MyBB1</span><span class="token number">.2</span><span class="token operator">+</span> <span class="token number">3711</span> <span class="token operator">=</span> <span class="token class-name">Mediawiki</span> <span class="token class-name">B</span> type <span class="token number">3721</span> <span class="token operator">=</span> <span class="token class-name">WebEdition</span> <span class="token class-name">CMS</span> <span class="token number">7600</span> <span class="token operator">=</span> <span class="token class-name">Redmine</span> <span class="token class-name">Project</span> <span class="token class-name">Management</span> <span class="token class-name">Web</span> <span class="token class-name">App</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><br><br><h3 id="密码破解推荐原则"><a href="#密码破解推荐原则" class="headerlink" title="密码破解推荐原则"></a>密码破解推荐原则</h3><hr><p>破解时采取先易后难的原则，建议如下：</p><ul><li><p>利用收集的公开字典进行破解</p></li><li><p>使用1-8位数字进行破解。</p></li><li><p>使用1-8位小写字母进行破解</p></li><li><p>使用1-8位大写字母进行破解</p></li><li><p>使用1-8位混合大小写+数字+特殊字符进行破解</p></li></ul><p>3.2 hashcat破解规则</p><p>（1）字典攻击</p><blockquote><p>-a 0 password.lst</p></blockquote><p>（2）1到8为数字掩码攻击</p><blockquote><p>-a 3 –increment –increment-min 1–increment-max 8 ?d?d?d?d?d?d?d?d –O</p></blockquote><p>?d代表数字，可以换成小写字母?l，大写字母?u，特殊字符?s，大小写字母+特殊字符?a，–O表示最优化破解模式，可以加该参数，也可以不加该参数。</p><p>（3）8为数字攻击</p><blockquote><p>-a 3 ?d?d?d?d?d?d?d?d </p></blockquote><p>同理可以根据位数设置为字母大写、小写、特殊字符等模式。</p><p>（4）自定义字符</p><p>现在纯数字或者纯字母的密码是比较少见的，根据密码专家对泄漏密码的分析，90%的个人密码是字母和数字的组合，可以是自定义字符了来进行暴力破解，Hashcat支持4个自定义字符集，分别是 -1 -2 -3 -4。定义时只需要这样-2  ?l?d ，然后就可以在后面指定?2，?2表示小写字母和数字。这时候要破解一个8位混合的小写字母加数字：</p><blockquote><p>Hashcat.exe -a 3 –force -2 ?l?d  hassh值或者hash文件  ?2?2?2?2?2?2?2?2</p></blockquote><p>例如破解dz小写字母+数字混合8位密码破解：</p><blockquote><p>Hashcat -m 2611  -a 3 -2 ?l?d  dz.hash    ?2?2?2?2?2?2?2?2</p></blockquote><p>（5）字典+掩码暴力破解</p><p>Hashcat还支持一种字典加暴力的破解方法，就是在字典前后再加上暴力的字符序列，比如在字典后面加上3为数字，这种密码是很常见的。使用第六种攻击模式：</p><blockquote><p>a-6 (Hybrid dict + mask)</p></blockquote><p>如果是在字典前面加则使用第7中攻击模式也即( a-7 = Hybridmask + dict)，下面对字典文件加数字123进行破解：</p><blockquote><p>H.exe -a 6 ffe1cb31eb084cd7a8dd1228c23617c8  password.lst ?d?d?d</p></blockquote><p>假如ffe1cb31eb084cd7a8dd1228c23617c8的密码为password123，则只要password.lst包含123即可。</p><p> （6）掩码+字典暴力破解</p><blockquote><p>H.exe -a 7  ffe1cb31eb084cd7a8dd1228c23617c8  password.lst ?d?d?d</p></blockquote><p>假如ffe1cb31eb084cd7a8dd1228c23617c8的密码为123password，则只要password.lst包含password即可。</p><p>（7）大小写转换攻击，对password.lst中的单词进行大小写转换攻击</p><blockquote><p>H.exe-a 2  ffe1cb31eb084cd7a8dd1228c23617c8  password.lst</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Kali</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Kali</tag>
      
      <tag>HashCat</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】多线程与高并发</title>
    <link href="/2020/07/03/%E3%80%90Java%E3%80%91%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/"/>
    <url>/2020/07/03/%E3%80%90Java%E3%80%91%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<h3 id="多线程与高并发-synchronized-篇"><a href="#多线程与高并发-synchronized-篇" class="headerlink" title="多线程与高并发 synchronized 篇"></a>多线程与高并发 synchronized 篇</h3><p><font color=DarkGray size=2>进程 线程 协程/纤程（Quasur）</font></p><hr><p><br><br></p><h4 id="线程：一个程序里不同的执行路径"><a href="#线程：一个程序里不同的执行路径" class="headerlink" title="线程：一个程序里不同的执行路径"></a>线程：一个程序里不同的执行路径</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> T1 <span class="token keyword">extends</span> <span class="token class-name">Thread</span><span class="token punctuation">&#123;</span>  <span class="token annotation punctuation">@Override</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Override Theme 中的 run 方法"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// 方法一</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 方法二</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 方法三</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span><span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"Hello World！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li><p>创建线程的两种方式：</p><ul><li>创建一个类，继承Thread，重写方法</li><li>定义一个类，实现 Runnable 接口，然后重写 run 方法</li></ul></li><li><p>启动：</p></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//方法一：</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//方法二：</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//方法三：</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"Hello World！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>面试<ul><li>问：启动线程的三种方式是？</li><li>答：<ul><li>1、从 <code>Thread</code> 继承</li><li>2、实现 <code>Runnable</code> 接口</li><li>3、从线程池中启动 <code>Executors.newCachedThrad</code></li></ul></li></ul></li></ul><hr><br><br><h4 id="线程的基本方法"><a href="#线程的基本方法" class="headerlink" title="线程的基本方法"></a>线程的基本方法</h4><p><font color =DarkGray size=2>在T1中调用  T2.join（）；则执行到 join 之后，<font color=#f123>T1进入等待模式</font>，先执行完T2之后，再返回执行T1。</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// sleep 睡眠</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 毫秒</span><span class="token comment">// Yield 让出一下CPU 进入等待队列（如果没有等待的则继续执行）</span><span class="token comment">// 使用场景，较少</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Join</span><span class="token class-name">Thread</span> T1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    T1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token class-name">Thread</span> T2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"T2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>其他方法</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 暴力结束线程（不建议使用）</span><span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// 唤起线程</span><span class="token punctuation">.</span><span class="token function">intereptor</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token comment">// 获取线程状态。</span><span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br></p><h4 id="线程的锁"><a href="#线程的锁" class="headerlink" title="线程的锁"></a>线程的锁</h4><hr><ol><li>上锁</li></ol><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token class-name">Object</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//任何县城要执行下面的代码，则必须先拿到o</span>        count<span class="token operator">--</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// synchronized(this) 等值于 synchronized(方法);</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> count  <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// 等同于synchronized(T.class)</span>    count <span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">mm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            count<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br></p><h4 id="synchronized的特性"><a href="#synchronized的特性" class="headerlink" title="synchronized的特性"></a>synchronized的特性</h4><p><font color=DarkGray size=2>1、锁的是对象，不是进程  / 线程 ； 2、能不加synchronized()锁就不加，加锁之后效率极低；</font></p><hr><ul><li><p>可重入性</p><ul><li>一个方法<code>m1</code>加锁，另一个方法<code>m2</code>也加了锁（同一把锁），那么<code>m1</code>是可以调用<code>m2</code>的。</li></ul></li><li><p>异常的锁</p><ul><li>程序中的锁的内容出现了<font color=#f123><strong>异常</strong></font>，那么该锁将被<font color=#f890>释放</font>。</li></ul></li></ul><hr><p><br><br></p><h4 id="synchronized-底层实现"><a href="#synchronized-底层实现" class="headerlink" title="synchronized 底层实现"></a>synchronized 底层实现</h4><p><font color=DarkGray size=2>synchronized(Object) ;  括号中一定要是Object对象，不能是String 或其他任何类型；</font></p><hr><blockquote><p>早期的锁：需要就去找操作系统申请、</p></blockquote><blockquote><p>发展后的：先乐观锁、后自旋锁、最后找系统实现（重量级锁 | 最浪费时间）</p></blockquote><blockquote><ul><li><font color=DarkGray size=2>抱着“没有线程跟我争用”的心态去申请一个资源：此时是 <font color=#f890>偏向锁</font>，只记录ID，不锁（默认没有第二个线程来访问）</font></li></ul></blockquote><blockquote><ul><li><font color=DarkGray size=2>如果有线程争用：升级为 <font color=#f890>自旋锁</font> 循环10次（占用CPU）</font></li></ul></blockquote><blockquote><ul><li><font color=DarkGray size=2>10次之后要访问的资源还被锁着？升级为<font color=#f890>重量级锁 </font> 去操作系统申请锁（不占用 CPU）</font></li></ul></blockquote><p><font color=7bafa6 size=2>自旋锁：在用户态解决问题，不经过内核态。</font></p><p><font color=7bafa6 size=2>执行时间长的用系统锁，（加锁代码）执行时间特别短，线程较少，用自旋锁。</font></p><hr><p><br><br></p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><hr><ul><li>Lock( )   CAS使用自旋</li><li>synchronized 是一种锁，其锁的目标是 对象 而不是线程 / 进程（用对象代替进程更易操作）</li><li>被锁的对象 必须是 Object 类型，不能是 String 或其他对象</li><li>锁申请资源的时候一定是    ：乐观锁</li><li>锁第一次升级的时候一定是：自旋锁（自旋十次，耗CPU，不走内核）</li><li>锁第二次升级的时候一定是：重量级锁（内核态，耗内核、耗时，不耗CPU）</li></ul><hr><p><br><br><br><br></p><h3 id="多线程与高并发-2-代码优化-及-volatile修饰-篇"><a href="#多线程与高并发-2-代码优化-及-volatile修饰-篇" class="headerlink" title="多线程与高并发 2  代码优化 及 volatile修饰 篇"></a>多线程与高并发 2  代码优化 及 volatile修饰 篇</h3><hr><p><br><br></p><h4 id="volatile-指令介绍"><a href="#volatile-指令介绍" class="headerlink" title="volatile 指令介绍"></a>volatile 指令介绍</h4><p><font color=DarkGray size=2>偏向锁  &gt;  循环锁  &gt;  重量级锁</font></p><hr><blockquote><ul><li><p>指令介绍</p><ul><li>volatile // 可变的，易变的</li></ul></li><li><p>指令功能</p><ul><li><p>保证线程可见性，禁止指令重排序。</p></li><li><p><font color=#f890>保证线程可见性：</font>一个类的值给两个类同时调用，里面的变量改变后无法轻易发现（线程之间不可见）。</p><p>volatile可以让一个线程发生改变之后，另一个线程可以马上知道。</p><p>// 原理：CPU的缓存一致性协议。</p></li><li><p><font color=#f890>禁止指令重排序：</font>CPU迸发执行指令，所以会对指令重新排序，加了volatile来保证重排序。</p></li></ul></li></ul></blockquote><hr><p><br><br></p><h4 id="举例介绍-及-代码优化"><a href="#举例介绍-及-代码优化" class="headerlink" title="举例介绍 及 代码优化"></a>举例介绍 及 代码优化</h4><hr><ul><li><font color=#f890>饿汉式</font>：（定义类的时候就实例化方法）</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Mgr01</span><span class="token punctuation">&#123;</span>  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Mgr01</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mgr01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">private</span> <span class="token class-name">Mgr01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Mgr01</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Mgr01</span> m1 <span class="token operator">=</span> <span class="token class-name">Mgr01</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Mgr01</span> m2 <span class="token operator">=</span> <span class="token class-name">Mgr01</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m1 <span class="token operator">==</span> m2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li><font color=#f890>懒汉式：</font>什么时候调用方法什么时候初始化（类似于懒加载）</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Lazy</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">Lazy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token comment">//默认不会实例化，什么时候用什么时候new</span>        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Lazy</span> lazy<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">Lazy</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>lazy<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                lazy<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Lazy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> lazy<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><table><thead><tr><th align="center"></th><th align="center">饿汉式</th><th align="center">懒汉式</th></tr></thead><tbody><tr><td align="center">安全</td><td align="center">√</td><td align="center"></td></tr><tr><td align="center">节省内存</td><td align="center"></td><td align="center">√</td></tr></tbody></table><ul><li>懒汉饿汉合并：</li></ul><blockquote><p>类的定义：</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Mgr01</span><span class="token punctuation">&#123;</span><span class="token keyword">private</span> <span class="token comment">/*volatile*/</span> <span class="token keyword">static</span> <span class="token class-name">Mgr0x</span> INSTANCE<span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token class-name">Mgr0x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Mgr01</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//以下所有代码写的都是这一个方法</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=#f890>以下所有方法写的都是上面的 <code>getInstance（）</code>方法。</font></p><p><font color=7baf23 size=3>以上方法没有加<code>volatile</code>，最后会写上。</font></p><hr><ul><li>直接判断null</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 先判断是否为空 然后再那啥：</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Mgr03</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>INSTANCE <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruotedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mgr03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=#f123 size=2>  ↑   ↑   ↑   ↑    ↑ 这是一种错误的书写方式，自己抿；</font></p><ul><li>先锁再null</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">Mgr04</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>INSTANCE <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruotedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mgr04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=7baf23 size=2>  ↑   ↑   ↑   ↑    ↑ 修改正确，但是违背了  <font color=#f890 size=3>能不加锁就不加锁</font>  原则。</font></p><ul><li>锁细化：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Mgr05</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>INSTANCE <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Mgr05</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">try</span><span class="token punctuation">&#123;</span>                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruotedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mgr05</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=#f123 size=2>  ↑   ↑   ↑   ↑    ↑ 这也是一种错误的书写方式（重复初始化）；</font></p><ul><li>双重检查：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Mgr05</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>INSTANCE <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Mgr05</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>INSTANCE <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">try</span><span class="token punctuation">&#123;</span>                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruotedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mgr05</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=7baf23 size=2>  ↑   ↑   ↑   ↑    ↑ 修改正确…….而且锁不加载外面，效率增高~~</font></p><ul><li><font color=#ff452>关于<code>volatile</code>(主要是   <font size=5 color=#f890><code>指令重排序</code>   </font>)超高超高迸发的情况可能会发生：</font></li></ul><blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// new对象的三步</span>INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mgr06</span>（）<span class="token punctuation">;</span><span class="token number">1.</span> 申请内存并给初始值（<span class="token keyword">int</span> <span class="token operator">=</span> <span class="token number">0</span>，<span class="token class-name">String</span> <span class="token operator">=</span> <span class="token keyword">null</span>；）<span class="token number">2.</span> 修改值<span class="token number">3.</span> 将值给对象<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=7baf23 size=2>加 <code>volatile</code> 防止第二步第三步会颠倒；</font></p><ul><li>一个求结果是 100000 的小程序</li></ul></blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">&#123;</span>    <span class="token keyword">volatile</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 加上vilatile</span>    <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">// 加上 synchronized</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">T</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Thread</span><span class="token punctuation">></span></span> threads <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArraysList</span><span class="token operator">&lt;</span><span class="token operator">~</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            threads<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>t<span class="token operator">::</span><span class="token function">m</span><span class="token punctuation">,</span><span class="token string">"threads-"</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        threads<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-></span>o<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        threads<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>          <span class="token keyword">try</span><span class="token punctuation">&#123;</span>              o<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=#f890 size=2>只有加上了 synchronized &amp; volatile 才能运行出正确结果，其中 synchronized 用来保证<code>原子性</code>。</font></p></blockquote><hr><p><br><br></p><h4 id="锁优化场景"><a href="#锁优化场景" class="headerlink" title="锁优化场景"></a>锁优化场景</h4><hr><ul><li>锁力度变小（争用不是很激烈的话）</li></ul><blockquote><p>如果有一群要争用的代码，那么可以将方法上的 synchronized 写到 count++ 上；</p></blockquote><ul><li>锁力度变大（争用很激烈很频繁的话）</li></ul><blockquote><p>假如一个方法里面 总共 20 行代码，加了19个锁，那不如直接用一个大的锁。</p></blockquote><hr><p><br><br></p><h4 id="锁的对象被调用"><a href="#锁的对象被调用" class="headerlink" title="锁的对象被调用"></a>锁的对象被调用</h4><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token operator">=</span> <span class="token class-name">T</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Object</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 错误修改点</span>        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">sout</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">zbc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">T</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        t<span class="token punctuation">.</span>o <span class="token operator">=</span> <span class="token string">"a"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=#f123 size=2>↑   ↑   ↑  以上代码错误！</font><font color=7baf23 size=2>以下为修改 ↓   ↓   ↓</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">final</span> <span class="token class-name">Object</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><br><br></p><h4 id="有些类在创建的时候直接加了锁"><a href="#有些类在创建的时候直接加了锁" class="headerlink" title="有些类在创建的时候直接加了锁"></a>有些类在创建的时候直接加了锁</h4><hr><blockquote><p>Atomic 开头的 ( <code>AtomicInteger  count = new AtomicInteger( );</code>  // 让count进行原子性加减)</p></blockquote><hr><p><br><br></p><h4 id="CAS-Compare-And-Set-无锁优化-乐观锁"><a href="#CAS-Compare-And-Set-无锁优化-乐观锁" class="headerlink" title="CAS ( Compare And Set ) 无锁优化 乐观锁"></a>CAS ( Compare And Set ) 无锁优化 乐观锁</h4><p><font color=#f890 size=2>在请求的时候就乐观的认为 代码里的值就是我的期望值</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">cas <span class="token punctuation">(</span><span class="token class-name">V</span> <span class="token punctuation">,</span><span class="token class-name">Expected</span><span class="token punctuation">,</span><span class="token class-name">NewValue</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> （<span class="token class-name">V</span> <span class="token operator">==</span> <span class="token class-name">Expected</span>）<span class="token punctuation">&#123;</span>        <span class="token class-name">V</span> <span class="token operator">=</span> <span class="token class-name">NewValue</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        tryAgain or fail<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=7baf23 size=2>↑   ↑   ↑  以上是在CPU 原语上的支持，不能被打断。</font></p><hr><p><br><br></p><h4 id="ABA-问题（与前女友复合之后，其实她已经经历了n个男人；）"><a href="#ABA-问题（与前女友复合之后，其实她已经经历了n个男人；）" class="headerlink" title="ABA 问题（与前女友复合之后，其实她已经经历了n个男人；）"></a><code>ABA</code> 问题（与前女友复合之后，其实她已经经历了<code>n个</code>男人；）</h4><hr><p>有个对象 object == 1；想使用<code>cas</code>把它变成2:</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token function">cas</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//没有线程进行操作，可以进行更改</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><font color=#f890 size=2>如果在更改的时候有一个线程给 object 改成了2，然后又改成了 1 ；在基础类型（如：int）没有影响，但是 <code>Object</code> 对象有影响；</font></p><p><font color=7baf23 size=2>解决方法：做 <code>cas</code> 的时候加个版本号：</font>version</p><p><font color=7baf23 size=2>解决方法：使用</font>  AutomicStampedReference ( unsafe 什么时候调用什么时候返回这个值 )</p><hr><p><br><br></p><h4 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h4><hr><ul><li>什么是 volatile ？ 它有什么用？</li><li>什么是 synchronized ？ 什么是 CAS ？两者有什么区别？分别在什么场景下使用？</li><li>什么时候要对锁进行细化？什么 时候进行泛化？</li><li>什么是 ABA 问题？有什么影响？怎么解决？</li></ul><hr><p><br><br><br><br><br></p><h3 id="各式锁的实际应用"><a href="#各式锁的实际应用" class="headerlink" title="各式锁的实际应用"></a>各式锁的实际应用</h3><p><font color=DarkGray size=2>公平锁？不公平锁？乐观锁？悲观锁？自旋锁？重量级锁？读写锁？</font></p><hr><p><br><br></p><h4 id="乐观锁-cas"><a href="#乐观锁-cas" class="headerlink" title="乐观锁 cas"></a>乐观锁 <a href="https://blog.csdn.net/ln_6am/article/details/85642853?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522160891401516780271139209%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&request_id=160891401516780271139209&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-85642853.first_rank_v2_pc_rank_v29&utm_term=cas">cas</a></h4><p><font color=DarkGray size=2>（要改的对象，期望的值，要给的值）无锁操作，其实是一个乐观锁……cas本身可以看成是一个锁；</font></p><hr><ul><li>automic ： 一种使用 cas 实现的原子性操作（上篇中提过）</li></ul><hr><p><br><br></p><h4 id="原子操作的简单方法："><a href="#原子操作的简单方法：" class="headerlink" title="原子操作的简单方法："></a>原子操作的简单方法：</h4><hr><table><thead><tr><th>函数</th><th>效果</th><th>备注</th></tr></thead><tbody><tr><td>AtomicInteger a = new AtomicInteger(0);</td><td>int a = 0;</td><td>创建对象a并且赋初值为0；</td></tr><tr><td>a.incrementAndGet(   )；</td><td>i++;</td><td>对原值+1后返回；</td></tr><tr><td>a.getAndIncrement(   )；</td><td>++i；</td><td>对原值返回后+1；</td></tr><tr><td>a.addAndGet(i);</td><td>a+=i;</td><td>返回a+i；</td></tr><tr><td>a.getAndAdd(i);</td><td>a+=i;</td><td>返回原值之后给a+i；</td></tr></tbody></table><p><font color = green>在线程很多的情况下：LongAdder（分段锁：在线程多的时候有优势） &gt; Atomic &gt; synchronized。</font></p><hr><p><br><br></p><h4 id="Synchronized-的可重入性："><a href="#Synchronized-的可重入性：" class="headerlink" title="Synchronized 的可重入性："></a>Synchronized 的可重入性：</h4><hr><blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//可重入：</span><span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">m1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">try</span><span class="token punctuation">&#123;</span><span class="token class-name">TimeUtil</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 睡一秒</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">sout</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">m2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">sout</span><span class="token punctuation">(</span><span class="token string">"m2..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">T01_ReentrantLock1</span> r1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">T01_ReentrantLock1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>r1<span class="token operator">::</span><span class="token function">m1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">try</span><span class="token punctuation">&#123;</span><span class="token class-name">TimeUtil</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 睡一秒</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>r1<span class="token operator">::</span><span class="token function">m2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>输出结果：0 1 23 4 5 6 7 8 9 m2…</p></blockquote><p>代码修改：synchronized</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//可重入：</span><span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">m1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>    <span class="token class-name">TimeUtil</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 睡一秒</span>    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">sout</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>r1<span class="token operator">::</span><span class="token function">m2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">m2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">sout</span><span class="token punctuation">(</span><span class="token string">"m2..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token class-name">T01_ReentrantLock1</span> r1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">T01_ReentrantLock1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>r1<span class="token operator">::</span><span class="token function">m1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">try</span><span class="token punctuation">&#123;</span>    <span class="token class-name">TimeUtil</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 睡一秒</span>  <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p> 输出结果：0 1 2 m2 … 3 4 5 6 7 8 9</p></blockquote></blockquote><hr><p><br><br></p><h4 id="lock-替代-synchronized-的方法"><a href="#lock-替代-synchronized-的方法" class="headerlink" title="lock():替代 synchronized 的方法;"></a><code>lock()</code>:替代 synchronized 的方法;</h4><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li><p>特点：</p><ul><li>需要手动上锁 <code>lock.lock( );</code></li><li>需要手动解锁<code>lock.unlock( )</code>;</li><li>防止进程出错而导致死锁，需要<code>try&#123; …… &#125;catch( )&#123; …… &#125;</code></li></ul><hr></li><li><p>优点：</p><ul><li><p>可以使用<code>tryLock()</code>尝试上锁；</p></li><li><p>当 <code>synchronized</code>遇到锁之后只能等待，而<code>tryLock()</code>可以自定义等待时间；</p></li><li><p>```java<br>locked = lock.tryLock(SECONDS(时间长度),TimeUtil.SECONDS（时间格式：秒）);</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">  ----- 常用方法：| 方法                          | 参数                 | 用法                                                         || ----------------------------- | -------------------- | ------------------------------------------------------------ || .lock( );                     | null                 | 锁定                                                         || .unlock( );                   | null                 | 释放                                                         || .tryLock(n,TimeUtil.SECONDS); | 时间长度&lt;br&gt;时间单位 | 等待&#96;参数&#96;时间过程中:&lt;br&#x2F;&gt;如果当前进程释放了，则锁定;&lt;br&#x2F;&gt;不释放则不锁定； || .lockInterruptibly( );        | null；               | 可以相应被打断的锁；                                         || .interrupt( );                | Null;                | 打断这个锁；                                                 |-----&lt;br&gt;&lt;br&gt;#### 公平锁&lt;font size&#x3D;2&gt;ReetrantLock lock &#x3D; new ReentrantLock( &lt;font color&#x3D;#f890&gt;true&lt;&#x2F;font&gt; );&lt;&#x2F;font&gt;----- 概念：  - 当执行队列中有线程正在排队的时候：    - 公平锁：继续等待，排队执行；    - 不公平锁：不等待，直接抢，有可能抢到第一个执行；- 创建方式：  - 在创建锁的时候加个 &#96;true&#96; 创建出来的就是公平锁；&#96;&#96;&#96;javapublic class T05_ReentrantLock extends Thread()&#123;private stratic ReentrantLock lock &#x3D; new ReentrantLock(true);  public void run()&#123;    for(int i &#x3D; 0;i&lt;100;i++)&#123;      lock.lock();      try&#123;        Sout(Thread.currentThread().getName()+&quot;获得锁&quot;);      &#125;finally&#123;        lock.unlock();      &#125;    &#125;  &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li></ul></li></ul><p><br><br></p><h4 id="一个倒计时的门栓-CountDownLatch"><a href="#一个倒计时的门栓-CountDownLatch" class="headerlink" title="一个倒计时的门栓 CountDownLatch"></a>一个倒计时的门栓 <code>CountDownLatch</code></h4><hr><p><code>CountDownLatch latch  = CountDownLatch( threads.length ); </code>    //创建一个length长度的门栓</p><p><code>.await()</code>   阻塞</p><p><code>原join()</code>    当前线程结束自动往前走</p><p><code>.countDown()</code>   原子性–</p><hr><p><br><br></p><h4 id="栅栏工具-CyclicBarrier"><a href="#栅栏工具-CyclicBarrier" class="headerlink" title="栅栏工具 CyclicBarrier"></a>栅栏工具 <code>CyclicBarrier</code></h4><p><font color=#dgreen size=2>循环栅栏工具</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 一个参数：不到20的时候，等待，到了20个，这20个发车，再来的继续等待</span><span class="token class-name">CyclicBarrier</span> barrier <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CyclicBarrier</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 两个参数：</span><span class="token class-name">CyclicBarrier</span> barrier <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CyclicBarrier</span><span class="token punctuation">(</span><span class="token number">20</span>，run<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"满员，发车！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">//lambdo 表达式</span><span class="token class-name">CyclicBarrier</span> barrier <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CyclicBarrier</span><span class="token punctuation">(</span><span class="token number">20</span>，<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"满员，发车！"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><br><br></p><h4 id="同步进行的-Phaser"><a href="#同步进行的-Phaser" class="headerlink" title="同步进行的 Phaser"></a>同步进行的 Phaser</h4><p><font size=2>按照不同的阶段对线程进行划分。</font></p><hr><ul><li><p>使用场景：</p><ul><li>遗传算法</li><li>现实生活一步一步执行的场景（如：婚礼）</li><li>像是一个一个栅栏一样</li></ul><hr></li><li><p>使用方法：</p><ul><li><p>自定义一个类，继承 <code>Phaser</code>类；</p><p><code>static class MarrigePhaser extends Phaser</code></p></li><li><p>重写<code>onAdvance</code>方法；（栅栏被推倒的时候自动调用）</p><p><code>protected boolean onAdvance(int phase,int registeredParties)</code></p></li></ul><hr></li><li><p>方法：</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">phaser<span class="token punctuation">.</span><span class="token function">arriveAndAwaitAdvance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行结束，开始等待；</span>phaser<span class="token punctuation">.</span><span class="token function">arriveAndDeregister</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//执行结束，不进入下一阶段；</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></li></ul><p><br><br></p><h4 id="读写锁"><a href="#读写锁" class="headerlink" title="读写锁"></a>读写锁</h4><p><font size=2>程序中的读写锁（一种排他锁、共享锁）</font></p><hr><ul><li><p>概念</p><ul><li>当<code>A</code>进程在读取<code>ABCD</code>的时候，<code>B</code>进程也来读取<code>ABCD</code>，同时发现<code>A</code>进程在读取，则读取成功；</li><li>当<code>A</code>进程在<font color=7baf23>读取</font><code>ABCD</code>的时候，<code>B</code>进程来<font color=#f890>修改</font><code>ABCD</code>，同时发现<code>A</code>进程在读取，若此时更改<code>ABCD</code>的内容，则<code>A</code>进程读取会出问题，所以修改失败；</li><li><strong>总结：</strong>两个都是<font color=7baf23>读取</font>的进程可以同时进行，当有 读 进程在进行时，<font color=red>无法</font>进行 <font color=red>写</font> 进程，写同理；</li></ul></li><li><p>作用</p><ul><li>避免 / 减少 脏数据</li></ul></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token class-name">ReadWriteLoak</span> readWriteLock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantReadWriteLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//在 ReentrantReadWriteLock 中 分出一个 `readLock`一个`writeLock`</span><span class="token keyword">static</span> <span class="token class-name">Lock</span> readLock <span class="token operator">=</span> readWriteLock<span class="token punctuation">.</span><span class="token function">readLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token class-name">Lock</span> writeLock <span class="token operator">=</span> readWriteLock<span class="token punctuation">.</span><span class="token function">writeLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token class-name">Lock</span> lock<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"read over!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 模拟读取过程</span>    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        e<span class="token punctuation">.</span><span class="token function">peintStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">finally</span><span class="token punctuation">&#123;</span>        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">Lock</span> lock<span class="token punctuation">,</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"write "</span><span class="token operator">+</span> a <span class="token operator">+</span><span class="token string">"over!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 模拟读取过程</span>    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        e<span class="token punctuation">.</span><span class="token function">peintStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">finally</span><span class="token punctuation">&#123;</span>        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Runnable</span> readR <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">read</span><span class="token punctuation">(</span>lock<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//Runnable readR = ()->read(readLock);</span>        <span class="token class-name">Runnable</span> write <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">write</span><span class="token punctuation">(</span>lock<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">18</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>readR <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">2</span> <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>writeR<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>// 如果使用 <code>ReentrantLock</code>的话，以上代码在执行<code>读</code>的时候也需要等待一秒；</p><p>// 解决方法：将<code>Main</code>方法中的<code>读</code>锁换成`Runnable readR = ()-&gt; read(readLock);<br></p><br><hr><p><br><br></p><h4 id="Semaphore-一个有意思的线程池"><a href="#Semaphore-一个有意思的线程池" class="headerlink" title="Semaphore 一个有意思的线程池"></a>Semaphore 一个有意思的<font color=#FFA500>线程池</font></h4><p><font color=DarkGray size=2><code>Semaphore s = new Semaphore(x);</code>x是几则这个 &lt; 线程池 &gt; 就   <font color=#f890 size=2>允许几个线程</font>    同时执行。</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Semaphore</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Semaphore</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//括号中数字为x时，允许x个线程同时执行</span>        <span class="token comment">// T1 Running</span>    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            s<span class="token punctuation">.</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 进来一个进程 1 变成 0 ，别的线程不能执行</span>            <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"T1 Running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"T1 Running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">finally</span><span class="token punctuation">&#123;</span>            s<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 离开一个进程 0 变成 1 ，别的线程可以执行</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// T2 Running</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            s<span class="token punctuation">.</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 进来一个进程 1 变成 0 ，别的线程不能执行</span>            <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"T2 Running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"T2 Running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">finally</span><span class="token punctuation">&#123;</span>            s<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 离开一个进程 0 变成 1 ，别的线程可以执行</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color = #f890 size=2>如果<code>x==1</code>则运行结果是<code>T1 T1 T2 T2</code>，否则可能是<code>T1 T2 T1 T2</code></font></p><p><br><br></p><h4 id="Exchanger-用于-lt-两个-gt-线程交换数据的方法"><a href="#Exchanger-用于-lt-两个-gt-线程交换数据的方法" class="headerlink" title="Exchanger 用于 &lt; ! 两个 ! &gt; 线程交换数据的方法"></a>Exchanger 用于 &lt; ! 两个 ! &gt; 线程交换数据的方法</h4><p><font color=DarkGray size=2>使用场景：双人游戏中两人交换装备！执行一次就失效，可以循环等待下一次；</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// T1</span>    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"T1"</span><span class="token punctuation">;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            s <span class="token operator">=</span> sxchanger<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token function">cathc</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">""</span><span class="token operator">+</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// T2</span>    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"T2"</span><span class="token punctuation">;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            s <span class="token operator">=</span> sxchanger<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token function">cathc</span><span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">""</span><span class="token operator">+</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"t2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>线程中有两个变量，分别是 s 和 s （局部变量），两个线程同时执行，最后交换 T1 与 T2 的值；</p></blockquote><hr><p><br><br></p><h4 id="分布式锁"><a href="#分布式锁" class="headerlink" title="分布式锁"></a>分布式锁</h4><hr><p><font color=#f890 size=2>只是某个类型的锁，将来补充概念。</font></p><p><br><br></p><h4 id="总结-："><a href="#总结-：" class="headerlink" title="总结 ："></a>总结 ：</h4><hr><ul><li>无论何种情况，优先考虑使用<code>synchronized</code></li><li>什么情况下使用lock（）？它与 synchronized（）相比有什么优点？</li><li>为什么使用读写锁？读写锁是怎么实现的？</li><li>随机列举一些跟锁一起使用的方法~~</li><li>把标题下的各种锁的使用场景和实现方式全都想一遍~</li></ul><hr>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>进阶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Java】Lambda 表达式</title>
    <link href="/2020/05/03/%E3%80%90Java%E3%80%91Lambda-%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <url>/2020/05/03/%E3%80%90Java%E3%80%91Lambda-%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h3 id="Lambda-表达式"><a href="#Lambda-表达式" class="headerlink" title="Lambda 表达式"></a>Lambda 表达式</h3><hr><p><br><br></p><h4 id="初识-Lambda"><a href="#初识-Lambda" class="headerlink" title="初识 Lambda"></a>初识 Lambda</h4><hr><ul><li><p>什么是 <font color=7baf23>  Lambda  </font>表达式？</p><ul><li>自 Java 8 增加的新特性</li><li>一个<a href="https://blog.csdn.net/aliang_godlike/article/details/97611706?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522160888413216780299074548%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&request_id=160888413216780299074548&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-97611706.first_rank_v2_pc_rank_v29&utm_term=%E4%BB%80%E4%B9%88%E6%98%AF%E5%8C%BF%E5%90%8D%E6%96%B9%E6%B3%95%20java">匿名方法</a>(一个没有名字的方法，在定义变量的时候定义的方法)</li></ul></li><li><p>为什么使用  <font color=7baf23>  Lambda  </font>？</p><ul><li><p>简洁实现接口对接；</p></li><li><p>虽然可以使用  <font color=7baf23>  Lambda  </font> 表达式对某些接口进行实现，但是并不是所有的接口都可以使用 <font color=7baf23>  Lambda  </font>来实现；</p></li><li><p><strong>实现要求：</strong>要实现的抽象方法只能是一个；</p></li><li><blockquote><p>在 Java 8 中对接口实现了一个新特性 <code>default</code> ，被此方法修饰的方法在类中有一个默认实现，所以不影响使用<font color=7baf23>  Lambda  </font>的实现；</p></blockquote></li></ul></li><li><p><strong>@FunctionalInterface</strong>：</p><ul><li>一个用来修饰<font color=#f890>函数式接口</font>的，接口中的<font color=#f890>抽象方法</font>只能有一个；</li></ul></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 错误代码展示</span><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">interface</span> <span class="token class-name">Comparer</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 方法一</span>    <span class="token keyword">int</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 方法二</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre><code>&lt;font color=red size=2&gt;↑ ↑ ↑ 错误代码展示 ↑ ↑ ↑&lt;/font&gt;</code></pre></div><ul><li><p><a href="https://blog.csdn.net/weixin_38106322/article/details/106493630">什么是函数式接口？</a></p></li><li><p>代码示例</p></li></ul> <div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> DEMO<span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 方法一：使用接口实现类</span>        <span class="token class-name">Comparator</span> comparator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyComparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//方法二：使用匿名内部类</span>        <span class="token class-name">Comparator</span> comparator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> a<span class="token operator">-</span>b<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token comment">//方法三：使用Lambda表达式</span>        <span class="token class-name">Comparator</span> comparator2 <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">-></span> a<span class="token operator">-</span>b<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// 一个接口</span><span class="token keyword">interface</span> <span class="token class-name">Comparator</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//方法一：使用实现类实现接口</span><span class="token keyword">class</span> <span class="token class-name">MyComparator</span> <span class="token keyword">implements</span> <span class="token class-name">Comparator</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> a<span class="token operator">-</span>b<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><p><br><br></p><h4 id="Lambda-基础语法"><a href="#Lambda-基础语法" class="headerlink" title="Lambda 基础语法"></a>Lambda 基础语法</h4><hr><ul><li><p>基础语法：</p><ul><li><font color=7baf23>  Lambda  </font>是一个匿名函数</li><li>包含：参数列表、方法体、（不包含：返回值类型、方法名）</li></ul></li><li><p>元素：</p><ul><li><code>()</code>：用来描述<font color=#f890>参数</font>列表</li><li><code>&#123;&#125;</code>：用来描述<font color=#f890>方法体</font></li><li><code>-&gt;</code>：分隔  Lambda 运算法，读作：<code>goes to</code></li></ul></li><li><p>几种情况：</p></li></ul><blockquote><p>1、<font color=#f8hsak>无参  无返回</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 无参 无返回</span><span class="token class-name">LambdaTest</span> lam1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span><span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"Hello World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>lam1<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 结果：输出`Hello World!`</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>2、<font color=green>单个参 </font> <font color=#f8hsak>无返回</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 无参 单个返回值</span><span class="token class-name">LambdaTest</span> lam2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span><span class="token class-name">Sout</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>lam2<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 结果：输出`10`</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>3、<font color=green>多个参 </font><font color=#f8hsak>无返回</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">LambdaTest</span> lam3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span><span class="token class-name">Sout</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>lam3<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 结果:输出`21`</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>4、<font color=#f8hsak>无参 </font><font color=green>有返回</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">LambdaTest</span> lam4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span><span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> ret <span class="token operator">=</span> lam4<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 结果:输出`100` ; 返回 `100`</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>5、<font color=green>有参数 有返回</font></p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">LambdaTest lam5 &#x3D; (int a)-&gt;&#123;Sout(a*2);return a*2;&#125;int ret &#x3D; lam5.test(10);&#x2F;&#x2F; 结果:输出&#96;20&#96; ; 返回 &#96;20&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></blockquote><div class="code-wrapper"><pre><code>&lt;font color=red size=2&gt;↑ ↑ ↑ 要注意 一定要定义相应的 `函数式接口` ↑ ↑ ↑ &lt;/font&gt;</code></pre></div><hr><p><br><br></p><h4 id="Lambda-语法精简"><a href="#Lambda-语法精简" class="headerlink" title="Lambda 语法精简"></a>Lambda 语法精简</h4><hr><ul><li>错误代码演示：</li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">interface</span> <span class="token class-name">Lamx</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Lamx</span> lamx <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"a="</span> <span class="token operator">+</span> a <span class="token operator">+</span> <span class="token string">"\nb="</span> <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// return a+b;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=red size=2>上面报错了？</font><font color=#f890 size=2>Lambda表达式如何知道有返回值？</font></p><blockquote><p>Lambda 因为定义的接口有了说明，比如接口中写<code>int test(int a);</code>第一个<code>int</code>表示返回值类型，第二个<code>int </code>表示参数类型，所以 舍去了 <code>return</code> 就会报错；</p></blockquote><blockquote><p>既然在定义接口的时候已经定义了类型，那么是不是可以在写入参数的时候，将<font color=#f890>参数</font>的<font color=#f890>类型描述</font>给省略掉呢？</p></blockquote><ul><li><p>精简1：省略<font color=green>参数描述<code>int</code></font></p><p>代码演示：</p></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">interface</span> <span class="token class-name">Lamx</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Lamx</span> lamx <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"a="</span> <span class="token operator">+</span> a <span class="token operator">+</span> <span class="token string">"\nb="</span> <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=CornflowerBlue size = 2>接口中已经说明了有<code>int</code>类型的返回值，所以不写<code>return</code>是错误的；</font></p><p><font color=CornflowerBlue size = 2>两个必须同时省略，不能一个写一个不写；</font></p><ul><li><p>精简2：省略<font color=green>小括号<code>()</code></font></p><p>代码演示：</p></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">interface</span> <span class="token class-name">Lamx</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Lamx</span> lamx <span class="token operator">=</span> a <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"a="</span> <span class="token operator">+</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> a<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=CornflowerBlue size = 2>当 入参 只有一个的时候，可以省略入参的 括号；</font></p><ul><li>精简3：省略<font color=green>大括号<code>&#123;&#125;</code></font></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">interface</span> <span class="token class-name">Lamx</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Lamx</span> lamx <span class="token operator">=</span> a <span class="token operator">-></span> <span class="token class-name">Sout</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=CornflowerBlue size = 2>当 函数 只有一行的时候，可以省略大括号；</font></p><ul><li>精简4：省略<font color=green><code>return</code></font></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">interface</span> <span class="token class-name">Lamx</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Lamx</span> lamx <span class="token operator">=</span> a <span class="token operator">-></span> a<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=CornflowerBlue size = 2>如果唯一一条语句是<code>return</code>语句，那么省略大括号的同时，也必须省略<code>return</code>；</font></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Lamx</span> lamx <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token operator">-></span>a<span class="token operator">+</span>b<span class="token punctuation">;</span>lamx<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p><br><br></p><hr><h4 id="Lambda-语法进阶"><a href="#Lambda-语法进阶" class="headerlink" title="Lambda 语法进阶"></a>Lambda 语法进阶</h4><hr><ul><li>Lambda 调用<font color=green>静态</font>方法<ul><li>代码示例：</li></ul></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 实现方式一： 传统 Lambda 语法</span>        <span class="token class-name">Lamx</span> lamx <span class="token operator">=</span> a <span class="token operator">-></span> <span class="token function">change</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 实现方式二： 双" : "语法</span>        <span class="token class-name">Lamx</span> lamx <span class="token operator">=</span> <span class="token class-name">Test</span><span class="token operator">::</span><span class="token function">change</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> a<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color=DarkGray size =2>将 Lambda 指向一个已经实现的方法；语法规则 – 方法隶属者：：方法名</font></p><p>此处的<code>change</code>是一个静态方法，隶属者就是<code>Test</code>类，所以就是<code>Test::change</code></p><ul><li><font color=red>注意事项：</font><ul><li>参数的数量和类型一定要和方法中定义的一致</li><li>返回型一定要和接口中定义的方法一致</li></ul></li></ul><hr><ul><li>Lambda 调用<font color=green>构造</font>方法<ul><li>保留</li></ul></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 构造方法</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"Person类的 无参 构造方法执行了;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age  <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span><span class="token string">"Person类的 有参 构造方法执行了;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Lambda 语法</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Lamx</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// 原始方法</span>        <span class="token class-name">PersonCreater</span> creater1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>                <span class="token comment">// 简化方法</span>        <span class="token class-name">PersonCreater</span> creater2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// 构造方法的引用</span>        <span class="token class-name">PersonCreater</span> creater3 <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">;</span>        <span class="token class-name">Person</span> a <span class="token operator">=</span> creater3<span class="token punctuation">.</span><span class="token function">getPersonNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Person</span> a <span class="token operator">=</span> creater3<span class="token punctuation">.</span><span class="token function">getPersonDouble</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//接口中要说明 返回值类型 方法参数！！！</span><span class="token keyword">interface</span> <span class="token class-name">PersonCreater</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Person</span> <span class="token function">gerPersonNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Person</span> <span class="token function">getPersonDouble</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><font color = DarkGray size=2>实现语法 – <font size=3><code>类::new</code></font></font></p><hr><p><br><br></p><h4 id="Lambda-实现实例"><a href="#Lambda-实现实例" class="headerlink" title="Lambda 实现实例"></a>Lambda 实现实例</h4><hr><p>1、已知在一个<a href="https://blog.csdn.net/qq_36711757/article/details/80402429"> ArrayList</a> 类中有若干个 Person 对象，讲这些Person对象按照年龄进行降序排序；</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Exercise</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"韩梅梅"</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"赵四"</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"尼古拉斯凯奇"</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tony"</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                list<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span>o2<span class="token punctuation">)</span><span class="token operator">-></span> o2<span class="token punctuation">.</span>age<span class="token operator">-</span>o1<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>2、使用TreeSet排序</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">TreeSer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeSer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span>o2<span class="token punctuation">)</span><span class="token operator">-></span>o2<span class="token punctuation">.</span>age<span class="token operator">-</span><span class="token number">01.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"xiaoming"</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"wanggang"</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"zhaosi"</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Nigu"</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tony"</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"poily"</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Wngffei"</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Sout</span><span class="token punctuation">(</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//运行结果：基本正确，但是只有一个8岁的人；</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><p><strong>代码优化</strong></p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">TreeSer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeSer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span>o2<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>o1<span class="token punctuation">.</span>age <span class="token operator">>=</span> o2<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        retrun <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"xiaoming"</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"wanggang"</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"zhaosi"</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Nigu"</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tony"</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"poily"</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Wngffei"</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Sout</span><span class="token punctuation">(</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//运行结果：正确;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Interger</span><span class="token punctuation">></span></span> list <span class="token operator">-=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Collection</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>ele<span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>ele<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token class-name">Sout</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><p><br><br></p><h4 id="使用-Lambda-实现线程的实例化"><a href="#使用-Lambda-实现线程的实例化" class="headerlink" title="使用 Lambda 实现线程的实例化"></a>使用 Lambda 实现线程的实例化</h4><p><font size=2 color=DarkGray>实现线程的实例化；</font></p><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Sout</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><p><br><br></p><h4 id="系统内置的函数式接口"><a href="#系统内置的函数式接口" class="headerlink" title="系统内置的函数式接口"></a>系统内置的函数式接口</h4><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>、    <span class="token comment">//最常用的是Predicate、Consumer、Function、Supplier</span>        <span class="token comment">// Predicate&lt;T>：参数T ·返回值 boolean</span>    <span class="token comment">//IntPredicate：int-> boolean</span>    <span class="token comment">//LongPredicate：long->boolean</span>    <span class="token comment">//DoublePredicate：double</span>        <span class="token comment">// Consumer&lt;T>：参数T ·返回值 void</span>    <span class="token comment">// IntConsumer：int ->void</span>    <span class="token comment">// LongConsumer</span>    <span class="token comment">// DoubleConsumer</span>        <span class="token comment">// Function&lt;T,R>：参数T ·返回值 R</span>    <span class="token comment">//IntFuncation：int->R</span>    <span class="token comment">//LongFunction</span>    <span class="token comment">//DoubleFunction</span>    <span class="token comment">//IntToLongFunction：int->long</span>    <span class="token comment">//IntToDoubleFunction</span>    <span class="token comment">//LongToIntFunction</span>    <span class="token comment">//LongToDoubleFunction</span>    <span class="token comment">//DoubleToIntFunction</span>    <span class="token comment">//DoubleToLongFunction</span>        <span class="token comment">// Supplier&lt;T>：参数无 ·返回值 T</span> <span class="token comment">//……省略好多好多   </span>    <span class="token comment">// UnaryOperator&lt;T>：参数T ·返回值T</span>    <span class="token comment">// BinaryOperator：参数T，T ·返回值T</span>    <span class="token comment">// BiFunction&lt;T,U,R>：参数T,U ·返回值R</span>    <span class="token comment">// BiPredicate&lt;T,U>：参数T,U ·返回值boolean</span>    <span class="token comment">// BiConsumer&lt;T,U>：参数T,U ·返回值void</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><p><br><br></p><h4 id="闭包问题"><a href="#闭包问题" class="headerlink" title="闭包问题"></a>闭包问题</h4><hr><ul><li><a href="https://baike.baidu.com/item/%E9%97%AD%E5%8C%85/10908873">什么是<code>闭包</code>？</a><ul><li>闭包会提升变量的生命周期，这样就可以获取某一个方法中的局部变量</li></ul></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Sout</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//结果是10;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> num<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>代码二：</p><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token function">PSVM</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//public static void main</span>    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> c <span class="token operator">=</span> ele<span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        c<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 结果11</span>            <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> c <span class="token operator">=</span> ele<span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token class-name">Sout</span><span class="token punctuation">(</span>a<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        c<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 结果报错，因为 闭包 中的变量必须是 final 的（也就是一个常量），所以不能修改这个值</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>进阶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【软件使用】IDEA使用Debug找错</title>
    <link href="/2020/05/03/IDEA/%E3%80%90%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8-IDEA%E3%80%91IDEA%E4%BD%BF%E7%94%A8Debug%E6%89%BE%E9%94%99/"/>
    <url>/2020/05/03/IDEA/%E3%80%90%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8-IDEA%E3%80%91IDEA%E4%BD%BF%E7%94%A8Debug%E6%89%BE%E9%94%99/</url>
    
    <content type="html"><![CDATA[<h3 id="单线程-Debug"><a href="#单线程-Debug" class="headerlink" title="单线程 Debug"></a>单线程 Debug</h3><hr><p><br><br></p><h4 id="01-Debug"><a href="#01-Debug" class="headerlink" title="01_Debug"></a>01_Debug</h4><hr><ul><li><p>什么是Debug</p><ul><li>Debug 程序调试</li><li>开发：调试 = 1 : 1.5</li></ul></li><li><p>Debug能帮我们做什么</p><ul><li>追踪代码运行流程</li><li>异常的定位与调试</li><li>线上问题追踪</li></ul></li><li><p>Debug的意义</p><ul><li>熟悉执行流程</li><li>方便理解复杂程序逻辑</li><li>定位问题 提高解决问题的能力</li></ul></li></ul><p><br><br></p><h4 id="02-Idea中的Debug"><a href="#02-Idea中的Debug" class="headerlink" title="02_Idea中的Debug"></a>02_Idea中的Debug</h4><hr><ul><li>设置断点（F9）</li><li>程序调试（按钮x8）</li></ul><table><thead><tr><th>按钮</th><th>快捷方式</th><th>说明</th></tr></thead><tbody><tr><td></td><td>Alt+F10</td><td>如果光标在其他行或者其他页面，点击按钮调到当前代码执行的行。</td></tr><tr><td></td><td>F8</td><td>步过，一步一步往下走，如果这一行上有方法不会进入方法。</td></tr><tr><td></td><td>F7</td><td>步入，如果当前行有方法，可以进入方法内部，一般用于进入自定义方法内，不会进入官方库方法。</td></tr><tr><td></td><td>Alt + Shift + F7</td><td>强制步入，能进入任何方法，查看底层源码的时候可以用此方法进入官方类库。</td></tr><tr><td></td><td>Shift + F8</td><td>不出，从步入的方法内退回到方法调用处，此时方法已经执行完毕，只是还没有完成赋值。</td></tr><tr><td></td><td></td><td>回退断点。</td></tr><tr><td></td><td>Alt + F9</td><td>运行到光标处，可以将光标定位到需要查看的一行，然后使用这一功能，代码会运行至光标行，而不需要打断点。</td></tr><tr><td></td><td>Alt + F8</td><td>计算表达式。</td></tr></tbody></table><ul><li>03_Debug 的使用<ul><li>设置断点</li><li>进入Debug</li></ul></li></ul><p><br><br></p><h4 id="代码实例"><a href="#代码实例" class="headerlink" title="代码实例"></a>代码实例</h4><hr><ul><li>步<ul><li>步过         跳过本行中的方法单行执行</li><li>步入         进入本行中的方法，但不进入官方库方法</li><li>强制步入 进入方法，包括官方类库</li><li>步出        在<code>步入</code>一个方法后，不执行结束则不会退出该方法，使用<code>步出</code>则可以直接结束该方法，调到该方法的<code>调用处</code></li></ul></li></ul><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token operator">></span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"---程序执行开始"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">></span><span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"---程序执行结束"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="code-wrapper"><pre><code>&lt;font color = #f890&gt;步过：&lt;/font&gt;在 2 号断点，步过 &lt;font color = #FF1493&gt;不会进入&lt;/font&gt;add方法而直接获得 add方法的返回值；&lt;font color = #f890&gt;步入：&lt;/font&gt;在 2 号断点，步入 &lt;font color = #FF1493&gt;会进入&lt;/font&gt; add 方法，并一步一步执行，但是在 1 号断点，步入 &lt;font color = #FF1493&gt;不会进入 print 方法&lt;/font&gt;；&lt;font color = #f890&gt;强制步入：&lt;/font&gt;在 1 号断点，强制步入&lt;font color = #FF1493&gt;会进入&lt;/font&gt; print 方法；&lt;font color = #f890&gt;步出：&lt;/font&gt;在 进入 add 方法后，如果不想看后面的代码，可以使用步出，直接&lt;font color = #FF1493&gt;回到&lt;/font&gt; a 方法；</code></pre></div><hr><ul><li>回退 &amp; 运行到光标<ul><li>回退：当 <code>步入</code>一个方法体之后，使用<font color = #f890>回退</font>可以回到该方法的调用处，进而可以重新执行步入等调试（而不用重启Debug）；</li><li>运行到光标：不用频繁设置断点，光标指到哪里，就运行到哪里；</li></ul></li></ul><hr><ul><li>计算表达式 </li></ul><blockquote><ul><li>查看变量的几种方式<ul><li>1、 Debug 的 <font color=#32CD32>Variables</font></li><li>2、 光标放在方法的 形参上面，然后点击 ＋号</li><li>3、 使用<font color=#32CD32>计算表达式</font>功能，输入<code>user</code>，就可以显示用户变量，并且可以<font color=#f890>修改用户变量值</font>；</li><li>修改方法：直接输入<code>user.setUserTyp=(&quot;员工&quot;);</code>点击<code>回车</code>    </li></ul></li></ul></blockquote><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token string">"123456"</span><span class="token punctuation">,</span><span class="token string">"超级管理员"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">login</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>userType<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token string">"超级管理员"</span>：            <span class="token function">sout</span><span class="token punctuation">(</span><span class="token string">"是超级管理员"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//User 类</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> username<span class="token punctuation">;</span>    <span class="token class-name">String</span> password<span class="token punctuation">;</span>    <span class="token class-name">String</span> userType<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><hr><ul><li>条件断点</li></ul><blockquote><ul><li>使用条件：循环300次的断点，需要连点 300 次 步过；</li><li>使用方式：在<code>断点</code>处 右击，在<code>Condititon</code>中输入 <code>i == 300</code>; </li></ul></blockquote><hr><p><br><br></p><h3 id="多线程-Debug"><a href="#多线程-Debug" class="headerlink" title="多线程 Debug"></a>多线程 Debug</h3><hr>]]></content>
    
    
    <categories>
      
      <category>软件使用</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IDEA</tag>
      
      <tag>Error</tag>
      
      <tag>软件使用</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Linux】Kali ｜ 物理机安装笔记</title>
    <link href="/2020/01/12/%E3%80%90Linux%E3%80%91Kali%20%E5%AE%89%E8%A3%85%E7%AC%94%E8%AE%B0/"/>
    <url>/2020/01/12/%E3%80%90Linux%E3%80%91Kali%20%E5%AE%89%E8%A3%85%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h3 id="【试】Kali-安装笔记"><a href="#【试】Kali-安装笔记" class="headerlink" title="【试】Kali 安装笔记"></a>【试】Kali 安装笔记</h3><p><font color=DarkGray size=2>今天得到了一块新的固态硬盘，在物理机上安装了一次 Kali ，总结一下安装心得；</font></p><hr><br><br><h4 id="安装环境："><a href="#安装环境：" class="headerlink" title="安装环境："></a>安装环境：</h4><hr><table><thead><tr><th align="center">电脑型号</th><th align="center">小米 Pro</th><th align="center">备注</th></tr></thead><tbody><tr><td align="center">运行内存</td><td align="center">8G</td><td align="center"></td></tr><tr><td align="center">固态存储</td><td align="center">256G</td><td align="center"></td></tr><tr><td align="center">CPU</td><td align="center">x86</td><td align="center">普普通通的CPU</td></tr></tbody></table><p><br><br></p><h4 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h4><hr><p>由于是单硬盘安装，只要不断 &gt; 下一步 &gt; 下一步 就好，在这里说几个注意事项；</p><ul><li>检查网络硬件的时候，需要一个 路由器 + 一根网线，这样可以让电脑自动获取 IP ，如果检测失败，拔插网线再来一遍；</li><li>安装硬盘我选的是 &gt; 整个硬盘，然后就会自动安装，你可以自己考虑；</li><li>引导，如果是两个硬盘的话，那么就有两种情况：<ul><li>引导放在 Linux 固态上，那么就是 F12 进入系统选择；</li><li>引导放在 Windows 引导下，可能会导致引导出错，导致后期自己搭引导，当然也可能成功；</li></ul></li><li>grub 问题在但固态情况下未遇到；</li><li>最后选择应用的时候，取消了最下方的一个勾选，否则会报错，原因不明；</li><li>安装好第一件事先给<code>root</code>用户更改密码，登录<code>root</code>用户，换源更新，换源步骤如下；</li><li>有一个小问题，安装 VSCode 之后无法安装插件，原来是给的权限不够，遇到相同问题的小伙伴去百度吧，网上挺多的；</li></ul><p><br><br></p><h4 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h4><hr><ul><li>使用<code>vim</code>打开<code>/etc/apt/sources.list</code> 文件，注解内部未注解的代码行，并且粘贴进新的源链接；</li><li>执行命令<code>apt-get update</code>；</li><li>执行命令<code>apt-get upgrade</code>；</li><li>遇到的问题：<ul><li>居然没有自带 vim，很奇怪，所以先使用：<code>apt-get install leafpad</code> 命令，下载安装 leafpad；</li><li>使用 leafpad 代替 vim ，从第一行向下执行；</li><li>依赖错误，使用命令<code>apt -f install</code>解决，解决后重新执行依赖报错的命令；</li><li><br><br></li></ul></li></ul><h4 id="更改密码"><a href="#更改密码" class="headerlink" title="更改密码"></a>更改密码</h4><hr><p>不同于 Windows ，Linux 激活的时候用的并不是管理员，而是普通用户，我们需要通过普通用户更改管理员的密码，过程如下：</p><ul><li>登录普通用户，打开终端输入命令<code>passwd root</code>；</li><li>输入普通用户的登录密码；</li><li>输入两次你想给管理员的密码；</li><li>更改成功，退出登录，重新登录；</li><li>账号是<code>root</code>，密码是刚刚输入的密码；</li></ul><br><br><h4 id="给系统更换语言"><a href="#给系统更换语言" class="headerlink" title="给系统更换语言"></a>给系统更换语言</h4><p>由于暗转的过程比较简单，所以我直接选择了英文安装，然后更改成中文，保留Downloads、Desktop、Documents 等文件夹；<br>较为简单，需要执行的同学请看如<a href="https://www.cnblogs.com/C-Noah/p/14227685.html">【点击这里】</a>；</p><br><br><h4 id="步骤细分"><a href="#步骤细分" class="headerlink" title="步骤细分"></a>步骤细分</h4><hr><ul><li>先准备启动盘，使用的软件是 Deepin ，在接下来更新系统的时候会将资源写进去；</li><li>换固态、装系统、一直下一步、解决问题、开机、给 root 用户设置密码、登录 root；</li><li>换源；</li><li>更换系统语言为中文；</li><li>安装搜狗输入法；</li></ul><p><br><br></p><h4 id="关于工具选择"><a href="#关于工具选择" class="headerlink" title="关于工具选择"></a>关于工具选择</h4><hr><ul><li>办公：摒弃了 Windows 的 Office 全家桶，换成了 WPS for Linux 版本；</li><li>编程：毫无变化，最近准备学习一下 Eclipse 的使用（课程需要）；</li><li>聊天：目前还没找到合适的替代品，不出意外的话，最近两天应该会尝试移植 wine 版本的 QQ / 微信；</li><li>上网： FireFox / Chrome ，一直以来我的不二之选；</li><li>网盘：百度网盘 for Linux；</li><li>音乐：网易云音乐 for Linux；</li><li>上网：小飞机 for Linux<br>目前这些软件已经包括我使用的了，但是还没有 PS / Pr 等软件（其实 Deepin 是有一个叫 Gxxx 的软件来代替 PS 的）不考虑移植，因为那个软件我用着很不习惯；另外在 Windows 上我一直有使用 WallpaperEngine ，在 Linux 上没有绚丽的动态壁纸，但是好在我有几个壁纸网站的永久会员，还有一些免费的壁纸软件可以选择，所以这一点倒不是十分必要；</li></ul><p><br><br></p><h4 id="我使用的-Kali-源"><a href="#我使用的-Kali-源" class="headerlink" title="我使用的 Kali 源"></a>我使用的 Kali 源</h4><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">deb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>kali kali<span class="token operator">-</span>rolling main non<span class="token operator">-</span>free contribdeb<span class="token operator">-</span>src http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>kali kali<span class="token operator">-</span>rolling main non<span class="token operator">-</span>free contrib<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p><br><br></p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><hr><p>这一篇博客就是在 Kali 实体机上写的，之前在 Windows 上使用的是 Typroa 来写 MarkDown，现在使用的是 VSCode 。每一个 MarkDown 的编辑器使用起来都不是很一样，现在正在慢慢适应，还是很不错的，有边写边预览的功能，嗯….好像也没什么要说的，我是用的源附在了上方，要使用的同学自取。</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Kali</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows/MacOS科学上网</title>
    <link href="/2019/10/03/%E4%B8%8A%E7%BD%91/-Windows%E7%BF%BB%E5%A2%99%E6%95%99%E5%AD%A6/"/>
    <url>/2019/10/03/%E4%B8%8A%E7%BD%91/-Windows%E7%BF%BB%E5%A2%99%E6%95%99%E5%AD%A6/</url>
    
    <content type="html"><![CDATA[<h2 id="Windows-MacOS-使用Clash科学上网"><a href="#Windows-MacOS-使用Clash科学上网" class="headerlink" title="Windows/MacOS 使用Clash科学上网"></a>Windows/MacOS 使用Clash科学上网</h2><span id="more"></span><hr><div class="note note-primary">            <p>平台：Windows / MacOS</p><p>工具：Clash</p>          </div><ul><li><a href="https://github.com/Fndroid/clash_for_windows_pkg/releases">【点击此处】</a>去GitHub安装Clash<ul><li>Windows下载.exe文件</li><li>MacOS 下载   .dmg文件</li></ul></li></ul><p><img src="https://i.loli.net/2021/10/03/EmjTHzgYUrCp61v.png" alt="Github截图"></p><ul><li>下载好后双击安装</li><li>打开软件后，点击Profiles，并在<strong>Downloads from a URL</strong>中输入你手中的URL，随后点击【下载】</li></ul><p><img src="https://i.loli.net/2021/10/03/suj7ydJxQ8XFBTZ.png" alt="Clash截图"></p><ul><li>点击General，配置成如下界面：</li></ul><p><img src="https://i.loli.net/2021/10/03/XRiSBLK2FqkJV5w.png" alt="Clash的设置"></p><div class="note note-primary">            <ul><li>等待10秒，等待左上角出现网速，就开始上网了～</li></ul>          </div>]]></content>
    
    
    <categories>
      
      <category>大龄男孩网上冲浪</category>
      
    </categories>
    
    
    <tags>
      
      <tag>上网</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>iPhone/iPad使用 Shadowrocket科学上网</title>
    <link href="/2019/10/02/%E4%B8%8A%E7%BD%91/-iPhone-iPad%E4%BD%BF%E7%94%A8-Shadowrocket%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    <url>/2019/10/02/%E4%B8%8A%E7%BD%91/-iPhone-iPad%E4%BD%BF%E7%94%A8-Shadowrocket%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/</url>
    
    <content type="html"><![CDATA[<h2 id="在iPhone-iPad使用-Shadowrocket科学上网"><a href="#在iPhone-iPad使用-Shadowrocket科学上网" class="headerlink" title="在iPhone/iPad使用 Shadowrocket科学上网"></a>在iPhone/iPad使用 Shadowrocket科学上网</h2><hr><span id="more"></span><div class="note note-primary">            <p>安装软件</p>          </div><ul><li>注册国外区的Apple ID（淘宝有出售，并且有美元代充值//小火箭兑换码的服务）</li><li>使用此ID登录AppStore</li><li>搜索<span class="label label-success">Shadowrocket</span>  或直接<a href="(https://apps.apple.com/us/app/shadowrocket/id932747118)">【点击这里】</a></li></ul><div class="note note-primary">            <p>配置节点</p>          </div><ul><li>安装完成后，点击Logo打开软件</li></ul><p><img src="https://i.loli.net/2021/10/02/xZJEF8AIb3gw4Mk.jpg"></p><ul><li>点击【右上角“➕”号】</li></ul><img src="https://i.loli.net/2021/10/02/7tquR98rSHzEhwB.jpg" width=500px align="center"><ul><li>输入自己的订阅链接，随后点击【完成】即可</li></ul><img src="https://i.loli.net/2021/10/02/xcwX6yMJjd7hVH5.png" width=500px><div class="note note-primary">            <p>补充</p>          </div><ul><li>很多🪜平台都有一键导入Shadowrocket，点击一下链接就好了</li></ul><img src="https://i.loli.net/2021/10/02/EdQIZSMcCXxTGsk.png" width=300px>]]></content>
    
    
    <categories>
      
      <category>大龄男孩网上冲浪</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>【Linux】 Kali 切换语言为中文</title>
    <link href="/2019/07/03/%E3%80%90Linux%E3%80%91-Kali-%E5%88%87%E6%8D%A2%E8%AF%AD%E8%A8%80%E4%B8%BA%E4%B8%AD%E6%96%87/"/>
    <url>/2019/07/03/%E3%80%90Linux%E3%80%91-Kali-%E5%88%87%E6%8D%A2%E8%AF%AD%E8%A8%80%E4%B8%BA%E4%B8%AD%E6%96%87/</url>
    
    <content type="html"><![CDATA[<h3 id="系统介绍"><a href="#系统介绍" class="headerlink" title="系统介绍"></a>系统介绍</h3><hr><p>博主使用的系统是2020版的 VMWare 虚拟机版本，系统运行流畅，其中 VMware 是15 Pro，配置为：2个内存各 1 G，运行起来还是十分流畅的，平时切在副屏上，运行效果跟两个电脑是一样的。</p><hr><p><br><br></p><h3 id="语言设置"><a href="#语言设置" class="headerlink" title="语言设置"></a>语言设置</h3><hr><ul><li>运行<code>apt install ttf-wqy-zenhei</code>命令安装中文字体;</li><li>运行<code>dpkg–reconfigure locales</code>命令设置系统时区，点击回车之后出现如下界面：<br><img src="https://img-blog.csdnimg.cn/20210104013716569.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hza18wMw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li><li>请注意：这虽然看起来是一个图形用户化界面的窗口，但是本质是一个指令操作窗口，可以使用的建基本只有上下左右与 <code>Tab</code> 还有 空格建，其中<code>Tab</code>用于从蓝色区域切换到 确定 / 取消，空格键用于选中；</li><li>按  <code>↓</code>  键，找到 ：<code>[en_us.UTF_8 UTF_8] </code>、<code>[zh_CN.GBK GBK]</code>、<code>[zh_CN.UTF_8 UTF_8]</code>三种语言，并按空格键选中；<br><img src="https://img-blog.csdnimg.cn/20210104014143753.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210104014247708.png" alt="在这里插入图片描述"></li><li>选中以后，点击<code>tab</code>键，切换到确定，然后点击<code>确定</code>，点击后，会看到如下界面：<br><img src="https://img-blog.csdnimg.cn/20210104014448392.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0hza18wMw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li><li>选中<code>zh_CN.UTF-8</code>，点击<code>回车键</code>；</li><li>返回到命令端口，重启即可变成中文界面，注：重启的命令是<code>reboot</code>当然手动重启也无妨；<br><br><br></li></ul><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><hr><br><h4 id="避坑"><a href="#避坑" class="headerlink" title="避坑"></a>避坑</h4><hr><p><font color=red>注意</font>：第一次更新语言之后，开机后会遇到一个窗口（由于每次更改语言后重启只会出现一次，我这里无法出现了，我在这里描述一下）：</p><ul><li>窗口内容分为两列左边是文件夹的原英文名称，右边是中文名称，大致如下：</li></ul><table><thead><tr><th>Desktop</th><th>桌面</th></tr></thead><tbody><tr><td>Downloads</td><td>下载</td></tr><tr><td>Music</td><td>音乐</td></tr><tr><td>Documents</td><td>文件</td></tr></tbody></table><ul><li>窗口的作用是让你决定保留原来的名称（用英文名）还是更新为新的名称（中文名）？其中在最下方有个选项是<code>不再提示</code>，如果你不确定的话，可以先不勾选这个选项，并在下次开机的时候将旧名称与新名称都体验一下，如果想看两种文件名的区别，请继续向下看；<br><br><br></li></ul><h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><hr><p>在开始之前，我要讲清楚一点：即使你选择中文，被改变的文件夹也只有以下几个而已，改成中文看着更舒服，如果你不是经常使用命令终端的话，影响也不是很大，所以我认为最主要的问题是你是否经常使用<code>命令终端</code>进入这几个文件夹，好比我经常会使用<code>cd Downloads</code>命令，并且不希望每次在输入<code>cd</code>之后点击<code>ctrl</code>  +  <code>shift</code>  键更换回中文，再输入<code>下载</code>，再将输入法切换回英文继续执行，那么德华我建议你最好保留英文文件夹名称；如果你的英语实在是不好并且不认为自己可以记住这留个文件夹名称的话，那么建议你使用中文；</p><p><img src="https://img-blog.csdnimg.cn/20210104020036172.png" alt="是一张图片"></p><br><h4 id="对其他操作系统的说明"><a href="#对其他操作系统的说明" class="headerlink" title="对其他操作系统的说明"></a>对其他操作系统的说明</h4><hr><p>中国产的操作系统，是没有这一问题的，即使你的操作系统语言是中文，<code>下载</code>这个文件夹就叫<code>下载</code>而不是<code>Downloads</code>，那么你执行<code>cd Downloads</code>依旧可以进<code>下载</code>文件夹；<br>并且，这些操作系统更换中文输入法没有这么麻烦（甚至可以说包括国外的操作系统，Kali是我见过最麻烦的，Ubuntu切换起来也只是进入设置&gt;更改&gt;重启就好了）;</p><p><br><br><br></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><hr><ul><li>更换语言比较简单；</li><li>文件夹建议还是选择英文的；</li></ul>]]></content>
    
    
    <categories>
      
      <category>Kali</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Debian</tag>
      
      <tag>Kali</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Linux】安装Linux系统后换源操作</title>
    <link href="/2019/07/03/%E3%80%90Linux%E3%80%91%E5%AE%89%E8%A3%85Linux%E7%B3%BB%E7%BB%9F%E5%90%8E%E6%8D%A2%E6%BA%90%E6%93%8D%E4%BD%9C/"/>
    <url>/2019/07/03/%E3%80%90Linux%E3%80%91%E5%AE%89%E8%A3%85Linux%E7%B3%BB%E7%BB%9F%E5%90%8E%E6%8D%A2%E6%BA%90%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h3 id="Linux-换源"><a href="#Linux-换源" class="headerlink" title="Linux 换源"></a>Linux 换源</h3><hr><p><br><br></p><h4 id="换源简介"><a href="#换源简介" class="headerlink" title="换源简介"></a>换源简介</h4><hr><ul><li>什么是源？</li></ul><p>源是 Linux 系统中的一个文件，可以说是 Linux 的灵魂，一个 Linux 配置的源文件决定了 Linux 系统可以获取哪些资源，获取哪些文件，源文件损坏意味着 Linux 系统无法下载  / 更新等；</p><ul><li>为什么要换源？</li></ul><p>除了部分国内的 Linux 系统（Deepin / 麒麟 集成了国内的源，所以不用换）以外，国外的系统，类似于Ubuntu / Kali / Parrot 这一类系统，默认集成的源是国外的源，可能用过 Maven 编程的小伙伴都有过给 Maven 换源的经历，只因为使用国外的源下载 / 更新十分缓慢，并且由于速度慢，可能会导致下载错误，中途停止等状况发生，所以国内的源还是十分重要的；</p><ul><li>源文件存储在哪里？</li></ul><p>从 Linux 的根目录出发，源文件就存储在了 <code>/etc/apt</code>文件夹下，具体地址是：<code>/etc/apt/source.list</code>文件；</p><ul><li>如何换源？</li></ul><p>使用 vim 编辑器进行换源，如果没有使用过 vim 编辑器，可以<a href="https://www.cnblogs.com/C-Noah/p/14223399.html">【点击此处】</a>查看 vim 编辑器的使用方式；</p><p><br><br></p><h4 id="开始换源"><a href="#开始换源" class="headerlink" title="开始换源"></a>开始换源</h4><hr><ul><li>打开终端；</li><li>【如果你不是 root 用户登录的话】请执行 <code>sudo su</code>命令，进入超级用户模式，root 用户可以跳过此步，如果你不确定自己是不是 root 用户的话，也请执行一次；</li><li>在终端中输入：<code>vim /etc/src/source.list</code>打开源文件；</li><li>点击<code>i</code>键进入编辑模式；</li><li>我们观察文件可以看到，有几行代码的前面是有一个<code>#</code>的，这是被注释掉的代码，不发挥作用，换源前我们需要将所有的代码都注释掉，可以选择在没被注释掉的代码前输入两个<code>##</code>，注释的同时，区分出这一行是系统自带的源（如果你想的话，也可以将所有的代码删除掉，但是不建议这么做）；</li><li>点到本博客的最下方，寻找你想要的源，复制后粘贴进源文件（就是当前正在编辑的文件）中，注意：命令行下的粘贴键是：ctrl + shift + c;</li><li>点击<code>Esc</code>键，进入到底行模式；</li><li>输入<code>:wq</code>，这时候你会发现你输入的内容出现在了 终端 的最底部，这就是命令行模式，详情可以<a href="https://www.cnblogs.com/C-Noah/p/14223399.html">【点击此处】</a>看我这一篇博客；</li><li>执行命令：<code>apt-get update</code>进行一次源文件的重新识别；</li><li>执行命令：<code>apt-get upgrade</code>进行一次更新；</li><li>换源结束；</li></ul><p><br><br><br></p><h3 id="国内源"><a href="#国内源" class="headerlink" title="国内源"></a>国内源</h3><hr><br><h4 id="清华源："><a href="#清华源：" class="headerlink" title="清华源："></a>清华源：</h4><hr><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">deb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial main restricteddeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>updates main restricteddeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial universedeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>updates universedeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial multiversedeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>updates multiversedeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>backports main restricted universe multiversedeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>security main restricteddeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>security universe deb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>security multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><h4 id="深度（Deepin）源："><a href="#深度（Deepin）源：" class="headerlink" title="深度（Deepin）源："></a>深度（Deepin）源：</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">deb <span class="token punctuation">[</span>by<span class="token operator">-</span>hash<span class="token operator">=</span>force<span class="token punctuation">]</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>deepin<span class="token operator">/</span> unstable main contrib non<span class="token operator">-</span>free<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br><h4 id="中科大源："><a href="#中科大源：" class="headerlink" title="中科大源："></a>中科大源：</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">deb https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic main restricted universe multiversedeb<span class="token operator">-</span>src https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic main restricted universe multiversedeb https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>updates main restricted universe multiversedeb<span class="token operator">-</span>src https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>updates main restricted universe multiversedeb https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>backports main restricted universe multiversedeb<span class="token operator">-</span>src https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>backports main restricted universe multiversedeb https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>security main restricted universe multiversedeb<span class="token operator">-</span>src https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>security main restricted universe multiversedeb https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>proposed main restricted universe multiversedeb<span class="token operator">-</span>src https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>ustc<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>proposed main restricted universe multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><h4 id="阿里源："><a href="#阿里源：" class="headerlink" title="阿里源："></a>阿里源：</h4><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java"># 阿里镜像源deb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic main restricted universe multiversedeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>security main restricted universe multiversedeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>updates main restricted universe multiversedeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>proposed main restricted universe multiversedeb http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>backports main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>security main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>updates main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>proposed main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>backports main restricted universe multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>入门</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Linux】安装系统的时候遇到grub-install Error 问题的解决，超详细傻瓜式教程</title>
    <link href="/2019/07/03/%E3%80%90Linux%E3%80%91%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%97%B6%E5%80%99%E9%81%87%E5%88%B0grub-install-Error-%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3%EF%BC%8C%E8%B6%85%E8%AF%A6%E7%BB%86%E5%82%BB%E7%93%9C%E5%BC%8F%E6%95%99%E7%A8%8B/"/>
    <url>/2019/07/03/%E3%80%90Linux%E3%80%91%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%97%B6%E5%80%99%E9%81%87%E5%88%B0grub-install-Error-%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3%EF%BC%8C%E8%B6%85%E8%AF%A6%E7%BB%86%E5%82%BB%E7%93%9C%E5%BC%8F%E6%95%99%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>这篇博客写于2020年5月11日，最初发布在我的 CSDN 博客上，当时的我刚玩烂了虚拟机，感觉有些卡顿，所以想换成实体机系统，最好的解决方案就是 双系统 ，一开始我只是实验性的安装了一次，装在了我的外接磁盘上，安装成功，在后面无论怎么安装都失败，我甚至尝试卸载了 Win 系统，只装一个 Ubuntu 系统，也是失败，后来就经历了大概一个月左右的拆机阶段，在一个月的时间里我的笔记本都处于各类硬件零散排放随意换的阶段，甚至更换了全新的硬盘之后，还是失败，最后无奈花钱求助大佬（还是找了三个才成功，前两个都失败了），然后学会了下面一套做法，在正式进入步骤之前，我先说一下但是我的电脑的型号；</p><p><font color=DarkGray size=2>来由于这电脑拿着死沉死沉的，而我不打游戏，当时我以为装系统失败是电脑的问题，就在2020年初换了台电脑，有的参数记不清楚了；</font></p><table><thead><tr><th>计算机</th><th>配置</th><th>备注</th></tr></thead><tbody><tr><td>型号</td><td>雷神 SE911</td><td>购买年份 2017年年底</td></tr><tr><td>CPU</td><td>记不清</td><td></td></tr><tr><td>显卡</td><td>1050T</td><td></td></tr><tr><td>硬盘</td><td>126G（固态） + 1 T（机械）</td><td>+ 512G（外接机械）+256G（外接固态）</td></tr><tr><td>内存</td><td>8Gb</td><td></td></tr></tbody></table><p>由于那一个月的拆电脑经历，后来我在学校跟移动公司合作，开了一个维修电脑的小店，（由于疫情封校生意一度火爆的不行），在这个过程中我收购了一台Macbook Air（一台无法开机的尸体机，后来维修后又卖了），装 Linux 十分顺畅了，且怎么装都可以；</p><p>我现在使用的笔记本是 小米 Pro，性能还可以，装 Ubuntu / Kali还是会遇到 grub 问题，但是国产系统，像是优麒麟（Ukylin）或者深度（Deepin）则不会，当时搜了很多资料都说是由于 英伟达 显卡问题，这一说较为合理，首先Mac笔记本没有独立显卡，而小米笔记本安装Deepin / 麒麟 成功是因为这两个系统在安装的时候就集成了英伟达显卡的驱动，所以我认为这一说法还是比较有道理，但是我还有一种猜测是：也许是因为引导问题导致的grub-install Error，因为当时我的雷神笔记本，再换了硬盘之后，居然还是能扫描到之前的因为，这真的很神奇；不过到现在我也没有真正弄明白为啥会出现这么奇怪的现象 而 Ubuntu 公司却无动于衷，也许是资金有限吧….</p><p><br><br></p><h3 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h3><hr><p>安装之前，请检查一下机子是否有英伟达显卡，对小白来说的话，就是你的机子上面有没有一个这样子的美丽贴纸，黑绿色的背景上面写着NVIDIA，如果有的话，建议收藏一下本帖：</p><p><img src="https://img-blog.csdnimg.cn/20200511013644909.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p><p><br><br></p><h4 id="下载系统："><a href="#下载系统：" class="headerlink" title="下载系统："></a>下载系统：</h4><hr><p>由于是国外的网址，所以下载下来会比较慢，没记错的话，这两个链接应该是永久有效：</p><ul><li>Ubuntu 18.04 + 20.04 版：</li></ul><blockquote><p>复制这段内容后打开百度网盘手机App，操作更方便哦<br>链接：<a href="https://pan.baidu.com/s/1Xc0CaxYZgJtDvWyGH3WuUw">https://pan.baidu.com/s/1Xc0CaxYZgJtDvWyGH3WuUw</a> 提取码：9D8b</p></blockquote><p>安装步骤：本文主要是解决grub问题，所以安装不赘述，需要的话可以[【点击查看】]；</p><ul><li>下载软件：DiskGenius</li></ul><blockquote><p>复制这段内容后打开百度网盘手机App，操作更方便哦<br>链接：<a href="https://pan.baidu.com/s/1p-mwVCcb0f3P91qSQzlqxg">https://pan.baidu.com/s/1p-mwVCcb0f3P91qSQzlqxg</a> 提取码：6bS4</p></blockquote><p><br><br></p><h4 id="解决问题："><a href="#解决问题：" class="headerlink" title="解决问题："></a>解决问题：</h4><hr><ul><li><p>我默认看到这里的你已经遇到了Grub问题，如果没有的话，要么你已经安装了，要么你还没开始，具体安装过程可以去网上百度，网上的教程真的超级多，臂展也有十分详细的说明；</p></li><li><p>重新开机，进入Windows （如果进不去的话就在开机的时候一直点击F12，选择 Windows）</p></li><li><p>打开DiskGenius（以下简称为DG）</p></li><li><p>使用 DG 进入Windows的引导区  EFI 区</p><p>EFI引导区只有100M左右，里面有boot、win等文件</p></li><li><p>解压缩你的 Ubuntu 镜像文件，进入<code>/boot/grub/</code>文件夹下，将里面的所有文件复制桌面（自己新建一个文件夹，命名成ubuntu全小写）</p></li><li><p>将这个文件夹拖到DG的efi的根目录下</p></li><li><p>关闭DG，重启，在开机画面时候按<code>f12</code>，选择U盘启动</p></li><li><p>在<code>ubuntu</code>的地方摁字母<code>e</code>进入编辑模式，可以看到一个类似于代码的文件</p></li><li><p>找到文件中的“—-”，在这几个横杠跟它的前一个单词中间加一个<code>nomodeset</code>（作用：屏蔽显卡），注意这个单词前后都要有空格；</p></li><li><p>更改好以后摁F10，进入安装模式，这里可以Ctrl+c跳过检查，直接进入安装；</p></li><li><p>前面不断执行，直到选择【与Windows一起安装】（install ubuntu alongside with WIindows）还是【自定义】那个界面这里我们选择：其他（something else），进入手动分区：</p><ul><li><p>分区的这里要注意一下，如果你是想ubuntu【运行在固态】【文件存储在机械】就选择如下分区模式：</p></li><li><p><code>/</code> 区 、 固态硬盘、 主分区、大小10G往上，我给了100G，在给朋友装的时候是分了15G，也挺流畅；</p></li><li><p><code>/home</code>区、机械、逻辑分区，大小无限制但是是放文件的建议不要太小，我给300G，给朋友分的时候装了25G；</p></li><li><p>然后挂载在固态开头的地方就行，这里<font color=7baf23 >【一定要拍张照】</font>，一会儿开机时候会用到；</p></li></ul></li><li><p>然后不断继续，最终进入桌面模式，进入后重启；</p></li><li><p>依旧是U盘启动，在 <code>install ubuntu</code> 的地方摁<code>e</code>进入编辑模式；</p></li><li><p>在倒数第二行最后加一个<code>nomodeset</code>，摁F10继续；</p></li></ul><p><br><br></p><h4 id="启动系统"><a href="#启动系统" class="headerlink" title="启动系统"></a>启动系统</h4><hr><ul><li><p>按开机键启动系统，如果正常的输入密码，进入系统了（如果进入系统失败，请直接执行）</p></li><li><p>打开终端，输入以下两条命令：</p><ul><li>sudo sed -i ‘s/vmlinuz/vmlinuz nomodeset  /g’ /boot/grub/grub.cfg</li><li>sudo grep ‘vmlinuz’ /boot/grub/grug.cfg</li></ul></li><li><p>没报错，成功，报错了就输入下面一条命令：</p><ul><li>sudo vim /boot/grub/grub.cfg （用 vim 编辑器打开<code>、boot/grub/grub.cfg</code>文件）；</li><li>在文本里找第一个出现的 “ linux /boot/vmlinuz “在后面加上一个nomodeset，保存退出；</li><li>对 vim 编辑器的使用有疑问可以<a href="https://www.cnblogs.com/C-Noah/p/14223399.html">【点击进入】</a>我的另一篇博客，学习 vim 编辑器的使用；</li></ul></li><li><p>到这里安装已经结束，可是如果在指定这一部分的第一步，也就是【按下开机键启动】的时候进入了 <code>grub&gt;</code>样式的命令行，那么执行如下命令：</p><ul><li>找到刚刚拍的照拍你，可以看到如下信息：<ul><li>给 ubuntu 分的<code>/</code>（根目录）区前面有几个小字，是sd xy（ xy是你的区号，比如我的是sda5），接下来以sda5为例子，介绍以下的命令：</li></ul></li><li>在 grub&gt; 后输入自己的登录账号，点击回车，再输入密码，点击回车（不同版本的系统初始密码不一样，如果不知道的话建议百度，如果提示<code>commond not found</code>的话，则跳过这一步就可以）； </li><li>执行如下命令：<ul><li>ls</li><li>set root=(hd0,5)</li><li>linux /boot/vm</li><li>initrd /boot/init</li><li>boot</li></ul></li></ul></li><li><p>到这里，问题彻底解决；</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Error</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【博客】常用颜色</title>
    <link href="/2019/03/16/markdown/%E3%80%90%E5%8D%9A%E5%AE%A2%E3%80%91%E5%B8%B8%E7%94%A8%E9%A2%9C%E8%89%B2/"/>
    <url>/2019/03/16/markdown/%E3%80%90%E5%8D%9A%E5%AE%A2%E3%80%91%E5%B8%B8%E7%94%A8%E9%A2%9C%E8%89%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="颜色表"><a href="#颜色表" class="headerlink" title="颜色表"></a>颜色表</h2><hr><p><font color=DarkRed>███ ：DarkRed</font></p><p><font color=DarkYellow>███ ：DarkYellow</font></p><p><font color=red>███ ：red</font></p><p><font color=DarkOrange>███ ：DarkOrange</font></p><p><font color=Orange>███ ：Orange</font></p><p><font color=Yellow>███ ：Yellow</font></p><p><font color=LightYellow>███ ：LightYellow</font></p><p><font color=DarkGreen>███ ：DarkGreen</font></p><p><font color=Green>███ ：Green</font></p><p><font color=7baf23 >███ ：7baf23 </font></p><p><font color=LightGreen>███ ：LightGreen</font></p><p><font color=DarkBlue>███ ：DarkBlue</font></p><p><font color=Blue>███ ：Blue</font></p><p><font color=LigBlue>███ ：LigBlue</font></p><p><font color=LightBlue>███ ：LightBlue</font></p><p><font color=Purple>███ ：Purple</font></p><p><font color=DPurple>███ ：Purple</font></p>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Markdown</tag>
      
      <tag>前端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Linux】 Debian 系 Linux 安装搜狗输入法</title>
    <link href="/2018/11/21/%E3%80%90Linux%E3%80%91-Linux-%E5%AE%89%E8%A3%85%E6%90%9C%E7%8B%97%E8%BE%93%E5%85%A5%E6%B3%95/"/>
    <url>/2018/11/21/%E3%80%90Linux%E3%80%91-Linux-%E5%AE%89%E8%A3%85%E6%90%9C%E7%8B%97%E8%BE%93%E5%85%A5%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><font color=Darkgray size=2>罗里吧嗦的话；<font color=7baf23 >可以跳过；</font></font></p><hr><p>搜狗输入法，作为我体验最好的一个输入法，一直陪我从小学走到了现在，优麒麟线上发布会时，搜狗团队代表用“聪明”来形同它，事实也确实如此，它能十分人性地记录使用者常用的热词，并且会“猜测”使用者想表达的意思，一个工具思考变多了，就意味着它的使用者思考变少了，这也正是我一直习惯于搜狗的原因，所以在安装Linux系统之后，第一时间并不是想着如何去安装各种编程工具，而是安装一个搜狗输入法，不过，搜狗对Linux的支持并不是十分友好（主要原因应该是Linux用户还是太少了，并且Linux的不同发行版本太多了，详情可以<a href="https://www.cnblogs.com/C-Noah/p/14221495.html">【点击此处】</a>查看我的另一篇博客），但是好在，国内的几个系统还是跟搜狗公司合作，并且发行了搜狗的Linux版本，接下来看教程。</p><h3 id="避坑介绍"><a href="#避坑介绍" class="headerlink" title="避坑介绍"></a>避坑介绍</h3><p><font color=DarkGray size=2>安装搜狗前的准备工作；<font color=red>不可跳过；</font></font></p><hr><p>在安装之前，要先介绍两个东西，他们分别叫：  fcitx  与 ibus ，这两个工具是 Linux 最原始的输入法工具，其在 Linux 中的地位不下于10年前我们常用的最原始的 拼音 / 五笔 输入法，这两个工具都有自己的中文输入法，也都支持拼音，其中 ibus 自带的是谷歌拼音输入法， fcitx 自带的是简体拼音，而搜狗输入法的 Linux 版正是在 fcitx 的基础上开发出来的，所以如果想在 Linux 上使用搜狗，你的 Linux 必须要安装 fcitx 。</p><p>在这里就可以将系统分为两类，一类是自己系统里集成了 fcitx 的系统，好比较为常见的 Ubuntu ，还有一种就是没有集成 fcitx 的，拿 Kali 举例（首页的背景图就是Kali自带的桌面背景，后面会介绍一下这个系统），除此之外，由于国产系统的逐渐崛起（大部分是基于Linux的），出现了许多自带 搜狗 输入法的系统，我常用的<code>Deepin</code>、优麒麟 等都自己集成了搜狗，这一类系统大部分是使用了一个叫 wine 的微型虚拟机，在这类系统上安装搜狗，只要进入<code>软件商店</code>查找搜狗就可以进行安装。</p><p>在安装搜狗之前，先进入系统的<code>菜单</code>界面（类似于 Win10 的开始界面），在搜索栏输入 fcitx ，如果查找到 fcitx 或者是 “输入法配置”，则证明是系统自己集成了 fcitx 的系统，可以跳过第三步，否则，请从第三步开始执行。</p><h3 id="安装-fcitx"><a href="#安装-fcitx" class="headerlink" title="安装 fcitx"></a>安装 fcitx</h3><p><font color=DarkGray size=2>安装搜狗的准备工作；</font></p><hr><p>看到这里，你的系统应该是没有集成 fcitx 了，这时候请进入软件商店，搜索 <code>fcitx configuration </code>，并进行安装，如果你的系统没有 软件商店的话（Kali就没有），则打开终端运行以下命令：</p><blockquote><div class="code-wrapper"><pre class="line-numbers language-java" data-language="java"><code class="language-java">apt<span class="token operator">-</span>get install fcitx<span class="token operator">-</span>table<span class="token operator">-</span>wbpy ttf<span class="token operator">-</span>wqy<span class="token operator">-</span>microhei ttf<span class="token operator">-</span>wqy<span class="token operator">-</span>zenhei<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></blockquote><p>命令运行成功，则重启一下计算机，进入 <strong>第四步</strong> ，如果提示 找不到资源，那么请[【点击此处】]给Linux换源（博文中有详细介绍什么是换源，为什么换源）；</p><h3 id="安装搜狗输入法"><a href="#安装搜狗输入法" class="headerlink" title="安装搜狗输入法"></a>安装搜狗输入法</h3><p><font color=DarkGray size=2>进入安装步骤；</font></p><hr><ul><li><p><a href="https://pinyin.sogou.com/">【点击进入搜狗官网】</a>下载安装包，其中 Linux 版本的在最上方，下载后的文件是一个<code>.deb</code>文件，这是 Debain 系 Linux 的标准安装包，如果有疑问的话，后期我会介绍一下 Linux 的发展史。</p></li><li><p>打开终端，逐步执行以下命令：</p><ul><li><p>执行<font color=7baf23>cd Downloads</font>命令，进入 <code>下载</code> 文件夹；</p></li><li><p>执行 <font color=7baf23>sudo su</font> 进入超级用户模式，如果你是 root 登录的话，可以跳过这一步（执行也无妨）；</p></li><li><p>执行上面那步会提示输入密码，输入你的解锁密码就可以，输入的内容不会显示在 终端 中，也不会出现<code>*</code>，所以大胆输就行了；</p></li><li><p>执行<font color=7baf23>dpkg -i sogouimebs………….deb</font>安装搜狗输入法，请注意，不要直接复制这条命令，因为随着版本的不同，版本号会出现变化，所以即使我给你完整的命令，这条命令也会随着时间失效，正确的做法如下：</p><blockquote><p>在终端中输入 <font color=7baf23>dpkg -i sogou</font> 后点击<code>tab</code>键进行自动补圈，然后点击回车，其中 tab 键是大写锁定上面的键；</p></blockquote></li><li><p>如果你的安装过程中没有出现报错，那么就已经安装成功了，跳过下面的<code>空心圆圈</code>步骤，直接进入<code>实心圆圈</code>步骤就可以了；</p></li><li><p>如果出现了<code>E</code>或者<code>Err</code>类型的提示，那么就是安装依赖出错，请执行<font color=7baf23>sudo apt –fix-broken install</font>命令，让系统自动解决依赖问题，如果还报错，请执行<font color=7baf23>sudo -f install -y</font>；</p></li><li><p>解决完依赖问题之后，再次执行第四个小圆圈圈的安装命令；</p></li><li><p>重启计算机；</p></li></ul></li></ul><h3 id="配置搜狗输入法"><a href="#配置搜狗输入法" class="headerlink" title="配置搜狗输入法"></a>配置搜狗输入法</h3><p><font color=DarkGray size=2>对输入法进行配置；</font></p><hr><ul><li><p>配置：</p><ul><li>在 菜单 中（也就是那个长的像 Win10的开始菜单的那里）搜索 fcitx</li><li>打开 fcitx configuration，点击最下方加号，选择搜狗输入法：</li><li>关闭界面，同时按下 ctrl + shift 键（部分系统默认是 ctrl + 空格 ）切换至搜狗输入法，如果想将搜狗设置成默认输入法，可以在上一步时，将搜狗输入法的位置调到第一个即可；</li></ul></li><li><p>如果这个时候还没有切换成搜狗输入法，那极大可能是系统默认集成了 ibus ，所以安装了 fcitx 之后，系统默认的还是 ibus ，执行如下步骤进行切换：</p><ul><li><p>打开 系统设置    （settings）</p></li><li><p>进入 区域与语言（Region &amp; Language）</p></li><li><p>进入 管理已经安装的语言（Manag Installed Languages）</p></li><li><p>点击 Keyboard input method system，无论默认状态下是什么，点击选择换成 fcitx</p></li></ul></li><li><p>安装成功</p></li></ul><blockquote><p>有任何问题或不理解，欢迎博客下进行留言，看到后第一时间会进行回复并解决；</p></blockquote><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><p>大家可以尝试一下【优麒麟】系统，自己集成了搜狗输入法、QQ、微信等许多常用软件，同时还支持部分安卓软件的安装。</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Debian</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【杂记】Linus 与 Linux</title>
    <link href="/2018/09/16/%E3%80%90%E6%9D%82%E8%AE%B0%E3%80%91Linus-%E4%B8%8E-Linux/"/>
    <url>/2018/09/16/%E3%80%90%E6%9D%82%E8%AE%B0%E3%80%91Linus-%E4%B8%8E-Linux/</url>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>在三年的我的眼中，世界上还只有三个系统，他们分别是：Window、Android、IOS；除去两个手机系统的话，那么世界上可能就只有一个Windows了；</p><p>三年前，我高三，在去食堂的时候，我的好哥们跟我聊到了手机，他问我：“你知不知道，以前好像有一个塞班系统的？”这句话，仿佛点亮了我对系统世界的认识，以至于后来才会对此有些锲而不舍的劲儿；</p><p>就现在来说，作为我知道的电脑系统，应该有：Docs、Mac、Windows、Unix、Linux 等，这五个是我比较熟悉的，接下来让我说一下这几位在历史上的血雨腥风；</p><h3 id="缘起"><a href="#缘起" class="headerlink" title="缘起"></a>缘起</h3><hr><p>图灵创造计算机的过程，相信大家都懂，我不再过多赘述，不了解的同学可以去看一下电影<a href="https://baike.baidu.com/item/%E6%A8%A1%E4%BB%BF%E6%B8%B8%E6%88%8F/316903?fr=aladdin">【模仿游戏】</a>，抖音里面也有影评，是一部十分不错的电影，我个人很喜欢；</p><p>图灵制造计算机之后，计算机迎来了起步阶段，直到<a href="https://www.sohu.com/a/211330060_286966">【星际旅行】</a>（一个计算机系统的名字，开发团队：贝尔实验室）开始之前，人们一直使用 纸带 来进行编码，有孔的位置为1，无孔的位置为0（没有考究过，或者是反过来表示），这时候的计算机还只是科学家才会使用的工具，星际旅行是一个多层次的电脑系统，类似于现在计算机的雏形，可是由于运行十分不理想，最终被搁置，这之后，贝尔实验室的两个人（Ken Thompson 和 Dernis Ritchie）将代码进行改造后，装在了一台游戏机上，最初的 Unics（UNiplexed Information and Computing Service，后改名为Unix） 就这样出现了；</p><p>Unics 出现后，这个系统依旧是在流转在各种实验室的一个系统，在这个时候，计算机界（或者说是商界）出现了两种声音：一种声音支持将 Unics 系统作为人类智慧的结晶，开源并流传出去，供人们开发；另一个声音则支持将 Unics 作为商用工具，闭源出售用来赚钱，两拨势力针锋相对，最后在法院上，【闭源】胜出了，当时的 Unics 已经被谐音成了 Unix ，这就是最初的 Unix，一个价格昂贵的计算机系统；</p><p>1991年时，一个叫 Linus 的大二计算机学生，十分想要一个 Unix 系统，但是作为赚钱工具的 Unix 对他来说十分昂贵，所以他有个大胆的想法，那就是自己做一个系统（在【鸟哥的Linux私房菜】中写道，Linus的父亲也是计算机从业者，所以他对计算机的敏感可以说是耳濡目染，是一个“少年骇客”）；</p><p>Linus 用了6个月的时间，写出了一个电脑系统的雏形，并且用自己的名字 Linus 来命名了这个系统，这是一个十分不成熟的电脑系统，我个人猜测可能是十分的“垃圾”，当时的 Linus 在写完系统之后，为了能让系统成长起来，他把代码发布到了网上，让网友指出问题并进行改进，没想到他这一举动却在网上引起了轩然大波（个人感觉这像极了MIUI 第一次在国外的论坛上引起轩然大波的样子)，一下子计算机从业者们从世界各地发来邮件，给出代码改进意见，或者功能增加描述等，这所有的邮件都由 Linus 来审核，然后改进， Linus 成了最初的代码审核员；</p><p>经过了一段时间的改进，Linus 系统已经成为了一个比较成熟的计算机系统，这时候的 Linus 系统依旧作为一个开源系统，广为流传，后来人们将 Linus 系统的最后一个字母改成 ‘x’，以纪念 Unix 的【开源战争】。</p><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><hr><p>Linux 出现至今，Linux系统都作为一个十分流行的系统被使用着，后来苹果公司发布了 麦金塔 系列的电脑（以 Unix 为内核），掀起了图形用户化界面的浪潮，这之后的一年，微软公司发布了 初代 的 Windows 电脑，但是由于 麦金塔 的内存小、Bug 多，图形用户化界面的市场最终被 Windows 占据（当然其中还有更多其他复杂的原因），再后来， Windows 与 Mac 你争我赶，这都是现在的事情了，如果有兴趣，可以去我十分喜欢的B站UP主【老师好我叫何同学】那里看一下Windows 与 Mac 的爱恨情长，顺便帮忙催一下更，<a href="https://www.bilibili.com/video/BV1cy4y1k7A2">【点击链接跳转】</a>;</p><p>在 Linux 作为一个实力没有微软苹果雄厚的系统，且没有及时抓住图形用户化的大浪潮，在现在真正的使用用户并不是很多，然而为何它依旧没有被淘汰呢？原因很简单，安全；</p><p>如果你认真的上过【计算机安全】这堂课，那么你就肯定知道 Linux 的安全等级是 2，Windows 系统的安全等级是 3，世界上暂时还没有安全等级是 1 的电脑系统，所以 Linux 系统基本上代表了全世界最安全的系统，并且由于 Linux 开源 且 免费，可以任意更改，所以就有了很多不同版本的“发行版”，在介绍Linux的发展历史之前，先说一些 Linux 有哪些优点：</p><ul><li><p>安全：安全系数要高于 Windows，这在日常使用中可能不会体验到什么优点，但是却是作为服务器的最优选择；</p></li><li><p>轻量：也就是小，安装 Winodows后，你的磁盘会被吃掉30~40Gb的内存，但是一个16Gb的内存卡上就可以安装一个 Linux 系统并且流畅运行（据说8Gb也可以但是我没尝试过）；</p></li><li><p>开源免费：代码公开且免费，任意更改，改个名字之后就可以闭源赚钱了；</p><p>……</p></li></ul><h3 id="Linux-发行版介绍"><a href="#Linux-发行版介绍" class="headerlink" title="Linux 发行版介绍"></a>Linux 发行版介绍</h3><p><font color=DarkGray size=2>国外系统</font></p><hr><blockquote><p><font  color=black><strong>Debian</strong>：这应该是自 Linus 创造 Linux 以后的第一个正式发行版的 Linux 系统，最早出现于1993年，只是在Linus创造Linux之后两年就出现了，这是发展历史最久的发行版系统，经历了时间的洗礼，目前的 Debian 应该是最稳定的 Linux 的系统，也是“儿子”最多的Linux系统；</font></p></blockquote><blockquote><p><font  color=black><strong>Ubuntu</strong>：是我认为最流行的发行版之一，它流行的原因在于：出现较早（2004）且改善了Debian的缺点；它的父亲是Debian，作为较早的 Linux 发行版，它改掉了 Debian 系统一些操作上的弊端，让 Linux 更加面向于大众用户，但是我个人觉得，它更适合的用户是程序员，而不是普通人，因为 生态 太差，目前发行了20.xxLTS版本（长期维护版本），界面变化不大，但是比以前已经好看一些了（18.xx以前很丑）；</font></p></blockquote><blockquote><p><font  color=black><strong>BackTrack</strong>：一个用来做渗透 / 数字取证的系统，如果你不懂，那么跟你说 黑客工具 你应该会比较了解一些，但是现在已经不流行了，因为下面这个系统的出现；</font></p></blockquote><blockquote><p><font  color=black><strong>Kali</strong>：“凯丽”，虽然它的原名也许不是这么叫的，但是我习惯这么称呼她，Kali 系统支持arm架构的芯片，同时也有x86版本，她也是用来做渗透的工具，父亲说是Backtrack应该毫不为过，甚至两者的标志都是一个样子的，是一个S型的西方龙的标志，Kali在BackTrack系统上做了升级，删减了一些工具，增加了一些工具；</font></p><p><font  color=black>我从Kali2018版开始使用它，升级了20.xx版本之后，Kali的桌面环境改成了KDE版本，一开始还有些不适应，但是真的是我接触到的所有国外系统里面最好看的系统，同时我还认识一些使用<a href="https://baike.baidu.com/item/%E6%A0%91%E8%8E%93%E6%B4%BE/80427?fr=aladdin">【树莓派】</a>运行Kali的自称网络安全联盟的小黑客，很有意思；</font></p></blockquote><blockquote><p><font color=black><strong>Parrot OS（鹦鹉）</strong>：与Kali几乎一致，用于渗透，在Linux圈被称为盗版Linux，与linux一样，界面很炫酷，集成的工具很多，图标是个鹦鹉，很好看，我只用过几天，且这几天我是在用了Deepin这样的<strong>友好型</strong>系统之后用的， 所以我甚至没能成功在Parrot上安装上搜狗输入法，就因为故障，后来卸载了；</font></p></blockquote><p><font color=DarkGray size=2>国产系统</font></p><hr><blockquote><p><font  color=black><strong>优麒麟</strong>：界面美观，支持搜狗输入法 / QQ / 微信 (都是wine移植版)等，20.xx版本的系统在界面上集成了 Windows 系统与 Mac 系统的优点，但是由于刚发布出来，还不是很稳定，且操作有些生硬，这是我在日常体验中不选择优麒麟的主要原因，它太像 Win10 却不如 Win10 方便，所以暂时不考虑它；</font></p><p><font  color=black>我之前有幸认识了几个优麒麟系统的开发人员，在之前一小段体验中，给过我一些指导，在此致谢！</font></p></blockquote><blockquote><p><font  color=black><strong>Deepin（深度）</strong>:界面美观（十分美观，这美观像是Mac的美观，而不像是Kali和Parrot的酷炫）大气，方便使用，集成了 优麒麟 的几乎所有优点（今年几乎所有的Linux系统都发布了20.xx版本），Deepin和麒麟的20.xx版本几乎一模一样），但是Deepin比优麒麟要灵活，且有一个我很喜欢的功能：雷神终端；这个终端超级灵活，支持快捷键呼出 / 鼠标失去焦点后自动隐藏 / 且支持快捷命令（将几个命令集成成一个快捷键，好比我点击 ctrl + alt + r 自动进入某个文件夹并启动 redis 之类的软件，对开发很友好）；</font></p><p><font  color=black>Deepin我还是使用了较长时间的，最后死在了不稳定上，且系统较大，吃配置，配置低带不动，配置高嫌浪费，有些鸡肋的一个系统；我是一机双系统，在有一次进入Deepin后，Win上被莫名其妙删除了很多文件，就放弃了这个系统；</font></p></blockquote><h3 id="其他系统"><a href="#其他系统" class="headerlink" title="其他系统"></a>其他系统</h3><hr><p>塞班：没用过不评价，甚至不确定是手机系统还是电脑系统（应该是手机系统）</p><p>MacOS：我很喜欢他的操作界面，且欣赏它的流畅程度，曾经使用过几个月的Mac Air、Mac Mini、在帮人装系统的时候接触过Mac Pro，最近M1芯片出来之后更是爱的不行，希望大学毕业之后能买一台M1芯片的Pro（目前不买的原因有二：是个资金不充足的学生 / M1 芯片尚不稳定，前者是坎儿，后者关系不是很大）</p><p>我后来自己给自己装过黑苹果系统且有半年多的使用体验，较为稳定，有一两个Bug（蓝牙偶尔连不上  / 外接网卡有一两次不给力）、不能使用AirDrop（我最心痛的就是这一点），如果有想了解的话可以百度，或者B站搜索，或者去<strong>黑果小兵的部落阁</strong>去看教程，下软件，体验还行，安装麻烦，我折腾了一整个晚上；</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><hr><p>建议小白用 Windows ，探索党用 Linux ，不嫌麻烦的可以体验黑苹果；</p><p>Linux方面，入门建议 Ubuntu ，想用着方便些建议 Deepin  / 优麒麟 ，20.xx 版本会越来越稳定的，我如此相信着。</p>]]></content>
    
    
    <categories>
      
      <category>杂记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>杂记</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
